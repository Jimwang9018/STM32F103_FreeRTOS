cscope 15 E:\myteeth code\myteeth_v0.7.3\USER"               0000489825
	@E:\MYTEET~1\MYTEET~1.3\CMSIS\SYSTEM~1.C

65 
	~"°m32f10x.h
"

106 #i‡
deföed
 (
STM32F10X_LD_VL
Ë|| (deföed 
STM32F10X_MD_VL
Ë|| (deföed 
STM32F10X_HD_VL
)

108 
	#SYSCLK_FREQ_24MHz
 24000000

	)

115 
	#SYSCLK_FREQ_72MHz
 72000000

	)

121 #i‡
deföed
 (
STM32F10X_HD
Ë|| (deföed 
STM32F10X_XL
Ë|| (deföed 
STM32F10X_HD_VL
)

128 
	#VECT_TAB_OFFSET
 0x0

	)

151 #ifde‡
SYSCLK_FREQ_HSE


152 
uöt32_t
 
	gSy°emC‹eClock
 = 
SYSCLK_FREQ_HSE
;

153 #ñi‡
deföed
 
SYSCLK_FREQ_24MHz


154 
uöt32_t
 
	gSy°emC‹eClock
 = 
SYSCLK_FREQ_24MHz
;

155 #ñi‡
deföed
 
SYSCLK_FREQ_36MHz


156 
uöt32_t
 
	gSy°emC‹eClock
 = 
SYSCLK_FREQ_36MHz
;

157 #ñi‡
deföed
 
SYSCLK_FREQ_48MHz


158 
uöt32_t
 
	gSy°emC‹eClock
 = 
SYSCLK_FREQ_48MHz
;

159 #ñi‡
deföed
 
SYSCLK_FREQ_56MHz


160 
uöt32_t
 
	gSy°emC‹eClock
 = 
SYSCLK_FREQ_56MHz
;

161 #ñi‡
deföed
 
SYSCLK_FREQ_72MHz


162 
uöt32_t
 
	gSy°emC‹eClock
 = 
SYSCLK_FREQ_72MHz
;

164 
uöt32_t
 
	gSy°emC‹eClock
 = 
HSI_VALUE
;

167 
__I
 
uöt8_t
 
	gAHBPªscTabÀ
[16] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9};

176 
SëSysClock
();

178 #ifde‡
SYSCLK_FREQ_HSE


179 
SëSysClockToHSE
();

180 #ñi‡
deföed
 
SYSCLK_FREQ_24MHz


181 
SëSysClockTo24
();

182 #ñi‡
deföed
 
SYSCLK_FREQ_36MHz


183 
SëSysClockTo36
();

184 #ñi‡
deföed
 
SYSCLK_FREQ_48MHz


185 
SëSysClockTo48
();

186 #ñi‡
deföed
 
SYSCLK_FREQ_56MHz


187 
SëSysClockTo56
();

188 #ñi‡
deföed
 
SYSCLK_FREQ_72MHz


189 
SëSysClockTo72
();

192 #ifde‡
DATA_IN_ExtSRAM


193 
Sy°emInô_ExtMemCé
();

212 
	$Sy°emInô
 ()

216 
RCC
->
CR
 |(
uöt32_t
)0x00000001;

219 #i‚de‡
STM32F10X_CL


220 
RCC
->
CFGR
 &(
uöt32_t
)0xF8FF0000;

222 
RCC
->
CFGR
 &(
uöt32_t
)0xF0FF0000;

226 
RCC
->
CR
 &(
uöt32_t
)0xFEF6FFFF;

229 
RCC
->
CR
 &(
uöt32_t
)0xFFFBFFFF;

232 
RCC
->
CFGR
 &(
uöt32_t
)0xFF80FFFF;

234 #ifde‡
STM32F10X_CL


236 
RCC
->
CR
 &(
uöt32_t
)0xEBFFFFFF;

239 
RCC
->
CIR
 = 0x00FF0000;

242 
RCC
->
CFGR2
 = 0x00000000;

243 #ñi‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| (
deföed
 
STM32F10X_HD_VL
)

245 
RCC
->
CIR
 = 0x009F0000;

248 
RCC
->
CFGR2
 = 0x00000000;

251 
RCC
->
CIR
 = 0x009F0000;

254 #i‡
	`deföed
 (
STM32F10X_HD
Ë|| (
deföed
 
STM32F10X_XL
Ë|| (deföed 
STM32F10X_HD_VL
)

255 #ifde‡
DATA_IN_ExtSRAM


256 
	`Sy°emInô_ExtMemCé
();

262 
	`SëSysClock
();

264 #ifde‡
VECT_TAB_SRAM


265 
SCB
->
VTOR
 = 
SRAM_BASE
 | 
VECT_TAB_OFFSET
;

267 
SCB
->
VTOR
 = 
FLASH_BASE
 | 
VECT_TAB_OFFSET
;

269 
	}
}

306 
	$Sy°emC‹eClockUpd©e
 ()

308 
uöt32_t
 
tmp
 = 0, 
∂lmuŒ
 = 0, 
∂lsour˚
 = 0;

310 #ifde‡ 
STM32F10X_CL


311 
uöt32_t
 
¥ediv1sour˚
 = 0, 
¥ediv1Á˘‹
 = 0, 
¥ediv2Á˘‹
 = 0, 
∂l2muŒ
 = 0;

314 #i‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| (
deföed
 
STM32F10X_HD_VL
)

315 
uöt32_t
 
¥ediv1Á˘‹
 = 0;

319 
tmp
 = 
RCC
->
CFGR
 & 
RCC_CFGR_SWS
;

321 
tmp
)

324 
Sy°emC‹eClock
 = 
HSI_VALUE
;

327 
Sy°emC‹eClock
 = 
HSE_VALUE
;

332 
∂lmuŒ
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLMULL
;

333 
∂lsour˚
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLSRC
;

335 #i‚de‡
STM32F10X_CL


336 
∂lmuŒ
 = (Öllmull >> 18) + 2;

338 i‡(
∂lsour˚
 == 0x00)

341 
Sy°emC‹eClock
 = (
HSI_VALUE
 >> 1Ë* 
∂lmuŒ
;

345 #i‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| (
deföed
 
STM32F10X_HD_VL
)

346 
¥ediv1Á˘‹
 = (
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV1
) + 1;

348 
Sy°emC‹eClock
 = (
HSE_VALUE
 / 
¥ediv1Á˘‹
Ë* 
∂lmuŒ
;

351 i‡((
RCC
->
CFGR
 & 
RCC_CFGR_PLLXTPRE
Ë!(
uöt32_t
)
RESET
)

353 
Sy°emC‹eClock
 = (
HSE_VALUE
 >> 1Ë* 
∂lmuŒ
;

357 
Sy°emC‹eClock
 = 
HSE_VALUE
 * 
∂lmuŒ
;

362 
∂lmuŒ
 =Öllmull >> 18;

364 i‡(
∂lmuŒ
 != 0x0D)

366 
∂lmuŒ
 += 2;

370 
∂lmuŒ
 = 13 / 2;

373 i‡(
∂lsour˚
 == 0x00)

376 
Sy°emC‹eClock
 = (
HSI_VALUE
 >> 1Ë* 
∂lmuŒ
;

382 
¥ediv1sour˚
 = 
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV1SRC
;

383 
¥ediv1Á˘‹
 = (
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV1
) + 1;

385 i‡(
¥ediv1sour˚
 == 0)

388 
Sy°emC‹eClock
 = (
HSE_VALUE
 / 
¥ediv1Á˘‹
Ë* 
∂lmuŒ
;

394 
¥ediv2Á˘‹
 = ((
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV2
) >> 4) + 1;

395 
∂l2muŒ
 = ((
RCC
->
CFGR2
 & 
RCC_CFGR2_PLL2MUL
) >> 8 ) + 2;

396 
Sy°emC‹eClock
 = (((
HSE_VALUE
 / 
¥ediv2Á˘‹
Ë* 
∂l2muŒ
Ë/ 
¥ediv1Á˘‹
Ë* 
∂lmuŒ
;

403 
Sy°emC‹eClock
 = 
HSI_VALUE
;

409 
tmp
 = 
AHBPªscTabÀ
[((
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
) >> 4)];

411 
Sy°emC‹eClock
 >>
tmp
;

412 
	}
}

419 
	$SëSysClock
()

421 #ifde‡
SYSCLK_FREQ_HSE


422 
	`SëSysClockToHSE
();

423 #ñi‡
deföed
 
SYSCLK_FREQ_24MHz


424 
	`SëSysClockTo24
();

425 #ñi‡
deföed
 
SYSCLK_FREQ_36MHz


426 
	`SëSysClockTo36
();

427 #ñi‡
deföed
 
SYSCLK_FREQ_48MHz


428 
	`SëSysClockTo48
();

429 #ñi‡
deföed
 
SYSCLK_FREQ_56MHz


430 
	`SëSysClockTo56
();

431 #ñi‡
deföed
 
SYSCLK_FREQ_72MHz


432 
	`SëSysClockTo72
();

437 
	}
}

445 #ifde‡
DATA_IN_ExtSRAM


455 
	$Sy°emInô_ExtMemCé
()

461 
RCC
->
AHBENR
 = 0x00000114;

464 
RCC
->
APB2ENR
 = 0x000001E0;

472 
GPIOD
->
CRL
 = 0x44BB44BB;

473 
GPIOD
->
CRH
 = 0xBBBBBBBB;

475 
GPIOE
->
CRL
 = 0xB44444BB;

476 
GPIOE
->
CRH
 = 0xBBBBBBBB;

478 
GPIOF
->
CRL
 = 0x44BBBBBB;

479 
GPIOF
->
CRH
 = 0xBBBB4444;

481 
GPIOG
->
CRL
 = 0x44BBBBBB;

482 
GPIOG
->
CRH
 = 0x44444B44;

487 
FSMC_B™k1
->
BTCR
[4] = 0x00001011;

488 
FSMC_B™k1
->
BTCR
[5] = 0x00000200;

489 
	}
}

492 #ifde‡
SYSCLK_FREQ_HSE


500 
	$SëSysClockToHSE
()

502 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0, 
HSESètus
 = 0;

506 
RCC
->
CR
 |((
uöt32_t
)
RCC_CR_HSEON
);

511 
HSESètus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

512 
SèπUpCou¡î
++;

513 } (
HSESètus
 =0Ë&& (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
));

515 i‡((
RCC
->
CR
 & 
RCC_CR_HSERDY
Ë!
RESET
)

517 
HSESètus
 = (
uöt32_t
)0x01;

521 
HSESètus
 = (
uöt32_t
)0x00;

524 i‡(
HSESètus
 =(
uöt32_t
)0x01)

527 #i‡!
deföed
 
STM32F10X_LD_VL
 && !deföed 
STM32F10X_MD_VL
 && !deföed 
STM32F10X_HD_VL


529 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

532 
FLASH
->
ACR
 &(
uöt32_t
)((uöt32_t)~
FLASH_ACR_LATENCY
);

534 #i‚de‡
STM32F10X_CL


535 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_0
;

537 i‡(
HSE_VALUE
 <= 24000000)

539 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_0
;

543 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_1
;

549 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_HPRE_DIV1
;

552 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE2_DIV1
;

555 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE1_DIV1
;

558 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_SW
));

559 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_SW_HSE
;

562 (
RCC
->
CFGR
 & (
uöt32_t
)
RCC_CFGR_SWS
) != (uint32_t)0x04)

570 
	}
}

571 #ñi‡
deföed
 
SYSCLK_FREQ_24MHz


579 
	$SëSysClockTo24
()

581 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0, 
HSESètus
 = 0;

585 
RCC
->
CR
 |((
uöt32_t
)
RCC_CR_HSEON
);

590 
HSESètus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

591 
SèπUpCou¡î
++;

592 } (
HSESètus
 =0Ë&& (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
));

594 i‡((
RCC
->
CR
 & 
RCC_CR_HSERDY
Ë!
RESET
)

596 
HSESètus
 = (
uöt32_t
)0x01;

600 
HSESètus
 = (
uöt32_t
)0x00;

603 i‡(
HSESètus
 =(
uöt32_t
)0x01)

605 #i‡!
deföed
 
STM32F10X_LD_VL
 && !deföed 
STM32F10X_MD_VL
 && !deföed 
STM32F10X_HD_VL


607 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

610 
FLASH
->
ACR
 &(
uöt32_t
)((uöt32_t)~
FLASH_ACR_LATENCY
);

611 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_0
;

615 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_HPRE_DIV1
;

618 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE2_DIV1
;

621 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE1_DIV1
;

623 #ifde‡
STM32F10X_CL


626 
RCC
->
CFGR
 &(
uöt32_t
)~(
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLMULL
);

627 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

628 
RCC_CFGR_PLLMULL6
);

632 
RCC
->
CFGR2
 &(
uöt32_t
)~(
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

633 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

634 
RCC
->
CFGR2
 |(
uöt32_t
)(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

635 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV10
);

638 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

640 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0)

643 #ñi‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
)

645 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLMULL
));

646 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLSRC_PREDIV1
 | 
RCC_CFGR_PLLXTPRE_PREDIV1_Div2
 | 
RCC_CFGR_PLLMULL6
);

649 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLMULL
));

650 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLXTPRE_HSE_Div2
 | 
RCC_CFGR_PLLMULL6
);

654 
RCC
->
CR
 |
RCC_CR_PLLON
;

657 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0)

662 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_SW
));

663 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_SW_PLL
;

666 (
RCC
->
CFGR
 & (
uöt32_t
)
RCC_CFGR_SWS
) != (uint32_t)0x08)

674 
	}
}

675 #ñi‡
deföed
 
SYSCLK_FREQ_36MHz


683 
	$SëSysClockTo36
()

685 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0, 
HSESètus
 = 0;

689 
RCC
->
CR
 |((
uöt32_t
)
RCC_CR_HSEON
);

694 
HSESètus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

695 
SèπUpCou¡î
++;

696 } (
HSESètus
 =0Ë&& (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
));

698 i‡((
RCC
->
CR
 & 
RCC_CR_HSERDY
Ë!
RESET
)

700 
HSESètus
 = (
uöt32_t
)0x01;

704 
HSESètus
 = (
uöt32_t
)0x00;

707 i‡(
HSESètus
 =(
uöt32_t
)0x01)

710 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

713 
FLASH
->
ACR
 &(
uöt32_t
)((uöt32_t)~
FLASH_ACR_LATENCY
);

714 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_1
;

717 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_HPRE_DIV1
;

720 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE2_DIV1
;

723 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE1_DIV1
;

725 #ifde‡
STM32F10X_CL


729 
RCC
->
CFGR
 &(
uöt32_t
)~(
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLMULL
);

730 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

731 
RCC_CFGR_PLLMULL9
);

736 
RCC
->
CFGR2
 &(
uöt32_t
)~(
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

737 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

738 
RCC
->
CFGR2
 |(
uöt32_t
)(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

739 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV10
);

742 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

744 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0)

750 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLMULL
));

751 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLXTPRE_HSE_Div2
 | 
RCC_CFGR_PLLMULL9
);

755 
RCC
->
CR
 |
RCC_CR_PLLON
;

758 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0)

763 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_SW
));

764 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_SW_PLL
;

767 (
RCC
->
CFGR
 & (
uöt32_t
)
RCC_CFGR_SWS
) != (uint32_t)0x08)

775 
	}
}

776 #ñi‡
deföed
 
SYSCLK_FREQ_48MHz


784 
	$SëSysClockTo48
()

786 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0, 
HSESètus
 = 0;

790 
RCC
->
CR
 |((
uöt32_t
)
RCC_CR_HSEON
);

795 
HSESètus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

796 
SèπUpCou¡î
++;

797 } (
HSESètus
 =0Ë&& (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
));

799 i‡((
RCC
->
CR
 & 
RCC_CR_HSERDY
Ë!
RESET
)

801 
HSESètus
 = (
uöt32_t
)0x01;

805 
HSESètus
 = (
uöt32_t
)0x00;

808 i‡(
HSESètus
 =(
uöt32_t
)0x01)

811 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

814 
FLASH
->
ACR
 &(
uöt32_t
)((uöt32_t)~
FLASH_ACR_LATENCY
);

815 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_1
;

818 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_HPRE_DIV1
;

821 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE2_DIV1
;

824 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE1_DIV2
;

826 #ifde‡
STM32F10X_CL


831 
RCC
->
CFGR2
 &(
uöt32_t
)~(
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

832 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

833 
RCC
->
CFGR2
 |(
uöt32_t
)(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

834 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV5
);

837 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

839 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0)

845 
RCC
->
CFGR
 &(
uöt32_t
)~(
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLMULL
);

846 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

847 
RCC_CFGR_PLLMULL6
);

850 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLMULL
));

851 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLMULL6
);

855 
RCC
->
CR
 |
RCC_CR_PLLON
;

858 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0)

863 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_SW
));

864 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_SW_PLL
;

867 (
RCC
->
CFGR
 & (
uöt32_t
)
RCC_CFGR_SWS
) != (uint32_t)0x08)

875 
	}
}

877 #ñi‡
deföed
 
SYSCLK_FREQ_56MHz


885 
	$SëSysClockTo56
()

887 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0, 
HSESètus
 = 0;

891 
RCC
->
CR
 |((
uöt32_t
)
RCC_CR_HSEON
);

896 
HSESètus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

897 
SèπUpCou¡î
++;

898 } (
HSESètus
 =0Ë&& (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
));

900 i‡((
RCC
->
CR
 & 
RCC_CR_HSERDY
Ë!
RESET
)

902 
HSESètus
 = (
uöt32_t
)0x01;

906 
HSESètus
 = (
uöt32_t
)0x00;

909 i‡(
HSESètus
 =(
uöt32_t
)0x01)

912 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

915 
FLASH
->
ACR
 &(
uöt32_t
)((uöt32_t)~
FLASH_ACR_LATENCY
);

916 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_2
;

919 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_HPRE_DIV1
;

922 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE2_DIV1
;

925 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE1_DIV2
;

927 #ifde‡
STM32F10X_CL


932 
RCC
->
CFGR2
 &(
uöt32_t
)~(
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

933 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

934 
RCC
->
CFGR2
 |(
uöt32_t
)(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

935 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV5
);

938 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

940 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0)

946 
RCC
->
CFGR
 &(
uöt32_t
)~(
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLMULL
);

947 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

948 
RCC_CFGR_PLLMULL7
);

951 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLMULL
));

952 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLMULL7
);

957 
RCC
->
CR
 |
RCC_CR_PLLON
;

960 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0)

965 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_SW
));

966 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_SW_PLL
;

969 (
RCC
->
CFGR
 & (
uöt32_t
)
RCC_CFGR_SWS
) != (uint32_t)0x08)

977 
	}
}

979 #ñi‡
deföed
 
SYSCLK_FREQ_72MHz


987 
	$SëSysClockTo72
()

989 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0, 
HSESètus
 = 0;

993 
RCC
->
CR
 |((
uöt32_t
)
RCC_CR_HSEON
);

998 
HSESètus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

999 
SèπUpCou¡î
++;

1000 } (
HSESètus
 =0Ë&& (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
));

1002 i‡((
RCC
->
CR
 & 
RCC_CR_HSERDY
Ë!
RESET
)

1004 
HSESètus
 = (
uöt32_t
)0x01;

1008 
HSESètus
 = (
uöt32_t
)0x00;

1011 i‡(
HSESètus
 =(
uöt32_t
)0x01)

1014 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

1017 
FLASH
->
ACR
 &(
uöt32_t
)((uöt32_t)~
FLASH_ACR_LATENCY
);

1018 
FLASH
->
ACR
 |(
uöt32_t
)
FLASH_ACR_LATENCY_2
;

1022 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_HPRE_DIV1
;

1025 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE2_DIV1
;

1028 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_PPRE1_DIV2
;

1030 #ifde‡
STM32F10X_CL


1035 
RCC
->
CFGR2
 &(
uöt32_t
)~(
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

1036 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

1037 
RCC
->
CFGR2
 |(
uöt32_t
)(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

1038 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV5
);

1041 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

1043 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0)

1049 
RCC
->
CFGR
 &(
uöt32_t
)~(
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLMULL
);

1050 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

1051 
RCC_CFGR_PLLMULL9
);

1054 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

1055 
RCC_CFGR_PLLMULL
));

1056 
RCC
->
CFGR
 |(
uöt32_t
)(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLMULL9
);

1060 
RCC
->
CR
 |
RCC_CR_PLLON
;

1063 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0)

1068 
RCC
->
CFGR
 &(
uöt32_t
)((uöt32_t)~(
RCC_CFGR_SW
));

1069 
RCC
->
CFGR
 |(
uöt32_t
)
RCC_CFGR_SW_PLL
;

1072 (
RCC
->
CFGR
 & (
uöt32_t
)
RCC_CFGR_SWS
) != (uint32_t)0x08)

1080 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\CMSIS\core_cm3.c

24 
	~<°döt.h
>

27 #i‡
deföed
 ( 
__CC_ARM
 )

28 
	#__ASM
 
__asm


	)

29 
	#__INLINE
 
__ölöe


	)

31 #ñi‡
deföed
 ( 
__ICCARM__
 )

32 
	#__ASM
 
__asm


	)

33 
	#__INLINE
 
ölöe


	)

35 #ñi‡
deföed
 ( 
__GNUC__
 )

36 
	#__ASM
 
__asm


	)

37 
	#__INLINE
 
ölöe


	)

39 #ñi‡
deföed
 ( 
__TASKING__
 )

40 
	#__ASM
 
__asm


	)

41 
	#__INLINE
 
ölöe


	)

48 #i‡
deföed
 ( 
__CC_ARM
 )

58 
__ASM
 
uöt32_t
 
	$__gë_PSP
()

60 
mrs
 
r0
, 
p•


61 
bx
 
Ã


62 
	}
}

72 
__ASM
 
	$__£t_PSP
(
uöt32_t
 
t›OfProcSèck
)

74 
m§
 
p•
, 
r0


75 
bx
 
Ã


76 
	}
}

86 
__ASM
 
uöt32_t
 
	$__gë_MSP
()

88 
mrs
 
r0
, 
m•


89 
bx
 
Ã


90 
	}
}

100 
__ASM
 
	$__£t_MSP
(
uöt32_t
 
maöSèckPoöãr
)

102 
m§
 
m•
, 
r0


103 
bx
 
Ã


104 
	}
}

114 
__ASM
 
uöt32_t
 
	$__REV16
(
uöt16_t
 
vÆue
)

116 
ªv16
 
r0
,Ñ0

117 
bx
 
Ã


118 
	}
}

128 
__ASM
 
öt32_t
 
	$__REVSH
(
öt16_t
 
vÆue
)

130 
ªvsh
 
r0
,Ñ0

131 
bx
 
Ã


132 
	}
}

135 #i‡(
__ARMCC_VERSION
 < 400000)

142 
__ASM
 
	$__CLREX
()

144 
˛ªx


145 
	}
}

154 
__ASM
 
uöt32_t
 
	$__gë_BASEPRI
()

156 
mrs
 
r0
, 
ba£¥i


157 
bx
 
Ã


158 
	}
}

167 
__ASM
 
	$__£t_BASEPRI
(
uöt32_t
 
ba£Pri
)

169 
m§
 
ba£¥i
, 
r0


170 
bx
 
Ã


171 
	}
}

180 
__ASM
 
uöt32_t
 
	$__gë_PRIMASK
()

182 
mrs
 
r0
, 
¥imask


183 
bx
 
Ã


184 
	}
}

193 
__ASM
 
	$__£t_PRIMASK
(
uöt32_t
 
¥iMask
)

195 
m§
 
¥imask
, 
r0


196 
bx
 
Ã


197 
	}
}

206 
__ASM
 
uöt32_t
 
	$__gë_FAULTMASK
()

208 
mrs
 
r0
, 
Áu…mask


209 
bx
 
Ã


210 
	}
}

219 
__ASM
 
	$__£t_FAULTMASK
(
uöt32_t
 
Áu…Mask
)

221 
m§
 
Áu…mask
, 
r0


222 
bx
 
Ã


223 
	}
}

232 
__ASM
 
uöt32_t
 
	$__gë_CONTROL
()

234 
mrs
 
r0
, 
c⁄åﬁ


235 
bx
 
Ã


236 
	}
}

245 
__ASM
 
	$__£t_CONTROL
(
uöt32_t
 
c⁄åﬁ
)

247 
m§
 
c⁄åﬁ
, 
r0


248 
bx
 
Ã


249 
	}
}

255 #ñi‡(
deföed
 (
__ICCARM__
))

257 #¥agm®
düg_suµªss
=
Pe940


266 
uöt32_t
 
	$__gë_PSP
()

268 
	`__ASM
("mrsÑ0,Ösp");

269 
	`__ASM
("bxÜr");

270 
	}
}

280 
	$__£t_PSP
(
uöt32_t
 
t›OfProcSèck
)

282 
	`__ASM
("msrÖsp,Ñ0");

283 
	`__ASM
("bxÜr");

284 
	}
}

294 
uöt32_t
 
	$__gë_MSP
()

296 
	`__ASM
("mrsÑ0, msp");

297 
	`__ASM
("bxÜr");

298 
	}
}

308 
	$__£t_MSP
(
uöt32_t
 
t›OfMaöSèck
)

310 
	`__ASM
("msr msp,Ñ0");

311 
	`__ASM
("bxÜr");

312 
	}
}

322 
uöt32_t
 
	$__REV16
(
uöt16_t
 
vÆue
)

324 
	`__ASM
("rev16Ñ0,Ñ0");

325 
	`__ASM
("bxÜr");

326 
	}
}

336 
uöt32_t
 
	$__RBIT
(
uöt32_t
 
vÆue
)

338 
	`__ASM
("rbitÑ0,Ñ0");

339 
	`__ASM
("bxÜr");

340 
	}
}

350 
uöt8_t
 
	$__LDREXB
(
uöt8_t
 *
addr
)

352 
	`__ASM
("ldrexbÑ0, [r0]");

353 
	`__ASM
("bxÜr");

354 
	}
}

364 
uöt16_t
 
	$__LDREXH
(
uöt16_t
 *
addr
)

366 
	`__ASM
("ldrexhÑ0, [r0]");

367 
	`__ASM
("bxÜr");

368 
	}
}

378 
uöt32_t
 
	$__LDREXW
(
uöt32_t
 *
addr
)

380 
	`__ASM
("ldrexÑ0, [r0]");

381 
	`__ASM
("bxÜr");

382 
	}
}

393 
uöt32_t
 
	$__STREXB
(
uöt8_t
 
vÆue
, uöt8_à*
addr
)

395 
	`__ASM
("strexbÑ0,Ñ0, [r1]");

396 
	`__ASM
("bxÜr");

397 
	}
}

408 
uöt32_t
 
	$__STREXH
(
uöt16_t
 
vÆue
, uöt16_à*
addr
)

410 
	`__ASM
("strexhÑ0,Ñ0, [r1]");

411 
	`__ASM
("bxÜr");

412 
	}
}

423 
uöt32_t
 
	$__STREXW
(
uöt32_t
 
vÆue
, uöt32_à*
addr
)

425 
	`__ASM
("strexÑ0,Ñ0, [r1]");

426 
	`__ASM
("bxÜr");

427 
	}
}

429 #¥agm®
düg_deÁu…
=
Pe940


432 #ñi‡(
deföed
 (
__GNUC__
))

442 
uöt32_t
 
	$__gë_PSP
(Ë
	`__©åibuã__
––
«ked
 ) );

443 
uöt32_t
 
	$__gë_PSP
()

445 
uöt32_t
 
ªsu…
=0;

447 
__ASM
 volatile ("MRS %0,Ösp\n\t"

449 "BXÜ∏ \n\t" : "Ù" (
ªsu…
) );

450 (
ªsu…
);

451 
	}
}

461 
	$__£t_PSP
(
uöt32_t
 
t›OfProcSèck
Ë
	`__©åibuã__
––
«ked
 ) );

462 
	$__£t_PSP
(
uöt32_t
 
t›OfProcSèck
)

464 
__ASM
 volatile ("MSRÖsp, %0\n\t"

465 "BXÜ∏ \n\t" : : "r" (
t›OfProcSèck
) );

466 
	}
}

476 
uöt32_t
 
	$__gë_MSP
(Ë
	`__©åibuã__
––
«ked
 ) );

477 
uöt32_t
 
	$__gë_MSP
()

479 
uöt32_t
 
ªsu…
=0;

481 
__ASM
 volatile ("MRS %0, msp\n\t"

483 "BXÜ∏ \n\t" : "Ù" (
ªsu…
) );

484 (
ªsu…
);

485 
	}
}

495 
	$__£t_MSP
(
uöt32_t
 
t›OfMaöSèck
Ë
	`__©åibuã__
––
«ked
 ) );

496 
	$__£t_MSP
(
uöt32_t
 
t›OfMaöSèck
)

498 
__ASM
 volatile ("MSR msp, %0\n\t"

499 "BXÜ∏ \n\t" : : "r" (
t›OfMaöSèck
) );

500 
	}
}

509 
uöt32_t
 
	$__gë_BASEPRI
()

511 
uöt32_t
 
ªsu…
=0;

513 
__ASM
 vﬁ©ûê("MRS %0, ba£¥i_max" : "Ù" (
ªsu…
) );

514 (
ªsu…
);

515 
	}
}

524 
	$__£t_BASEPRI
(
uöt32_t
 
vÆue
)

526 
__ASM
 vﬁ©ûê("MSR ba£¥i, %0" : : "r" (
vÆue
) );

527 
	}
}

536 
uöt32_t
 
	$__gë_PRIMASK
()

538 
uöt32_t
 
ªsu…
=0;

540 
__ASM
 vﬁ©ûê("MRS %0,Örimask" : "Ù" (
ªsu…
) );

541 (
ªsu…
);

542 
	}
}

551 
	$__£t_PRIMASK
(
uöt32_t
 
¥iMask
)

553 
__ASM
 vﬁ©ûê("MSRÖrimask, %0" : : "r" (
¥iMask
) );

554 
	}
}

563 
uöt32_t
 
	$__gë_FAULTMASK
()

565 
uöt32_t
 
ªsu…
=0;

567 
__ASM
 vﬁ©ûê("MRS %0, fau…mask" : "Ù" (
ªsu…
) );

568 (
ªsu…
);

569 
	}
}

578 
	$__£t_FAULTMASK
(
uöt32_t
 
Áu…Mask
)

580 
__ASM
 vﬁ©ûê("MSR fau…mask, %0" : : "r" (
Áu…Mask
) );

581 
	}
}

590 
uöt32_t
 
	$__gë_CONTROL
()

592 
uöt32_t
 
ªsu…
=0;

594 
__ASM
 vﬁ©ûê("MRS %0, c⁄åﬁ" : "Ù" (
ªsu…
) );

595 (
ªsu…
);

596 
	}
}

605 
	$__£t_CONTROL
(
uöt32_t
 
c⁄åﬁ
)

607 
__ASM
 vﬁ©ûê("MSR c⁄åﬁ, %0" : : "r" (
c⁄åﬁ
) );

608 
	}
}

619 
uöt32_t
 
	$__REV
(
uöt32_t
 
vÆue
)

621 
uöt32_t
 
ªsu…
=0;

623 
__ASM
 vﬁ©ûê("ªv %0, %1" : "Ù" (
ªsu…
Ë: "r" (
vÆue
) );

624 (
ªsu…
);

625 
	}
}

635 
uöt32_t
 
	$__REV16
(
uöt16_t
 
vÆue
)

637 
uöt32_t
 
ªsu…
=0;

639 
__ASM
 vﬁ©ûê("ªv16 %0, %1" : "Ù" (
ªsu…
Ë: "r" (
vÆue
) );

640 (
ªsu…
);

641 
	}
}

651 
öt32_t
 
	$__REVSH
(
öt16_t
 
vÆue
)

653 
uöt32_t
 
ªsu…
=0;

655 
__ASM
 vﬁ©ûê("ªvsh %0, %1" : "Ù" (
ªsu…
Ë: "r" (
vÆue
) );

656 (
ªsu…
);

657 
	}
}

667 
uöt32_t
 
	$__RBIT
(
uöt32_t
 
vÆue
)

669 
uöt32_t
 
ªsu…
=0;

671 
__ASM
 vﬁ©ûê("rbô %0, %1" : "Ù" (
ªsu…
Ë: "r" (
vÆue
) );

672 (
ªsu…
);

673 
	}
}

683 
uöt8_t
 
	$__LDREXB
(
uöt8_t
 *
addr
)

685 
uöt8_t
 
ªsu…
=0;

687 
__ASM
 vﬁ©ûê("ldªxb %0, [%1]" : "Ù" (
ªsu…
Ë: "r" (
addr
) );

688 (
ªsu…
);

689 
	}
}

699 
uöt16_t
 
	$__LDREXH
(
uöt16_t
 *
addr
)

701 
uöt16_t
 
ªsu…
=0;

703 
__ASM
 vﬁ©ûê("ldªxh %0, [%1]" : "Ù" (
ªsu…
Ë: "r" (
addr
) );

704 (
ªsu…
);

705 
	}
}

715 
uöt32_t
 
	$__LDREXW
(
uöt32_t
 *
addr
)

717 
uöt32_t
 
ªsu…
=0;

719 
__ASM
 vﬁ©ûê("ldªx %0, [%1]" : "Ù" (
ªsu…
Ë: "r" (
addr
) );

720 (
ªsu…
);

721 
	}
}

732 
uöt32_t
 
	$__STREXB
(
uöt8_t
 
vÆue
, uöt8_à*
addr
)

734 
uöt32_t
 
ªsu…
=0;

736 
__ASM
 vﬁ©ûê("°ªxb %0, %2, [%1]" : "Ù" (
ªsu…
Ë: "r" (
addr
), "r" (
vÆue
) );

737 (
ªsu…
);

738 
	}
}

749 
uöt32_t
 
	$__STREXH
(
uöt16_t
 
vÆue
, uöt16_à*
addr
)

751 
uöt32_t
 
ªsu…
=0;

753 
__ASM
 vﬁ©ûê("°ªxh %0, %2, [%1]" : "Ù" (
ªsu…
Ë: "r" (
addr
), "r" (
vÆue
) );

754 (
ªsu…
);

755 
	}
}

766 
uöt32_t
 
	$__STREXW
(
uöt32_t
 
vÆue
, uöt32_à*
addr
)

768 
uöt32_t
 
ªsu…
=0;

770 
__ASM
 vﬁ©ûê("°ªx %0, %2, [%1]" : "Ù" (
ªsu…
Ë: "r" (
addr
), "r" (
vÆue
) );

771 (
ªsu…
);

772 
	}
}

775 #ñi‡(
deföed
 (
__TASKING__
))

	@E:\MYTEET~1\MYTEET~1.3\CMSIS\startup\STFEF3~1.S

1 ;******************** (
	gC
Ë
	gCOPYRIGHT
 2011 
	gSTMi¸€À˘r⁄ics
 ********************

2 ;* 
Fûe
 
	gName
 : 
°¨tup_°m32f10x_md
.
s


3 ;* 
	gAuth‹
 : 
MCD
 
Aµliˇti⁄
 
Tóm


4 ;* 
	gVîsi⁄
 : 
V3
.5.0

5 ;* 
	gD©e
 : 11-
M¨ch
-2011

6 ;* 
	gDes¸ùti⁄
 : 
STM32F10x
 
Medium
 
Dísôy
 
Devi˚s
 
ve˘‹
 
èbÀ
 
MDK
-
ARM


7 ;* 
	gtoﬁchaö
.

8 ;* 
This
 
moduÀ
 
	g≥rf‹ms
:

9 ;* - 
Së
 
the
 
öôül
 
	gSP


10 ;* - 
Së
 
the
 
öôül
 
	gPC
 =
Re£t_H™dÀr


11 ;* - 
Së
 
the
 
ve˘‹
 
èbÀ
 
íåõs
 
wôh
Åhê
ex˚±i⁄s
 
ISR
 
	gaddªss


12 ;* - 
C⁄figuª
 
the
 
˛ock
 
	gsy°em


13 ;* - 
Bønches
 
to
 
__maö
 
ö
 
the
 
C
 
libøry
 (
which
 
evítuÆly


14 ;* 
ˇŒs
 
maö
()).

15 ;* 
A·î
 
Re£t
 
the
 
C‹ãxM3
 
¥o˚ss‹
 
is
 
ö
 
Thªad
 
	gmode
,

16 ;* 
¥i‹ôy
 
is
 
	gPrivûeged
, 
™d
 
the
 
Sèck
 i†
£t
 
to
 
	gMaö
.

17 ;* <<< 
U£
 
C⁄figuøti⁄
 
Wiz¨d
 
ö
 
C⁄ãxt
 
	gMíu
 >>>

19 ; 
THE
 
PRESENT
 
FIRMWARE
 
WHICH
 
IS
 
FOR
 
GUIDANCE
 
ONLY
 
AIMS
 
AT
 
PROVIDING
 
	gCUSTOMERS


20 ; 
WITH
 
CODING
 
INFORMATION
 
REGARDING
 
THEIR
 
PRODUCTS
 
IN
 
ORDER
 
FOR
 
THEM
 
TO
 
SAVE
 
	gTIME
.

21 ; 
AS
 
A
 
	gRESULT
, 
STMICROELECTRONICS
 
SHALL
 
NOT
 
BE
 
HELD
 
LIABLE
 
FOR
 
ANY
 
	gDIRECT
,

22 ; 
INDIRECT
 
OR
 
CONSEQUENTIAL
 
DAMAGES
 
WITH
 
RESPECT
 
TO
 
ANY
 
CLAIMS
 
ARISING
 
FROM
 
	gTHE


23 ; 
CONTENT
 
OF
 
SUCH
 
FIRMWARE
 
	gAND
/
OR
 
THE
 
USE
 
MADE
 
BY
 
CUSTOMERS
 OF THE 
	gCODING


24 ; 
INFORMATION
 
CONTAINED
 
HEREIN
 
IN
 
CONNECTION
 
WITH
 
THEIR
 
	gPRODUCTS
.

27 ; 
Amou¡
 
of
 
	$mem‹y
 (
ö
 
byãs
Ë
Æloˇãd
 
Sèck


28 ; 
Taû‹
 
this
 
vÆue
 
to
 
your
 
≠∂iˇti⁄
 
√eds


29 ; <
h
> 
Sèck
 
C⁄figuøti⁄


30 ; <
o
> 
Sèck
 
	`Size
 (
ö
 
Byãs
) <0x0-0xFFFFFFFF:8>

31 ; </
h
>

33 
Sèck_Size
 
EQU
 0x00000400

35 
AREA
 
STACK
, 
NOINIT
, 
READWRITE
, 
ALIGN
=3

36 
Sèck_Mem
 
SPACE
 
Sèck_Size


37 
__öôül_•


40 ; <
h
> 
Hóp
 
C⁄figuøti⁄


41 ; <
o
> 
Hóp
 
	`Size
 (
ö
 
Byãs
) <0x0-0xFFFFFFFF:8>

42 ; </
h
>

44 
Hóp_Size
 
EQU
 0x00000200

46 
AREA
 
HEAP
, 
NOINIT
, 
READWRITE
, 
ALIGN
=3

47 
__hóp_ba£


48 
Hóp_Mem
 
SPACE
 
Hóp_Size


49 
__hóp_limô


51 
PRESERVE8


52 
THUMB


53 
IMPORT
 
xP‹tPídSVH™dÀr


54 
IMPORT
 
xP‹tSysTickH™dÀr


55 
IMPORT
 
vP‹tSVCH™dÀr


58 ; 
Ve˘‹
 
TabÀ
 
M≠≥d
 
to
 
Addªss
 0 
©
 
Re£t


59 
AREA
 
RESET
, 
DATA
, 
READONLY


60 
EXPORT
 
__Ve˘‹s


61 
EXPORT
 
__Ve˘‹s_End


62 
EXPORT
 
__Ve˘‹s_Size


64 
__Ve˘‹s
 
DCD
 
__öôül_•
 ; 
T›
 
of
 
Sèck


65 
DCD
 
Re£t_H™dÀr
 ; 
Re£t
 
H™dÀr


66 
DCD
 
NMI_H™dÀr
 ; 
NMI
 
H™dÀr


67 
DCD
 
H¨dFau…_H™dÀr
 ; 
H¨d
 
Fau…
 
H™dÀr


68 
DCD
 
MemM™age_H™dÀr
 ; 
MPU
 
Fau…
 
H™dÀr


69 
DCD
 
BusFau…_H™dÀr
 ; 
Bus
 
Fau…
 
H™dÀr


70 
DCD
 
UßgeFau…_H™dÀr
 ; 
Ußge
 
Fau…
 
H™dÀr


71 
DCD
 0 ; 
Re£rved


72 
DCD
 0 ; 
Re£rved


73 
DCD
 0 ; 
Re£rved


74 
DCD
 0 ; 
Re£rved


75 
DCD
 
vP‹tSVCH™dÀr
 ; 
SVCÆl
 
H™dÀr


76 
DCD
 
DebugM⁄_H™dÀr
 ; 
Debug
 
M⁄ô‹
 
H™dÀr


77 
DCD
 0 ; 
Re£rved


78 
DCD
 
xP‹tPídSVH™dÀr
 ; 
PídSV
 
H™dÀr


79 
DCD
 
xP‹tSysTickH™dÀr
 ; 
SysTick
 
H™dÀr


81 ; 
Exã∫Æ
 
I¡îru±s


82 
DCD
 
WWDG_IRQH™dÀr
 ; 
Wödow
 
W©chdog


83 
DCD
 
PVD_IRQH™dÀr
 ; 
PVD
 
through
 
EXTI
 
Löe
 
dëe˘


84 
DCD
 
TAMPER_IRQH™dÀr
 ; 
Tam≥r


85 
DCD
 
RTC_IRQH™dÀr
 ; 
RTC


86 
DCD
 
FLASH_IRQH™dÀr
 ; 
Fœsh


87 
DCD
 
RCC_IRQH™dÀr
 ; 
RCC


88 
DCD
 
EXTI0_IRQH™dÀr
 ; 
EXTI
 
Löe
 0

89 
DCD
 
EXTI1_IRQH™dÀr
 ; 
EXTI
 
Löe
 1

90 
DCD
 
EXTI2_IRQH™dÀr
 ; 
EXTI
 
Löe
 2

91 
DCD
 
EXTI3_IRQH™dÀr
 ; 
EXTI
 
Löe
 3

92 
DCD
 
EXTI4_IRQH™dÀr
 ; 
EXTI
 
Löe
 4

93 
DCD
 
DMA1_Ch™√l1_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 1

94 
DCD
 
DMA1_Ch™√l2_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 2

95 
DCD
 
DMA1_Ch™√l3_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 3

96 
DCD
 
DMA1_Ch™√l4_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 4

97 
DCD
 
DMA1_Ch™√l5_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 5

98 
DCD
 
DMA1_Ch™√l6_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 6

99 
DCD
 
DMA1_Ch™√l7_IRQH™dÀr
 ; 
DMA1
 
Ch™√l
 7

100 
DCD
 
ADC1_2_IRQH™dÀr
 ; 
ADC1_2


101 
DCD
 
USB_HP_CAN1_TX_IRQH™dÀr
 ; 
USB
 
High
 
Pri‹ôy
 
‹
 
CAN1
 
TX


102 
DCD
 
USB_LP_CAN1_RX0_IRQH™dÀr
 ; 
USB
 
Low
 
Pri‹ôy
 
‹
 
CAN1
 
RX0


103 
DCD
 
CAN1_RX1_IRQH™dÀr
 ; 
CAN1
 
RX1


104 
DCD
 
CAN1_SCE_IRQH™dÀr
 ; 
CAN1
 
SCE


105 
DCD
 
EXTI9_5_IRQH™dÀr
 ; 
EXTI
 
Löe
 9..5

106 
DCD
 
TIM1_BRK_IRQH™dÀr
 ; 
TIM1
 
Bªak


107 
DCD
 
TIM1_UP_IRQH™dÀr
 ; 
TIM1
 
Upd©e


108 
DCD
 
TIM1_TRG_COM_IRQH™dÀr
 ; 
TIM1
 
Triggî
 
™d
 
Commuèti⁄


109 
DCD
 
TIM1_CC_IRQH™dÀr
 ; 
TIM1
 
C≠tuª
 
Com∑ª


110 
DCD
 
TIM2_IRQH™dÀr
 ; 
TIM2


111 
DCD
 
TIM3_IRQH™dÀr
 ; 
TIM3


112 
DCD
 
TIM4_IRQH™dÀr
 ; 
TIM4


113 
DCD
 
I2C1_EV_IRQH™dÀr
 ; 
I2C1
 
Evít


114 
DCD
 
I2C1_ER_IRQH™dÀr
 ; 
I2C1
 
Eº‹


115 
DCD
 
I2C2_EV_IRQH™dÀr
 ; 
I2C2
 
Evít


116 
DCD
 
I2C2_ER_IRQH™dÀr
 ; 
I2C2
 
Eº‹


117 
DCD
 
SPI1_IRQH™dÀr
 ; 
SPI1


118 
DCD
 
SPI2_IRQH™dÀr
 ; 
SPI2


119 
DCD
 
USART1_IRQH™dÀr
 ; 
USART1


120 
DCD
 
USART2_IRQH™dÀr
 ; 
USART2


121 
DCD
 
USART3_IRQH™dÀr
 ; 
USART3


122 
DCD
 
EXTI15_10_IRQH™dÀr
 ; 
EXTI
 
Löe
 15..10

123 
DCD
 
RTCAœrm_IRQH™dÀr
 ; 
RTC
 
Aœrm
 
through
 
EXTI
 
Löe


124 
DCD
 
USBWakeUp_IRQH™dÀr
 ; 
USB
 
Wakeup
 
‰om
 
su•íd


125 
__Ve˘‹s_End


127 
__Ve˘‹s_Size
 
EQU
 
__Ve˘‹s_End
 - 
__Ve˘‹s


129 
AREA
 |.
ãxt
|, 
CODE
, 
READONLY


131 ; 
Re£t
 
h™dÀr


132 
Re£t_H™dÀr
 
PROC


133 
EXPORT
 
Re£t_H™dÀr
 [
WEAK
]

134 
IMPORT
 
__maö


135 
IMPORT
 
Sy°emInô


136 
LDR
 
R0
, =
Sy°emInô


137 
BLX
 
R0


138 
LDR
 
R0
, =
__maö


139 
BX
 
R0


140 
ENDP


142 ; 
Dummy
 
Ex˚±i⁄
 
	$H™dÀrs
 (
öföôe
 
lo›s
 
which
 
ˇn
 
be
 
modifõd
)

144 
NMI_H™dÀr
 
PROC


145 
EXPORT
 
NMI_H™dÀr
 [
WEAK
]

146 
B
 .

147 
ENDP


148 
H¨dFau…_H™dÀr
\

149 
PROC


150 
EXPORT
 
H¨dFau…_H™dÀr
 [
WEAK
]

151 
B
 .

152 
ENDP


153 
MemM™age_H™dÀr
\

154 
PROC


155 
EXPORT
 
MemM™age_H™dÀr
 [
WEAK
]

156 
B
 .

157 
ENDP


158 
BusFau…_H™dÀr
\

159 
PROC


160 
EXPORT
 
BusFau…_H™dÀr
 [
WEAK
]

161 
B
 .

162 
ENDP


163 
UßgeFau…_H™dÀr
\

164 
PROC


165 
EXPORT
 
UßgeFau…_H™dÀr
 [
WEAK
]

166 
B
 .

167 
ENDP


168 
SVC_H™dÀr
 
PROC


169 
EXPORT
 
SVC_H™dÀr
 [
WEAK
]

170 
B
 .

171 
ENDP


172 
DebugM⁄_H™dÀr
\

173 
PROC


174 
EXPORT
 
DebugM⁄_H™dÀr
 [
WEAK
]

175 
B
 .

176 
ENDP


177 
PídSV_H™dÀr
 
PROC


178 
EXPORT
 
PídSV_H™dÀr
 [
WEAK
]

179 
B
 .

180 
ENDP


181 
SysTick_H™dÀr
 
PROC


182 
EXPORT
 
SysTick_H™dÀr
 [
WEAK
]

183 
B
 .

184 
ENDP


186 
DeÁu…_H™dÀr
 
PROC


188 
EXPORT
 
WWDG_IRQH™dÀr
 [
WEAK
]

189 
EXPORT
 
PVD_IRQH™dÀr
 [
WEAK
]

190 
EXPORT
 
TAMPER_IRQH™dÀr
 [
WEAK
]

191 
EXPORT
 
RTC_IRQH™dÀr
 [
WEAK
]

192 
EXPORT
 
FLASH_IRQH™dÀr
 [
WEAK
]

193 
EXPORT
 
RCC_IRQH™dÀr
 [
WEAK
]

194 
EXPORT
 
EXTI0_IRQH™dÀr
 [
WEAK
]

195 
EXPORT
 
EXTI1_IRQH™dÀr
 [
WEAK
]

196 
EXPORT
 
EXTI2_IRQH™dÀr
 [
WEAK
]

197 
EXPORT
 
EXTI3_IRQH™dÀr
 [
WEAK
]

198 
EXPORT
 
EXTI4_IRQH™dÀr
 [
WEAK
]

199 
EXPORT
 
DMA1_Ch™√l1_IRQH™dÀr
 [
WEAK
]

200 
EXPORT
 
DMA1_Ch™√l2_IRQH™dÀr
 [
WEAK
]

201 
EXPORT
 
DMA1_Ch™√l3_IRQH™dÀr
 [
WEAK
]

202 
EXPORT
 
DMA1_Ch™√l4_IRQH™dÀr
 [
WEAK
]

203 
EXPORT
 
DMA1_Ch™√l5_IRQH™dÀr
 [
WEAK
]

204 
EXPORT
 
DMA1_Ch™√l6_IRQH™dÀr
 [
WEAK
]

205 
EXPORT
 
DMA1_Ch™√l7_IRQH™dÀr
 [
WEAK
]

206 
EXPORT
 
ADC1_2_IRQH™dÀr
 [
WEAK
]

207 
EXPORT
 
USB_HP_CAN1_TX_IRQH™dÀr
 [
WEAK
]

208 
EXPORT
 
USB_LP_CAN1_RX0_IRQH™dÀr
 [
WEAK
]

209 
EXPORT
 
CAN1_RX1_IRQH™dÀr
 [
WEAK
]

210 
EXPORT
 
CAN1_SCE_IRQH™dÀr
 [
WEAK
]

211 
EXPORT
 
EXTI9_5_IRQH™dÀr
 [
WEAK
]

212 
EXPORT
 
TIM1_BRK_IRQH™dÀr
 [
WEAK
]

213 
EXPORT
 
TIM1_UP_IRQH™dÀr
 [
WEAK
]

214 
EXPORT
 
TIM1_TRG_COM_IRQH™dÀr
 [
WEAK
]

215 
EXPORT
 
TIM1_CC_IRQH™dÀr
 [
WEAK
]

216 
EXPORT
 
TIM2_IRQH™dÀr
 [
WEAK
]

217 
EXPORT
 
TIM3_IRQH™dÀr
 [
WEAK
]

218 
EXPORT
 
TIM4_IRQH™dÀr
 [
WEAK
]

219 
EXPORT
 
I2C1_EV_IRQH™dÀr
 [
WEAK
]

220 
EXPORT
 
I2C1_ER_IRQH™dÀr
 [
WEAK
]

221 
EXPORT
 
I2C2_EV_IRQH™dÀr
 [
WEAK
]

222 
EXPORT
 
I2C2_ER_IRQH™dÀr
 [
WEAK
]

223 
EXPORT
 
SPI1_IRQH™dÀr
 [
WEAK
]

224 
EXPORT
 
SPI2_IRQH™dÀr
 [
WEAK
]

225 
EXPORT
 
USART1_IRQH™dÀr
 [
WEAK
]

226 
EXPORT
 
USART2_IRQH™dÀr
 [
WEAK
]

227 
EXPORT
 
USART3_IRQH™dÀr
 [
WEAK
]

228 
EXPORT
 
EXTI15_10_IRQH™dÀr
 [
WEAK
]

229 
EXPORT
 
RTCAœrm_IRQH™dÀr
 [
WEAK
]

230 
EXPORT
 
USBWakeUp_IRQH™dÀr
 [
WEAK
]

232 
WWDG_IRQH™dÀr


233 
PVD_IRQH™dÀr


234 
TAMPER_IRQH™dÀr


235 
RTC_IRQH™dÀr


236 
FLASH_IRQH™dÀr


237 
RCC_IRQH™dÀr


238 
EXTI0_IRQH™dÀr


239 
EXTI1_IRQH™dÀr


240 
EXTI2_IRQH™dÀr


241 
EXTI3_IRQH™dÀr


242 
EXTI4_IRQH™dÀr


243 
DMA1_Ch™√l1_IRQH™dÀr


244 
DMA1_Ch™√l2_IRQH™dÀr


245 
DMA1_Ch™√l3_IRQH™dÀr


246 
DMA1_Ch™√l4_IRQH™dÀr


247 
DMA1_Ch™√l5_IRQH™dÀr


248 
DMA1_Ch™√l6_IRQH™dÀr


249 
DMA1_Ch™√l7_IRQH™dÀr


250 
ADC1_2_IRQH™dÀr


251 
USB_HP_CAN1_TX_IRQH™dÀr


252 
USB_LP_CAN1_RX0_IRQH™dÀr


253 
CAN1_RX1_IRQH™dÀr


254 
CAN1_SCE_IRQH™dÀr


255 
EXTI9_5_IRQH™dÀr


256 
TIM1_BRK_IRQH™dÀr


257 
TIM1_UP_IRQH™dÀr


258 
TIM1_TRG_COM_IRQH™dÀr


259 
TIM1_CC_IRQH™dÀr


260 
TIM2_IRQH™dÀr


261 
TIM3_IRQH™dÀr


262 
TIM4_IRQH™dÀr


263 
I2C1_EV_IRQH™dÀr


264 
I2C1_ER_IRQH™dÀr


265 
I2C2_EV_IRQH™dÀr


266 
I2C2_ER_IRQH™dÀr


267 
SPI1_IRQH™dÀr


268 
SPI2_IRQH™dÀr


269 
USART1_IRQH™dÀr


270 
USART2_IRQH™dÀr


271 
USART3_IRQH™dÀr


272 
EXTI15_10_IRQH™dÀr


273 
RTCAœrm_IRQH™dÀr


274 
USBWakeUp_IRQH™dÀr


276 
B
 .

278 
ENDP


280 
ALIGN


283 ; 
U£r
 
Sèck
 
™d
 
Hóp
 
öôüliz©i⁄


285 
IF
 :
DEF
:
__MICROLIB


287 
EXPORT
 
__öôül_•


288 
EXPORT
 
__hóp_ba£


289 
EXPORT
 
__hóp_limô


291 
ELSE


293 
IMPORT
 
__u£_two_ªgi⁄_mem‹y


294 
EXPORT
 
__u£r_öôül_°ackhóp


296 
__u£r_öôül_°ackhóp


298 
LDR
 
R0
, = 
Hóp_Mem


299 
LDR
 
R1
, =(
Sèck_Mem
 + 
Sèck_Size
)

300 
LDR
 
R2
, = (
Hóp_Mem
 + 
Hóp_Size
)

301 
LDR
 
R3
, = 
Sèck_Mem


302 
BX
 
LR


304 
ALIGN


306 
ENDIF


308 
END


310 ;******************* (
C
Ë
COPYRIGHT
 2011 
STMi¸€À˘r⁄ics
 *****
END
 
OF
 
FILE
*****

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST12DF~1.C

23 
	~"°m32f10x_¸c.h
"

83 
	$CRC_Re£tDR
()

86 
CRC
->
CR
 = 
CRC_CR_RESET
;

87 
	}
}

94 
uöt32_t
 
	$CRC_CÆcCRC
(
uöt32_t
 
D©a
)

96 
CRC
->
DR
 = 
D©a
;

98  (
CRC
->
DR
);

99 
	}
}

107 
uöt32_t
 
	$CRC_CÆcBlockCRC
(
uöt32_t
 
pBuf„r
[], uöt32_à
Buf„rLígth
)

109 
uöt32_t
 
ödex
 = 0;

111 
ödex
 = 0; index < 
Buf„rLígth
; index++)

113 
CRC
->
DR
 = 
pBuf„r
[
ödex
];

115  (
CRC
->
DR
);

116 
	}
}

123 
uöt32_t
 
	$CRC_GëCRC
()

125  (
CRC
->
DR
);

126 
	}
}

133 
	$CRC_SëIDRegi°î
(
uöt8_t
 
IDVÆue
)

135 
CRC
->
IDR
 = 
IDVÆue
;

136 
	}
}

143 
uöt8_t
 
	$CRC_GëIDRegi°î
()

145  (
CRC
->
IDR
);

146 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST1D4B~1.C

23 
	~"°m32f10x_iwdg.h
"

49 
	#KR_KEY_Rñﬂd
 ((
uöt16_t
)0xAAAA)

	)

50 
	#KR_KEY_E«bÀ
 ((
uöt16_t
)0xCCCC)

	)

92 
	$IWDG_WrôeAc˚ssCmd
(
uöt16_t
 
IWDG_WrôeAc˚ss
)

95 
	`as£π_∑øm
(
	`IS_IWDG_WRITE_ACCESS
(
IWDG_WrôeAc˚ss
));

96 
IWDG
->
KR
 = 
IWDG_WrôeAc˚ss
;

97 
	}
}

112 
	$IWDG_SëPªsˇÀr
(
uöt8_t
 
IWDG_PªsˇÀr
)

115 
	`as£π_∑øm
(
	`IS_IWDG_PRESCALER
(
IWDG_PªsˇÀr
));

116 
IWDG
->
PR
 = 
IWDG_PªsˇÀr
;

117 
	}
}

125 
	$IWDG_SëRñﬂd
(
uöt16_t
 
Rñﬂd
)

128 
	`as£π_∑øm
(
	`IS_IWDG_RELOAD
(
Rñﬂd
));

129 
IWDG
->
RLR
 = 
Rñﬂd
;

130 
	}
}

138 
	$IWDG_RñﬂdCou¡î
()

140 
IWDG
->
KR
 = 
KR_KEY_Rñﬂd
;

141 
	}
}

148 
	$IWDG_E«bÀ
()

150 
IWDG
->
KR
 = 
KR_KEY_E«bÀ
;

151 
	}
}

161 
FœgSètus
 
	$IWDG_GëFœgSètus
(
uöt16_t
 
IWDG_FLAG
)

163 
FœgSètus
 
bô°©us
 = 
RESET
;

165 
	`as£π_∑øm
(
	`IS_IWDG_FLAG
(
IWDG_FLAG
));

166 i‡((
IWDG
->
SR
 & 
IWDG_FLAG
Ë!(
uöt32_t
)
RESET
)

168 
bô°©us
 = 
SET
;

172 
bô°©us
 = 
RESET
;

175  
bô°©us
;

176 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST508A~1.C

23 
	~"°m32f10x_πc.h
"

44 
	#RTC_LSB_MASK
 ((
uöt32_t
)0x0000FFFFË

	)

45 
	#PRLH_MSB_MASK
 ((
uöt32_t
)0x000F0000Ë

	)

90 
	$RTC_ITC⁄fig
(
uöt16_t
 
RTC_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

93 
	`as£π_∑øm
(
	`IS_RTC_IT
(
RTC_IT
));

94 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

96 i‡(
NewSèã
 !
DISABLE
)

98 
RTC
->
CRH
 |
RTC_IT
;

102 
RTC
->
CRH
 &(
uöt16_t
)~
RTC_IT
;

104 
	}
}

111 
	$RTC_E¡îC⁄figMode
()

114 
RTC
->
CRL
 |
RTC_CRL_CNF
;

115 
	}
}

122 
	$RTC_ExôC⁄figMode
()

125 
RTC
->
CRL
 &(
uöt16_t
)~((uöt16_t)
RTC_CRL_CNF
);

126 
	}
}

133 
uöt32_t
 
	$RTC_GëCou¡î
()

135 
uöt16_t
 
tmp
 = 0;

136 
tmp
 = 
RTC
->
CNTL
;

137  (((
uöt32_t
)
RTC
->
CNTH
 << 16 ) | 
tmp
) ;

138 
	}
}

145 
	$RTC_SëCou¡î
(
uöt32_t
 
Cou¡îVÆue
)

147 
	`RTC_E¡îC⁄figMode
();

149 
RTC
->
CNTH
 = 
Cou¡îVÆue
 >> 16;

151 
RTC
->
CNTL
 = (
Cou¡îVÆue
 & 
RTC_LSB_MASK
);

152 
	`RTC_ExôC⁄figMode
();

153 
	}
}

160 
	$RTC_SëPªsˇÀr
(
uöt32_t
 
PªsˇÀrVÆue
)

163 
	`as£π_∑øm
(
	`IS_RTC_PRESCALER
(
PªsˇÀrVÆue
));

165 
	`RTC_E¡îC⁄figMode
();

167 
RTC
->
PRLH
 = (
PªsˇÀrVÆue
 & 
PRLH_MSB_MASK
) >> 16;

169 
RTC
->
PRLL
 = (
PªsˇÀrVÆue
 & 
RTC_LSB_MASK
);

170 
	`RTC_ExôC⁄figMode
();

171 
	}
}

178 
	$RTC_SëAœrm
(
uöt32_t
 
AœrmVÆue
)

180 
	`RTC_E¡îC⁄figMode
();

182 
RTC
->
ALRH
 = 
AœrmVÆue
 >> 16;

184 
RTC
->
ALRL
 = (
AœrmVÆue
 & 
RTC_LSB_MASK
);

185 
	`RTC_ExôC⁄figMode
();

186 
	}
}

193 
uöt32_t
 
	$RTC_GëDividî
()

195 
uöt32_t
 
tmp
 = 0x00;

196 
tmp
 = ((
uöt32_t
)
RTC
->
DIVH
 & (uint32_t)0x000F) << 16;

197 
tmp
 |
RTC
->
DIVL
;

198  
tmp
;

199 
	}
}

207 
	$RTC_WaôF‹La°Task
()

210 (
RTC
->
CRL
 & 
RTC_FLAG_RTOFF
Ë=(
uöt16_t
)
RESET
)

213 
	}
}

223 
	$RTC_WaôF‹Synchro
()

226 
RTC
->
CRL
 &(
uöt16_t
)~
RTC_FLAG_RSF
;

228 (
RTC
->
CRL
 & 
RTC_FLAG_RSF
Ë=(
uöt16_t
)
RESET
)

231 
	}
}

244 
FœgSètus
 
	$RTC_GëFœgSètus
(
uöt16_t
 
RTC_FLAG
)

246 
FœgSètus
 
bô°©us
 = 
RESET
;

249 
	`as£π_∑øm
(
	`IS_RTC_GET_FLAG
(
RTC_FLAG
));

251 i‡((
RTC
->
CRL
 & 
RTC_FLAG
Ë!(
uöt16_t
)
RESET
)

253 
bô°©us
 = 
SET
;

257 
bô°©us
 = 
RESET
;

259  
bô°©us
;

260 
	}
}

273 
	$RTC_CÀ¨Fœg
(
uöt16_t
 
RTC_FLAG
)

276 
	`as£π_∑øm
(
	`IS_RTC_CLEAR_FLAG
(
RTC_FLAG
));

279 
RTC
->
CRL
 &(
uöt16_t
)~
RTC_FLAG
;

280 
	}
}

291 
ITSètus
 
	$RTC_GëITSètus
(
uöt16_t
 
RTC_IT
)

293 
ITSètus
 
bô°©us
 = 
RESET
;

295 
	`as£π_∑øm
(
	`IS_RTC_GET_IT
(
RTC_IT
));

297 
bô°©us
 = (
ITSètus
)(
RTC
->
CRL
 & 
RTC_IT
);

298 i‡(((
RTC
->
CRH
 & 
RTC_IT
Ë!(
uöt16_t
)
RESET
Ë&& (
bô°©us
 != (uint16_t)RESET))

300 
bô°©us
 = 
SET
;

304 
bô°©us
 = 
RESET
;

306  
bô°©us
;

307 
	}
}

318 
	$RTC_CÀ¨ITPídögBô
(
uöt16_t
 
RTC_IT
)

321 
	`as£π_∑øm
(
	`IS_RTC_IT
(
RTC_IT
));

324 
RTC
->
CRL
 &(
uöt16_t
)~
RTC_IT
;

325 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST53A5~1.C

23 
	~"°m32f10x_•i.h
"

24 
	~"°m32f10x_rcc.h
"

49 
	#CR1_SPE_Së
 ((
uöt16_t
)0x0040)

	)

50 
	#CR1_SPE_Re£t
 ((
uöt16_t
)0xFFBF)

	)

53 
	#I2SCFGR_I2SE_Së
 ((
uöt16_t
)0x0400)

	)

54 
	#I2SCFGR_I2SE_Re£t
 ((
uöt16_t
)0xFBFF)

	)

57 
	#CR1_CRCNext_Së
 ((
uöt16_t
)0x1000)

	)

60 
	#CR1_CRCEN_Së
 ((
uöt16_t
)0x2000)

	)

61 
	#CR1_CRCEN_Re£t
 ((
uöt16_t
)0xDFFF)

	)

64 
	#CR2_SSOE_Së
 ((
uöt16_t
)0x0004)

	)

65 
	#CR2_SSOE_Re£t
 ((
uöt16_t
)0xFFFB)

	)

68 
	#CR1_CLEAR_Mask
 ((
uöt16_t
)0x3040)

	)

69 
	#I2SCFGR_CLEAR_Mask
 ((
uöt16_t
)0xF040)

	)

72 
	#SPI_Mode_Sñe˘
 ((
uöt16_t
)0xF7FF)

	)

73 
	#I2S_Mode_Sñe˘
 ((
uöt16_t
)0x0800)

	)

76 
	#I2S2_CLOCK_SRC
 ((
uöt32_t
)(0x00020000))

	)

77 
	#I2S3_CLOCK_SRC
 ((
uöt32_t
)(0x00040000))

	)

78 
	#I2S_MUL_MASK
 ((
uöt32_t
)(0x0000F000))

	)

79 
	#I2S_DIV_MASK
 ((
uöt32_t
)(0x000000F0))

	)

119 
	$SPI_I2S_DeInô
(
SPI_Ty≥Def
* 
SPIx
)

122 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

124 i‡(
SPIx
 =
SPI1
)

127 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_SPI1
, 
ENABLE
);

129 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_SPI1
, 
DISABLE
);

131 i‡(
SPIx
 =
SPI2
)

134 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_SPI2
, 
ENABLE
);

136 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_SPI2
, 
DISABLE
);

140 i‡(
SPIx
 =
SPI3
)

143 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_SPI3
, 
ENABLE
);

145 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_SPI3
, 
DISABLE
);

148 
	}
}

158 
	$SPI_Inô
(
SPI_Ty≥Def
* 
SPIx
, 
SPI_InôTy≥Def
* 
SPI_InôSåu˘
)

160 
uöt16_t
 
tm¥eg
 = 0;

163 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

166 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_MODE
(
SPI_InôSåu˘
->
SPI_Dúe˘i⁄
));

167 
	`as£π_∑øm
(
	`IS_SPI_MODE
(
SPI_InôSåu˘
->
SPI_Mode
));

168 
	`as£π_∑øm
(
	`IS_SPI_DATASIZE
(
SPI_InôSåu˘
->
SPI_D©aSize
));

169 
	`as£π_∑øm
(
	`IS_SPI_CPOL
(
SPI_InôSåu˘
->
SPI_CPOL
));

170 
	`as£π_∑øm
(
	`IS_SPI_CPHA
(
SPI_InôSåu˘
->
SPI_CPHA
));

171 
	`as£π_∑øm
(
	`IS_SPI_NSS
(
SPI_InôSåu˘
->
SPI_NSS
));

172 
	`as£π_∑øm
(
	`IS_SPI_BAUDRATE_PRESCALER
(
SPI_InôSåu˘
->
SPI_BaudR©ePªsˇÀr
));

173 
	`as£π_∑øm
(
	`IS_SPI_FIRST_BIT
(
SPI_InôSåu˘
->
SPI_Fú°Bô
));

174 
	`as£π_∑øm
(
	`IS_SPI_CRC_POLYNOMIAL
(
SPI_InôSåu˘
->
SPI_CRCPﬁynomül
));

178 
tm¥eg
 = 
SPIx
->
CR1
;

180 
tm¥eg
 &
CR1_CLEAR_Mask
;

189 
tm¥eg
 |(
uöt16_t
)((
uöt32_t
)
SPI_InôSåu˘
->
SPI_Dúe˘i⁄
 | SPI_InôSåu˘->
SPI_Mode
 |

190 
SPI_InôSåu˘
->
SPI_D©aSize
 | SPI_InôSåu˘->
SPI_CPOL
 |

191 
SPI_InôSåu˘
->
SPI_CPHA
 | SPI_InôSåu˘->
SPI_NSS
 |

192 
SPI_InôSåu˘
->
SPI_BaudR©ePªsˇÀr
 | SPI_InôSåu˘->
SPI_Fú°Bô
);

194 
SPIx
->
CR1
 = 
tm¥eg
;

197 
SPIx
->
I2SCFGR
 &
SPI_Mode_Sñe˘
;

201 
SPIx
->
CRCPR
 = 
SPI_InôSåu˘
->
SPI_CRCPﬁynomül
;

202 
	}
}

219 
	$I2S_Inô
(
SPI_Ty≥Def
* 
SPIx
, 
I2S_InôTy≥Def
* 
I2S_InôSåu˘
)

221 
uöt16_t
 
tm¥eg
 = 0, 
i2sdiv
 = 2, 
i2sodd
 = 0, 
∑ckëÀngth
 = 1;

222 
uöt32_t
 
tmp
 = 0;

223 
RCC_ClocksTy≥Def
 
RCC_Clocks
;

224 
uöt32_t
 
sour˚˛ock
 = 0;

227 
	`as£π_∑øm
(
	`IS_SPI_23_PERIPH
(
SPIx
));

228 
	`as£π_∑øm
(
	`IS_I2S_MODE
(
I2S_InôSåu˘
->
I2S_Mode
));

229 
	`as£π_∑øm
(
	`IS_I2S_STANDARD
(
I2S_InôSåu˘
->
I2S_Sènd¨d
));

230 
	`as£π_∑øm
(
	`IS_I2S_DATA_FORMAT
(
I2S_InôSåu˘
->
I2S_D©aF‹m©
));

231 
	`as£π_∑øm
(
	`IS_I2S_MCLK_OUTPUT
(
I2S_InôSåu˘
->
I2S_MCLKOuçut
));

232 
	`as£π_∑øm
(
	`IS_I2S_AUDIO_FREQ
(
I2S_InôSåu˘
->
I2S_AudioFªq
));

233 
	`as£π_∑øm
(
	`IS_I2S_CPOL
(
I2S_InôSåu˘
->
I2S_CPOL
));

237 
SPIx
->
I2SCFGR
 &
I2SCFGR_CLEAR_Mask
;

238 
SPIx
->
I2SPR
 = 0x0002;

241 
tm¥eg
 = 
SPIx
->
I2SCFGR
;

244 if(
I2S_InôSåu˘
->
I2S_AudioFªq
 =
I2S_AudioFªq_DeÁu…
)

246 
i2sodd
 = (
uöt16_t
)0;

247 
i2sdiv
 = (
uöt16_t
)2;

253 if(
I2S_InôSåu˘
->
I2S_D©aF‹m©
 =
I2S_D©aF‹m©_16b
)

256 
∑ckëÀngth
 = 1;

261 
∑ckëÀngth
 = 2;

265 if(((
uöt32_t
)
SPIx
Ë=
SPI2_BASE
)

268 
tmp
 = 
I2S2_CLOCK_SRC
;

273 
tmp
 = 
I2S3_CLOCK_SRC
;

278 #ifde‡
STM32F10X_CL


279 if((
RCC
->
CFGR2
 & 
tmp
) != 0)

282 
tmp
 = (
uöt32_t
)((
RCC
->
CFGR2
 & 
I2S_MUL_MASK
) >> 12);

285 if((
tmp
 > 5) && (tmp < 15))

288 
tmp
 += 2;

292 i‡(
tmp
 == 15)

295 
tmp
 = 20;

299 
sour˚˛ock
 = (
uöt32_t
)(((
RCC
->
CFGR2
 & 
I2S_DIV_MASK
) >> 4) + 1);

302 
sour˚˛ock
 = (
uöt32_t
Ë((
HSE_VÆue
 / sour˚˛ockË* 
tmp
 * 2);

307 
	`RCC_GëClocksFªq
(&
RCC_Clocks
);

310 
sour˚˛ock
 = 
RCC_Clocks
.
SYSCLK_Fªquícy
;

314 
	`RCC_GëClocksFªq
(&
RCC_Clocks
);

317 
sour˚˛ock
 = 
RCC_Clocks
.
SYSCLK_Fªquícy
;

321 if(
I2S_InôSåu˘
->
I2S_MCLKOuçut
 =
I2S_MCLKOuçut_E«bÀ
)

324 
tmp
 = (
uöt16_t
)(((((
sour˚˛ock
 / 256Ë* 10Ë/ 
I2S_InôSåu˘
->
I2S_AudioFªq
)) + 5);

329 
tmp
 = (
uöt16_t
)(((((
sour˚˛ock
 / (32 * 
∑ckëÀngth
)Ë*10 ) / 
I2S_InôSåu˘
->
I2S_AudioFªq
)) + 5);

333 
tmp
 =Åmp / 10;

336 
i2sodd
 = (
uöt16_t
)(
tmp
 & (uint16_t)0x0001);

339 
i2sdiv
 = (
uöt16_t
)((
tmp
 - 
i2sodd
) / 2);

342 
i2sodd
 = (
uöt16_t
) (i2sodd << 8);

346 i‡((
i2sdiv
 < 2) || (i2sdiv > 0xFF))

349 
i2sdiv
 = 2;

350 
i2sodd
 = 0;

354 
SPIx
->
I2SPR
 = (
uöt16_t
)(
i2sdiv
 | (uöt16_t)(
i2sodd
 | (uöt16_t)
I2S_InôSåu˘
->
I2S_MCLKOuçut
));

357 
tm¥eg
 |(
uöt16_t
)(
I2S_Mode_Sñe˘
 | (uöt16_t)(
I2S_InôSåu˘
->
I2S_Mode
 | \

358 (
uöt16_t
)(
I2S_InôSåu˘
->
I2S_Sènd¨d
 | (uöt16_t)(I2S_InôSåu˘->
I2S_D©aF‹m©
 | \

359 (
uöt16_t
)
I2S_InôSåu˘
->
I2S_CPOL
))));

362 
SPIx
->
I2SCFGR
 = 
tm¥eg
;

363 
	}
}

370 
	$SPI_Såu˘Inô
(
SPI_InôTy≥Def
* 
SPI_InôSåu˘
)

374 
SPI_InôSåu˘
->
SPI_Dúe˘i⁄
 = 
SPI_Dúe˘i⁄_2Löes_FuŒDu∂ex
;

376 
SPI_InôSåu˘
->
SPI_Mode
 = 
SPI_Mode_Sœve
;

378 
SPI_InôSåu˘
->
SPI_D©aSize
 = 
SPI_D©aSize_8b
;

380 
SPI_InôSåu˘
->
SPI_CPOL
 = 
SPI_CPOL_Low
;

382 
SPI_InôSåu˘
->
SPI_CPHA
 = 
SPI_CPHA_1Edge
;

384 
SPI_InôSåu˘
->
SPI_NSS
 = 
SPI_NSS_H¨d
;

386 
SPI_InôSåu˘
->
SPI_BaudR©ePªsˇÀr
 = 
SPI_BaudR©ePªsˇÀr_2
;

388 
SPI_InôSåu˘
->
SPI_Fú°Bô
 = 
SPI_Fú°Bô_MSB
;

390 
SPI_InôSåu˘
->
SPI_CRCPﬁynomül
 = 7;

391 
	}
}

398 
	$I2S_Såu˘Inô
(
I2S_InôTy≥Def
* 
I2S_InôSåu˘
)

402 
I2S_InôSåu˘
->
I2S_Mode
 = 
I2S_Mode_SœveTx
;

405 
I2S_InôSåu˘
->
I2S_Sènd¨d
 = 
I2S_Sènd¨d_Phûlùs
;

408 
I2S_InôSåu˘
->
I2S_D©aF‹m©
 = 
I2S_D©aF‹m©_16b
;

411 
I2S_InôSåu˘
->
I2S_MCLKOuçut
 = 
I2S_MCLKOuçut_DißbÀ
;

414 
I2S_InôSåu˘
->
I2S_AudioFªq
 = 
I2S_AudioFªq_DeÁu…
;

417 
I2S_InôSåu˘
->
I2S_CPOL
 = 
I2S_CPOL_Low
;

418 
	}
}

427 
	$SPI_Cmd
(
SPI_Ty≥Def
* 
SPIx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

430 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

431 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

432 i‡(
NewSèã
 !
DISABLE
)

435 
SPIx
->
CR1
 |
CR1_SPE_Së
;

440 
SPIx
->
CR1
 &
CR1_SPE_Re£t
;

442 
	}
}

451 
	$I2S_Cmd
(
SPI_Ty≥Def
* 
SPIx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

454 
	`as£π_∑øm
(
	`IS_SPI_23_PERIPH
(
SPIx
));

455 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

456 i‡(
NewSèã
 !
DISABLE
)

459 
SPIx
->
I2SCFGR
 |
I2SCFGR_I2SE_Së
;

464 
SPIx
->
I2SCFGR
 &
I2SCFGR_I2SE_Re£t
;

466 
	}
}

482 
	$SPI_I2S_ITC⁄fig
(
SPI_Ty≥Def
* 
SPIx
, 
uöt8_t
 
SPI_I2S_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

484 
uöt16_t
 
ôpos
 = 0, 
ômask
 = 0 ;

486 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

487 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

488 
	`as£π_∑øm
(
	`IS_SPI_I2S_CONFIG_IT
(
SPI_I2S_IT
));

491 
ôpos
 = 
SPI_I2S_IT
 >> 4;

494 
ômask
 = (
uöt16_t
)1 << (uöt16_t)
ôpos
;

496 i‡(
NewSèã
 !
DISABLE
)

499 
SPIx
->
CR2
 |
ômask
;

504 
SPIx
->
CR2
 &(
uöt16_t
)~
ômask
;

506 
	}
}

521 
	$SPI_I2S_DMACmd
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
SPI_I2S_DMAReq
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

524 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

525 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

526 
	`as£π_∑øm
(
	`IS_SPI_I2S_DMAREQ
(
SPI_I2S_DMAReq
));

527 i‡(
NewSèã
 !
DISABLE
)

530 
SPIx
->
CR2
 |
SPI_I2S_DMAReq
;

535 
SPIx
->
CR2
 &(
uöt16_t
)~
SPI_I2S_DMAReq
;

537 
	}
}

547 
	$SPI_I2S_SídD©a
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
D©a
)

550 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

553 
SPIx
->
DR
 = 
D©a
;

554 
	}
}

563 
uöt16_t
 
	$SPI_I2S_Re˚iveD©a
(
SPI_Ty≥Def
* 
SPIx
)

566 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

569  
SPIx
->
DR
;

570 
	}
}

581 
	$SPI_NSSI¡î«lSo·w¨eC⁄fig
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
SPI_NSSI¡î«lSo·
)

584 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

585 
	`as£π_∑øm
(
	`IS_SPI_NSS_INTERNAL
(
SPI_NSSI¡î«lSo·
));

586 i‡(
SPI_NSSI¡î«lSo·
 !
SPI_NSSI¡î«lSo·_Re£t
)

589 
SPIx
->
CR1
 |
SPI_NSSI¡î«lSo·_Së
;

594 
SPIx
->
CR1
 &
SPI_NSSI¡î«lSo·_Re£t
;

596 
	}
}

605 
	$SPI_SSOuçutCmd
(
SPI_Ty≥Def
* 
SPIx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

608 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

609 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

610 i‡(
NewSèã
 !
DISABLE
)

613 
SPIx
->
CR2
 |
CR2_SSOE_Së
;

618 
SPIx
->
CR2
 &
CR2_SSOE_Re£t
;

620 
	}
}

631 
	$SPI_D©aSizeC⁄fig
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
SPI_D©aSize
)

634 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

635 
	`as£π_∑øm
(
	`IS_SPI_DATASIZE
(
SPI_D©aSize
));

637 
SPIx
->
CR1
 &(
uöt16_t
)~
SPI_D©aSize_16b
;

639 
SPIx
->
CR1
 |
SPI_D©aSize
;

640 
	}
}

647 
	$SPI_TønsmôCRC
(
SPI_Ty≥Def
* 
SPIx
)

650 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

653 
SPIx
->
CR1
 |
CR1_CRCNext_Së
;

654 
	}
}

663 
	$SPI_CÆcuœãCRC
(
SPI_Ty≥Def
* 
SPIx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

666 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

667 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

668 i‡(
NewSèã
 !
DISABLE
)

671 
SPIx
->
CR1
 |
CR1_CRCEN_Së
;

676 
SPIx
->
CR1
 &
CR1_CRCEN_Re£t
;

678 
	}
}

689 
uöt16_t
 
	$SPI_GëCRC
(
SPI_Ty≥Def
* 
SPIx
, 
uöt8_t
 
SPI_CRC
)

691 
uöt16_t
 
¸¸eg
 = 0;

693 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

694 
	`as£π_∑øm
(
	`IS_SPI_CRC
(
SPI_CRC
));

695 i‡(
SPI_CRC
 !
SPI_CRC_Rx
)

698 
¸¸eg
 = 
SPIx
->
TXCRCR
;

703 
¸¸eg
 = 
SPIx
->
RXCRCR
;

706  
¸¸eg
;

707 
	}
}

714 
uöt16_t
 
	$SPI_GëCRCPﬁynomül
(
SPI_Ty≥Def
* 
SPIx
)

717 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

720  
SPIx
->
CRCPR
;

721 
	}
}

732 
	$SPI_BiDúe˘i⁄ÆLöeC⁄fig
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
SPI_Dúe˘i⁄
)

735 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

736 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION
(
SPI_Dúe˘i⁄
));

737 i‡(
SPI_Dúe˘i⁄
 =
SPI_Dúe˘i⁄_Tx
)

740 
SPIx
->
CR1
 |
SPI_Dúe˘i⁄_Tx
;

745 
SPIx
->
CR1
 &
SPI_Dúe˘i⁄_Rx
;

747 
	}
}

766 
FœgSètus
 
	$SPI_I2S_GëFœgSètus
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
SPI_I2S_FLAG
)

768 
FœgSètus
 
bô°©us
 = 
RESET
;

770 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

771 
	`as£π_∑øm
(
	`IS_SPI_I2S_GET_FLAG
(
SPI_I2S_FLAG
));

773 i‡((
SPIx
->
SR
 & 
SPI_I2S_FLAG
Ë!(
uöt16_t
)
RESET
)

776 
bô°©us
 = 
SET
;

781 
bô°©us
 = 
RESET
;

784  
bô°©us
;

785 
	}
}

804 
	$SPI_I2S_CÀ¨Fœg
(
SPI_Ty≥Def
* 
SPIx
, 
uöt16_t
 
SPI_I2S_FLAG
)

807 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

808 
	`as£π_∑øm
(
	`IS_SPI_I2S_CLEAR_FLAG
(
SPI_I2S_FLAG
));

811 
SPIx
->
SR
 = (
uöt16_t
)~
SPI_I2S_FLAG
;

812 
	}
}

829 
ITSètus
 
	$SPI_I2S_GëITSètus
(
SPI_Ty≥Def
* 
SPIx
, 
uöt8_t
 
SPI_I2S_IT
)

831 
ITSètus
 
bô°©us
 = 
RESET
;

832 
uöt16_t
 
ôpos
 = 0, 
ômask
 = 0, 
íabÀ°©us
 = 0;

835 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

836 
	`as£π_∑øm
(
	`IS_SPI_I2S_GET_IT
(
SPI_I2S_IT
));

839 
ôpos
 = 0x01 << (
SPI_I2S_IT
 & 0x0F);

842 
ômask
 = 
SPI_I2S_IT
 >> 4;

845 
ômask
 = 0x01 << itmask;

848 
íabÀ°©us
 = (
SPIx
->
CR2
 & 
ômask
) ;

851 i‡(((
SPIx
->
SR
 & 
ôpos
Ë!(
uöt16_t
)
RESET
Ë&& 
íabÀ°©us
)

854 
bô°©us
 = 
SET
;

859 
bô°©us
 = 
RESET
;

862  
bô°©us
;

863 
	}
}

883 
	$SPI_I2S_CÀ¨ITPídögBô
(
SPI_Ty≥Def
* 
SPIx
, 
uöt8_t
 
SPI_I2S_IT
)

885 
uöt16_t
 
ôpos
 = 0;

887 
	`as£π_∑øm
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

888 
	`as£π_∑øm
(
	`IS_SPI_I2S_CLEAR_IT
(
SPI_I2S_IT
));

891 
ôpos
 = 0x01 << (
SPI_I2S_IT
 & 0x0F);

894 
SPIx
->
SR
 = (
uöt16_t
)~
ôpos
;

895 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST57C7~1.C

23 
	~"°m32f10x_rcc.h
"

47 
	#RCC_OFFSET
 (
RCC_BASE
 - 
PERIPH_BASE
)

	)

52 
	#CR_OFFSET
 (
RCC_OFFSET
 + 0x00)

	)

53 
	#HSION_BôNumbî
 0x00

	)

54 
	#CR_HSION_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
HSION_BôNumbî
 * 4))

	)

57 
	#PLLON_BôNumbî
 0x18

	)

58 
	#CR_PLLON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
PLLON_BôNumbî
 * 4))

	)

60 #ifde‡
STM32F10X_CL


62 
	#PLL2ON_BôNumbî
 0x1A

	)

63 
	#CR_PLL2ON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
PLL2ON_BôNumbî
 * 4))

	)

66 
	#PLL3ON_BôNumbî
 0x1C

	)

67 
	#CR_PLL3ON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
PLL3ON_BôNumbî
 * 4))

	)

71 
	#CSSON_BôNumbî
 0x13

	)

72 
	#CR_CSSON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
CSSON_BôNumbî
 * 4))

	)

77 
	#CFGR_OFFSET
 (
RCC_OFFSET
 + 0x04)

	)

79 #i‚de‡
STM32F10X_CL


80 
	#USBPRE_BôNumbî
 0x16

	)

81 
	#CFGR_USBPRE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32Ë+ (
USBPRE_BôNumbî
 * 4))

	)

83 
	#OTGFSPRE_BôNumbî
 0x16

	)

84 
	#CFGR_OTGFSPRE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32Ë+ (
OTGFSPRE_BôNumbî
 * 4))

	)

90 
	#BDCR_OFFSET
 (
RCC_OFFSET
 + 0x20)

	)

91 
	#RTCEN_BôNumbî
 0x0F

	)

92 
	#BDCR_RTCEN_BB
 (
PERIPH_BB_BASE
 + (
BDCR_OFFSET
 * 32Ë+ (
RTCEN_BôNumbî
 * 4))

	)

95 
	#BDRST_BôNumbî
 0x10

	)

96 
	#BDCR_BDRST_BB
 (
PERIPH_BB_BASE
 + (
BDCR_OFFSET
 * 32Ë+ (
BDRST_BôNumbî
 * 4))

	)

101 
	#CSR_OFFSET
 (
RCC_OFFSET
 + 0x24)

	)

102 
	#LSION_BôNumbî
 0x00

	)

103 
	#CSR_LSION_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
LSION_BôNumbî
 * 4))

	)

105 #ifde‡
STM32F10X_CL


109 
	#CFGR2_OFFSET
 (
RCC_OFFSET
 + 0x2C)

	)

110 
	#I2S2SRC_BôNumbî
 0x11

	)

111 
	#CFGR2_I2S2SRC_BB
 (
PERIPH_BB_BASE
 + (
CFGR2_OFFSET
 * 32Ë+ (
I2S2SRC_BôNumbî
 * 4))

	)

114 
	#I2S3SRC_BôNumbî
 0x12

	)

115 
	#CFGR2_I2S3SRC_BB
 (
PERIPH_BB_BASE
 + (
CFGR2_OFFSET
 * 32Ë+ (
I2S3SRC_BôNumbî
 * 4))

	)

121 
	#CR_HSEBYP_Re£t
 ((
uöt32_t
)0xFFFBFFFF)

	)

122 
	#CR_HSEBYP_Së
 ((
uöt32_t
)0x00040000)

	)

123 
	#CR_HSEON_Re£t
 ((
uöt32_t
)0xFFFEFFFF)

	)

124 
	#CR_HSEON_Së
 ((
uöt32_t
)0x00010000)

	)

125 
	#CR_HSITRIM_Mask
 ((
uöt32_t
)0xFFFFFF07)

	)

128 #i‡
deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
Ë|| deföed (
STM32F10X_CL
)

129 
	#CFGR_PLL_Mask
 ((
uöt32_t
)0xFFC2FFFF)

	)

131 
	#CFGR_PLL_Mask
 ((
uöt32_t
)0xFFC0FFFF)

	)

134 
	#CFGR_PLLMuŒ_Mask
 ((
uöt32_t
)0x003C0000)

	)

135 
	#CFGR_PLLSRC_Mask
 ((
uöt32_t
)0x00010000)

	)

136 
	#CFGR_PLLXTPRE_Mask
 ((
uöt32_t
)0x00020000)

	)

137 
	#CFGR_SWS_Mask
 ((
uöt32_t
)0x0000000C)

	)

138 
	#CFGR_SW_Mask
 ((
uöt32_t
)0xFFFFFFFC)

	)

139 
	#CFGR_HPRE_Re£t_Mask
 ((
uöt32_t
)0xFFFFFF0F)

	)

140 
	#CFGR_HPRE_Së_Mask
 ((
uöt32_t
)0x000000F0)

	)

141 
	#CFGR_PPRE1_Re£t_Mask
 ((
uöt32_t
)0xFFFFF8FF)

	)

142 
	#CFGR_PPRE1_Së_Mask
 ((
uöt32_t
)0x00000700)

	)

143 
	#CFGR_PPRE2_Re£t_Mask
 ((
uöt32_t
)0xFFFFC7FF)

	)

144 
	#CFGR_PPRE2_Së_Mask
 ((
uöt32_t
)0x00003800)

	)

145 
	#CFGR_ADCPRE_Re£t_Mask
 ((
uöt32_t
)0xFFFF3FFF)

	)

146 
	#CFGR_ADCPRE_Së_Mask
 ((
uöt32_t
)0x0000C000)

	)

149 
	#CSR_RMVF_Së
 ((
uöt32_t
)0x01000000)

	)

151 #i‡
deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
Ë|| deföed (
STM32F10X_CL
)

153 
	#CFGR2_PREDIV1SRC
 ((
uöt32_t
)0x00010000)

	)

154 
	#CFGR2_PREDIV1
 ((
uöt32_t
)0x0000000F)

	)

156 #ifde‡
STM32F10X_CL


157 
	#CFGR2_PREDIV2
 ((
uöt32_t
)0x000000F0)

	)

158 
	#CFGR2_PLL2MUL
 ((
uöt32_t
)0x00000F00)

	)

159 
	#CFGR2_PLL3MUL
 ((
uöt32_t
)0x0000F000)

	)

163 
	#FLAG_Mask
 ((
uöt8_t
)0x1F)

	)

166 
	#CIR_BYTE2_ADDRESS
 ((
uöt32_t
)0x40021009)

	)

169 
	#CIR_BYTE3_ADDRESS
 ((
uöt32_t
)0x4002100A)

	)

172 
	#CFGR_BYTE4_ADDRESS
 ((
uöt32_t
)0x40021007)

	)

175 
	#BDCR_ADDRESS
 (
PERIPH_BASE
 + 
BDCR_OFFSET
)

	)

193 
__I
 
uöt8_t
 
	gAPBAHBPªscTabÀ
[16] = {0, 0, 0, 0, 1, 2, 3, 4, 1, 2, 3, 4, 6, 7, 8, 9};

194 
__I
 
uöt8_t
 
	gADCPªscTabÀ
[4] = {2, 4, 6, 8};

217 
	$RCC_DeInô
()

220 
RCC
->
CR
 |(
uöt32_t
)0x00000001;

223 #i‚de‡
STM32F10X_CL


224 
RCC
->
CFGR
 &(
uöt32_t
)0xF8FF0000;

226 
RCC
->
CFGR
 &(
uöt32_t
)0xF0FF0000;

230 
RCC
->
CR
 &(
uöt32_t
)0xFEF6FFFF;

233 
RCC
->
CR
 &(
uöt32_t
)0xFFFBFFFF;

236 
RCC
->
CFGR
 &(
uöt32_t
)0xFF80FFFF;

238 #ifde‡
STM32F10X_CL


240 
RCC
->
CR
 &(
uöt32_t
)0xEBFFFFFF;

243 
RCC
->
CIR
 = 0x00FF0000;

246 
RCC
->
CFGR2
 = 0x00000000;

247 #ñi‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
)

249 
RCC
->
CIR
 = 0x009F0000;

252 
RCC
->
CFGR2
 = 0x00000000;

255 
RCC
->
CIR
 = 0x009F0000;

258 
	}
}

270 
	$RCC_HSEC⁄fig
(
uöt32_t
 
RCC_HSE
)

273 
	`as£π_∑øm
(
	`IS_RCC_HSE
(
RCC_HSE
));

276 
RCC
->
CR
 &
CR_HSEON_Re£t
;

278 
RCC
->
CR
 &
CR_HSEBYP_Re£t
;

280 
RCC_HSE
)

282 
RCC_HSE_ON
:

284 
RCC
->
CR
 |
CR_HSEON_Së
;

287 
RCC_HSE_By∑ss
:

289 
RCC
->
CR
 |
CR_HSEBYP_Së
 | 
CR_HSEON_Së
;

295 
	}
}

304 
Eº‹Sètus
 
	$RCC_WaôF‹HSESèπUp
()

306 
__IO
 
uöt32_t
 
SèπUpCou¡î
 = 0;

307 
Eº‹Sètus
 
°©us
 = 
ERROR
;

308 
FœgSètus
 
HSESètus
 = 
RESET
;

313 
HSESètus
 = 
	`RCC_GëFœgSètus
(
RCC_FLAG_HSERDY
);

314 
SèπUpCou¡î
++;

315 } (
SèπUpCou¡î
 !
HSE_STARTUP_TIMEOUT
Ë&& (
HSESètus
 =
RESET
));

317 i‡(
	`RCC_GëFœgSètus
(
RCC_FLAG_HSERDY
Ë!
RESET
)

319 
°©us
 = 
SUCCESS
;

323 
°©us
 = 
ERROR
;

325  (
°©us
);

326 
	}
}

334 
	$RCC_Adju°HSICÆibøti⁄VÆue
(
uöt8_t
 
HSICÆibøti⁄VÆue
)

336 
uöt32_t
 
tm¥eg
 = 0;

338 
	`as£π_∑øm
(
	`IS_RCC_CALIBRATION_VALUE
(
HSICÆibøti⁄VÆue
));

339 
tm¥eg
 = 
RCC
->
CR
;

341 
tm¥eg
 &
CR_HSITRIM_Mask
;

343 
tm¥eg
 |(
uöt32_t
)
HSICÆibøti⁄VÆue
 << 3;

345 
RCC
->
CR
 = 
tm¥eg
;

346 
	}
}

354 
	$RCC_HSICmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

357 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

358 *(
__IO
 
uöt32_t
 *Ë
CR_HSION_BB
 = (uöt32_t)
NewSèã
;

359 
	}
}

378 
	$RCC_PLLC⁄fig
(
uöt32_t
 
RCC_PLLSour˚
, uöt32_à
RCC_PLLMul
)

380 
uöt32_t
 
tm¥eg
 = 0;

383 
	`as£π_∑øm
(
	`IS_RCC_PLL_SOURCE
(
RCC_PLLSour˚
));

384 
	`as£π_∑øm
(
	`IS_RCC_PLL_MUL
(
RCC_PLLMul
));

386 
tm¥eg
 = 
RCC
->
CFGR
;

388 
tm¥eg
 &
CFGR_PLL_Mask
;

390 
tm¥eg
 |
RCC_PLLSour˚
 | 
RCC_PLLMul
;

392 
RCC
->
CFGR
 = 
tm¥eg
;

393 
	}
}

401 
	$RCC_PLLCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

404 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

406 *(
__IO
 
uöt32_t
 *Ë
CR_PLLON_BB
 = (uöt32_t)
NewSèã
;

407 
	}
}

409 #i‡
deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
Ë|| deföed (
STM32F10X_CL
)

426 
	$RCC_PREDIV1C⁄fig
(
uöt32_t
 
RCC_PREDIV1_Sour˚
, uöt32_à
RCC_PREDIV1_Div
)

428 
uöt32_t
 
tm¥eg
 = 0;

431 
	`as£π_∑øm
(
	`IS_RCC_PREDIV1_SOURCE
(
RCC_PREDIV1_Sour˚
));

432 
	`as£π_∑øm
(
	`IS_RCC_PREDIV1
(
RCC_PREDIV1_Div
));

434 
tm¥eg
 = 
RCC
->
CFGR2
;

436 
tm¥eg
 &~(
CFGR2_PREDIV1
 | 
CFGR2_PREDIV1SRC
);

438 
tm¥eg
 |
RCC_PREDIV1_Sour˚
 | 
RCC_PREDIV1_Div
 ;

440 
RCC
->
CFGR2
 = 
tm¥eg
;

441 
	}
}

444 #ifde‡
STM32F10X_CL


454 
	$RCC_PREDIV2C⁄fig
(
uöt32_t
 
RCC_PREDIV2_Div
)

456 
uöt32_t
 
tm¥eg
 = 0;

459 
	`as£π_∑øm
(
	`IS_RCC_PREDIV2
(
RCC_PREDIV2_Div
));

461 
tm¥eg
 = 
RCC
->
CFGR2
;

463 
tm¥eg
 &~
CFGR2_PREDIV2
;

465 
tm¥eg
 |
RCC_PREDIV2_Div
;

467 
RCC
->
CFGR2
 = 
tm¥eg
;

468 
	}
}

479 
	$RCC_PLL2C⁄fig
(
uöt32_t
 
RCC_PLL2Mul
)

481 
uöt32_t
 
tm¥eg
 = 0;

484 
	`as£π_∑øm
(
	`IS_RCC_PLL2_MUL
(
RCC_PLL2Mul
));

486 
tm¥eg
 = 
RCC
->
CFGR2
;

488 
tm¥eg
 &~
CFGR2_PLL2MUL
;

490 
tm¥eg
 |
RCC_PLL2Mul
;

492 
RCC
->
CFGR2
 = 
tm¥eg
;

493 
	}
}

505 
	$RCC_PLL2Cmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

508 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

510 *(
__IO
 
uöt32_t
 *Ë
CR_PLL2ON_BB
 = (uöt32_t)
NewSèã
;

511 
	}
}

523 
	$RCC_PLL3C⁄fig
(
uöt32_t
 
RCC_PLL3Mul
)

525 
uöt32_t
 
tm¥eg
 = 0;

528 
	`as£π_∑øm
(
	`IS_RCC_PLL3_MUL
(
RCC_PLL3Mul
));

530 
tm¥eg
 = 
RCC
->
CFGR2
;

532 
tm¥eg
 &~
CFGR2_PLL3MUL
;

534 
tm¥eg
 |
RCC_PLL3Mul
;

536 
RCC
->
CFGR2
 = 
tm¥eg
;

537 
	}
}

546 
	$RCC_PLL3Cmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

550 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

551 *(
__IO
 
uöt32_t
 *Ë
CR_PLL3ON_BB
 = (uöt32_t)
NewSèã
;

552 
	}
}

564 
	$RCC_SYSCLKC⁄fig
(
uöt32_t
 
RCC_SYSCLKSour˚
)

566 
uöt32_t
 
tm¥eg
 = 0;

568 
	`as£π_∑øm
(
	`IS_RCC_SYSCLK_SOURCE
(
RCC_SYSCLKSour˚
));

569 
tm¥eg
 = 
RCC
->
CFGR
;

571 
tm¥eg
 &
CFGR_SW_Mask
;

573 
tm¥eg
 |
RCC_SYSCLKSour˚
;

575 
RCC
->
CFGR
 = 
tm¥eg
;

576 
	}
}

587 
uöt8_t
 
	$RCC_GëSYSCLKSour˚
()

589  ((
uöt8_t
)(
RCC
->
CFGR
 & 
CFGR_SWS_Mask
));

590 
	}
}

608 
	$RCC_HCLKC⁄fig
(
uöt32_t
 
RCC_SYSCLK
)

610 
uöt32_t
 
tm¥eg
 = 0;

612 
	`as£π_∑øm
(
	`IS_RCC_HCLK
(
RCC_SYSCLK
));

613 
tm¥eg
 = 
RCC
->
CFGR
;

615 
tm¥eg
 &
CFGR_HPRE_Re£t_Mask
;

617 
tm¥eg
 |
RCC_SYSCLK
;

619 
RCC
->
CFGR
 = 
tm¥eg
;

620 
	}
}

634 
	$RCC_PCLK1C⁄fig
(
uöt32_t
 
RCC_HCLK
)

636 
uöt32_t
 
tm¥eg
 = 0;

638 
	`as£π_∑øm
(
	`IS_RCC_PCLK
(
RCC_HCLK
));

639 
tm¥eg
 = 
RCC
->
CFGR
;

641 
tm¥eg
 &
CFGR_PPRE1_Re£t_Mask
;

643 
tm¥eg
 |
RCC_HCLK
;

645 
RCC
->
CFGR
 = 
tm¥eg
;

646 
	}
}

660 
	$RCC_PCLK2C⁄fig
(
uöt32_t
 
RCC_HCLK
)

662 
uöt32_t
 
tm¥eg
 = 0;

664 
	`as£π_∑øm
(
	`IS_RCC_PCLK
(
RCC_HCLK
));

665 
tm¥eg
 = 
RCC
->
CFGR
;

667 
tm¥eg
 &
CFGR_PPRE2_Re£t_Mask
;

669 
tm¥eg
 |
RCC_HCLK
 << 3;

671 
RCC
->
CFGR
 = 
tm¥eg
;

672 
	}
}

700 
	$RCC_ITC⁄fig
(
uöt8_t
 
RCC_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

703 
	`as£π_∑øm
(
	`IS_RCC_IT
(
RCC_IT
));

704 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

705 i‡(
NewSèã
 !
DISABLE
)

708 *(
__IO
 
uöt8_t
 *Ë
CIR_BYTE2_ADDRESS
 |
RCC_IT
;

713 *(
__IO
 
uöt8_t
 *Ë
CIR_BYTE2_ADDRESS
 &(uöt8_t)~
RCC_IT
;

715 
	}
}

717 #i‚de‡
STM32F10X_CL


728 
	$RCC_USBCLKC⁄fig
(
uöt32_t
 
RCC_USBCLKSour˚
)

731 
	`as£π_∑øm
(
	`IS_RCC_USBCLK_SOURCE
(
RCC_USBCLKSour˚
));

733 *(
__IO
 
uöt32_t
 *Ë
CFGR_USBPRE_BB
 = 
RCC_USBCLKSour˚
;

734 
	}
}

746 
	$RCC_OTGFSCLKC⁄fig
(
uöt32_t
 
RCC_OTGFSCLKSour˚
)

749 
	`as£π_∑øm
(
	`IS_RCC_OTGFSCLK_SOURCE
(
RCC_OTGFSCLKSour˚
));

751 *(
__IO
 
uöt32_t
 *Ë
CFGR_OTGFSPRE_BB
 = 
RCC_OTGFSCLKSour˚
;

752 
	}
}

766 
	$RCC_ADCCLKC⁄fig
(
uöt32_t
 
RCC_PCLK2
)

768 
uöt32_t
 
tm¥eg
 = 0;

770 
	`as£π_∑øm
(
	`IS_RCC_ADCCLK
(
RCC_PCLK2
));

771 
tm¥eg
 = 
RCC
->
CFGR
;

773 
tm¥eg
 &
CFGR_ADCPRE_Re£t_Mask
;

775 
tm¥eg
 |
RCC_PCLK2
;

777 
RCC
->
CFGR
 = 
tm¥eg
;

778 
	}
}

780 #ifde‡
STM32F10X_CL


792 
	$RCC_I2S2CLKC⁄fig
(
uöt32_t
 
RCC_I2S2CLKSour˚
)

795 
	`as£π_∑øm
(
	`IS_RCC_I2S2CLK_SOURCE
(
RCC_I2S2CLKSour˚
));

797 *(
__IO
 
uöt32_t
 *Ë
CFGR2_I2S2SRC_BB
 = 
RCC_I2S2CLKSour˚
;

798 
	}
}

811 
	$RCC_I2S3CLKC⁄fig
(
uöt32_t
 
RCC_I2S3CLKSour˚
)

814 
	`as£π_∑øm
(
	`IS_RCC_I2S3CLK_SOURCE
(
RCC_I2S3CLKSour˚
));

816 *(
__IO
 
uöt32_t
 *Ë
CFGR2_I2S3SRC_BB
 = 
RCC_I2S3CLKSour˚
;

817 
	}
}

829 
	$RCC_LSEC⁄fig
(
uöt8_t
 
RCC_LSE
)

832 
	`as£π_∑øm
(
	`IS_RCC_LSE
(
RCC_LSE
));

835 *(
__IO
 
uöt8_t
 *Ë
BDCR_ADDRESS
 = 
RCC_LSE_OFF
;

837 *(
__IO
 
uöt8_t
 *Ë
BDCR_ADDRESS
 = 
RCC_LSE_OFF
;

839 
RCC_LSE
)

841 
RCC_LSE_ON
:

843 *(
__IO
 
uöt8_t
 *Ë
BDCR_ADDRESS
 = 
RCC_LSE_ON
;

846 
RCC_LSE_By∑ss
:

848 *(
__IO
 
uöt8_t
 *Ë
BDCR_ADDRESS
 = 
RCC_LSE_By∑ss
 | 
RCC_LSE_ON
;

854 
	}
}

862 
	$RCC_LSICmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

865 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

866 *(
__IO
 
uöt32_t
 *Ë
CSR_LSION_BB
 = (uöt32_t)
NewSèã
;

867 
	}
}

879 
	$RCC_RTCCLKC⁄fig
(
uöt32_t
 
RCC_RTCCLKSour˚
)

882 
	`as£π_∑øm
(
	`IS_RCC_RTCCLK_SOURCE
(
RCC_RTCCLKSour˚
));

884 
RCC
->
BDCR
 |
RCC_RTCCLKSour˚
;

885 
	}
}

893 
	$RCC_RTCCLKCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

896 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

897 *(
__IO
 
uöt32_t
 *Ë
BDCR_RTCEN_BB
 = (uöt32_t)
NewSèã
;

898 
	}
}

908 
	$RCC_GëClocksFªq
(
RCC_ClocksTy≥Def
* 
RCC_Clocks
)

910 
uöt32_t
 
tmp
 = 0, 
∂lmuŒ
 = 0, 
∂lsour˚
 = 0, 
¥esc
 = 0;

912 #ifde‡ 
STM32F10X_CL


913 
uöt32_t
 
¥ediv1sour˚
 = 0, 
¥ediv1Á˘‹
 = 0, 
¥ediv2Á˘‹
 = 0, 
∂l2muŒ
 = 0;

916 #i‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
)

917 
uöt32_t
 
¥ediv1Á˘‹
 = 0;

921 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_SWS_Mask
;

923 
tmp
)

926 
RCC_Clocks
->
SYSCLK_Fªquícy
 = 
HSI_VALUE
;

929 
RCC_Clocks
->
SYSCLK_Fªquícy
 = 
HSE_VALUE
;

934 
∂lmuŒ
 = 
RCC
->
CFGR
 & 
CFGR_PLLMuŒ_Mask
;

935 
∂lsour˚
 = 
RCC
->
CFGR
 & 
CFGR_PLLSRC_Mask
;

937 #i‚de‡
STM32F10X_CL


938 
∂lmuŒ
 = (Öllmull >> 18) + 2;

940 i‡(
∂lsour˚
 == 0x00)

942 
RCC_Clocks
->
SYSCLK_Fªquícy
 = (
HSI_VALUE
 >> 1Ë* 
∂lmuŒ
;

946 #i‡
	`deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
)

947 
¥ediv1Á˘‹
 = (
RCC
->
CFGR2
 & 
CFGR2_PREDIV1
) + 1;

949 
RCC_Clocks
->
SYSCLK_Fªquícy
 = (
HSE_VALUE
 / 
¥ediv1Á˘‹
Ë* 
∂lmuŒ
;

952 i‡((
RCC
->
CFGR
 & 
CFGR_PLLXTPRE_Mask
Ë!(
uöt32_t
)
RESET
)

954 
RCC_Clocks
->
SYSCLK_Fªquícy
 = (
HSE_VALUE
 >> 1Ë* 
∂lmuŒ
;

958 
RCC_Clocks
->
SYSCLK_Fªquícy
 = 
HSE_VALUE
 * 
∂lmuŒ
;

963 
∂lmuŒ
 =Öllmull >> 18;

965 i‡(
∂lmuŒ
 != 0x0D)

967 
∂lmuŒ
 += 2;

971 
∂lmuŒ
 = 13 / 2;

974 i‡(
∂lsour˚
 == 0x00)

976 
RCC_Clocks
->
SYSCLK_Fªquícy
 = (
HSI_VALUE
 >> 1Ë* 
∂lmuŒ
;

982 
¥ediv1sour˚
 = 
RCC
->
CFGR2
 & 
CFGR2_PREDIV1SRC
;

983 
¥ediv1Á˘‹
 = (
RCC
->
CFGR2
 & 
CFGR2_PREDIV1
) + 1;

985 i‡(
¥ediv1sour˚
 == 0)

987 
RCC_Clocks
->
SYSCLK_Fªquícy
 = (
HSE_VALUE
 / 
¥ediv1Á˘‹
Ë* 
∂lmuŒ
;

993 
¥ediv2Á˘‹
 = ((
RCC
->
CFGR2
 & 
CFGR2_PREDIV2
) >> 4) + 1;

994 
∂l2muŒ
 = ((
RCC
->
CFGR2
 & 
CFGR2_PLL2MUL
) >> 8 ) + 2;

995 
RCC_Clocks
->
SYSCLK_Fªquícy
 = (((
HSE_VALUE
 / 
¥ediv2Á˘‹
Ë* 
∂l2muŒ
Ë/ 
¥ediv1Á˘‹
Ë* 
∂lmuŒ
;

1002 
RCC_Clocks
->
SYSCLK_Fªquícy
 = 
HSI_VALUE
;

1008 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_HPRE_Së_Mask
;

1009 
tmp
 =Åmp >> 4;

1010 
¥esc
 = 
APBAHBPªscTabÀ
[
tmp
];

1012 
RCC_Clocks
->
HCLK_Fªquícy
 = RCC_Clocks->
SYSCLK_Fªquícy
 >> 
¥esc
;

1014 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_PPRE1_Së_Mask
;

1015 
tmp
 =Åmp >> 8;

1016 
¥esc
 = 
APBAHBPªscTabÀ
[
tmp
];

1018 
RCC_Clocks
->
PCLK1_Fªquícy
 = RCC_Clocks->
HCLK_Fªquícy
 >> 
¥esc
;

1020 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_PPRE2_Së_Mask
;

1021 
tmp
 =Åmp >> 11;

1022 
¥esc
 = 
APBAHBPªscTabÀ
[
tmp
];

1024 
RCC_Clocks
->
PCLK2_Fªquícy
 = RCC_Clocks->
HCLK_Fªquícy
 >> 
¥esc
;

1026 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_ADCPRE_Së_Mask
;

1027 
tmp
 =Åmp >> 14;

1028 
¥esc
 = 
ADCPªscTabÀ
[
tmp
];

1030 
RCC_Clocks
->
ADCCLK_Fªquícy
 = RCC_Clocks->
PCLK2_Fªquícy
 / 
¥esc
;

1031 
	}
}

1064 
	$RCC_AHBPîùhClockCmd
(
uöt32_t
 
RCC_AHBPîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1067 
	`as£π_∑øm
(
	`IS_RCC_AHB_PERIPH
(
RCC_AHBPîùh
));

1068 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1070 i‡(
NewSèã
 !
DISABLE
)

1072 
RCC
->
AHBENR
 |
RCC_AHBPîùh
;

1076 
RCC
->
AHBENR
 &~
RCC_AHBPîùh
;

1078 
	}
}

1095 
	$RCC_APB2PîùhClockCmd
(
uöt32_t
 
RCC_APB2Pîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1098 
	`as£π_∑øm
(
	`IS_RCC_APB2_PERIPH
(
RCC_APB2Pîùh
));

1099 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1100 i‡(
NewSèã
 !
DISABLE
)

1102 
RCC
->
APB2ENR
 |
RCC_APB2Pîùh
;

1106 
RCC
->
APB2ENR
 &~
RCC_APB2Pîùh
;

1108 
	}
}

1126 
	$RCC_APB1PîùhClockCmd
(
uöt32_t
 
RCC_APB1Pîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1129 
	`as£π_∑øm
(
	`IS_RCC_APB1_PERIPH
(
RCC_APB1Pîùh
));

1130 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1131 i‡(
NewSèã
 !
DISABLE
)

1133 
RCC
->
APB1ENR
 |
RCC_APB1Pîùh
;

1137 
RCC
->
APB1ENR
 &~
RCC_APB1Pîùh
;

1139 
	}
}

1141 #ifde‡
STM32F10X_CL


1153 
	$RCC_AHBPîùhRe£tCmd
(
uöt32_t
 
RCC_AHBPîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1156 
	`as£π_∑øm
(
	`IS_RCC_AHB_PERIPH_RESET
(
RCC_AHBPîùh
));

1157 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1159 i‡(
NewSèã
 !
DISABLE
)

1161 
RCC
->
AHBRSTR
 |
RCC_AHBPîùh
;

1165 
RCC
->
AHBRSTR
 &~
RCC_AHBPîùh
;

1167 
	}
}

1185 
	$RCC_APB2PîùhRe£tCmd
(
uöt32_t
 
RCC_APB2Pîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1188 
	`as£π_∑øm
(
	`IS_RCC_APB2_PERIPH
(
RCC_APB2Pîùh
));

1189 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1190 i‡(
NewSèã
 !
DISABLE
)

1192 
RCC
->
APB2RSTR
 |
RCC_APB2Pîùh
;

1196 
RCC
->
APB2RSTR
 &~
RCC_APB2Pîùh
;

1198 
	}
}

1216 
	$RCC_APB1PîùhRe£tCmd
(
uöt32_t
 
RCC_APB1Pîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1219 
	`as£π_∑øm
(
	`IS_RCC_APB1_PERIPH
(
RCC_APB1Pîùh
));

1220 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1221 i‡(
NewSèã
 !
DISABLE
)

1223 
RCC
->
APB1RSTR
 |
RCC_APB1Pîùh
;

1227 
RCC
->
APB1RSTR
 &~
RCC_APB1Pîùh
;

1229 
	}
}

1237 
	$RCC_BackupRe£tCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

1240 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1241 *(
__IO
 
uöt32_t
 *Ë
BDCR_BDRST_BB
 = (uöt32_t)
NewSèã
;

1242 
	}
}

1250 
	$RCC_ClockSecurôySy°emCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

1253 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1254 *(
__IO
 
uöt32_t
 *Ë
CR_CSSON_BB
 = (uöt32_t)
NewSèã
;

1255 
	}
}

1282 
	$RCC_MCOC⁄fig
(
uöt8_t
 
RCC_MCO
)

1285 
	`as£π_∑øm
(
	`IS_RCC_MCO
(
RCC_MCO
));

1288 *(
__IO
 
uöt8_t
 *Ë
CFGR_BYTE4_ADDRESS
 = 
RCC_MCO
;

1289 
	}
}

1326 
FœgSètus
 
	$RCC_GëFœgSètus
(
uöt8_t
 
RCC_FLAG
)

1328 
uöt32_t
 
tmp
 = 0;

1329 
uöt32_t
 
°©u§eg
 = 0;

1330 
FœgSètus
 
bô°©us
 = 
RESET
;

1332 
	`as£π_∑øm
(
	`IS_RCC_FLAG
(
RCC_FLAG
));

1335 
tmp
 = 
RCC_FLAG
 >> 5;

1336 i‡(
tmp
 == 1)

1338 
°©u§eg
 = 
RCC
->
CR
;

1340 i‡(
tmp
 == 2)

1342 
°©u§eg
 = 
RCC
->
BDCR
;

1346 
°©u§eg
 = 
RCC
->
CSR
;

1350 
tmp
 = 
RCC_FLAG
 & 
FLAG_Mask
;

1351 i‡((
°©u§eg
 & ((
uöt32_t
)1 << 
tmp
)Ë!(uöt32_t)
RESET
)

1353 
bô°©us
 = 
SET
;

1357 
bô°©us
 = 
RESET
;

1361  
bô°©us
;

1362 
	}
}

1371 
	$RCC_CÀ¨Fœg
()

1374 
RCC
->
CSR
 |
CSR_RMVF_Së
;

1375 
	}
}

1402 
ITSètus
 
	$RCC_GëITSètus
(
uöt8_t
 
RCC_IT
)

1404 
ITSètus
 
bô°©us
 = 
RESET
;

1406 
	`as£π_∑øm
(
	`IS_RCC_GET_IT
(
RCC_IT
));

1409 i‡((
RCC
->
CIR
 & 
RCC_IT
Ë!(
uöt32_t
)
RESET
)

1411 
bô°©us
 = 
SET
;

1415 
bô°©us
 = 
RESET
;

1419  
bô°©us
;

1420 
	}
}

1448 
	$RCC_CÀ¨ITPídögBô
(
uöt8_t
 
RCC_IT
)

1451 
	`as£π_∑øm
(
	`IS_RCC_CLEAR_IT
(
RCC_IT
));

1455 *(
__IO
 
uöt8_t
 *Ë
CIR_BYTE3_ADDRESS
 = 
RCC_IT
;

1456 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST585B~1.C

23 
	~"°m32f10x_fsmc.h
"

24 
	~"°m32f10x_rcc.h
"

49 
	#BCR_MBKEN_Së
 ((
uöt32_t
)0x00000001)

	)

50 
	#BCR_MBKEN_Re£t
 ((
uöt32_t
)0x000FFFFE)

	)

51 
	#BCR_FACCEN_Së
 ((
uöt32_t
)0x00000040)

	)

54 
	#PCR_PBKEN_Së
 ((
uöt32_t
)0x00000004)

	)

55 
	#PCR_PBKEN_Re£t
 ((
uöt32_t
)0x000FFFFB)

	)

56 
	#PCR_ECCEN_Së
 ((
uöt32_t
)0x00000040)

	)

57 
	#PCR_ECCEN_Re£t
 ((
uöt32_t
)0x000FFFBF)

	)

58 
	#PCR_Mem‹yTy≥_NAND
 ((
uöt32_t
)0x00000008)

	)

102 
	$FSMC_NORSRAMDeInô
(
uöt32_t
 
FSMC_B™k
)

105 
	`as£π_∑øm
(
	`IS_FSMC_NORSRAM_BANK
(
FSMC_B™k
));

108 if(
FSMC_B™k
 =
FSMC_B™k1_NORSRAM1
)

110 
FSMC_B™k1
->
BTCR
[
FSMC_B™k
] = 0x000030DB;

115 
FSMC_B™k1
->
BTCR
[
FSMC_B™k
] = 0x000030D2;

117 
FSMC_B™k1
->
BTCR
[
FSMC_B™k
 + 1] = 0x0FFFFFFF;

118 
FSMC_B™k1E
->
BWTR
[
FSMC_B™k
] = 0x0FFFFFFF;

119 
	}
}

129 
	$FSMC_NANDDeInô
(
uöt32_t
 
FSMC_B™k
)

132 
	`as£π_∑øm
(
	`IS_FSMC_NAND_BANK
(
FSMC_B™k
));

134 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

137 
FSMC_B™k2
->
PCR2
 = 0x00000018;

138 
FSMC_B™k2
->
SR2
 = 0x00000040;

139 
FSMC_B™k2
->
PMEM2
 = 0xFCFCFCFC;

140 
FSMC_B™k2
->
PATT2
 = 0xFCFCFCFC;

146 
FSMC_B™k3
->
PCR3
 = 0x00000018;

147 
FSMC_B™k3
->
SR3
 = 0x00000040;

148 
FSMC_B™k3
->
PMEM3
 = 0xFCFCFCFC;

149 
FSMC_B™k3
->
PATT3
 = 0xFCFCFCFC;

151 
	}
}

158 
	$FSMC_PCCARDDeInô
()

161 
FSMC_B™k4
->
PCR4
 = 0x00000018;

162 
FSMC_B™k4
->
SR4
 = 0x00000000;

163 
FSMC_B™k4
->
PMEM4
 = 0xFCFCFCFC;

164 
FSMC_B™k4
->
PATT4
 = 0xFCFCFCFC;

165 
FSMC_B™k4
->
PIO4
 = 0xFCFCFCFC;

166 
	}
}

176 
	$FSMC_NORSRAMInô
(
FSMC_NORSRAMInôTy≥Def
* 
FSMC_NORSRAMInôSåu˘
)

179 
	`as£π_∑øm
(
	`IS_FSMC_NORSRAM_BANK
(
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
));

180 
	`as£π_∑øm
(
	`IS_FSMC_MUX
(
FSMC_NORSRAMInôSåu˘
->
FSMC_D©aAddªssMux
));

181 
	`as£π_∑øm
(
	`IS_FSMC_MEMORY
(
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yTy≥
));

182 
	`as£π_∑øm
(
	`IS_FSMC_MEMORY_WIDTH
(
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yD©aWidth
));

183 
	`as£π_∑øm
(
	`IS_FSMC_BURSTMODE
(
FSMC_NORSRAMInôSåu˘
->
FSMC_Bur°Ac˚ssMode
));

184 
	`as£π_∑øm
(
	`IS_FSMC_ASYNWAIT
(
FSMC_NORSRAMInôSåu˘
->
FSMC_Asynchr⁄ousWaô
));

185 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_POLARITY
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«lPﬁ¨ôy
));

186 
	`as£π_∑øm
(
	`IS_FSMC_WRAP_MODE
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WøpMode
));

187 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_SIGNAL_ACTIVE
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«lA˘ive
));

188 
	`as£π_∑øm
(
	`IS_FSMC_WRITE_OPERATION
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeO≥øti⁄
));

189 
	`as£π_∑øm
(
	`IS_FSMC_WAITE_SIGNAL
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«l
));

190 
	`as£π_∑øm
(
	`IS_FSMC_EXTENDED_MODE
(
FSMC_NORSRAMInôSåu˘
->
FSMC_ExãndedMode
));

191 
	`as£π_∑øm
(
	`IS_FSMC_WRITE_BURST
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeBur°
));

192 
	`as£π_∑øm
(
	`IS_FSMC_ADDRESS_SETUP_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_AddªssSëupTime
));

193 
	`as£π_∑øm
(
	`IS_FSMC_ADDRESS_HOLD_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_AddªssHﬁdTime
));

194 
	`as£π_∑øm
(
	`IS_FSMC_DATASETUP_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_D©aSëupTime
));

195 
	`as£π_∑øm
(
	`IS_FSMC_TURNAROUND_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_BusTu∫AroundDuøti⁄
));

196 
	`as£π_∑øm
(
	`IS_FSMC_CLK_DIV
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_CLKDivisi⁄
));

197 
	`as£π_∑øm
(
	`IS_FSMC_DATA_LATENCY
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_D©aL©ícy
));

198 
	`as£π_∑øm
(
	`IS_FSMC_ACCESS_MODE
(
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_Ac˚ssMode
));

201 
FSMC_B™k1
->
BTCR
[
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
] =

202 (
uöt32_t
)
FSMC_NORSRAMInôSåu˘
->
FSMC_D©aAddªssMux
 |

203 
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yTy≥
 |

204 
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yD©aWidth
 |

205 
FSMC_NORSRAMInôSåu˘
->
FSMC_Bur°Ac˚ssMode
 |

206 
FSMC_NORSRAMInôSåu˘
->
FSMC_Asynchr⁄ousWaô
 |

207 
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«lPﬁ¨ôy
 |

208 
FSMC_NORSRAMInôSåu˘
->
FSMC_WøpMode
 |

209 
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«lA˘ive
 |

210 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeO≥øti⁄
 |

211 
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«l
 |

212 
FSMC_NORSRAMInôSåu˘
->
FSMC_ExãndedMode
 |

213 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeBur°
;

215 if(
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yTy≥
 =
FSMC_Mem‹yTy≥_NOR
)

217 
FSMC_B™k1
->
BTCR
[
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
] |(
uöt32_t
)
BCR_FACCEN_Së
;

221 
FSMC_B™k1
->
BTCR
[
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
+1] =

222 (
uöt32_t
)
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_AddªssSëupTime
 |

223 (
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_AddªssHﬁdTime
 << 4) |

224 (
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_D©aSëupTime
 << 8) |

225 (
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_BusTu∫AroundDuøti⁄
 << 16) |

226 (
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_CLKDivisi⁄
 << 20) |

227 (
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_D©aL©ícy
 << 24) |

228 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_Ac˚ssMode
;

232 if(
FSMC_NORSRAMInôSåu˘
->
FSMC_ExãndedMode
 =
FSMC_ExãndedMode_E«bÀ
)

234 
	`as£π_∑øm
(
	`IS_FSMC_ADDRESS_SETUP_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_AddªssSëupTime
));

235 
	`as£π_∑øm
(
	`IS_FSMC_ADDRESS_HOLD_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_AddªssHﬁdTime
));

236 
	`as£π_∑øm
(
	`IS_FSMC_DATASETUP_TIME
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_D©aSëupTime
));

237 
	`as£π_∑øm
(
	`IS_FSMC_CLK_DIV
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_CLKDivisi⁄
));

238 
	`as£π_∑øm
(
	`IS_FSMC_DATA_LATENCY
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_D©aL©ícy
));

239 
	`as£π_∑øm
(
	`IS_FSMC_ACCESS_MODE
(
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_Ac˚ssMode
));

240 
FSMC_B™k1E
->
BWTR
[
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
] =

241 (
uöt32_t
)
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_AddªssSëupTime
 |

242 (
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_AddªssHﬁdTime
 << 4 )|

243 (
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_D©aSëupTime
 << 8) |

244 (
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_CLKDivisi⁄
 << 20) |

245 (
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_D©aL©ícy
 << 24) |

246 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_Ac˚ssMode
;

250 
FSMC_B™k1E
->
BWTR
[
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
] = 0x0FFFFFFF;

252 
	}
}

262 
	$FSMC_NANDInô
(
FSMC_NANDInôTy≥Def
* 
FSMC_NANDInôSåu˘
)

264 
uöt32_t
 
tmµ¸
 = 0x00000000, 
tmµmem
 = 0x00000000, 
tmµ©t
 = 0x00000000;

267 
	`as£π_∑øm
–
	`IS_FSMC_NAND_BANK
(
FSMC_NANDInôSåu˘
->
FSMC_B™k
));

268 
	`as£π_∑øm
–
	`IS_FSMC_WAIT_FEATURE
(
FSMC_NANDInôSåu˘
->
FSMC_Waô„©uª
));

269 
	`as£π_∑øm
–
	`IS_FSMC_MEMORY_WIDTH
(
FSMC_NANDInôSåu˘
->
FSMC_Mem‹yD©aWidth
));

270 
	`as£π_∑øm
–
	`IS_FSMC_ECC_STATE
(
FSMC_NANDInôSåu˘
->
FSMC_ECC
));

271 
	`as£π_∑øm
–
	`IS_FSMC_ECCPAGE_SIZE
(
FSMC_NANDInôSåu˘
->
FSMC_ECCPageSize
));

272 
	`as£π_∑øm
–
	`IS_FSMC_TCLR_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_TCLRSëupTime
));

273 
	`as£π_∑øm
–
	`IS_FSMC_TAR_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_TARSëupTime
));

274 
	`as£π_∑øm
(
	`IS_FSMC_SETUP_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_SëupTime
));

275 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_WaôSëupTime
));

276 
	`as£π_∑øm
(
	`IS_FSMC_HOLD_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
));

277 
	`as£π_∑øm
(
	`IS_FSMC_HIZ_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HiZSëupTime
));

278 
	`as£π_∑øm
(
	`IS_FSMC_SETUP_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_SëupTime
));

279 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
));

280 
	`as£π_∑øm
(
	`IS_FSMC_HOLD_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
));

281 
	`as£π_∑øm
(
	`IS_FSMC_HIZ_TIME
(
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
));

284 
tmµ¸
 = (
uöt32_t
)
FSMC_NANDInôSåu˘
->
FSMC_Waô„©uª
 |

285 
PCR_Mem‹yTy≥_NAND
 |

286 
FSMC_NANDInôSåu˘
->
FSMC_Mem‹yD©aWidth
 |

287 
FSMC_NANDInôSåu˘
->
FSMC_ECC
 |

288 
FSMC_NANDInôSåu˘
->
FSMC_ECCPageSize
 |

289 (
FSMC_NANDInôSåu˘
->
FSMC_TCLRSëupTime
 << 9 )|

290 (
FSMC_NANDInôSåu˘
->
FSMC_TARSëupTime
 << 13);

293 
tmµmem
 = (
uöt32_t
)
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_SëupTime
 |

294 (
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 << 8) |

295 (
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 << 16)|

296 (
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 << 24);

299 
tmµ©t
 = (
uöt32_t
)
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_SëupTime
 |

300 (
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 << 8) |

301 (
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 << 16)|

302 (
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 << 24);

304 if(
FSMC_NANDInôSåu˘
->
FSMC_B™k
 =
FSMC_B™k2_NAND
)

307 
FSMC_B™k2
->
PCR2
 = 
tmµ¸
;

308 
FSMC_B™k2
->
PMEM2
 = 
tmµmem
;

309 
FSMC_B™k2
->
PATT2
 = 
tmµ©t
;

314 
FSMC_B™k3
->
PCR3
 = 
tmµ¸
;

315 
FSMC_B™k3
->
PMEM3
 = 
tmµmem
;

316 
FSMC_B™k3
->
PATT3
 = 
tmµ©t
;

318 
	}
}

328 
	$FSMC_PCCARDInô
(
FSMC_PCCARDInôTy≥Def
* 
FSMC_PCCARDInôSåu˘
)

331 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_FEATURE
(
FSMC_PCCARDInôSåu˘
->
FSMC_Waô„©uª
));

332 
	`as£π_∑øm
(
	`IS_FSMC_TCLR_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_TCLRSëupTime
));

333 
	`as£π_∑øm
(
	`IS_FSMC_TAR_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_TARSëupTime
));

335 
	`as£π_∑øm
(
	`IS_FSMC_SETUP_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_SëupTime
));

336 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_WaôSëupTime
));

337 
	`as£π_∑øm
(
	`IS_FSMC_HOLD_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
));

338 
	`as£π_∑øm
(
	`IS_FSMC_HIZ_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HiZSëupTime
));

340 
	`as£π_∑øm
(
	`IS_FSMC_SETUP_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_SëupTime
));

341 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
));

342 
	`as£π_∑øm
(
	`IS_FSMC_HOLD_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
));

343 
	`as£π_∑øm
(
	`IS_FSMC_HIZ_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
));

344 
	`as£π_∑øm
(
	`IS_FSMC_SETUP_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_SëupTime
));

345 
	`as£π_∑øm
(
	`IS_FSMC_WAIT_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
));

346 
	`as£π_∑øm
(
	`IS_FSMC_HOLD_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
));

347 
	`as£π_∑øm
(
	`IS_FSMC_HIZ_TIME
(
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
));

350 
FSMC_B™k4
->
PCR4
 = (
uöt32_t
)
FSMC_PCCARDInôSåu˘
->
FSMC_Waô„©uª
 |

351 
FSMC_Mem‹yD©aWidth_16b
 |

352 (
FSMC_PCCARDInôSåu˘
->
FSMC_TCLRSëupTime
 << 9) |

353 (
FSMC_PCCARDInôSåu˘
->
FSMC_TARSëupTime
 << 13);

356 
FSMC_B™k4
->
PMEM4
 = (
uöt32_t
)
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_SëupTime
 |

357 (
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 << 8) |

358 (
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 << 16)|

359 (
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 << 24);

362 
FSMC_B™k4
->
PATT4
 = (
uöt32_t
)
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_SëupTime
 |

363 (
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 << 8) |

364 (
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 << 16)|

365 (
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 << 24);

368 
FSMC_B™k4
->
PIO4
 = (
uöt32_t
)
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_SëupTime
 |

369 (
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 << 8) |

370 (
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 << 16)|

371 (
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 << 24);

372 
	}
}

380 
	$FSMC_NORSRAMSåu˘Inô
(
FSMC_NORSRAMInôTy≥Def
* 
FSMC_NORSRAMInôSåu˘
)

383 
FSMC_NORSRAMInôSåu˘
->
FSMC_B™k
 = 
FSMC_B™k1_NORSRAM1
;

384 
FSMC_NORSRAMInôSåu˘
->
FSMC_D©aAddªssMux
 = 
FSMC_D©aAddªssMux_E«bÀ
;

385 
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yTy≥
 = 
FSMC_Mem‹yTy≥_SRAM
;

386 
FSMC_NORSRAMInôSåu˘
->
FSMC_Mem‹yD©aWidth
 = 
FSMC_Mem‹yD©aWidth_8b
;

387 
FSMC_NORSRAMInôSåu˘
->
FSMC_Bur°Ac˚ssMode
 = 
FSMC_Bur°Ac˚ssMode_DißbÀ
;

388 
FSMC_NORSRAMInôSåu˘
->
FSMC_Asynchr⁄ousWaô
 = 
FSMC_Asynchr⁄ousWaô_DißbÀ
;

389 
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«lPﬁ¨ôy
 = 
FSMC_WaôSig«lPﬁ¨ôy_Low
;

390 
FSMC_NORSRAMInôSåu˘
->
FSMC_WøpMode
 = 
FSMC_WøpMode_DißbÀ
;

391 
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«lA˘ive
 = 
FSMC_WaôSig«lA˘ive_Bef‹eWaôSèã
;

392 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeO≥øti⁄
 = 
FSMC_WrôeO≥øti⁄_E«bÀ
;

393 
FSMC_NORSRAMInôSåu˘
->
FSMC_WaôSig«l
 = 
FSMC_WaôSig«l_E«bÀ
;

394 
FSMC_NORSRAMInôSåu˘
->
FSMC_ExãndedMode
 = 
FSMC_ExãndedMode_DißbÀ
;

395 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeBur°
 = 
FSMC_WrôeBur°_DißbÀ
;

396 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_AddªssSëupTime
 = 0xF;

397 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_AddªssHﬁdTime
 = 0xF;

398 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_D©aSëupTime
 = 0xFF;

399 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_BusTu∫AroundDuøti⁄
 = 0xF;

400 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_CLKDivisi⁄
 = 0xF;

401 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_D©aL©ícy
 = 0xF;

402 
FSMC_NORSRAMInôSåu˘
->
FSMC_RódWrôeTimögSåu˘
->
FSMC_Ac˚ssMode
 = 
FSMC_Ac˚ssMode_A
;

403 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_AddªssSëupTime
 = 0xF;

404 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_AddªssHﬁdTime
 = 0xF;

405 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_D©aSëupTime
 = 0xFF;

406 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_BusTu∫AroundDuøti⁄
 = 0xF;

407 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_CLKDivisi⁄
 = 0xF;

408 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_D©aL©ícy
 = 0xF;

409 
FSMC_NORSRAMInôSåu˘
->
FSMC_WrôeTimögSåu˘
->
FSMC_Ac˚ssMode
 = 
FSMC_Ac˚ssMode_A
;

410 
	}
}

418 
	$FSMC_NANDSåu˘Inô
(
FSMC_NANDInôTy≥Def
* 
FSMC_NANDInôSåu˘
)

421 
FSMC_NANDInôSåu˘
->
FSMC_B™k
 = 
FSMC_B™k2_NAND
;

422 
FSMC_NANDInôSåu˘
->
FSMC_Waô„©uª
 = 
FSMC_Waô„©uª_DißbÀ
;

423 
FSMC_NANDInôSåu˘
->
FSMC_Mem‹yD©aWidth
 = 
FSMC_Mem‹yD©aWidth_8b
;

424 
FSMC_NANDInôSåu˘
->
FSMC_ECC
 = 
FSMC_ECC_DißbÀ
;

425 
FSMC_NANDInôSåu˘
->
FSMC_ECCPageSize
 = 
FSMC_ECCPageSize_256Byãs
;

426 
FSMC_NANDInôSåu˘
->
FSMC_TCLRSëupTime
 = 0x0;

427 
FSMC_NANDInôSåu˘
->
FSMC_TARSëupTime
 = 0x0;

428 
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_SëupTime
 = 0xFC;

429 
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 = 0xFC;

430 
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 = 0xFC;

431 
FSMC_NANDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 = 0xFC;

432 
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_SëupTime
 = 0xFC;

433 
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 = 0xFC;

434 
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 = 0xFC;

435 
FSMC_NANDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 = 0xFC;

436 
	}
}

444 
	$FSMC_PCCARDSåu˘Inô
(
FSMC_PCCARDInôTy≥Def
* 
FSMC_PCCARDInôSåu˘
)

447 
FSMC_PCCARDInôSåu˘
->
FSMC_Waô„©uª
 = 
FSMC_Waô„©uª_DißbÀ
;

448 
FSMC_PCCARDInôSåu˘
->
FSMC_TCLRSëupTime
 = 0x0;

449 
FSMC_PCCARDInôSåu˘
->
FSMC_TARSëupTime
 = 0x0;

450 
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_SëupTime
 = 0xFC;

451 
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 = 0xFC;

452 
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 = 0xFC;

453 
FSMC_PCCARDInôSåu˘
->
FSMC_Comm⁄S∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 = 0xFC;

454 
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_SëupTime
 = 0xFC;

455 
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 = 0xFC;

456 
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 = 0xFC;

457 
FSMC_PCCARDInôSåu˘
->
FSMC_AâribuãS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 = 0xFC;

458 
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_SëupTime
 = 0xFC;

459 
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_WaôSëupTime
 = 0xFC;

460 
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_HﬁdSëupTime
 = 0xFC;

461 
FSMC_PCCARDInôSåu˘
->
FSMC_IOS∑˚TimögSåu˘
->
FSMC_HiZSëupTime
 = 0xFC;

462 
	}
}

475 
	$FSMC_NORSRAMCmd
(
uöt32_t
 
FSMC_B™k
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

477 
	`as£π_∑øm
(
	`IS_FSMC_NORSRAM_BANK
(
FSMC_B™k
));

478 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

480 i‡(
NewSèã
 !
DISABLE
)

483 
FSMC_B™k1
->
BTCR
[
FSMC_B™k
] |
BCR_MBKEN_Së
;

488 
FSMC_B™k1
->
BTCR
[
FSMC_B™k
] &
BCR_MBKEN_Re£t
;

490 
	}
}

501 
	$FSMC_NANDCmd
(
uöt32_t
 
FSMC_B™k
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

503 
	`as£π_∑øm
(
	`IS_FSMC_NAND_BANK
(
FSMC_B™k
));

504 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

506 i‡(
NewSèã
 !
DISABLE
)

509 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

511 
FSMC_B™k2
->
PCR2
 |
PCR_PBKEN_Së
;

515 
FSMC_B™k3
->
PCR3
 |
PCR_PBKEN_Së
;

521 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

523 
FSMC_B™k2
->
PCR2
 &
PCR_PBKEN_Re£t
;

527 
FSMC_B™k3
->
PCR3
 &
PCR_PBKEN_Re£t
;

530 
	}
}

538 
	$FSMC_PCCARDCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

540 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

542 i‡(
NewSèã
 !
DISABLE
)

545 
FSMC_B™k4
->
PCR4
 |
PCR_PBKEN_Së
;

550 
FSMC_B™k4
->
PCR4
 &
PCR_PBKEN_Re£t
;

552 
	}
}

564 
	$FSMC_NANDECCCmd
(
uöt32_t
 
FSMC_B™k
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

566 
	`as£π_∑øm
(
	`IS_FSMC_NAND_BANK
(
FSMC_B™k
));

567 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

569 i‡(
NewSèã
 !
DISABLE
)

572 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

574 
FSMC_B™k2
->
PCR2
 |
PCR_ECCEN_Së
;

578 
FSMC_B™k3
->
PCR3
 |
PCR_ECCEN_Së
;

584 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

586 
FSMC_B™k2
->
PCR2
 &
PCR_ECCEN_Re£t
;

590 
FSMC_B™k3
->
PCR3
 &
PCR_ECCEN_Re£t
;

593 
	}
}

603 
uöt32_t
 
	$FSMC_GëECC
(
uöt32_t
 
FSMC_B™k
)

605 
uöt32_t
 
eccvÆ
 = 0x00000000;

607 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

610 
eccvÆ
 = 
FSMC_B™k2
->
ECCR2
;

615 
eccvÆ
 = 
FSMC_B™k3
->
ECCR3
;

618 (
eccvÆ
);

619 
	}
}

637 
	$FSMC_ITC⁄fig
(
uöt32_t
 
FSMC_B™k
, uöt32_à
FSMC_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

639 
	`as£π_∑øm
(
	`IS_FSMC_IT_BANK
(
FSMC_B™k
));

640 
	`as£π_∑øm
(
	`IS_FSMC_IT
(
FSMC_IT
));

641 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

643 i‡(
NewSèã
 !
DISABLE
)

646 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

648 
FSMC_B™k2
->
SR2
 |
FSMC_IT
;

651 i‡(
FSMC_B™k
 =
FSMC_B™k3_NAND
)

653 
FSMC_B™k3
->
SR3
 |
FSMC_IT
;

658 
FSMC_B™k4
->
SR4
 |
FSMC_IT
;

664 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

667 
FSMC_B™k2
->
SR2
 &(
uöt32_t
)~
FSMC_IT
;

670 i‡(
FSMC_B™k
 =
FSMC_B™k3_NAND
)

672 
FSMC_B™k3
->
SR3
 &(
uöt32_t
)~
FSMC_IT
;

677 
FSMC_B™k4
->
SR4
 &(
uöt32_t
)~
FSMC_IT
;

680 
	}
}

697 
FœgSètus
 
	$FSMC_GëFœgSètus
(
uöt32_t
 
FSMC_B™k
, uöt32_à
FSMC_FLAG
)

699 
FœgSètus
 
bô°©us
 = 
RESET
;

700 
uöt32_t
 
tmp§
 = 0x00000000;

703 
	`as£π_∑øm
(
	`IS_FSMC_GETFLAG_BANK
(
FSMC_B™k
));

704 
	`as£π_∑øm
(
	`IS_FSMC_GET_FLAG
(
FSMC_FLAG
));

706 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

708 
tmp§
 = 
FSMC_B™k2
->
SR2
;

710 if(
FSMC_B™k
 =
FSMC_B™k3_NAND
)

712 
tmp§
 = 
FSMC_B™k3
->
SR3
;

717 
tmp§
 = 
FSMC_B™k4
->
SR4
;

721 i‡((
tmp§
 & 
FSMC_FLAG
Ë!(
uöt16_t
)
RESET
 )

723 
bô°©us
 = 
SET
;

727 
bô°©us
 = 
RESET
;

730  
bô°©us
;

731 
	}
}

747 
	$FSMC_CÀ¨Fœg
(
uöt32_t
 
FSMC_B™k
, uöt32_à
FSMC_FLAG
)

750 
	`as£π_∑øm
(
	`IS_FSMC_GETFLAG_BANK
(
FSMC_B™k
));

751 
	`as£π_∑øm
(
	`IS_FSMC_CLEAR_FLAG
(
FSMC_FLAG
)) ;

753 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

755 
FSMC_B™k2
->
SR2
 &~
FSMC_FLAG
;

757 if(
FSMC_B™k
 =
FSMC_B™k3_NAND
)

759 
FSMC_B™k3
->
SR3
 &~
FSMC_FLAG
;

764 
FSMC_B™k4
->
SR4
 &~
FSMC_FLAG
;

766 
	}
}

782 
ITSètus
 
	$FSMC_GëITSètus
(
uöt32_t
 
FSMC_B™k
, uöt32_à
FSMC_IT
)

784 
ITSètus
 
bô°©us
 = 
RESET
;

785 
uöt32_t
 
tmp§
 = 0x0, 
ô°©us
 = 0x0, 
ôíabÀ
 = 0x0;

788 
	`as£π_∑øm
(
	`IS_FSMC_IT_BANK
(
FSMC_B™k
));

789 
	`as£π_∑øm
(
	`IS_FSMC_GET_IT
(
FSMC_IT
));

791 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

793 
tmp§
 = 
FSMC_B™k2
->
SR2
;

795 if(
FSMC_B™k
 =
FSMC_B™k3_NAND
)

797 
tmp§
 = 
FSMC_B™k3
->
SR3
;

802 
tmp§
 = 
FSMC_B™k4
->
SR4
;

805 
ô°©us
 = 
tmp§
 & 
FSMC_IT
;

807 
ôíabÀ
 = 
tmp§
 & (
FSMC_IT
 >> 3);

808 i‡((
ô°©us
 !(
uöt32_t
)
RESET
Ë&& (
ôíabÀ
 != (uint32_t)RESET))

810 
bô°©us
 = 
SET
;

814 
bô°©us
 = 
RESET
;

816  
bô°©us
;

817 
	}
}

833 
	$FSMC_CÀ¨ITPídögBô
(
uöt32_t
 
FSMC_B™k
, uöt32_à
FSMC_IT
)

836 
	`as£π_∑øm
(
	`IS_FSMC_IT_BANK
(
FSMC_B™k
));

837 
	`as£π_∑øm
(
	`IS_FSMC_IT
(
FSMC_IT
));

839 if(
FSMC_B™k
 =
FSMC_B™k2_NAND
)

841 
FSMC_B™k2
->
SR2
 &~(
FSMC_IT
 >> 3);

843 if(
FSMC_B™k
 =
FSMC_B™k3_NAND
)

845 
FSMC_B™k3
->
SR3
 &~(
FSMC_IT
 >> 3);

850 
FSMC_B™k4
->
SR4
 &~(
FSMC_IT
 >> 3);

852 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST5F15~1.C

23 
	~"°m32f10x_dac.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#CR_CLEAR_MASK
 ((
uöt32_t
)0x00000FFE)

	)

51 
	#DUAL_SWTRIG_SET
 ((
uöt32_t
)0x00000003)

	)

52 
	#DUAL_SWTRIG_RESET
 ((
uöt32_t
)0xFFFFFFFC)

	)

55 
	#DHR12R1_OFFSET
 ((
uöt32_t
)0x00000008)

	)

56 
	#DHR12R2_OFFSET
 ((
uöt32_t
)0x00000014)

	)

57 
	#DHR12RD_OFFSET
 ((
uöt32_t
)0x00000020)

	)

60 
	#DOR_OFFSET
 ((
uöt32_t
)0x0000002C)

	)

98 
	$DAC_DeInô
()

101 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_DAC
, 
ENABLE
);

103 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_DAC
, 
DISABLE
);

104 
	}
}

117 
	$DAC_Inô
(
uöt32_t
 
DAC_Ch™√l
, 
DAC_InôTy≥Def
* 
DAC_InôSåu˘
)

119 
uöt32_t
 
tm¥eg1
 = 0, 
tm¥eg2
 = 0;

121 
	`as£π_∑øm
(
	`IS_DAC_TRIGGER
(
DAC_InôSåu˘
->
DAC_Triggî
));

122 
	`as£π_∑øm
(
	`IS_DAC_GENERATE_WAVE
(
DAC_InôSåu˘
->
DAC_WaveGíî©i⁄
));

123 
	`as£π_∑øm
(
	`IS_DAC_LFSR_UNMASK_TRIANGLE_AMPLITUDE
(
DAC_InôSåu˘
->
DAC_LFSRUnmask_TrüngÀAm∂ôude
));

124 
	`as£π_∑øm
(
	`IS_DAC_OUTPUT_BUFFER_STATE
(
DAC_InôSåu˘
->
DAC_OuçutBuf„r
));

127 
tm¥eg1
 = 
DAC
->
CR
;

129 
tm¥eg1
 &~(
CR_CLEAR_MASK
 << 
DAC_Ch™√l
);

136 
tm¥eg2
 = (
DAC_InôSåu˘
->
DAC_Triggî
 | DAC_InôSåu˘->
DAC_WaveGíî©i⁄
 |

137 
DAC_InôSåu˘
->
DAC_LFSRUnmask_TrüngÀAm∂ôude
 | DAC_InôSåu˘->
DAC_OuçutBuf„r
);

139 
tm¥eg1
 |
tm¥eg2
 << 
DAC_Ch™√l
;

141 
DAC
->
CR
 = 
tm¥eg1
;

142 
	}
}

150 
	$DAC_Såu˘Inô
(
DAC_InôTy≥Def
* 
DAC_InôSåu˘
)

154 
DAC_InôSåu˘
->
DAC_Triggî
 = 
DAC_Triggî_N⁄e
;

156 
DAC_InôSåu˘
->
DAC_WaveGíî©i⁄
 = 
DAC_WaveGíî©i⁄_N⁄e
;

158 
DAC_InôSåu˘
->
DAC_LFSRUnmask_TrüngÀAm∂ôude
 = 
DAC_LFSRUnmask_Bô0
;

160 
DAC_InôSåu˘
->
DAC_OuçutBuf„r
 = 
DAC_OuçutBuf„r_E«bÀ
;

161 
	}
}

173 
	$DAC_Cmd
(
uöt32_t
 
DAC_Ch™√l
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

176 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

177 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

178 i‡(
NewSèã
 !
DISABLE
)

181 
DAC
->
CR
 |(
DAC_CR_EN1
 << 
DAC_Ch™√l
);

186 
DAC
->
CR
 &~(
DAC_CR_EN1
 << 
DAC_Ch™√l
);

188 
	}
}

189 #i‡
deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
)

203 
	$DAC_ITC⁄fig
(
uöt32_t
 
DAC_Ch™√l
, uöt32_à
DAC_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

206 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

207 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

208 
	`as£π_∑øm
(
	`IS_DAC_IT
(
DAC_IT
));

210 i‡(
NewSèã
 !
DISABLE
)

213 
DAC
->
CR
 |(
DAC_IT
 << 
DAC_Ch™√l
);

218 
DAC
->
CR
 &(~(
uöt32_t
)(
DAC_IT
 << 
DAC_Ch™√l
));

220 
	}
}

233 
	$DAC_DMACmd
(
uöt32_t
 
DAC_Ch™√l
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

236 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

237 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

238 i‡(
NewSèã
 !
DISABLE
)

241 
DAC
->
CR
 |(
DAC_CR_DMAEN1
 << 
DAC_Ch™√l
);

246 
DAC
->
CR
 &~(
DAC_CR_DMAEN1
 << 
DAC_Ch™√l
);

248 
	}
}

260 
	$DAC_So·w¨eTriggîCmd
(
uöt32_t
 
DAC_Ch™√l
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

263 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

264 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

265 i‡(
NewSèã
 !
DISABLE
)

268 
DAC
->
SWTRIGR
 |(
uöt32_t
)
DAC_SWTRIGR_SWTRIG1
 << (
DAC_Ch™√l
 >> 4);

273 
DAC
->
SWTRIGR
 &~((
uöt32_t
)
DAC_SWTRIGR_SWTRIG1
 << (
DAC_Ch™√l
 >> 4));

275 
	}
}

284 
	$DAC_DuÆSo·w¨eTriggîCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

287 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

288 i‡(
NewSèã
 !
DISABLE
)

291 
DAC
->
SWTRIGR
 |
DUAL_SWTRIG_SET
 ;

296 
DAC
->
SWTRIGR
 &
DUAL_SWTRIG_RESET
;

298 
	}
}

314 
	$DAC_WaveGíî©i⁄Cmd
(
uöt32_t
 
DAC_Ch™√l
, uöt32_à
DAC_Wave
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

317 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

318 
	`as£π_∑øm
(
	`IS_DAC_WAVE
(
DAC_Wave
));

319 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

320 i‡(
NewSèã
 !
DISABLE
)

323 
DAC
->
CR
 |
DAC_Wave
 << 
DAC_Ch™√l
;

328 
DAC
->
CR
 &~(
DAC_Wave
 << 
DAC_Ch™√l
);

330 
	}
}

342 
	$DAC_SëCh™√l1D©a
(
uöt32_t
 
DAC_Align
, 
uöt16_t
 
D©a
)

344 
__IO
 
uöt32_t
 
tmp
 = 0;

347 
	`as£π_∑øm
(
	`IS_DAC_ALIGN
(
DAC_Align
));

348 
	`as£π_∑øm
(
	`IS_DAC_DATA
(
D©a
));

350 
tmp
 = (
uöt32_t
)
DAC_BASE
;

351 
tmp
 +
DHR12R1_OFFSET
 + 
DAC_Align
;

354 *(
__IO
 
uöt32_t
 *Ë
tmp
 = 
D©a
;

355 
	}
}

367 
	$DAC_SëCh™√l2D©a
(
uöt32_t
 
DAC_Align
, 
uöt16_t
 
D©a
)

369 
__IO
 
uöt32_t
 
tmp
 = 0;

372 
	`as£π_∑øm
(
	`IS_DAC_ALIGN
(
DAC_Align
));

373 
	`as£π_∑øm
(
	`IS_DAC_DATA
(
D©a
));

375 
tmp
 = (
uöt32_t
)
DAC_BASE
;

376 
tmp
 +
DHR12R2_OFFSET
 + 
DAC_Align
;

379 *(
__IO
 
uöt32_t
 *)
tmp
 = 
D©a
;

380 
	}
}

396 
	$DAC_SëDuÆCh™√lD©a
(
uöt32_t
 
DAC_Align
, 
uöt16_t
 
D©a2
, uöt16_à
D©a1
)

398 
uöt32_t
 
d©a
 = 0, 
tmp
 = 0;

401 
	`as£π_∑øm
(
	`IS_DAC_ALIGN
(
DAC_Align
));

402 
	`as£π_∑øm
(
	`IS_DAC_DATA
(
D©a1
));

403 
	`as£π_∑øm
(
	`IS_DAC_DATA
(
D©a2
));

406 i‡(
DAC_Align
 =
DAC_Align_8b_R
)

408 
d©a
 = ((
uöt32_t
)
D©a2
 << 8Ë| 
D©a1
;

412 
d©a
 = ((
uöt32_t
)
D©a2
 << 16Ë| 
D©a1
;

415 
tmp
 = (
uöt32_t
)
DAC_BASE
;

416 
tmp
 +
DHR12RD_OFFSET
 + 
DAC_Align
;

419 *(
__IO
 
uöt32_t
 *)
tmp
 = 
d©a
;

420 
	}
}

430 
uöt16_t
 
	$DAC_GëD©aOuçutVÆue
(
uöt32_t
 
DAC_Ch™√l
)

432 
__IO
 
uöt32_t
 
tmp
 = 0;

435 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

437 
tmp
 = (
uöt32_t
Ë
DAC_BASE
 ;

438 
tmp
 +
DOR_OFFSET
 + ((
uöt32_t
)
DAC_Ch™√l
 >> 2);

441  (
uöt16_t
Ë(*(
__IO
 
uöt32_t
*Ë
tmp
);

442 
	}
}

444 #i‡
deföed
 (
STM32F10X_LD_VL
Ë|| deföed (
STM32F10X_MD_VL
Ë|| deföed (
STM32F10X_HD_VL
)

456 
FœgSètus
 
	$DAC_GëFœgSètus
(
uöt32_t
 
DAC_Ch™√l
, uöt32_à
DAC_FLAG
)

458 
FœgSètus
 
bô°©us
 = 
RESET
;

460 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

461 
	`as£π_∑øm
(
	`IS_DAC_FLAG
(
DAC_FLAG
));

464 i‡((
DAC
->
SR
 & (
DAC_FLAG
 << 
DAC_Ch™√l
)Ë!(
uöt8_t
)
RESET
)

467 
bô°©us
 = 
SET
;

472 
bô°©us
 = 
RESET
;

475  
bô°©us
;

476 
	}
}

489 
	$DAC_CÀ¨Fœg
(
uöt32_t
 
DAC_Ch™√l
, uöt32_à
DAC_FLAG
)

492 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

493 
	`as£π_∑øm
(
	`IS_DAC_FLAG
(
DAC_FLAG
));

496 
DAC
->
SR
 = (
DAC_FLAG
 << 
DAC_Ch™√l
);

497 
	}
}

510 
ITSètus
 
	$DAC_GëITSètus
(
uöt32_t
 
DAC_Ch™√l
, uöt32_à
DAC_IT
)

512 
ITSètus
 
bô°©us
 = 
RESET
;

513 
uöt32_t
 
íabÀ°©us
 = 0;

516 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

517 
	`as£π_∑øm
(
	`IS_DAC_IT
(
DAC_IT
));

520 
íabÀ°©us
 = (
DAC
->
CR
 & (
DAC_IT
 << 
DAC_Ch™√l
)) ;

523 i‡(((
DAC
->
SR
 & (
DAC_IT
 << 
DAC_Ch™√l
)Ë!(
uöt32_t
)
RESET
Ë&& 
íabÀ°©us
)

526 
bô°©us
 = 
SET
;

531 
bô°©us
 = 
RESET
;

534  
bô°©us
;

535 
	}
}

548 
	$DAC_CÀ¨ITPídögBô
(
uöt32_t
 
DAC_Ch™√l
, uöt32_à
DAC_IT
)

551 
	`as£π_∑øm
(
	`IS_DAC_CHANNEL
(
DAC_Ch™√l
));

552 
	`as£π_∑øm
(
	`IS_DAC_IT
(
DAC_IT
));

555 
DAC
->
SR
 = (
DAC_IT
 << 
DAC_Ch™√l
);

556 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST7656~1.C

23 
	~"°m32f10x_gpio.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#AFIO_OFFSET
 (
AFIO_BASE
 - 
PERIPH_BASE
)

	)

53 
	#EVCR_OFFSET
 (
AFIO_OFFSET
 + 0x00)

	)

54 
	#EVOE_BôNumbî
 ((
uöt8_t
)0x07)

	)

55 
	#EVCR_EVOE_BB
 (
PERIPH_BB_BASE
 + (
EVCR_OFFSET
 * 32Ë+ (
EVOE_BôNumbî
 * 4))

	)

60 
	#MAPR_OFFSET
 (
AFIO_OFFSET
 + 0x04)

	)

61 
	#MII_RMII_SEL_BôNumbî
 ((
u8
)0x17)

	)

62 
	#MAPR_MII_RMII_SEL_BB
 (
PERIPH_BB_BASE
 + (
MAPR_OFFSET
 * 32Ë+ (
MII_RMII_SEL_BôNumbî
 * 4))

	)

65 
	#EVCR_PORTPINCONFIG_MASK
 ((
uöt16_t
)0xFF80)

	)

66 
	#LSB_MASK
 ((
uöt16_t
)0xFFFF)

	)

67 
	#DBGAFR_POSITION_MASK
 ((
uöt32_t
)0x000F0000)

	)

68 
	#DBGAFR_SWJCFG_MASK
 ((
uöt32_t
)0xF0FFFFFF)

	)

69 
	#DBGAFR_LOCATION_MASK
 ((
uöt32_t
)0x00200000)

	)

70 
	#DBGAFR_NUMBITS_MASK
 ((
uöt32_t
)0x00100000)

	)

108 
	$GPIO_DeInô
(
GPIO_Ty≥Def
* 
GPIOx
)

111 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

113 i‡(
GPIOx
 =
GPIOA
)

115 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOA
, 
ENABLE
);

116 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOA
, 
DISABLE
);

118 i‡(
GPIOx
 =
GPIOB
)

120 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOB
, 
ENABLE
);

121 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOB
, 
DISABLE
);

123 i‡(
GPIOx
 =
GPIOC
)

125 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOC
, 
ENABLE
);

126 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOC
, 
DISABLE
);

128 i‡(
GPIOx
 =
GPIOD
)

130 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOD
, 
ENABLE
);

131 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOD
, 
DISABLE
);

133 i‡(
GPIOx
 =
GPIOE
)

135 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOE
, 
ENABLE
);

136 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOE
, 
DISABLE
);

138 i‡(
GPIOx
 =
GPIOF
)

140 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOF
, 
ENABLE
);

141 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOF
, 
DISABLE
);

145 i‡(
GPIOx
 =
GPIOG
)

147 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOG
, 
ENABLE
);

148 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_GPIOG
, 
DISABLE
);

151 
	}
}

159 
	$GPIO_AFIODeInô
()

161 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_AFIO
, 
ENABLE
);

162 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_AFIO
, 
DISABLE
);

163 
	}
}

173 
	$GPIO_Inô
(
GPIO_Ty≥Def
* 
GPIOx
, 
GPIO_InôTy≥Def
* 
GPIO_InôSåu˘
)

175 
uöt32_t
 
cuºítmode
 = 0x00, 
cuºíçö
 = 0x00, 
pöpos
 = 0x00, 
pos
 = 0x00;

176 
uöt32_t
 
tm¥eg
 = 0x00, 
pömask
 = 0x00;

178 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

179 
	`as£π_∑øm
(
	`IS_GPIO_MODE
(
GPIO_InôSåu˘
->
GPIO_Mode
));

180 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_InôSåu˘
->
GPIO_Pö
));

183 
cuºítmode
 = ((
uöt32_t
)
GPIO_InôSåu˘
->
GPIO_Mode
) & ((uint32_t)0x0F);

184 i‡((((
uöt32_t
)
GPIO_InôSåu˘
->
GPIO_Mode
) & ((uint32_t)0x10)) != 0x00)

187 
	`as£π_∑øm
(
	`IS_GPIO_SPEED
(
GPIO_InôSåu˘
->
GPIO_S≥ed
));

189 
cuºítmode
 |(
uöt32_t
)
GPIO_InôSåu˘
->
GPIO_S≥ed
;

193 i‡(((
uöt32_t
)
GPIO_InôSåu˘
->
GPIO_Pö
 & ((uint32_t)0x00FF)) != 0x00)

195 
tm¥eg
 = 
GPIOx
->
CRL
;

196 
pöpos
 = 0x00;Öinpos < 0x08;Öinpos++)

198 
pos
 = ((
uöt32_t
)0x01Ë<< 
pöpos
;

200 
cuºíçö
 = (
GPIO_InôSåu˘
->
GPIO_Pö
Ë& 
pos
;

201 i‡(
cuºíçö
 =
pos
)

203 
pos
 = 
pöpos
 << 2;

205 
pömask
 = ((
uöt32_t
)0x0FË<< 
pos
;

206 
tm¥eg
 &~
pömask
;

208 
tm¥eg
 |(
cuºítmode
 << 
pos
);

210 i‡(
GPIO_InôSåu˘
->
GPIO_Mode
 =
GPIO_Mode_IPD
)

212 
GPIOx
->
BRR
 = (((
uöt32_t
)0x01Ë<< 
pöpos
);

217 i‡(
GPIO_InôSåu˘
->
GPIO_Mode
 =
GPIO_Mode_IPU
)

219 
GPIOx
->
BSRR
 = (((
uöt32_t
)0x01Ë<< 
pöpos
);

224 
GPIOx
->
CRL
 = 
tm¥eg
;

228 i‡(
GPIO_InôSåu˘
->
GPIO_Pö
 > 0x00FF)

230 
tm¥eg
 = 
GPIOx
->
CRH
;

231 
pöpos
 = 0x00;Öinpos < 0x08;Öinpos++)

233 
pos
 = (((
uöt32_t
)0x01Ë<< (
pöpos
 + 0x08));

235 
cuºíçö
 = ((
GPIO_InôSåu˘
->
GPIO_Pö
Ë& 
pos
);

236 i‡(
cuºíçö
 =
pos
)

238 
pos
 = 
pöpos
 << 2;

240 
pömask
 = ((
uöt32_t
)0x0FË<< 
pos
;

241 
tm¥eg
 &~
pömask
;

243 
tm¥eg
 |(
cuºítmode
 << 
pos
);

245 i‡(
GPIO_InôSåu˘
->
GPIO_Mode
 =
GPIO_Mode_IPD
)

247 
GPIOx
->
BRR
 = (((
uöt32_t
)0x01Ë<< (
pöpos
 + 0x08));

250 i‡(
GPIO_InôSåu˘
->
GPIO_Mode
 =
GPIO_Mode_IPU
)

252 
GPIOx
->
BSRR
 = (((
uöt32_t
)0x01Ë<< (
pöpos
 + 0x08));

256 
GPIOx
->
CRH
 = 
tm¥eg
;

258 
	}
}

266 
	$GPIO_Såu˘Inô
(
GPIO_InôTy≥Def
* 
GPIO_InôSåu˘
)

269 
GPIO_InôSåu˘
->
GPIO_Pö
 = 
GPIO_Pö_AŒ
;

270 
GPIO_InôSåu˘
->
GPIO_S≥ed
 = 
GPIO_S≥ed_2MHz
;

271 
GPIO_InôSåu˘
->
GPIO_Mode
 = 
GPIO_Mode_IN_FLOATING
;

272 
	}
}

281 
uöt8_t
 
	$GPIO_RódI≈utD©aBô
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

283 
uöt8_t
 
bô°©us
 = 0x00;

286 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

287 
	`as£π_∑øm
(
	`IS_GET_GPIO_PIN
(
GPIO_Pö
));

289 i‡((
GPIOx
->
IDR
 & 
GPIO_Pö
Ë!(
uöt32_t
)
Bô_RESET
)

291 
bô°©us
 = (
uöt8_t
)
Bô_SET
;

295 
bô°©us
 = (
uöt8_t
)
Bô_RESET
;

297  
bô°©us
;

298 
	}
}

305 
uöt16_t
 
	$GPIO_RódI≈utD©a
(
GPIO_Ty≥Def
* 
GPIOx
)

308 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

310  ((
uöt16_t
)
GPIOx
->
IDR
);

311 
	}
}

320 
uöt8_t
 
	$GPIO_RódOuçutD©aBô
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

322 
uöt8_t
 
bô°©us
 = 0x00;

324 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

325 
	`as£π_∑øm
(
	`IS_GET_GPIO_PIN
(
GPIO_Pö
));

327 i‡((
GPIOx
->
ODR
 & 
GPIO_Pö
Ë!(
uöt32_t
)
Bô_RESET
)

329 
bô°©us
 = (
uöt8_t
)
Bô_SET
;

333 
bô°©us
 = (
uöt8_t
)
Bô_RESET
;

335  
bô°©us
;

336 
	}
}

343 
uöt16_t
 
	$GPIO_RódOuçutD©a
(
GPIO_Ty≥Def
* 
GPIOx
)

346 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

348  ((
uöt16_t
)
GPIOx
->
ODR
);

349 
	}
}

358 
	$GPIO_SëBôs
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

361 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

362 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

364 
GPIOx
->
BSRR
 = 
GPIO_Pö
;

365 
	}
}

374 
	$GPIO_Re£tBôs
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

377 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

378 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

380 
GPIOx
->
BRR
 = 
GPIO_Pö
;

381 
	}
}

394 
	$GPIO_WrôeBô
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
, 
BôA˘i⁄
 
BôVÆ
)

397 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

398 
	`as£π_∑øm
(
	`IS_GET_GPIO_PIN
(
GPIO_Pö
));

399 
	`as£π_∑øm
(
	`IS_GPIO_BIT_ACTION
(
BôVÆ
));

401 i‡(
BôVÆ
 !
Bô_RESET
)

403 
GPIOx
->
BSRR
 = 
GPIO_Pö
;

407 
GPIOx
->
BRR
 = 
GPIO_Pö
;

409 
	}
}

417 
	$GPIO_Wrôe
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
P‹tVÆ
)

420 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

422 
GPIOx
->
ODR
 = 
P‹tVÆ
;

423 
	}
}

432 
	$GPIO_PöLockC⁄fig
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

434 
uöt32_t
 
tmp
 = 0x00010000;

437 
	`as£π_∑øm
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

438 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

440 
tmp
 |
GPIO_Pö
;

442 
GPIOx
->
LCKR
 = 
tmp
;

444 
GPIOx
->
LCKR
 = 
GPIO_Pö
;

446 
GPIOx
->
LCKR
 = 
tmp
;

448 
tmp
 = 
GPIOx
->
LCKR
;

450 
tmp
 = 
GPIOx
->
LCKR
;

451 
	}
}

462 
	$GPIO_EvítOuçutC⁄fig
(
uöt8_t
 
GPIO_P‹tSour˚
, uöt8_à
GPIO_PöSour˚
)

464 
uöt32_t
 
tm¥eg
 = 0x00;

466 
	`as£π_∑øm
(
	`IS_GPIO_EVENTOUT_PORT_SOURCE
(
GPIO_P‹tSour˚
));

467 
	`as£π_∑øm
(
	`IS_GPIO_PIN_SOURCE
(
GPIO_PöSour˚
));

469 
tm¥eg
 = 
AFIO
->
EVCR
;

471 
tm¥eg
 &
EVCR_PORTPINCONFIG_MASK
;

472 
tm¥eg
 |(
uöt32_t
)
GPIO_P‹tSour˚
 << 0x04;

473 
tm¥eg
 |
GPIO_PöSour˚
;

474 
AFIO
->
EVCR
 = 
tm¥eg
;

475 
	}
}

483 
	$GPIO_EvítOuçutCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

486 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

488 *(
__IO
 
uöt32_t
 *Ë
EVCR_EVOE_BB
 = (uöt32_t)
NewSèã
;

489 
	}
}

549 
	$GPIO_PöRem≠C⁄fig
(
uöt32_t
 
GPIO_Rem≠
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

551 
uöt32_t
 
tmp
 = 0x00, 
tmp1
 = 0x00, 
tm¥eg
 = 0x00, 
tmpmask
 = 0x00;

554 
	`as£π_∑øm
(
	`IS_GPIO_REMAP
(
GPIO_Rem≠
));

555 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

557 if((
GPIO_Rem≠
 & 0x80000000) == 0x80000000)

559 
tm¥eg
 = 
AFIO
->
MAPR2
;

563 
tm¥eg
 = 
AFIO
->
MAPR
;

566 
tmpmask
 = (
GPIO_Rem≠
 & 
DBGAFR_POSITION_MASK
) >> 0x10;

567 
tmp
 = 
GPIO_Rem≠
 & 
LSB_MASK
;

569 i‡((
GPIO_Rem≠
 & (
DBGAFR_LOCATION_MASK
 | 
DBGAFR_NUMBITS_MASK
)) == (DBGAFR_LOCATION_MASK | DBGAFR_NUMBITS_MASK))

571 
tm¥eg
 &
DBGAFR_SWJCFG_MASK
;

572 
AFIO
->
MAPR
 &
DBGAFR_SWJCFG_MASK
;

574 i‡((
GPIO_Rem≠
 & 
DBGAFR_NUMBITS_MASK
) == DBGAFR_NUMBITS_MASK)

576 
tmp1
 = ((
uöt32_t
)0x03Ë<< 
tmpmask
;

577 
tm¥eg
 &~
tmp1
;

578 
tm¥eg
 |~
DBGAFR_SWJCFG_MASK
;

582 
tm¥eg
 &~(
tmp
 << ((
GPIO_Rem≠
 >> 0x15)*0x10));

583 
tm¥eg
 |~
DBGAFR_SWJCFG_MASK
;

586 i‡(
NewSèã
 !
DISABLE
)

588 
tm¥eg
 |(
tmp
 << ((
GPIO_Rem≠
 >> 0x15)*0x10));

591 if((
GPIO_Rem≠
 & 0x80000000) == 0x80000000)

593 
AFIO
->
MAPR2
 = 
tm¥eg
;

597 
AFIO
->
MAPR
 = 
tm¥eg
;

599 
	}
}

609 
	$GPIO_EXTILöeC⁄fig
(
uöt8_t
 
GPIO_P‹tSour˚
, uöt8_à
GPIO_PöSour˚
)

611 
uöt32_t
 
tmp
 = 0x00;

613 
	`as£π_∑øm
(
	`IS_GPIO_EXTI_PORT_SOURCE
(
GPIO_P‹tSour˚
));

614 
	`as£π_∑øm
(
	`IS_GPIO_PIN_SOURCE
(
GPIO_PöSour˚
));

616 
tmp
 = ((
uöt32_t
)0x0FË<< (0x04 * (
GPIO_PöSour˚
 & (
uöt8_t
)0x03));

617 
AFIO
->
EXTICR
[
GPIO_PöSour˚
 >> 0x02] &~
tmp
;

618 
AFIO
->
EXTICR
[
GPIO_PöSour˚
 >> 0x02] |(((
uöt32_t
)
GPIO_P‹tSour˚
Ë<< (0x04 * (GPIO_PöSour˚ & (
uöt8_t
)0x03)));

619 
	}
}

630 
	$GPIO_ETH_MedüI¡îÁ˚C⁄fig
(
uöt32_t
 
GPIO_ETH_MedüI¡îÁ˚
)

632 
	`as£π_∑øm
(
	`IS_GPIO_ETH_MEDIA_INTERFACE
(
GPIO_ETH_MedüI¡îÁ˚
));

635 *(
__IO
 
uöt32_t
 *Ë
MAPR_MII_RMII_SEL_BB
 = 
GPIO_ETH_MedüI¡îÁ˚
;

636 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST7B0D~1.C

23 
	~"°m32f10x_Êash.h
"

47 
	#ACR_LATENCY_Mask
 ((
uöt32_t
)0x00000038)

	)

48 
	#ACR_HLFCYA_Mask
 ((
uöt32_t
)0xFFFFFFF7)

	)

49 
	#ACR_PRFTBE_Mask
 ((
uöt32_t
)0xFFFFFFEF)

	)

52 
	#ACR_PRFTBS_Mask
 ((
uöt32_t
)0x00000020)

	)

55 
	#CR_PG_Së
 ((
uöt32_t
)0x00000001)

	)

56 
	#CR_PG_Re£t
 ((
uöt32_t
)0x00001FFE)

	)

57 
	#CR_PER_Së
 ((
uöt32_t
)0x00000002)

	)

58 
	#CR_PER_Re£t
 ((
uöt32_t
)0x00001FFD)

	)

59 
	#CR_MER_Së
 ((
uöt32_t
)0x00000004)

	)

60 
	#CR_MER_Re£t
 ((
uöt32_t
)0x00001FFB)

	)

61 
	#CR_OPTPG_Së
 ((
uöt32_t
)0x00000010)

	)

62 
	#CR_OPTPG_Re£t
 ((
uöt32_t
)0x00001FEF)

	)

63 
	#CR_OPTER_Së
 ((
uöt32_t
)0x00000020)

	)

64 
	#CR_OPTER_Re£t
 ((
uöt32_t
)0x00001FDF)

	)

65 
	#CR_STRT_Së
 ((
uöt32_t
)0x00000040)

	)

66 
	#CR_LOCK_Së
 ((
uöt32_t
)0x00000080)

	)

69 
	#RDPRT_Mask
 ((
uöt32_t
)0x00000002)

	)

70 
	#WRP0_Mask
 ((
uöt32_t
)0x000000FF)

	)

71 
	#WRP1_Mask
 ((
uöt32_t
)0x0000FF00)

	)

72 
	#WRP2_Mask
 ((
uöt32_t
)0x00FF0000)

	)

73 
	#WRP3_Mask
 ((
uöt32_t
)0xFF000000)

	)

74 
	#OB_USER_BFB2
 ((
uöt16_t
)0x0008)

	)

77 
	#RDP_Key
 ((
uöt16_t
)0x00A5)

	)

78 
	#FLASH_KEY1
 ((
uöt32_t
)0x45670123)

	)

79 
	#FLASH_KEY2
 ((
uöt32_t
)0xCDEF89AB)

	)

82 
	#FLASH_BANK1_END_ADDRESS
 ((
uöt32_t
)0x807FFFF)

	)

85 
	#Eø£Timeout
 ((
uöt32_t
)0x000B0000)

	)

86 
	#ProgømTimeout
 ((
uöt32_t
)0x00002000)

	)

254 
	$FLASH_SëL©ícy
(
uöt32_t
 
FLASH_L©ícy
)

256 
uöt32_t
 
tm¥eg
 = 0;

259 
	`as£π_∑øm
(
	`IS_FLASH_LATENCY
(
FLASH_L©ícy
));

262 
tm¥eg
 = 
FLASH
->
ACR
;

265 
tm¥eg
 &
ACR_LATENCY_Mask
;

266 
tm¥eg
 |
FLASH_L©ícy
;

269 
FLASH
->
ACR
 = 
tm¥eg
;

270 
	}
}

281 
	$FLASH_HÆfCy˛eAc˚ssCmd
(
uöt32_t
 
FLASH_HÆfCy˛eAc˚ss
)

284 
	`as£π_∑øm
(
	`IS_FLASH_HALFCYCLEACCESS_STATE
(
FLASH_HÆfCy˛eAc˚ss
));

287 
FLASH
->
ACR
 &
ACR_HLFCYA_Mask
;

288 
FLASH
->
ACR
 |
FLASH_HÆfCy˛eAc˚ss
;

289 
	}
}

300 
	$FLASH_Pª„tchBuf„rCmd
(
uöt32_t
 
FLASH_Pª„tchBuf„r
)

303 
	`as£π_∑øm
(
	`IS_FLASH_PREFETCHBUFFER_STATE
(
FLASH_Pª„tchBuf„r
));

306 
FLASH
->
ACR
 &
ACR_PRFTBE_Mask
;

307 
FLASH
->
ACR
 |
FLASH_Pª„tchBuf„r
;

308 
	}
}

319 
	$FLASH_U∆ock
()

322 
FLASH
->
KEYR
 = 
FLASH_KEY1
;

323 
FLASH
->
KEYR
 = 
FLASH_KEY2
;

325 #ifde‡
STM32F10X_XL


327 
FLASH
->
KEYR2
 = 
FLASH_KEY1
;

328 
FLASH
->
KEYR2
 = 
FLASH_KEY2
;

330 
	}
}

340 
	$FLASH_U∆ockB™k1
()

343 
FLASH
->
KEYR
 = 
FLASH_KEY1
;

344 
FLASH
->
KEYR
 = 
FLASH_KEY2
;

345 
	}
}

347 #ifde‡
STM32F10X_XL


354 
	$FLASH_U∆ockB™k2
()

357 
FLASH
->
KEYR2
 = 
FLASH_KEY1
;

358 
FLASH
->
KEYR2
 = 
FLASH_KEY2
;

360 
	}
}

372 
	$FLASH_Lock
()

375 
FLASH
->
CR
 |
CR_LOCK_Së
;

377 #ifde‡
STM32F10X_XL


379 
FLASH
->
CR2
 |
CR_LOCK_Së
;

381 
	}
}

392 
	$FLASH_LockB™k1
()

395 
FLASH
->
CR
 |
CR_LOCK_Së
;

396 
	}
}

398 #ifde‡
STM32F10X_XL


405 
	$FLASH_LockB™k2
()

408 
FLASH
->
CR2
 |
CR_LOCK_Së
;

409 
	}
}

419 
FLASH_Sètus
 
	$FLASH_Eø£Page
(
uöt32_t
 
Page_Addªss
)

421 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

423 
	`as£π_∑øm
(
	`IS_FLASH_ADDRESS
(
Page_Addªss
));

425 #ifde‡
STM32F10X_XL


426 if(
Page_Addªss
 < 
FLASH_BANK1_END_ADDRESS
)

429 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
Eø£Timeout
);

430 if(
°©us
 =
FLASH_COMPLETE
)

433 
FLASH
->
CR
|
CR_PER_Së
;

434 
FLASH
->
AR
 = 
Page_Addªss
;

435 
FLASH
->
CR
|
CR_STRT_Së
;

438 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
Eø£Timeout
);

441 
FLASH
->
CR
 &
CR_PER_Re£t
;

447 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
Eø£Timeout
);

448 if(
°©us
 =
FLASH_COMPLETE
)

451 
FLASH
->
CR2
|
CR_PER_Së
;

452 
FLASH
->
AR2
 = 
Page_Addªss
;

453 
FLASH
->
CR2
|
CR_STRT_Së
;

456 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
Eø£Timeout
);

459 
FLASH
->
CR2
 &
CR_PER_Re£t
;

464 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

466 if(
°©us
 =
FLASH_COMPLETE
)

469 
FLASH
->
CR
|
CR_PER_Së
;

470 
FLASH
->
AR
 = 
Page_Addªss
;

471 
FLASH
->
CR
|
CR_STRT_Së
;

474 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

477 
FLASH
->
CR
 &
CR_PER_Re£t
;

482  
°©us
;

483 
	}
}

492 
FLASH_Sètus
 
	$FLASH_Eø£AŒPages
()

494 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

496 #ifde‡
STM32F10X_XL


498 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
Eø£Timeout
);

500 if(
°©us
 =
FLASH_COMPLETE
)

503 
FLASH
->
CR
 |
CR_MER_Së
;

504 
FLASH
->
CR
 |
CR_STRT_Së
;

507 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
Eø£Timeout
);

510 
FLASH
->
CR
 &
CR_MER_Re£t
;

512 if(
°©us
 =
FLASH_COMPLETE
)

515 
FLASH
->
CR2
 |
CR_MER_Së
;

516 
FLASH
->
CR2
 |
CR_STRT_Së
;

519 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
Eø£Timeout
);

522 
FLASH
->
CR2
 &
CR_MER_Re£t
;

526 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

527 if(
°©us
 =
FLASH_COMPLETE
)

530 
FLASH
->
CR
 |
CR_MER_Së
;

531 
FLASH
->
CR
 |
CR_STRT_Së
;

534 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

537 
FLASH
->
CR
 &
CR_MER_Re£t
;

542  
°©us
;

543 
	}
}

555 
FLASH_Sètus
 
	$FLASH_Eø£AŒB™k1Pages
()

557 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

559 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
Eø£Timeout
);

561 if(
°©us
 =
FLASH_COMPLETE
)

564 
FLASH
->
CR
 |
CR_MER_Së
;

565 
FLASH
->
CR
 |
CR_STRT_Së
;

568 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
Eø£Timeout
);

571 
FLASH
->
CR
 &
CR_MER_Re£t
;

574  
°©us
;

575 
	}
}

577 #ifde‡
STM32F10X_XL


585 
FLASH_Sètus
 
	$FLASH_Eø£AŒB™k2Pages
()

587 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

589 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
Eø£Timeout
);

591 if(
°©us
 =
FLASH_COMPLETE
)

594 
FLASH
->
CR2
 |
CR_MER_Së
;

595 
FLASH
->
CR2
 |
CR_STRT_Së
;

598 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
Eø£Timeout
);

601 
FLASH
->
CR2
 &
CR_MER_Re£t
;

604  
°©us
;

605 
	}
}

616 
FLASH_Sètus
 
	$FLASH_Eø£O±i⁄Byãs
()

618 
uöt16_t
 
rd±mp
 = 
RDP_Key
;

620 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

623 if(
	`FLASH_GëRódOutPrŸe˘i⁄Sètus
(Ë!
RESET
)

625 
rd±mp
 = 0x00;

629 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

630 if(
°©us
 =
FLASH_COMPLETE
)

633 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

634 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

637 
FLASH
->
CR
 |
CR_OPTER_Së
;

638 
FLASH
->
CR
 |
CR_STRT_Së
;

640 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

642 if(
°©us
 =
FLASH_COMPLETE
)

645 
FLASH
->
CR
 &
CR_OPTER_Re£t
;

648 
FLASH
->
CR
 |
CR_OPTPG_Së
;

650 
OB
->
RDP
 = (
uöt16_t
)
rd±mp
;

652 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

654 if(
°©us
 !
FLASH_TIMEOUT
)

657 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

662 i‡(
°©us
 !
FLASH_TIMEOUT
)

665 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

670  
°©us
;

671 
	}
}

681 
FLASH_Sètus
 
	$FLASH_ProgømW‹d
(
uöt32_t
 
Addªss
, uöt32_à
D©a
)

683 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

684 
__IO
 
uöt32_t
 
tmp
 = 0;

687 
	`as£π_∑øm
(
	`IS_FLASH_ADDRESS
(
Addªss
));

689 #ifde‡
STM32F10X_XL


690 if(
Addªss
 < 
FLASH_BANK1_END_ADDRESS
 - 2)

693 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
ProgømTimeout
);

694 if(
°©us
 =
FLASH_COMPLETE
)

698 
FLASH
->
CR
 |
CR_PG_Së
;

700 *(
__IO
 
uöt16_t
*)
Addªss
 = (uöt16_t)
D©a
;

702 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

704 if(
°©us
 =
FLASH_COMPLETE
)

708 
tmp
 = 
Addªss
 + 2;

710 *(
__IO
 
uöt16_t
*Ë
tmp
 = 
D©a
 >> 16;

713 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

716 
FLASH
->
CR
 &
CR_PG_Re£t
;

721 
FLASH
->
CR
 &
CR_PG_Re£t
;

725 if(
Addªss
 =(
FLASH_BANK1_END_ADDRESS
 - 1))

728 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
ProgømTimeout
);

730 if(
°©us
 =
FLASH_COMPLETE
)

734 
FLASH
->
CR
 |
CR_PG_Së
;

736 *(
__IO
 
uöt16_t
*)
Addªss
 = (uöt16_t)
D©a
;

739 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
ProgømTimeout
);

742 
FLASH
->
CR
 &
CR_PG_Re£t
;

747 
FLASH
->
CR
 &
CR_PG_Re£t
;

751 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
ProgømTimeout
);

753 if(
°©us
 =
FLASH_COMPLETE
)

757 
FLASH
->
CR2
 |
CR_PG_Së
;

758 
tmp
 = 
Addªss
 + 2;

760 *(
__IO
 
uöt16_t
*Ë
tmp
 = 
D©a
 >> 16;

763 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
ProgømTimeout
);

766 
FLASH
->
CR2
 &
CR_PG_Re£t
;

771 
FLASH
->
CR2
 &
CR_PG_Re£t
;

777 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
ProgømTimeout
);

779 if(
°©us
 =
FLASH_COMPLETE
)

783 
FLASH
->
CR2
 |
CR_PG_Së
;

785 *(
__IO
 
uöt16_t
*)
Addªss
 = (uöt16_t)
D©a
;

787 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
ProgømTimeout
);

789 if(
°©us
 =
FLASH_COMPLETE
)

793 
tmp
 = 
Addªss
 + 2;

795 *(
__IO
 
uöt16_t
*Ë
tmp
 = 
D©a
 >> 16;

798 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
ProgømTimeout
);

801 
FLASH
->
CR2
 &
CR_PG_Re£t
;

806 
FLASH
->
CR2
 &
CR_PG_Re£t
;

812 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

814 if(
°©us
 =
FLASH_COMPLETE
)

818 
FLASH
->
CR
 |
CR_PG_Së
;

820 *(
__IO
 
uöt16_t
*)
Addªss
 = (uöt16_t)
D©a
;

822 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

824 if(
°©us
 =
FLASH_COMPLETE
)

828 
tmp
 = 
Addªss
 + 2;

830 *(
__IO
 
uöt16_t
*Ë
tmp
 = 
D©a
 >> 16;

833 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

836 
FLASH
->
CR
 &
CR_PG_Re£t
;

841 
FLASH
->
CR
 &
CR_PG_Re£t
;

847  
°©us
;

848 
	}
}

858 
FLASH_Sètus
 
	$FLASH_ProgømHÆfW‹d
(
uöt32_t
 
Addªss
, 
uöt16_t
 
D©a
)

860 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

862 
	`as£π_∑øm
(
	`IS_FLASH_ADDRESS
(
Addªss
));

864 #ifde‡
STM32F10X_XL


866 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

868 if(
Addªss
 < 
FLASH_BANK1_END_ADDRESS
)

870 if(
°©us
 =
FLASH_COMPLETE
)

873 
FLASH
->
CR
 |
CR_PG_Së
;

875 *(
__IO
 
uöt16_t
*)
Addªss
 = 
D©a
;

877 
°©us
 = 
	`FLASH_WaôF‹La°B™k1O≥øti⁄
(
ProgømTimeout
);

880 
FLASH
->
CR
 &
CR_PG_Re£t
;

885 if(
°©us
 =
FLASH_COMPLETE
)

888 
FLASH
->
CR2
 |
CR_PG_Së
;

890 *(
__IO
 
uöt16_t
*)
Addªss
 = 
D©a
;

892 
°©us
 = 
	`FLASH_WaôF‹La°B™k2O≥øti⁄
(
ProgømTimeout
);

895 
FLASH
->
CR2
 &
CR_PG_Re£t
;

900 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

902 if(
°©us
 =
FLASH_COMPLETE
)

905 
FLASH
->
CR
 |
CR_PG_Së
;

907 *(
__IO
 
uöt16_t
*)
Addªss
 = 
D©a
;

909 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

912 
FLASH
->
CR
 &
CR_PG_Re£t
;

917  
°©us
;

918 
	}
}

929 
FLASH_Sètus
 
	$FLASH_ProgømO±i⁄ByãD©a
(
uöt32_t
 
Addªss
, 
uöt8_t
 
D©a
)

931 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

933 
	`as£π_∑øm
(
	`IS_OB_DATA_ADDRESS
(
Addªss
));

934 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

936 if(
°©us
 =
FLASH_COMPLETE
)

939 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

940 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

942 
FLASH
->
CR
 |
CR_OPTPG_Së
;

943 *(
__IO
 
uöt16_t
*)
Addªss
 = 
D©a
;

946 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

947 if(
°©us
 !
FLASH_TIMEOUT
)

950 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

954  
°©us
;

955 
	}
}

975 
FLASH_Sètus
 
	$FLASH_E«bÀWrôePrŸe˘i⁄
(
uöt32_t
 
FLASH_Pages
)

977 
uöt16_t
 
WRP0_D©a
 = 0xFFFF, 
WRP1_D©a
 = 0xFFFF, 
WRP2_D©a
 = 0xFFFF, 
WRP3_D©a
 = 0xFFFF;

979 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

982 
	`as£π_∑øm
(
	`IS_FLASH_WRPROT_PAGE
(
FLASH_Pages
));

984 
FLASH_Pages
 = (
uöt32_t
)(~FLASH_Pages);

985 
WRP0_D©a
 = (
uöt16_t
)(
FLASH_Pages
 & 
WRP0_Mask
);

986 
WRP1_D©a
 = (
uöt16_t
)((
FLASH_Pages
 & 
WRP1_Mask
) >> 8);

987 
WRP2_D©a
 = (
uöt16_t
)((
FLASH_Pages
 & 
WRP2_Mask
) >> 16);

988 
WRP3_D©a
 = (
uöt16_t
)((
FLASH_Pages
 & 
WRP3_Mask
) >> 24);

991 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

993 if(
°©us
 =
FLASH_COMPLETE
)

996 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

997 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

998 
FLASH
->
CR
 |
CR_OPTPG_Së
;

999 if(
WRP0_D©a
 != 0xFF)

1001 
OB
->
WRP0
 = 
WRP0_D©a
;

1004 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1006 if((
°©us
 =
FLASH_COMPLETE
Ë&& (
WRP1_D©a
 != 0xFF))

1008 
OB
->
WRP1
 = 
WRP1_D©a
;

1011 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1013 if((
°©us
 =
FLASH_COMPLETE
Ë&& (
WRP2_D©a
 != 0xFF))

1015 
OB
->
WRP2
 = 
WRP2_D©a
;

1018 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1021 if((
°©us
 =
FLASH_COMPLETE
)&& (
WRP3_D©a
 != 0xFF))

1023 
OB
->
WRP3
 = 
WRP3_D©a
;

1026 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1029 if(
°©us
 !
FLASH_TIMEOUT
)

1032 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

1036  
°©us
;

1037 
	}
}

1049 
FLASH_Sètus
 
	$FLASH_RódOutPrŸe˘i⁄
(
Fun˘i⁄ÆSèã
 
NewSèã
)

1051 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

1053 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1054 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

1055 if(
°©us
 =
FLASH_COMPLETE
)

1058 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

1059 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

1060 
FLASH
->
CR
 |
CR_OPTER_Së
;

1061 
FLASH
->
CR
 |
CR_STRT_Së
;

1063 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

1064 if(
°©us
 =
FLASH_COMPLETE
)

1067 
FLASH
->
CR
 &
CR_OPTER_Re£t
;

1069 
FLASH
->
CR
 |
CR_OPTPG_Së
;

1070 if(
NewSèã
 !
DISABLE
)

1072 
OB
->
RDP
 = 0x00;

1076 
OB
->
RDP
 = 
RDP_Key
;

1079 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
Eø£Timeout
);

1081 if(
°©us
 !
FLASH_TIMEOUT
)

1084 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

1089 if(
°©us
 !
FLASH_TIMEOUT
)

1092 
FLASH
->
CR
 &
CR_OPTER_Re£t
;

1097  
°©us
;

1098 
	}
}

1118 
FLASH_Sètus
 
	$FLASH_U£rO±i⁄ByãC⁄fig
(
uöt16_t
 
OB_IWDG
, uöt16_à
OB_STOP
, uöt16_à
OB_STDBY
)

1120 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

1123 
	`as£π_∑øm
(
	`IS_OB_IWDG_SOURCE
(
OB_IWDG
));

1124 
	`as£π_∑øm
(
	`IS_OB_STOP_SOURCE
(
OB_STOP
));

1125 
	`as£π_∑øm
(
	`IS_OB_STDBY_SOURCE
(
OB_STDBY
));

1128 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

1129 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

1132 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1134 if(
°©us
 =
FLASH_COMPLETE
)

1137 
FLASH
->
CR
 |
CR_OPTPG_Së
;

1139 
OB
->
USER
 = 
OB_IWDG
 | (
uöt16_t
)(
OB_STOP
 | (uöt16_t)(
OB_STDBY
 | ((uint16_t)0xF8)));

1142 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1143 if(
°©us
 !
FLASH_TIMEOUT
)

1146 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

1150  
°©us
;

1151 
	}
}

1153 #ifde‡
STM32F10X_XL


1172 
FLASH_Sètus
 
	$FLASH_BoŸC⁄fig
(
uöt16_t
 
FLASH_BOOT
)

1174 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

1175 
	`as£π_∑øm
(
	`IS_FLASH_BOOT
(
FLASH_BOOT
));

1177 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

1178 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

1181 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1183 if(
°©us
 =
FLASH_COMPLETE
)

1186 
FLASH
->
CR
 |
CR_OPTPG_Së
;

1188 if(
FLASH_BOOT
 =
FLASH_BOOT_B™k1
)

1190 
OB
->
USER
 |
OB_USER_BFB2
;

1194 
OB
->
USER
 &(
uöt16_t
)(~(uöt16_t)(
OB_USER_BFB2
));

1197 
°©us
 = 
	`FLASH_WaôF‹La°O≥øti⁄
(
ProgømTimeout
);

1198 if(
°©us
 !
FLASH_TIMEOUT
)

1201 
FLASH
->
CR
 &
CR_OPTPG_Re£t
;

1205  
°©us
;

1206 
	}
}

1216 
uöt32_t
 
	$FLASH_GëU£rO±i⁄Byã
()

1219  (
uöt32_t
)(
FLASH
->
OBR
 >> 2);

1220 
	}
}

1228 
uöt32_t
 
	$FLASH_GëWrôePrŸe˘i⁄O±i⁄Byã
()

1231  (
uöt32_t
)(
FLASH
->
WRPR
);

1232 
	}
}

1240 
FœgSètus
 
	$FLASH_GëRódOutPrŸe˘i⁄Sètus
()

1242 
FœgSètus
 
ªadout°©us
 = 
RESET
;

1243 i‡((
FLASH
->
OBR
 & 
RDPRT_Mask
Ë!(
uöt32_t
)
RESET
)

1245 
ªadout°©us
 = 
SET
;

1249 
ªadout°©us
 = 
RESET
;

1251  
ªadout°©us
;

1252 
	}
}

1260 
FœgSètus
 
	$FLASH_GëPª„tchBuf„rSètus
()

1262 
FœgSètus
 
bô°©us
 = 
RESET
;

1264 i‡((
FLASH
->
ACR
 & 
ACR_PRFTBS_Mask
Ë!(
uöt32_t
)
RESET
)

1266 
bô°©us
 = 
SET
;

1270 
bô°©us
 = 
RESET
;

1273  
bô°©us
;

1274 
	}
}

1290 
	$FLASH_ITC⁄fig
(
uöt32_t
 
FLASH_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1292 #ifde‡
STM32F10X_XL


1294 
	`as£π_∑øm
(
	`IS_FLASH_IT
(
FLASH_IT
));

1295 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1297 if((
FLASH_IT
 & 0x80000000) != 0x0)

1299 if(
NewSèã
 !
DISABLE
)

1302 
FLASH
->
CR2
 |(
FLASH_IT
 & 0x7FFFFFFF);

1307 
FLASH
->
CR2
 &~(
uöt32_t
)(
FLASH_IT
 & 0x7FFFFFFF);

1312 if(
NewSèã
 !
DISABLE
)

1315 
FLASH
->
CR
 |
FLASH_IT
;

1320 
FLASH
->
CR
 &~(
uöt32_t
)
FLASH_IT
;

1325 
	`as£π_∑øm
(
	`IS_FLASH_IT
(
FLASH_IT
));

1326 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1328 if(
NewSèã
 !
DISABLE
)

1331 
FLASH
->
CR
 |
FLASH_IT
;

1336 
FLASH
->
CR
 &~(
uöt32_t
)
FLASH_IT
;

1339 
	}
}

1357 
FœgSètus
 
	$FLASH_GëFœgSètus
(
uöt32_t
 
FLASH_FLAG
)

1359 
FœgSètus
 
bô°©us
 = 
RESET
;

1361 #ifde‡
STM32F10X_XL


1363 
	`as£π_∑øm
(
	`IS_FLASH_GET_FLAG
(
FLASH_FLAG
)) ;

1364 if(
FLASH_FLAG
 =
FLASH_FLAG_OPTERR
)

1366 if((
FLASH
->
OBR
 & 
FLASH_FLAG_OPTERR
Ë!(
uöt32_t
)
RESET
)

1368 
bô°©us
 = 
SET
;

1372 
bô°©us
 = 
RESET
;

1377 if((
FLASH_FLAG
 & 0x80000000) != 0x0)

1379 if((
FLASH
->
SR2
 & 
FLASH_FLAG
Ë!(
uöt32_t
)
RESET
)

1381 
bô°©us
 = 
SET
;

1385 
bô°©us
 = 
RESET
;

1390 if((
FLASH
->
SR
 & 
FLASH_FLAG
Ë!(
uöt32_t
)
RESET
)

1392 
bô°©us
 = 
SET
;

1396 
bô°©us
 = 
RESET
;

1402 
	`as£π_∑øm
(
	`IS_FLASH_GET_FLAG
(
FLASH_FLAG
)) ;

1403 if(
FLASH_FLAG
 =
FLASH_FLAG_OPTERR
)

1405 if((
FLASH
->
OBR
 & 
FLASH_FLAG_OPTERR
Ë!(
uöt32_t
)
RESET
)

1407 
bô°©us
 = 
SET
;

1411 
bô°©us
 = 
RESET
;

1416 if((
FLASH
->
SR
 & 
FLASH_FLAG
Ë!(
uöt32_t
)
RESET
)

1418 
bô°©us
 = 
SET
;

1422 
bô°©us
 = 
RESET
;

1428  
bô°©us
;

1429 
	}
}

1443 
	$FLASH_CÀ¨Fœg
(
uöt32_t
 
FLASH_FLAG
)

1445 #ifde‡
STM32F10X_XL


1447 
	`as£π_∑øm
(
	`IS_FLASH_CLEAR_FLAG
(
FLASH_FLAG
)) ;

1449 if((
FLASH_FLAG
 & 0x80000000) != 0x0)

1452 
FLASH
->
SR2
 = 
FLASH_FLAG
;

1457 
FLASH
->
SR
 = 
FLASH_FLAG
;

1462 
	`as£π_∑øm
(
	`IS_FLASH_CLEAR_FLAG
(
FLASH_FLAG
)) ;

1465 
FLASH
->
SR
 = 
FLASH_FLAG
;

1467 
	}
}

1477 
FLASH_Sètus
 
	$FLASH_GëSètus
()

1479 
FLASH_Sètus
 
Êash°©us
 = 
FLASH_COMPLETE
;

1481 if((
FLASH
->
SR
 & 
FLASH_FLAG_BSY
) == FLASH_FLAG_BSY)

1483 
Êash°©us
 = 
FLASH_BUSY
;

1487 if((
FLASH
->
SR
 & 
FLASH_FLAG_PGERR
) != 0)

1489 
Êash°©us
 = 
FLASH_ERROR_PG
;

1493 if((
FLASH
->
SR
 & 
FLASH_FLAG_WRPRTERR
) != 0 )

1495 
Êash°©us
 = 
FLASH_ERROR_WRP
;

1499 
Êash°©us
 = 
FLASH_COMPLETE
;

1504  
Êash°©us
;

1505 
	}
}

1515 
FLASH_Sètus
 
	$FLASH_GëB™k1Sètus
()

1517 
FLASH_Sètus
 
Êash°©us
 = 
FLASH_COMPLETE
;

1519 if((
FLASH
->
SR
 & 
FLASH_FLAG_BANK1_BSY
Ë=
FLASH_FLAG_BSY
)

1521 
Êash°©us
 = 
FLASH_BUSY
;

1525 if((
FLASH
->
SR
 & 
FLASH_FLAG_BANK1_PGERR
) != 0)

1527 
Êash°©us
 = 
FLASH_ERROR_PG
;

1531 if((
FLASH
->
SR
 & 
FLASH_FLAG_BANK1_WRPRTERR
) != 0 )

1533 
Êash°©us
 = 
FLASH_ERROR_WRP
;

1537 
Êash°©us
 = 
FLASH_COMPLETE
;

1542  
Êash°©us
;

1543 
	}
}

1545 #ifde‡
STM32F10X_XL


1553 
FLASH_Sètus
 
	$FLASH_GëB™k2Sètus
()

1555 
FLASH_Sètus
 
Êash°©us
 = 
FLASH_COMPLETE
;

1557 if((
FLASH
->
SR2
 & (
FLASH_FLAG_BANK2_BSY
 & 0x7FFFFFFF)) == (FLASH_FLAG_BANK2_BSY & 0x7FFFFFFF))

1559 
Êash°©us
 = 
FLASH_BUSY
;

1563 if((
FLASH
->
SR2
 & (
FLASH_FLAG_BANK2_PGERR
 & 0x7FFFFFFF)) != 0)

1565 
Êash°©us
 = 
FLASH_ERROR_PG
;

1569 if((
FLASH
->
SR2
 & (
FLASH_FLAG_BANK2_WRPRTERR
 & 0x7FFFFFFF)) != 0 )

1571 
Êash°©us
 = 
FLASH_ERROR_WRP
;

1575 
Êash°©us
 = 
FLASH_COMPLETE
;

1580  
Êash°©us
;

1581 
	}
}

1595 
FLASH_Sètus
 
	$FLASH_WaôF‹La°O≥øti⁄
(
uöt32_t
 
Timeout
)

1597 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

1600 
°©us
 = 
	`FLASH_GëB™k1Sètus
();

1602 (
°©us
 =
FLASH_BUSY
Ë&& (
Timeout
 != 0x00))

1604 
°©us
 = 
	`FLASH_GëB™k1Sètus
();

1605 
Timeout
--;

1607 if(
Timeout
 == 0x00 )

1609 
°©us
 = 
FLASH_TIMEOUT
;

1612  
°©us
;

1613 
	}
}

1623 
FLASH_Sètus
 
	$FLASH_WaôF‹La°B™k1O≥øti⁄
(
uöt32_t
 
Timeout
)

1625 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

1628 
°©us
 = 
	`FLASH_GëB™k1Sètus
();

1630 (
°©us
 =
FLASH_FLAG_BANK1_BSY
Ë&& (
Timeout
 != 0x00))

1632 
°©us
 = 
	`FLASH_GëB™k1Sètus
();

1633 
Timeout
--;

1635 if(
Timeout
 == 0x00 )

1637 
°©us
 = 
FLASH_TIMEOUT
;

1640  
°©us
;

1641 
	}
}

1643 #ifde‡
STM32F10X_XL


1651 
FLASH_Sètus
 
	$FLASH_WaôF‹La°B™k2O≥øti⁄
(
uöt32_t
 
Timeout
)

1653 
FLASH_Sètus
 
°©us
 = 
FLASH_COMPLETE
;

1656 
°©us
 = 
	`FLASH_GëB™k2Sètus
();

1658 (
°©us
 =(
FLASH_FLAG_BANK2_BSY
 & 0x7FFFFFFF)Ë&& (
Timeout
 != 0x00))

1660 
°©us
 = 
	`FLASH_GëB™k2Sètus
();

1661 
Timeout
--;

1663 if(
Timeout
 == 0x00 )

1665 
°©us
 = 
FLASH_TIMEOUT
;

1668  
°©us
;

1669 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST866E~1.C

23 
	~"°m32f10x_ußπ.h
"

24 
	~"°m32f10x_rcc.h
"

47 
	#CR1_UE_Së
 ((
uöt16_t
)0x2000Ë

	)

48 
	#CR1_UE_Re£t
 ((
uöt16_t
)0xDFFFË

	)

50 
	#CR1_WAKE_Mask
 ((
uöt16_t
)0xF7FFË

	)

52 
	#CR1_RWU_Së
 ((
uöt16_t
)0x0002Ë

	)

53 
	#CR1_RWU_Re£t
 ((
uöt16_t
)0xFFFDË

	)

54 
	#CR1_SBK_Së
 ((
uöt16_t
)0x0001Ë

	)

55 
	#CR1_CLEAR_Mask
 ((
uöt16_t
)0xE9F3Ë

	)

56 
	#CR2_Addªss_Mask
 ((
uöt16_t
)0xFFF0Ë

	)

58 
	#CR2_LINEN_Së
 ((
uöt16_t
)0x4000Ë

	)

59 
	#CR2_LINEN_Re£t
 ((
uöt16_t
)0xBFFFË

	)

61 
	#CR2_LBDL_Mask
 ((
uöt16_t
)0xFFDFË

	)

62 
	#CR2_STOP_CLEAR_Mask
 ((
uöt16_t
)0xCFFFË

	)

63 
	#CR2_CLOCK_CLEAR_Mask
 ((
uöt16_t
)0xF0FFË

	)

65 
	#CR3_SCEN_Së
 ((
uöt16_t
)0x0020Ë

	)

66 
	#CR3_SCEN_Re£t
 ((
uöt16_t
)0xFFDFË

	)

68 
	#CR3_NACK_Së
 ((
uöt16_t
)0x0010Ë

	)

69 
	#CR3_NACK_Re£t
 ((
uöt16_t
)0xFFEFË

	)

71 
	#CR3_HDSEL_Së
 ((
uöt16_t
)0x0008Ë

	)

72 
	#CR3_HDSEL_Re£t
 ((
uöt16_t
)0xFFF7Ë

	)

74 
	#CR3_IRLP_Mask
 ((
uöt16_t
)0xFFFBË

	)

75 
	#CR3_CLEAR_Mask
 ((
uöt16_t
)0xFCFFË

	)

77 
	#CR3_IREN_Së
 ((
uöt16_t
)0x0002Ë

	)

78 
	#CR3_IREN_Re£t
 ((
uöt16_t
)0xFFFDË

	)

79 
	#GTPR_LSB_Mask
 ((
uöt16_t
)0x00FFË

	)

80 
	#GTPR_MSB_Mask
 ((
uöt16_t
)0xFF00Ë

	)

81 
	#IT_Mask
 ((
uöt16_t
)0x001FË

	)

84 
	#CR1_OVER8_Së
 ((
u16
)0x8000Ë

	)

85 
	#CR1_OVER8_Re£t
 ((
u16
)0x7FFFË

	)

88 
	#CR3_ONEBITE_Së
 ((
u16
)0x0800Ë

	)

89 
	#CR3_ONEBITE_Re£t
 ((
u16
)0xF7FFË

	)

130 
	$USART_DeInô
(
USART_Ty≥Def
* 
USARTx
)

133 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

135 i‡(
USARTx
 =
USART1
)

137 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_USART1
, 
ENABLE
);

138 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_USART1
, 
DISABLE
);

140 i‡(
USARTx
 =
USART2
)

142 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_USART2
, 
ENABLE
);

143 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_USART2
, 
DISABLE
);

145 i‡(
USARTx
 =
USART3
)

147 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_USART3
, 
ENABLE
);

148 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_USART3
, 
DISABLE
);

150 i‡(
USARTx
 =
UART4
)

152 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_UART4
, 
ENABLE
);

153 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_UART4
, 
DISABLE
);

157 i‡(
USARTx
 =
UART5
)

159 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_UART5
, 
ENABLE
);

160 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_UART5
, 
DISABLE
);

163 
	}
}

176 
	$USART_Inô
(
USART_Ty≥Def
* 
USARTx
, 
USART_InôTy≥Def
* 
USART_InôSåu˘
)

178 
uöt32_t
 
tm¥eg
 = 0x00, 
≠b˛ock
 = 0x00;

179 
uöt32_t
 
öãgîdividî
 = 0x00;

180 
uöt32_t
 
‰a˘i⁄Ædividî
 = 0x00;

181 
uöt32_t
 
ußπxba£
 = 0;

182 
RCC_ClocksTy≥Def
 
RCC_ClocksSètus
;

184 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

185 
	`as£π_∑øm
(
	`IS_USART_BAUDRATE
(
USART_InôSåu˘
->
USART_BaudR©e
));

186 
	`as£π_∑øm
(
	`IS_USART_WORD_LENGTH
(
USART_InôSåu˘
->
USART_W‹dLígth
));

187 
	`as£π_∑øm
(
	`IS_USART_STOPBITS
(
USART_InôSåu˘
->
USART_St›Bôs
));

188 
	`as£π_∑øm
(
	`IS_USART_PARITY
(
USART_InôSåu˘
->
USART_P¨ôy
));

189 
	`as£π_∑øm
(
	`IS_USART_MODE
(
USART_InôSåu˘
->
USART_Mode
));

190 
	`as£π_∑øm
(
	`IS_USART_HARDWARE_FLOW_CONTROL
(
USART_InôSåu˘
->
USART_H¨dw¨eFlowC⁄åﬁ
));

192 i‡(
USART_InôSåu˘
->
USART_H¨dw¨eFlowC⁄åﬁ
 !
USART_H¨dw¨eFlowC⁄åﬁ_N⁄e
)

194 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

197 
ußπxba£
 = (
uöt32_t
)
USARTx
;

200 
tm¥eg
 = 
USARTx
->
CR2
;

202 
tm¥eg
 &
CR2_STOP_CLEAR_Mask
;

205 
tm¥eg
 |(
uöt32_t
)
USART_InôSåu˘
->
USART_St›Bôs
;

208 
USARTx
->
CR2
 = (
uöt16_t
)
tm¥eg
;

211 
tm¥eg
 = 
USARTx
->
CR1
;

213 
tm¥eg
 &
CR1_CLEAR_Mask
;

218 
tm¥eg
 |(
uöt32_t
)
USART_InôSåu˘
->
USART_W‹dLígth
 | USART_InôSåu˘->
USART_P¨ôy
 |

219 
USART_InôSåu˘
->
USART_Mode
;

221 
USARTx
->
CR1
 = (
uöt16_t
)
tm¥eg
;

224 
tm¥eg
 = 
USARTx
->
CR3
;

226 
tm¥eg
 &
CR3_CLEAR_Mask
;

229 
tm¥eg
 |
USART_InôSåu˘
->
USART_H¨dw¨eFlowC⁄åﬁ
;

231 
USARTx
->
CR3
 = (
uöt16_t
)
tm¥eg
;

235 
	`RCC_GëClocksFªq
(&
RCC_ClocksSètus
);

236 i‡(
ußπxba£
 =
USART1_BASE
)

238 
≠b˛ock
 = 
RCC_ClocksSètus
.
PCLK2_Fªquícy
;

242 
≠b˛ock
 = 
RCC_ClocksSètus
.
PCLK1_Fªquícy
;

246 i‡((
USARTx
->
CR1
 & 
CR1_OVER8_Së
) != 0)

249 
öãgîdividî
 = ((25 * 
≠b˛ock
Ë/ (2 * (
USART_InôSåu˘
->
USART_BaudR©e
)));

254 
öãgîdividî
 = ((25 * 
≠b˛ock
Ë/ (4 * (
USART_InôSåu˘
->
USART_BaudR©e
)));

256 
tm¥eg
 = (
öãgîdividî
 / 100) << 4;

259 
‰a˘i⁄Ædividî
 = 
öãgîdividî
 - (100 * (
tm¥eg
 >> 4));

262 i‡((
USARTx
->
CR1
 & 
CR1_OVER8_Së
) != 0)

264 
tm¥eg
 |((((
‰a˘i⁄Ædividî
 * 8Ë+ 50Ë/ 100)Ë& ((
uöt8_t
)0x07);

268 
tm¥eg
 |((((
‰a˘i⁄Ædividî
 * 16Ë+ 50Ë/ 100)Ë& ((
uöt8_t
)0x0F);

272 
USARTx
->
BRR
 = (
uöt16_t
)
tm¥eg
;

273 
	}
}

281 
	$USART_Såu˘Inô
(
USART_InôTy≥Def
* 
USART_InôSåu˘
)

284 
USART_InôSåu˘
->
USART_BaudR©e
 = 9600;

285 
USART_InôSåu˘
->
USART_W‹dLígth
 = 
USART_W‹dLígth_8b
;

286 
USART_InôSåu˘
->
USART_St›Bôs
 = 
USART_St›Bôs_1
;

287 
USART_InôSåu˘
->
USART_P¨ôy
 = 
USART_P¨ôy_No
 ;

288 
USART_InôSåu˘
->
USART_Mode
 = 
USART_Mode_Rx
 | 
USART_Mode_Tx
;

289 
USART_InôSåu˘
->
USART_H¨dw¨eFlowC⁄åﬁ
 = 
USART_H¨dw¨eFlowC⁄åﬁ_N⁄e
;

290 
	}
}

302 
	$USART_ClockInô
(
USART_Ty≥Def
* 
USARTx
, 
USART_ClockInôTy≥Def
* 
USART_ClockInôSåu˘
)

304 
uöt32_t
 
tm¥eg
 = 0x00;

306 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

307 
	`as£π_∑øm
(
	`IS_USART_CLOCK
(
USART_ClockInôSåu˘
->
USART_Clock
));

308 
	`as£π_∑øm
(
	`IS_USART_CPOL
(
USART_ClockInôSåu˘
->
USART_CPOL
));

309 
	`as£π_∑øm
(
	`IS_USART_CPHA
(
USART_ClockInôSåu˘
->
USART_CPHA
));

310 
	`as£π_∑øm
(
	`IS_USART_LASTBIT
(
USART_ClockInôSåu˘
->
USART_La°Bô
));

313 
tm¥eg
 = 
USARTx
->
CR2
;

315 
tm¥eg
 &
CR2_CLOCK_CLEAR_Mask
;

321 
tm¥eg
 |(
uöt32_t
)
USART_ClockInôSåu˘
->
USART_Clock
 | USART_ClockInôSåu˘->
USART_CPOL
 |

322 
USART_ClockInôSåu˘
->
USART_CPHA
 | USART_ClockInôSåu˘->
USART_La°Bô
;

324 
USARTx
->
CR2
 = (
uöt16_t
)
tm¥eg
;

325 
	}
}

333 
	$USART_ClockSåu˘Inô
(
USART_ClockInôTy≥Def
* 
USART_ClockInôSåu˘
)

336 
USART_ClockInôSåu˘
->
USART_Clock
 = 
USART_Clock_DißbÀ
;

337 
USART_ClockInôSåu˘
->
USART_CPOL
 = 
USART_CPOL_Low
;

338 
USART_ClockInôSåu˘
->
USART_CPHA
 = 
USART_CPHA_1Edge
;

339 
USART_ClockInôSåu˘
->
USART_La°Bô
 = 
USART_La°Bô_DißbÀ
;

340 
	}
}

351 
	$USART_Cmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

354 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

355 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

357 i‡(
NewSèã
 !
DISABLE
)

360 
USARTx
->
CR1
 |
CR1_UE_Së
;

365 
USARTx
->
CR1
 &
CR1_UE_Re£t
;

367 
	}
}

388 
	$USART_ITC⁄fig
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

390 
uöt32_t
 
ußπªg
 = 0x00, 
ôpos
 = 0x00, 
ômask
 = 0x00;

391 
uöt32_t
 
ußπxba£
 = 0x00;

393 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

394 
	`as£π_∑øm
(
	`IS_USART_CONFIG_IT
(
USART_IT
));

395 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

397 i‡(
USART_IT
 =
USART_IT_CTS
)

399 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

402 
ußπxba£
 = (
uöt32_t
)
USARTx
;

405 
ußπªg
 = (((
uöt8_t
)
USART_IT
) >> 0x05);

408 
ôpos
 = 
USART_IT
 & 
IT_Mask
;

409 
ômask
 = (((
uöt32_t
)0x01Ë<< 
ôpos
);

411 i‡(
ußπªg
 == 0x01)

413 
ußπxba£
 += 0x0C;

415 i‡(
ußπªg
 == 0x02)

417 
ußπxba£
 += 0x10;

421 
ußπxba£
 += 0x14;

423 i‡(
NewSèã
 !
DISABLE
)

425 *(
__IO
 
uöt32_t
*)
ußπxba£
 |
ômask
;

429 *(
__IO
 
uöt32_t
*)
ußπxba£
 &~
ômask
;

431 
	}
}

448 
	$USART_DMACmd
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_DMAReq
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

451 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

452 
	`as£π_∑øm
(
	`IS_USART_DMAREQ
(
USART_DMAReq
));

453 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

454 i‡(
NewSèã
 !
DISABLE
)

458 
USARTx
->
CR3
 |
USART_DMAReq
;

464 
USARTx
->
CR3
 &(
uöt16_t
)~
USART_DMAReq
;

466 
	}
}

476 
	$USART_SëAddªss
(
USART_Ty≥Def
* 
USARTx
, 
uöt8_t
 
USART_Addªss
)

479 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

480 
	`as£π_∑øm
(
	`IS_USART_ADDRESS
(
USART_Addªss
));

483 
USARTx
->
CR2
 &
CR2_Addªss_Mask
;

485 
USARTx
->
CR2
 |
USART_Addªss
;

486 
	}
}

499 
	$USART_WakeUpC⁄fig
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_WakeUp
)

502 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

503 
	`as£π_∑øm
(
	`IS_USART_WAKEUP
(
USART_WakeUp
));

505 
USARTx
->
CR1
 &
CR1_WAKE_Mask
;

506 
USARTx
->
CR1
 |
USART_WakeUp
;

507 
	}
}

518 
	$USART_Re˚ivîWakeUpCmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

521 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

522 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

524 i‡(
NewSèã
 !
DISABLE
)

527 
USARTx
->
CR1
 |
CR1_RWU_Së
;

532 
USARTx
->
CR1
 &
CR1_RWU_Re£t
;

534 
	}
}

547 
	$USART_LINBªakDëe˘LígthC⁄fig
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_LINBªakDëe˘Lígth
)

550 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

551 
	`as£π_∑øm
(
	`IS_USART_LIN_BREAK_DETECT_LENGTH
(
USART_LINBªakDëe˘Lígth
));

553 
USARTx
->
CR2
 &
CR2_LBDL_Mask
;

554 
USARTx
->
CR2
 |
USART_LINBªakDëe˘Lígth
;

555 
	}
}

566 
	$USART_LINCmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

569 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

570 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

572 i‡(
NewSèã
 !
DISABLE
)

575 
USARTx
->
CR2
 |
CR2_LINEN_Së
;

580 
USARTx
->
CR2
 &
CR2_LINEN_Re£t
;

582 
	}
}

592 
	$USART_SídD©a
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
D©a
)

595 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

596 
	`as£π_∑øm
(
	`IS_USART_DATA
(
D©a
));

599 
USARTx
->
DR
 = (
D©a
 & (
uöt16_t
)0x01FF);

600 
	}
}

609 
uöt16_t
 
	$USART_Re˚iveD©a
(
USART_Ty≥Def
* 
USARTx
)

612 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

615  (
uöt16_t
)(
USARTx
->
DR
 & (uint16_t)0x01FF);

616 
	}
}

625 
	$USART_SídBªak
(
USART_Ty≥Def
* 
USARTx
)

628 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

631 
USARTx
->
CR1
 |
CR1_SBK_Së
;

632 
	}
}

641 
	$USART_SëGu¨dTime
(
USART_Ty≥Def
* 
USARTx
, 
uöt8_t
 
USART_Gu¨dTime
)

644 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

647 
USARTx
->
GTPR
 &
GTPR_LSB_Mask
;

649 
USARTx
->
GTPR
 |(
uöt16_t
)((uöt16_t)
USART_Gu¨dTime
 << 0x08);

650 
	}
}

661 
	$USART_SëPªsˇÀr
(
USART_Ty≥Def
* 
USARTx
, 
uöt8_t
 
USART_PªsˇÀr
)

664 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

667 
USARTx
->
GTPR
 &
GTPR_MSB_Mask
;

669 
USARTx
->
GTPR
 |
USART_PªsˇÀr
;

670 
	}
}

680 
	$USART_Sm¨tC¨dCmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

683 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

684 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

685 i‡(
NewSèã
 !
DISABLE
)

688 
USARTx
->
CR3
 |
CR3_SCEN_Së
;

693 
USARTx
->
CR3
 &
CR3_SCEN_Re£t
;

695 
	}
}

705 
	$USART_Sm¨tC¨dNACKCmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

708 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

709 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

710 i‡(
NewSèã
 !
DISABLE
)

713 
USARTx
->
CR3
 |
CR3_NACK_Së
;

718 
USARTx
->
CR3
 &
CR3_NACK_Re£t
;

720 
	}
}

731 
	$USART_HÆfDu∂exCmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

734 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

735 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

737 i‡(
NewSèã
 !
DISABLE
)

740 
USARTx
->
CR3
 |
CR3_HDSEL_Së
;

745 
USARTx
->
CR3
 &
CR3_HDSEL_Re£t
;

747 
	}
}

762 
	$USART_OvîSam∂ög8Cmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

765 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

766 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

768 i‡(
NewSèã
 !
DISABLE
)

771 
USARTx
->
CR1
 |
CR1_OVER8_Së
;

776 
USARTx
->
CR1
 &
CR1_OVER8_Re£t
;

778 
	}
}

789 
	$USART_O√BôMëhodCmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

792 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

793 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

795 i‡(
NewSèã
 !
DISABLE
)

798 
USARTx
->
CR3
 |
CR3_ONEBITE_Së
;

803 
USARTx
->
CR3
 &
CR3_ONEBITE_Re£t
;

805 
	}
}

818 
	$USART_IrDAC⁄fig
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_IrDAMode
)

821 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

822 
	`as£π_∑øm
(
	`IS_USART_IRDA_MODE
(
USART_IrDAMode
));

824 
USARTx
->
CR3
 &
CR3_IRLP_Mask
;

825 
USARTx
->
CR3
 |
USART_IrDAMode
;

826 
	}
}

837 
	$USART_IrDACmd
(
USART_Ty≥Def
* 
USARTx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

840 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

841 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

843 i‡(
NewSèã
 !
DISABLE
)

846 
USARTx
->
CR3
 |
CR3_IREN_Së
;

851 
USARTx
->
CR3
 &
CR3_IREN_Re£t
;

853 
	}
}

874 
FœgSètus
 
	$USART_GëFœgSètus
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_FLAG
)

876 
FœgSètus
 
bô°©us
 = 
RESET
;

878 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

879 
	`as£π_∑øm
(
	`IS_USART_FLAG
(
USART_FLAG
));

881 i‡(
USART_FLAG
 =
USART_FLAG_CTS
)

883 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

886 i‡((
USARTx
->
SR
 & 
USART_FLAG
Ë!(
uöt16_t
)
RESET
)

888 
bô°©us
 = 
SET
;

892 
bô°©us
 = 
RESET
;

894  
bô°©us
;

895 
	}
}

923 
	$USART_CÀ¨Fœg
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_FLAG
)

926 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

927 
	`as£π_∑øm
(
	`IS_USART_CLEAR_FLAG
(
USART_FLAG
));

929 i‡((
USART_FLAG
 & 
USART_FLAG_CTS
) == USART_FLAG_CTS)

931 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

934 
USARTx
->
SR
 = (
uöt16_t
)~
USART_FLAG
;

935 
	}
}

956 
ITSètus
 
	$USART_GëITSètus
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_IT
)

958 
uöt32_t
 
bôpos
 = 0x00, 
ômask
 = 0x00, 
ußπªg
 = 0x00;

959 
ITSètus
 
bô°©us
 = 
RESET
;

961 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

962 
	`as£π_∑øm
(
	`IS_USART_GET_IT
(
USART_IT
));

964 i‡(
USART_IT
 =
USART_IT_CTS
)

966 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

970 
ußπªg
 = (((
uöt8_t
)
USART_IT
) >> 0x05);

972 
ômask
 = 
USART_IT
 & 
IT_Mask
;

973 
ômask
 = (
uöt32_t
)0x01 << itmask;

975 i‡(
ußπªg
 == 0x01)

977 
ômask
 &
USARTx
->
CR1
;

979 i‡(
ußπªg
 == 0x02)

981 
ômask
 &
USARTx
->
CR2
;

985 
ômask
 &
USARTx
->
CR3
;

988 
bôpos
 = 
USART_IT
 >> 0x08;

989 
bôpos
 = (
uöt32_t
)0x01 << bitpos;

990 
bôpos
 &
USARTx
->
SR
;

991 i‡((
ômask
 !(
uöt16_t
)
RESET
)&&(
bôpos
 != (uint16_t)RESET))

993 
bô°©us
 = 
SET
;

997 
bô°©us
 = 
RESET
;

1000  
bô°©us
;

1001 
	}
}

1030 
	$USART_CÀ¨ITPídögBô
(
USART_Ty≥Def
* 
USARTx
, 
uöt16_t
 
USART_IT
)

1032 
uöt16_t
 
bôpos
 = 0x00, 
ômask
 = 0x00;

1034 
	`as£π_∑øm
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

1035 
	`as£π_∑øm
(
	`IS_USART_CLEAR_IT
(
USART_IT
));

1037 i‡(
USART_IT
 =
USART_IT_CTS
)

1039 
	`as£π_∑øm
(
	`IS_USART_123_PERIPH
(
USARTx
));

1042 
bôpos
 = 
USART_IT
 >> 0x08;

1043 
ômask
 = ((
uöt16_t
)0x01 << (uöt16_t)
bôpos
);

1044 
USARTx
->
SR
 = (
uöt16_t
)~
ômask
;

1045 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST92BF~1.C

23 
	~"°m32f10x_sdio.h
"

24 
	~"°m32f10x_rcc.h
"

40 
	#SDIO_OFFSET
 (
SDIO_BASE
 - 
PERIPH_BASE
)

	)

45 
	#CLKCR_OFFSET
 (
SDIO_OFFSET
 + 0x04)

	)

46 
	#CLKEN_BôNumbî
 0x08

	)

47 
	#CLKCR_CLKEN_BB
 (
PERIPH_BB_BASE
 + (
CLKCR_OFFSET
 * 32Ë+ (
CLKEN_BôNumbî
 * 4))

	)

52 
	#CMD_OFFSET
 (
SDIO_OFFSET
 + 0x0C)

	)

53 
	#SDIOSUSPEND_BôNumbî
 0x0B

	)

54 
	#CMD_SDIOSUSPEND_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32Ë+ (
SDIOSUSPEND_BôNumbî
 * 4))

	)

57 
	#ENCMDCOMPL_BôNumbî
 0x0C

	)

58 
	#CMD_ENCMDCOMPL_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32Ë+ (
ENCMDCOMPL_BôNumbî
 * 4))

	)

61 
	#NIEN_BôNumbî
 0x0D

	)

62 
	#CMD_NIEN_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32Ë+ (
NIEN_BôNumbî
 * 4))

	)

65 
	#ATACMD_BôNumbî
 0x0E

	)

66 
	#CMD_ATACMD_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32Ë+ (
ATACMD_BôNumbî
 * 4))

	)

71 
	#DCTRL_OFFSET
 (
SDIO_OFFSET
 + 0x2C)

	)

72 
	#DMAEN_BôNumbî
 0x03

	)

73 
	#DCTRL_DMAEN_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32Ë+ (
DMAEN_BôNumbî
 * 4))

	)

76 
	#RWSTART_BôNumbî
 0x08

	)

77 
	#DCTRL_RWSTART_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32Ë+ (
RWSTART_BôNumbî
 * 4))

	)

80 
	#RWSTOP_BôNumbî
 0x09

	)

81 
	#DCTRL_RWSTOP_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32Ë+ (
RWSTOP_BôNumbî
 * 4))

	)

84 
	#RWMOD_BôNumbî
 0x0A

	)

85 
	#DCTRL_RWMOD_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32Ë+ (
RWMOD_BôNumbî
 * 4))

	)

88 
	#SDIOEN_BôNumbî
 0x0B

	)

89 
	#DCTRL_SDIOEN_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32Ë+ (
SDIOEN_BôNumbî
 * 4))

	)

96 
	#CLKCR_CLEAR_MASK
 ((
uöt32_t
)0xFFFF8100)

	)

101 
	#PWR_PWRCTRL_MASK
 ((
uöt32_t
)0xFFFFFFFC)

	)

106 
	#DCTRL_CLEAR_MASK
 ((
uöt32_t
)0xFFFFFF08)

	)

111 
	#CMD_CLEAR_MASK
 ((
uöt32_t
)0xFFFFF800)

	)

114 
	#SDIO_RESP_ADDR
 ((
uöt32_t
)(
SDIO_BASE
 + 0x14))

	)

161 
	$SDIO_DeInô
()

163 
SDIO
->
POWER
 = 0x00000000;

164 
SDIO
->
CLKCR
 = 0x00000000;

165 
SDIO
->
ARG
 = 0x00000000;

166 
SDIO
->
CMD
 = 0x00000000;

167 
SDIO
->
DTIMER
 = 0x00000000;

168 
SDIO
->
DLEN
 = 0x00000000;

169 
SDIO
->
DCTRL
 = 0x00000000;

170 
SDIO
->
ICR
 = 0x00C007FF;

171 
SDIO
->
MASK
 = 0x00000000;

172 
	}
}

181 
	$SDIO_Inô
(
SDIO_InôTy≥Def
* 
SDIO_InôSåu˘
)

183 
uöt32_t
 
tm¥eg
 = 0;

186 
	`as£π_∑øm
(
	`IS_SDIO_CLOCK_EDGE
(
SDIO_InôSåu˘
->
SDIO_ClockEdge
));

187 
	`as£π_∑øm
(
	`IS_SDIO_CLOCK_BYPASS
(
SDIO_InôSåu˘
->
SDIO_ClockBy∑ss
));

188 
	`as£π_∑øm
(
	`IS_SDIO_CLOCK_POWER_SAVE
(
SDIO_InôSåu˘
->
SDIO_ClockPowîSave
));

189 
	`as£π_∑øm
(
	`IS_SDIO_BUS_WIDE
(
SDIO_InôSåu˘
->
SDIO_BusWide
));

190 
	`as£π_∑øm
(
	`IS_SDIO_HARDWARE_FLOW_CONTROL
(
SDIO_InôSåu˘
->
SDIO_H¨dw¨eFlowC⁄åﬁ
));

194 
tm¥eg
 = 
SDIO
->
CLKCR
;

197 
tm¥eg
 &
CLKCR_CLEAR_MASK
;

205 
tm¥eg
 |(
SDIO_InôSåu˘
->
SDIO_ClockDiv
 | SDIO_InôSåu˘->
SDIO_ClockPowîSave
 |

206 
SDIO_InôSåu˘
->
SDIO_ClockBy∑ss
 | SDIO_InôSåu˘->
SDIO_BusWide
 |

207 
SDIO_InôSåu˘
->
SDIO_ClockEdge
 | SDIO_InôSåu˘->
SDIO_H¨dw¨eFlowC⁄åﬁ
);

210 
SDIO
->
CLKCR
 = 
tm¥eg
;

211 
	}
}

219 
	$SDIO_Såu˘Inô
(
SDIO_InôTy≥Def
* 
SDIO_InôSåu˘
)

222 
SDIO_InôSåu˘
->
SDIO_ClockDiv
 = 0x00;

223 
SDIO_InôSåu˘
->
SDIO_ClockEdge
 = 
SDIO_ClockEdge_Risög
;

224 
SDIO_InôSåu˘
->
SDIO_ClockBy∑ss
 = 
SDIO_ClockBy∑ss_DißbÀ
;

225 
SDIO_InôSåu˘
->
SDIO_ClockPowîSave
 = 
SDIO_ClockPowîSave_DißbÀ
;

226 
SDIO_InôSåu˘
->
SDIO_BusWide
 = 
SDIO_BusWide_1b
;

227 
SDIO_InôSåu˘
->
SDIO_H¨dw¨eFlowC⁄åﬁ
 = 
SDIO_H¨dw¨eFlowC⁄åﬁ_DißbÀ
;

228 
	}
}

235 
	$SDIO_ClockCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

238 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

240 *(
__IO
 
uöt32_t
 *Ë
CLKCR_CLKEN_BB
 = (uöt32_t)
NewSèã
;

241 
	}
}

251 
	$SDIO_SëPowîSèã
(
uöt32_t
 
SDIO_PowîSèã
)

254 
	`as£π_∑øm
(
	`IS_SDIO_POWER_STATE
(
SDIO_PowîSèã
));

256 
SDIO
->
POWER
 &
PWR_PWRCTRL_MASK
;

257 
SDIO
->
POWER
 |
SDIO_PowîSèã
;

258 
	}
}

269 
uöt32_t
 
	$SDIO_GëPowîSèã
()

271  (
SDIO
->
POWER
 & (~
PWR_PWRCTRL_MASK
));

272 
	}
}

307 
	$SDIO_ITC⁄fig
(
uöt32_t
 
SDIO_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

310 
	`as£π_∑øm
(
	`IS_SDIO_IT
(
SDIO_IT
));

311 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

313 i‡(
NewSèã
 !
DISABLE
)

316 
SDIO
->
MASK
 |
SDIO_IT
;

321 
SDIO
->
MASK
 &~
SDIO_IT
;

323 
	}
}

331 
	$SDIO_DMACmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

334 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

336 *(
__IO
 
uöt32_t
 *Ë
DCTRL_DMAEN_BB
 = (uöt32_t)
NewSèã
;

337 
	}
}

346 
	$SDIO_SídComm™d
(
SDIO_CmdInôTy≥Def
 *
SDIO_CmdInôSåu˘
)

348 
uöt32_t
 
tm¥eg
 = 0;

351 
	`as£π_∑øm
(
	`IS_SDIO_CMD_INDEX
(
SDIO_CmdInôSåu˘
->
SDIO_CmdIndex
));

352 
	`as£π_∑øm
(
	`IS_SDIO_RESPONSE
(
SDIO_CmdInôSåu˘
->
SDIO_Re•⁄£
));

353 
	`as£π_∑øm
(
	`IS_SDIO_WAIT
(
SDIO_CmdInôSåu˘
->
SDIO_Waô
));

354 
	`as£π_∑øm
(
	`IS_SDIO_CPSM
(
SDIO_CmdInôSåu˘
->
SDIO_CPSM
));

358 
SDIO
->
ARG
 = 
SDIO_CmdInôSåu˘
->
SDIO_Argumít
;

362 
tm¥eg
 = 
SDIO
->
CMD
;

364 
tm¥eg
 &
CMD_CLEAR_MASK
;

369 
tm¥eg
 |(
uöt32_t
)
SDIO_CmdInôSåu˘
->
SDIO_CmdIndex
 | SDIO_CmdInôSåu˘->
SDIO_Re•⁄£


370 | 
SDIO_CmdInôSåu˘
->
SDIO_Waô
 | SDIO_CmdInôSåu˘->
SDIO_CPSM
;

373 
SDIO
->
CMD
 = 
tm¥eg
;

374 
	}
}

382 
	$SDIO_CmdSåu˘Inô
(
SDIO_CmdInôTy≥Def
* 
SDIO_CmdInôSåu˘
)

385 
SDIO_CmdInôSåu˘
->
SDIO_Argumít
 = 0x00;

386 
SDIO_CmdInôSåu˘
->
SDIO_CmdIndex
 = 0x00;

387 
SDIO_CmdInôSåu˘
->
SDIO_Re•⁄£
 = 
SDIO_Re•⁄£_No
;

388 
SDIO_CmdInôSåu˘
->
SDIO_Waô
 = 
SDIO_Waô_No
;

389 
SDIO_CmdInôSåu˘
->
SDIO_CPSM
 = 
SDIO_CPSM_DißbÀ
;

390 
	}
}

397 
uöt8_t
 
	$SDIO_GëComm™dRe•⁄£
()

399  (
uöt8_t
)(
SDIO
->
RESPCMD
);

400 
	}
}

412 
uöt32_t
 
	$SDIO_GëRe•⁄£
(
uöt32_t
 
SDIO_RESP
)

414 
__IO
 
uöt32_t
 
tmp
 = 0;

417 
	`as£π_∑øm
(
	`IS_SDIO_RESP
(
SDIO_RESP
));

419 
tmp
 = 
SDIO_RESP_ADDR
 + 
SDIO_RESP
;

421  (*(
__IO
 
uöt32_t
 *Ë
tmp
);

422 
	}
}

431 
	$SDIO_D©aC⁄fig
(
SDIO_D©aInôTy≥Def
* 
SDIO_D©aInôSåu˘
)

433 
uöt32_t
 
tm¥eg
 = 0;

436 
	`as£π_∑øm
(
	`IS_SDIO_DATA_LENGTH
(
SDIO_D©aInôSåu˘
->
SDIO_D©aLígth
));

437 
	`as£π_∑øm
(
	`IS_SDIO_BLOCK_SIZE
(
SDIO_D©aInôSåu˘
->
SDIO_D©aBlockSize
));

438 
	`as£π_∑øm
(
	`IS_SDIO_TRANSFER_DIR
(
SDIO_D©aInôSåu˘
->
SDIO_Tøns„rDú
));

439 
	`as£π_∑øm
(
	`IS_SDIO_TRANSFER_MODE
(
SDIO_D©aInôSåu˘
->
SDIO_Tøns„rMode
));

440 
	`as£π_∑øm
(
	`IS_SDIO_DPSM
(
SDIO_D©aInôSåu˘
->
SDIO_DPSM
));

444 
SDIO
->
DTIMER
 = 
SDIO_D©aInôSåu˘
->
SDIO_D©aTimeOut
;

448 
SDIO
->
DLEN
 = 
SDIO_D©aInôSåu˘
->
SDIO_D©aLígth
;

452 
tm¥eg
 = 
SDIO
->
DCTRL
;

454 
tm¥eg
 &
DCTRL_CLEAR_MASK
;

459 
tm¥eg
 |(
uöt32_t
)
SDIO_D©aInôSåu˘
->
SDIO_D©aBlockSize
 | SDIO_D©aInôSåu˘->
SDIO_Tøns„rDú


460 | 
SDIO_D©aInôSåu˘
->
SDIO_Tøns„rMode
 | SDIO_D©aInôSåu˘->
SDIO_DPSM
;

463 
SDIO
->
DCTRL
 = 
tm¥eg
;

464 
	}
}

472 
	$SDIO_D©aSåu˘Inô
(
SDIO_D©aInôTy≥Def
* 
SDIO_D©aInôSåu˘
)

475 
SDIO_D©aInôSåu˘
->
SDIO_D©aTimeOut
 = 0xFFFFFFFF;

476 
SDIO_D©aInôSåu˘
->
SDIO_D©aLígth
 = 0x00;

477 
SDIO_D©aInôSåu˘
->
SDIO_D©aBlockSize
 = 
SDIO_D©aBlockSize_1b
;

478 
SDIO_D©aInôSåu˘
->
SDIO_Tøns„rDú
 = 
SDIO_Tøns„rDú_ToC¨d
;

479 
SDIO_D©aInôSåu˘
->
SDIO_Tøns„rMode
 = 
SDIO_Tøns„rMode_Block
;

480 
SDIO_D©aInôSåu˘
->
SDIO_DPSM
 = 
SDIO_DPSM_DißbÀ
;

481 
	}
}

488 
uöt32_t
 
	$SDIO_GëD©aCou¡î
()

490  
SDIO
->
DCOUNT
;

491 
	}
}

498 
uöt32_t
 
	$SDIO_RódD©a
()

500  
SDIO
->
FIFO
;

501 
	}
}

508 
	$SDIO_WrôeD©a
(
uöt32_t
 
D©a
)

510 
SDIO
->
FIFO
 = 
D©a
;

511 
	}
}

518 
uöt32_t
 
	$SDIO_GëFIFOCou¡
()

520  
SDIO
->
FIFOCNT
;

521 
	}
}

529 
	$SDIO_SèπSDIORódWaô
(
Fun˘i⁄ÆSèã
 
NewSèã
)

532 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

534 *(
__IO
 
uöt32_t
 *Ë
DCTRL_RWSTART_BB
 = (uöt32_tË
NewSèã
;

535 
	}
}

543 
	$SDIO_St›SDIORódWaô
(
Fun˘i⁄ÆSèã
 
NewSèã
)

546 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

548 *(
__IO
 
uöt32_t
 *Ë
DCTRL_RWSTOP_BB
 = (uöt32_tË
NewSèã
;

549 
	}
}

559 
	$SDIO_SëSDIORódWaôMode
(
uöt32_t
 
SDIO_RódWaôMode
)

562 
	`as£π_∑øm
(
	`IS_SDIO_READWAIT_MODE
(
SDIO_RódWaôMode
));

564 *(
__IO
 
uöt32_t
 *Ë
DCTRL_RWMOD_BB
 = 
SDIO_RódWaôMode
;

565 
	}
}

573 
	$SDIO_SëSDIOO≥øti⁄
(
Fun˘i⁄ÆSèã
 
NewSèã
)

576 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

578 *(
__IO
 
uöt32_t
 *Ë
DCTRL_SDIOEN_BB
 = (uöt32_t)
NewSèã
;

579 
	}
}

587 
	$SDIO_SídSDIOSu•ídCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

590 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

592 *(
__IO
 
uöt32_t
 *Ë
CMD_SDIOSUSPEND_BB
 = (uöt32_t)
NewSèã
;

593 
	}
}

601 
	$SDIO_Comm™dCom∂ëi⁄Cmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

604 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

606 *(
__IO
 
uöt32_t
 *Ë
CMD_ENCMDCOMPL_BB
 = (uöt32_t)
NewSèã
;

607 
	}
}

614 
	$SDIO_CEATAITCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

617 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

619 *(
__IO
 
uöt32_t
 *Ë
CMD_NIEN_BB
 = (uöt32_t)((~((uöt32_t)
NewSèã
)) & ((uint32_t)0x1));

620 
	}
}

627 
	$SDIO_SídCEATACmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

630 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

632 *(
__IO
 
uöt32_t
 *Ë
CMD_ATACMD_BB
 = (uöt32_t)
NewSèã
;

633 
	}
}

666 
FœgSètus
 
	$SDIO_GëFœgSètus
(
uöt32_t
 
SDIO_FLAG
)

668 
FœgSètus
 
bô°©us
 = 
RESET
;

671 
	`as£π_∑øm
(
	`IS_SDIO_FLAG
(
SDIO_FLAG
));

673 i‡((
SDIO
->
STA
 & 
SDIO_FLAG
Ë!(
uöt32_t
)
RESET
)

675 
bô°©us
 = 
SET
;

679 
bô°©us
 = 
RESET
;

681  
bô°©us
;

682 
	}
}

704 
	$SDIO_CÀ¨Fœg
(
uöt32_t
 
SDIO_FLAG
)

707 
	`as£π_∑øm
(
	`IS_SDIO_CLEAR_FLAG
(
SDIO_FLAG
));

709 
SDIO
->
ICR
 = 
SDIO_FLAG
;

710 
	}
}

743 
ITSètus
 
	$SDIO_GëITSètus
(
uöt32_t
 
SDIO_IT
)

745 
ITSètus
 
bô°©us
 = 
RESET
;

748 
	`as£π_∑øm
(
	`IS_SDIO_GET_IT
(
SDIO_IT
));

749 i‡((
SDIO
->
STA
 & 
SDIO_IT
Ë!(
uöt32_t
)
RESET
)

751 
bô°©us
 = 
SET
;

755 
bô°©us
 = 
RESET
;

757  
bô°©us
;

758 
	}
}

779 
	$SDIO_CÀ¨ITPídögBô
(
uöt32_t
 
SDIO_IT
)

782 
	`as£π_∑øm
(
	`IS_SDIO_CLEAR_IT
(
SDIO_IT
));

784 
SDIO
->
ICR
 = 
SDIO_IT
;

785 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STA2D5~1.C

23 
	~"°m32f10x_exti.h
"

46 
	#EXTI_LINENONE
 ((
uöt32_t
)0x00000Ë

	)

85 
	$EXTI_DeInô
()

87 
EXTI
->
IMR
 = 0x00000000;

88 
EXTI
->
EMR
 = 0x00000000;

89 
EXTI
->
RTSR
 = 0x00000000;

90 
EXTI
->
FTSR
 = 0x00000000;

91 
EXTI
->
PR
 = 0x000FFFFF;

92 
	}
}

101 
	$EXTI_Inô
(
EXTI_InôTy≥Def
* 
EXTI_InôSåu˘
)

103 
uöt32_t
 
tmp
 = 0;

106 
	`as£π_∑øm
(
	`IS_EXTI_MODE
(
EXTI_InôSåu˘
->
EXTI_Mode
));

107 
	`as£π_∑øm
(
	`IS_EXTI_TRIGGER
(
EXTI_InôSåu˘
->
EXTI_Triggî
));

108 
	`as£π_∑øm
(
	`IS_EXTI_LINE
(
EXTI_InôSåu˘
->
EXTI_Löe
));

109 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
EXTI_InôSåu˘
->
EXTI_LöeCmd
));

111 
tmp
 = (
uöt32_t
)
EXTI_BASE
;

113 i‡(
EXTI_InôSåu˘
->
EXTI_LöeCmd
 !
DISABLE
)

116 
EXTI
->
IMR
 &~
EXTI_InôSåu˘
->
EXTI_Löe
;

117 
EXTI
->
EMR
 &~
EXTI_InôSåu˘
->
EXTI_Löe
;

119 
tmp
 +
EXTI_InôSåu˘
->
EXTI_Mode
;

121 *(
__IO
 
uöt32_t
 *Ë
tmp
 |
EXTI_InôSåu˘
->
EXTI_Löe
;

124 
EXTI
->
RTSR
 &~
EXTI_InôSåu˘
->
EXTI_Löe
;

125 
EXTI
->
FTSR
 &~
EXTI_InôSåu˘
->
EXTI_Löe
;

128 i‡(
EXTI_InôSåu˘
->
EXTI_Triggî
 =
EXTI_Triggî_Risög_FÆlög
)

131 
EXTI
->
RTSR
 |
EXTI_InôSåu˘
->
EXTI_Löe
;

132 
EXTI
->
FTSR
 |
EXTI_InôSåu˘
->
EXTI_Löe
;

136 
tmp
 = (
uöt32_t
)
EXTI_BASE
;

137 
tmp
 +
EXTI_InôSåu˘
->
EXTI_Triggî
;

139 *(
__IO
 
uöt32_t
 *Ë
tmp
 |
EXTI_InôSåu˘
->
EXTI_Löe
;

144 
tmp
 +
EXTI_InôSåu˘
->
EXTI_Mode
;

147 *(
__IO
 
uöt32_t
 *Ë
tmp
 &~
EXTI_InôSåu˘
->
EXTI_Löe
;

149 
	}
}

157 
	$EXTI_Såu˘Inô
(
EXTI_InôTy≥Def
* 
EXTI_InôSåu˘
)

159 
EXTI_InôSåu˘
->
EXTI_Löe
 = 
EXTI_LINENONE
;

160 
EXTI_InôSåu˘
->
EXTI_Mode
 = 
EXTI_Mode_I¡îru±
;

161 
EXTI_InôSåu˘
->
EXTI_Triggî
 = 
EXTI_Triggî_FÆlög
;

162 
EXTI_InôSåu˘
->
EXTI_LöeCmd
 = 
DISABLE
;

163 
	}
}

171 
	$EXTI_Gíî©eSWI¡îru±
(
uöt32_t
 
EXTI_Löe
)

174 
	`as£π_∑øm
(
	`IS_EXTI_LINE
(
EXTI_Löe
));

176 
EXTI
->
SWIER
 |
EXTI_Löe
;

177 
	}
}

186 
FœgSètus
 
	$EXTI_GëFœgSètus
(
uöt32_t
 
EXTI_Löe
)

188 
FœgSètus
 
bô°©us
 = 
RESET
;

190 
	`as£π_∑øm
(
	`IS_GET_EXTI_LINE
(
EXTI_Löe
));

192 i‡((
EXTI
->
PR
 & 
EXTI_Löe
Ë!(
uöt32_t
)
RESET
)

194 
bô°©us
 = 
SET
;

198 
bô°©us
 = 
RESET
;

200  
bô°©us
;

201 
	}
}

209 
	$EXTI_CÀ¨Fœg
(
uöt32_t
 
EXTI_Löe
)

212 
	`as£π_∑øm
(
	`IS_EXTI_LINE
(
EXTI_Löe
));

214 
EXTI
->
PR
 = 
EXTI_Löe
;

215 
	}
}

224 
ITSètus
 
	$EXTI_GëITSètus
(
uöt32_t
 
EXTI_Löe
)

226 
ITSètus
 
bô°©us
 = 
RESET
;

227 
uöt32_t
 
íabÀ°©us
 = 0;

229 
	`as£π_∑øm
(
	`IS_GET_EXTI_LINE
(
EXTI_Löe
));

231 
íabÀ°©us
 = 
EXTI
->
IMR
 & 
EXTI_Löe
;

232 i‡(((
EXTI
->
PR
 & 
EXTI_Löe
Ë!(
uöt32_t
)
RESET
Ë&& (
íabÀ°©us
 != (uint32_t)RESET))

234 
bô°©us
 = 
SET
;

238 
bô°©us
 = 
RESET
;

240  
bô°©us
;

241 
	}
}

249 
	$EXTI_CÀ¨ITPídögBô
(
uöt32_t
 
EXTI_Löe
)

252 
	`as£π_∑øm
(
	`IS_EXTI_LINE
(
EXTI_Löe
));

254 
EXTI
->
PR
 = 
EXTI_Löe
;

255 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STB65C~1.C

23 
	~"°m32f10x_dma.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#DMA1_Ch™√l1_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF1
 | 
DMA_ISR_TCIF1
 | 
DMA_ISR_HTIF1
 | 
DMA_ISR_TEIF1
))

	)

49 
	#DMA1_Ch™√l2_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF2
 | 
DMA_ISR_TCIF2
 | 
DMA_ISR_HTIF2
 | 
DMA_ISR_TEIF2
))

	)

50 
	#DMA1_Ch™√l3_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF3
 | 
DMA_ISR_TCIF3
 | 
DMA_ISR_HTIF3
 | 
DMA_ISR_TEIF3
))

	)

51 
	#DMA1_Ch™√l4_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF4
 | 
DMA_ISR_TCIF4
 | 
DMA_ISR_HTIF4
 | 
DMA_ISR_TEIF4
))

	)

52 
	#DMA1_Ch™√l5_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF5
 | 
DMA_ISR_TCIF5
 | 
DMA_ISR_HTIF5
 | 
DMA_ISR_TEIF5
))

	)

53 
	#DMA1_Ch™√l6_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF6
 | 
DMA_ISR_TCIF6
 | 
DMA_ISR_HTIF6
 | 
DMA_ISR_TEIF6
))

	)

54 
	#DMA1_Ch™√l7_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF7
 | 
DMA_ISR_TCIF7
 | 
DMA_ISR_HTIF7
 | 
DMA_ISR_TEIF7
))

	)

57 
	#DMA2_Ch™√l1_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF1
 | 
DMA_ISR_TCIF1
 | 
DMA_ISR_HTIF1
 | 
DMA_ISR_TEIF1
))

	)

58 
	#DMA2_Ch™√l2_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF2
 | 
DMA_ISR_TCIF2
 | 
DMA_ISR_HTIF2
 | 
DMA_ISR_TEIF2
))

	)

59 
	#DMA2_Ch™√l3_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF3
 | 
DMA_ISR_TCIF3
 | 
DMA_ISR_HTIF3
 | 
DMA_ISR_TEIF3
))

	)

60 
	#DMA2_Ch™√l4_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF4
 | 
DMA_ISR_TCIF4
 | 
DMA_ISR_HTIF4
 | 
DMA_ISR_TEIF4
))

	)

61 
	#DMA2_Ch™√l5_IT_Mask
 ((
uöt32_t
)(
DMA_ISR_GIF5
 | 
DMA_ISR_TCIF5
 | 
DMA_ISR_HTIF5
 | 
DMA_ISR_TEIF5
))

	)

64 
	#FLAG_Mask
 ((
uöt32_t
)0x10000000)

	)

67 
	#CCR_CLEAR_Mask
 ((
uöt32_t
)0xFFFF800F)

	)

108 
	$DMA_DeInô
(
DMA_Ch™√l_Ty≥Def
* 
DMAy_Ch™√lx
)

111 
	`as£π_∑øm
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Ch™√lx
));

114 
DMAy_Ch™√lx
->
CCR
 &(
uöt16_t
)(~
DMA_CCR1_EN
);

117 
DMAy_Ch™√lx
->
CCR
 = 0;

120 
DMAy_Ch™√lx
->
CNDTR
 = 0;

123 
DMAy_Ch™√lx
->
CPAR
 = 0;

126 
DMAy_Ch™√lx
->
CMAR
 = 0;

128 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l1
)

131 
DMA1
->
IFCR
 |
DMA1_Ch™√l1_IT_Mask
;

133 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l2
)

136 
DMA1
->
IFCR
 |
DMA1_Ch™√l2_IT_Mask
;

138 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l3
)

141 
DMA1
->
IFCR
 |
DMA1_Ch™√l3_IT_Mask
;

143 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l4
)

146 
DMA1
->
IFCR
 |
DMA1_Ch™√l4_IT_Mask
;

148 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l5
)

151 
DMA1
->
IFCR
 |
DMA1_Ch™√l5_IT_Mask
;

153 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l6
)

156 
DMA1
->
IFCR
 |
DMA1_Ch™√l6_IT_Mask
;

158 i‡(
DMAy_Ch™√lx
 =
DMA1_Ch™√l7
)

161 
DMA1
->
IFCR
 |
DMA1_Ch™√l7_IT_Mask
;

163 i‡(
DMAy_Ch™√lx
 =
DMA2_Ch™√l1
)

166 
DMA2
->
IFCR
 |
DMA2_Ch™√l1_IT_Mask
;

168 i‡(
DMAy_Ch™√lx
 =
DMA2_Ch™√l2
)

171 
DMA2
->
IFCR
 |
DMA2_Ch™√l2_IT_Mask
;

173 i‡(
DMAy_Ch™√lx
 =
DMA2_Ch™√l3
)

176 
DMA2
->
IFCR
 |
DMA2_Ch™√l3_IT_Mask
;

178 i‡(
DMAy_Ch™√lx
 =
DMA2_Ch™√l4
)

181 
DMA2
->
IFCR
 |
DMA2_Ch™√l4_IT_Mask
;

185 i‡(
DMAy_Ch™√lx
 =
DMA2_Ch™√l5
)

188 
DMA2
->
IFCR
 |
DMA2_Ch™√l5_IT_Mask
;

191 
	}
}

202 
	$DMA_Inô
(
DMA_Ch™√l_Ty≥Def
* 
DMAy_Ch™√lx
, 
DMA_InôTy≥Def
* 
DMA_InôSåu˘
)

204 
uöt32_t
 
tm¥eg
 = 0;

207 
	`as£π_∑øm
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Ch™√lx
));

208 
	`as£π_∑øm
(
	`IS_DMA_DIR
(
DMA_InôSåu˘
->
DMA_DIR
));

209 
	`as£π_∑øm
(
	`IS_DMA_BUFFER_SIZE
(
DMA_InôSåu˘
->
DMA_Buf„rSize
));

210 
	`as£π_∑øm
(
	`IS_DMA_PERIPHERAL_INC_STATE
(
DMA_InôSåu˘
->
DMA_PîùhîÆInc
));

211 
	`as£π_∑øm
(
	`IS_DMA_MEMORY_INC_STATE
(
DMA_InôSåu˘
->
DMA_Mem‹yInc
));

212 
	`as£π_∑øm
(
	`IS_DMA_PERIPHERAL_DATA_SIZE
(
DMA_InôSåu˘
->
DMA_PîùhîÆD©aSize
));

213 
	`as£π_∑øm
(
	`IS_DMA_MEMORY_DATA_SIZE
(
DMA_InôSåu˘
->
DMA_Mem‹yD©aSize
));

214 
	`as£π_∑øm
(
	`IS_DMA_MODE
(
DMA_InôSåu˘
->
DMA_Mode
));

215 
	`as£π_∑øm
(
	`IS_DMA_PRIORITY
(
DMA_InôSåu˘
->
DMA_Pri‹ôy
));

216 
	`as£π_∑øm
(
	`IS_DMA_M2M_STATE
(
DMA_InôSåu˘
->
DMA_M2M
));

220 
tm¥eg
 = 
DMAy_Ch™√lx
->
CCR
;

222 
tm¥eg
 &
CCR_CLEAR_Mask
;

232 
tm¥eg
 |
DMA_InôSåu˘
->
DMA_DIR
 | DMA_InôSåu˘->
DMA_Mode
 |

233 
DMA_InôSåu˘
->
DMA_PîùhîÆInc
 | DMA_InôSåu˘->
DMA_Mem‹yInc
 |

234 
DMA_InôSåu˘
->
DMA_PîùhîÆD©aSize
 | DMA_InôSåu˘->
DMA_Mem‹yD©aSize
 |

235 
DMA_InôSåu˘
->
DMA_Pri‹ôy
 | DMA_InôSåu˘->
DMA_M2M
;

238 
DMAy_Ch™√lx
->
CCR
 = 
tm¥eg
;

242 
DMAy_Ch™√lx
->
CNDTR
 = 
DMA_InôSåu˘
->
DMA_Buf„rSize
;

246 
DMAy_Ch™√lx
->
CPAR
 = 
DMA_InôSåu˘
->
DMA_PîùhîÆBa£Addr
;

250 
DMAy_Ch™√lx
->
CMAR
 = 
DMA_InôSåu˘
->
DMA_Mem‹yBa£Addr
;

251 
	}
}

259 
	$DMA_Såu˘Inô
(
DMA_InôTy≥Def
* 
DMA_InôSåu˘
)

263 
DMA_InôSåu˘
->
DMA_PîùhîÆBa£Addr
 = 0;

265 
DMA_InôSåu˘
->
DMA_Mem‹yBa£Addr
 = 0;

267 
DMA_InôSåu˘
->
DMA_DIR
 = 
DMA_DIR_PîùhîÆSRC
;

269 
DMA_InôSåu˘
->
DMA_Buf„rSize
 = 0;

271 
DMA_InôSåu˘
->
DMA_PîùhîÆInc
 = 
DMA_PîùhîÆInc_DißbÀ
;

273 
DMA_InôSåu˘
->
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_DißbÀ
;

275 
DMA_InôSåu˘
->
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_Byã
;

277 
DMA_InôSåu˘
->
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_Byã
;

279 
DMA_InôSåu˘
->
DMA_Mode
 = 
DMA_Mode_N‹mÆ
;

281 
DMA_InôSåu˘
->
DMA_Pri‹ôy
 = 
DMA_Pri‹ôy_Low
;

283 
DMA_InôSåu˘
->
DMA_M2M
 = 
DMA_M2M_DißbÀ
;

284 
	}
}

294 
	$DMA_Cmd
(
DMA_Ch™√l_Ty≥Def
* 
DMAy_Ch™√lx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

297 
	`as£π_∑øm
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Ch™√lx
));

298 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

300 i‡(
NewSèã
 !
DISABLE
)

303 
DMAy_Ch™√lx
->
CCR
 |
DMA_CCR1_EN
;

308 
DMAy_Ch™√lx
->
CCR
 &(
uöt16_t
)(~
DMA_CCR1_EN
);

310 
	}
}

326 
	$DMA_ITC⁄fig
(
DMA_Ch™√l_Ty≥Def
* 
DMAy_Ch™√lx
, 
uöt32_t
 
DMA_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

329 
	`as£π_∑øm
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Ch™√lx
));

330 
	`as£π_∑øm
(
	`IS_DMA_CONFIG_IT
(
DMA_IT
));

331 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

332 i‡(
NewSèã
 !
DISABLE
)

335 
DMAy_Ch™√lx
->
CCR
 |
DMA_IT
;

340 
DMAy_Ch™√lx
->
CCR
 &~
DMA_IT
;

342 
	}
}

353 
	$DMA_SëCuºD©aCou¡î
(
DMA_Ch™√l_Ty≥Def
* 
DMAy_Ch™√lx
, 
uöt16_t
 
D©aNumbî
)

356 
	`as£π_∑øm
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Ch™√lx
));

360 
DMAy_Ch™√lx
->
CNDTR
 = 
D©aNumbî
;

361 
	}
}

371 
uöt16_t
 
	$DMA_GëCuºD©aCou¡î
(
DMA_Ch™√l_Ty≥Def
* 
DMAy_Ch™√lx
)

374 
	`as£π_∑øm
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Ch™√lx
));

376  ((
uöt16_t
)(
DMAy_Ch™√lx
->
CNDTR
));

377 
	}
}

433 
FœgSètus
 
	$DMA_GëFœgSètus
(
uöt32_t
 
DMAy_FLAG
)

435 
FœgSètus
 
bô°©us
 = 
RESET
;

436 
uöt32_t
 
tm¥eg
 = 0;

439 
	`as£π_∑øm
(
	`IS_DMA_GET_FLAG
(
DMAy_FLAG
));

442 i‡((
DMAy_FLAG
 & 
FLAG_Mask
Ë!(
uöt32_t
)
RESET
)

445 
tm¥eg
 = 
DMA2
->
ISR
 ;

450 
tm¥eg
 = 
DMA1
->
ISR
 ;

454 i‡((
tm¥eg
 & 
DMAy_FLAG
Ë!(
uöt32_t
)
RESET
)

457 
bô°©us
 = 
SET
;

462 
bô°©us
 = 
RESET
;

466  
bô°©us
;

467 
	}
}

523 
	$DMA_CÀ¨Fœg
(
uöt32_t
 
DMAy_FLAG
)

526 
	`as£π_∑øm
(
	`IS_DMA_CLEAR_FLAG
(
DMAy_FLAG
));

529 i‡((
DMAy_FLAG
 & 
FLAG_Mask
Ë!(
uöt32_t
)
RESET
)

532 
DMA2
->
IFCR
 = 
DMAy_FLAG
;

537 
DMA1
->
IFCR
 = 
DMAy_FLAG
;

539 
	}
}

595 
ITSètus
 
	$DMA_GëITSètus
(
uöt32_t
 
DMAy_IT
)

597 
ITSètus
 
bô°©us
 = 
RESET
;

598 
uöt32_t
 
tm¥eg
 = 0;

601 
	`as£π_∑øm
(
	`IS_DMA_GET_IT
(
DMAy_IT
));

604 i‡((
DMAy_IT
 & 
FLAG_Mask
Ë!(
uöt32_t
)
RESET
)

607 
tm¥eg
 = 
DMA2
->
ISR
;

612 
tm¥eg
 = 
DMA1
->
ISR
;

616 i‡((
tm¥eg
 & 
DMAy_IT
Ë!(
uöt32_t
)
RESET
)

619 
bô°©us
 = 
SET
;

624 
bô°©us
 = 
RESET
;

627  
bô°©us
;

628 
	}
}

684 
	$DMA_CÀ¨ITPídögBô
(
uöt32_t
 
DMAy_IT
)

687 
	`as£π_∑øm
(
	`IS_DMA_CLEAR_IT
(
DMAy_IT
));

690 i‡((
DMAy_IT
 & 
FLAG_Mask
Ë!(
uöt32_t
)
RESET
)

693 
DMA2
->
IFCR
 = 
DMAy_IT
;

698 
DMA1
->
IFCR
 = 
DMAy_IT
;

700 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STC0DE~1.C

23 
	~"°m32f10x_i2c.h
"

24 
	~"°m32f10x_rcc.h
"

49 
	#CR1_PE_Së
 ((
uöt16_t
)0x0001)

	)

50 
	#CR1_PE_Re£t
 ((
uöt16_t
)0xFFFE)

	)

53 
	#CR1_START_Së
 ((
uöt16_t
)0x0100)

	)

54 
	#CR1_START_Re£t
 ((
uöt16_t
)0xFEFF)

	)

57 
	#CR1_STOP_Së
 ((
uöt16_t
)0x0200)

	)

58 
	#CR1_STOP_Re£t
 ((
uöt16_t
)0xFDFF)

	)

61 
	#CR1_ACK_Së
 ((
uöt16_t
)0x0400)

	)

62 
	#CR1_ACK_Re£t
 ((
uöt16_t
)0xFBFF)

	)

65 
	#CR1_ENGC_Së
 ((
uöt16_t
)0x0040)

	)

66 
	#CR1_ENGC_Re£t
 ((
uöt16_t
)0xFFBF)

	)

69 
	#CR1_SWRST_Së
 ((
uöt16_t
)0x8000)

	)

70 
	#CR1_SWRST_Re£t
 ((
uöt16_t
)0x7FFF)

	)

73 
	#CR1_PEC_Së
 ((
uöt16_t
)0x1000)

	)

74 
	#CR1_PEC_Re£t
 ((
uöt16_t
)0xEFFF)

	)

77 
	#CR1_ENPEC_Së
 ((
uöt16_t
)0x0020)

	)

78 
	#CR1_ENPEC_Re£t
 ((
uöt16_t
)0xFFDF)

	)

81 
	#CR1_ENARP_Së
 ((
uöt16_t
)0x0010)

	)

82 
	#CR1_ENARP_Re£t
 ((
uöt16_t
)0xFFEF)

	)

85 
	#CR1_NOSTRETCH_Së
 ((
uöt16_t
)0x0080)

	)

86 
	#CR1_NOSTRETCH_Re£t
 ((
uöt16_t
)0xFF7F)

	)

89 
	#CR1_CLEAR_Mask
 ((
uöt16_t
)0xFBF5)

	)

92 
	#CR2_DMAEN_Së
 ((
uöt16_t
)0x0800)

	)

93 
	#CR2_DMAEN_Re£t
 ((
uöt16_t
)0xF7FF)

	)

96 
	#CR2_LAST_Së
 ((
uöt16_t
)0x1000)

	)

97 
	#CR2_LAST_Re£t
 ((
uöt16_t
)0xEFFF)

	)

100 
	#CR2_FREQ_Re£t
 ((
uöt16_t
)0xFFC0)

	)

103 
	#OAR1_ADD0_Së
 ((
uöt16_t
)0x0001)

	)

104 
	#OAR1_ADD0_Re£t
 ((
uöt16_t
)0xFFFE)

	)

107 
	#OAR2_ENDUAL_Së
 ((
uöt16_t
)0x0001)

	)

108 
	#OAR2_ENDUAL_Re£t
 ((
uöt16_t
)0xFFFE)

	)

111 
	#OAR2_ADD2_Re£t
 ((
uöt16_t
)0xFF01)

	)

114 
	#CCR_FS_Së
 ((
uöt16_t
)0x8000)

	)

117 
	#CCR_CCR_Së
 ((
uöt16_t
)0x0FFF)

	)

120 
	#FLAG_Mask
 ((
uöt32_t
)0x00FFFFFF)

	)

123 
	#ITEN_Mask
 ((
uöt32_t
)0x07000000)

	)

162 
	$I2C_DeInô
(
I2C_Ty≥Def
* 
I2Cx
)

165 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

167 i‡(
I2Cx
 =
I2C1
)

170 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_I2C1
, 
ENABLE
);

172 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_I2C1
, 
DISABLE
);

177 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_I2C2
, 
ENABLE
);

179 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_I2C2
, 
DISABLE
);

181 
	}
}

191 
	$I2C_Inô
(
I2C_Ty≥Def
* 
I2Cx
, 
I2C_InôTy≥Def
* 
I2C_InôSåu˘
)

193 
uöt16_t
 
tm¥eg
 = 0, 
‰eqønge
 = 0;

194 
uöt16_t
 
ªsu…
 = 0x04;

195 
uöt32_t
 
p˛k1
 = 8000000;

196 
RCC_ClocksTy≥Def
 
rcc_˛ocks
;

198 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

199 
	`as£π_∑øm
(
	`IS_I2C_CLOCK_SPEED
(
I2C_InôSåu˘
->
I2C_ClockS≥ed
));

200 
	`as£π_∑øm
(
	`IS_I2C_MODE
(
I2C_InôSåu˘
->
I2C_Mode
));

201 
	`as£π_∑øm
(
	`IS_I2C_DUTY_CYCLE
(
I2C_InôSåu˘
->
I2C_DutyCy˛e
));

202 
	`as£π_∑øm
(
	`IS_I2C_OWN_ADDRESS1
(
I2C_InôSåu˘
->
I2C_OwnAddªss1
));

203 
	`as£π_∑øm
(
	`IS_I2C_ACK_STATE
(
I2C_InôSåu˘
->
I2C_Ack
));

204 
	`as£π_∑øm
(
	`IS_I2C_ACKNOWLEDGE_ADDRESS
(
I2C_InôSåu˘
->
I2C_AcknowÀdgedAddªss
));

208 
tm¥eg
 = 
I2Cx
->
CR2
;

210 
tm¥eg
 &
CR2_FREQ_Re£t
;

212 
	`RCC_GëClocksFªq
(&
rcc_˛ocks
);

213 
p˛k1
 = 
rcc_˛ocks
.
PCLK1_Fªquícy
;

215 
‰eqønge
 = (
uöt16_t
)(
p˛k1
 / 1000000);

216 
tm¥eg
 |
‰eqønge
;

218 
I2Cx
->
CR2
 = 
tm¥eg
;

222 
I2Cx
->
CR1
 &
CR1_PE_Re£t
;

225 
tm¥eg
 = 0;

228 i‡(
I2C_InôSåu˘
->
I2C_ClockS≥ed
 <= 100000)

231 
ªsu…
 = (
uöt16_t
)(
p˛k1
 / (
I2C_InôSåu˘
->
I2C_ClockS≥ed
 << 1));

233 i‡(
ªsu…
 < 0x04)

236 
ªsu…
 = 0x04;

239 
tm¥eg
 |
ªsu…
;

241 
I2Cx
->
TRISE
 = 
‰eqønge
 + 1;

246 i‡(
I2C_InôSåu˘
->
I2C_DutyCy˛e
 =
I2C_DutyCy˛e_2
)

249 
ªsu…
 = (
uöt16_t
)(
p˛k1
 / (
I2C_InôSåu˘
->
I2C_ClockS≥ed
 * 3));

254 
ªsu…
 = (
uöt16_t
)(
p˛k1
 / (
I2C_InôSåu˘
->
I2C_ClockS≥ed
 * 25));

256 
ªsu…
 |
I2C_DutyCy˛e_16_9
;

260 i‡((
ªsu…
 & 
CCR_CCR_Së
) == 0)

263 
ªsu…
 |(
uöt16_t
)0x0001;

266 
tm¥eg
 |(
uöt16_t
)(
ªsu…
 | 
CCR_FS_Së
);

268 
I2Cx
->
TRISE
 = (
uöt16_t
)(((
‰eqønge
 * (uint16_t)300) / (uint16_t)1000) + (uint16_t)1);

272 
I2Cx
->
CCR
 = 
tm¥eg
;

274 
I2Cx
->
CR1
 |
CR1_PE_Së
;

278 
tm¥eg
 = 
I2Cx
->
CR1
;

280 
tm¥eg
 &
CR1_CLEAR_Mask
;

284 
tm¥eg
 |(
uöt16_t
)((
uöt32_t
)
I2C_InôSåu˘
->
I2C_Mode
 | I2C_InôSåu˘->
I2C_Ack
);

286 
I2Cx
->
CR1
 = 
tm¥eg
;

290 
I2Cx
->
OAR1
 = (
I2C_InôSåu˘
->
I2C_AcknowÀdgedAddªss
 | I2C_InôSåu˘->
I2C_OwnAddªss1
);

291 
	}
}

298 
	$I2C_Såu˘Inô
(
I2C_InôTy≥Def
* 
I2C_InôSåu˘
)

302 
I2C_InôSåu˘
->
I2C_ClockS≥ed
 = 5000;

304 
I2C_InôSåu˘
->
I2C_Mode
 = 
I2C_Mode_I2C
;

306 
I2C_InôSåu˘
->
I2C_DutyCy˛e
 = 
I2C_DutyCy˛e_2
;

308 
I2C_InôSåu˘
->
I2C_OwnAddªss1
 = 0;

310 
I2C_InôSåu˘
->
I2C_Ack
 = 
I2C_Ack_DißbÀ
;

312 
I2C_InôSåu˘
->
I2C_AcknowÀdgedAddªss
 = 
I2C_AcknowÀdgedAddªss_7bô
;

313 
	}
}

322 
	$I2C_Cmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

325 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

326 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

327 i‡(
NewSèã
 !
DISABLE
)

330 
I2Cx
->
CR1
 |
CR1_PE_Së
;

335 
I2Cx
->
CR1
 &
CR1_PE_Re£t
;

337 
	}
}

346 
	$I2C_DMACmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

349 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

350 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

351 i‡(
NewSèã
 !
DISABLE
)

354 
I2Cx
->
CR2
 |
CR2_DMAEN_Së
;

359 
I2Cx
->
CR2
 &
CR2_DMAEN_Re£t
;

361 
	}
}

370 
	$I2C_DMALa°Tøns„rCmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

373 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

374 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

375 i‡(
NewSèã
 !
DISABLE
)

378 
I2Cx
->
CR2
 |
CR2_LAST_Së
;

383 
I2Cx
->
CR2
 &
CR2_LAST_Re£t
;

385 
	}
}

394 
	$I2C_Gíî©eSTART
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

397 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

398 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

399 i‡(
NewSèã
 !
DISABLE
)

402 
I2Cx
->
CR1
 |
CR1_START_Së
;

407 
I2Cx
->
CR1
 &
CR1_START_Re£t
;

409 
	}
}

418 
	$I2C_Gíî©eSTOP
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

421 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

422 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

423 i‡(
NewSèã
 !
DISABLE
)

426 
I2Cx
->
CR1
 |
CR1_STOP_Së
;

431 
I2Cx
->
CR1
 &
CR1_STOP_Re£t
;

433 
	}
}

442 
	$I2C_AcknowÀdgeC⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

445 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

446 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

447 i‡(
NewSèã
 !
DISABLE
)

450 
I2Cx
->
CR1
 |
CR1_ACK_Së
;

455 
I2Cx
->
CR1
 &
CR1_ACK_Re£t
;

457 
	}
}

465 
	$I2C_OwnAddªss2C⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt8_t
 
Addªss
)

467 
uöt16_t
 
tm¥eg
 = 0;

470 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

473 
tm¥eg
 = 
I2Cx
->
OAR2
;

476 
tm¥eg
 &
OAR2_ADD2_Re£t
;

479 
tm¥eg
 |(
uöt16_t
)((uöt16_t)
Addªss
 & (uint16_t)0x00FE);

482 
I2Cx
->
OAR2
 = 
tm¥eg
;

483 
	}
}

492 
	$I2C_DuÆAddªssCmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

495 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

496 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

497 i‡(
NewSèã
 !
DISABLE
)

500 
I2Cx
->
OAR2
 |
OAR2_ENDUAL_Së
;

505 
I2Cx
->
OAR2
 &
OAR2_ENDUAL_Re£t
;

507 
	}
}

516 
	$I2C_GíîÆCÆlCmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

519 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

520 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

521 i‡(
NewSèã
 !
DISABLE
)

524 
I2Cx
->
CR1
 |
CR1_ENGC_Së
;

529 
I2Cx
->
CR1
 &
CR1_ENGC_Re£t
;

531 
	}
}

545 
	$I2C_ITC⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt16_t
 
I2C_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

548 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

549 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

550 
	`as£π_∑øm
(
	`IS_I2C_CONFIG_IT
(
I2C_IT
));

552 i‡(
NewSèã
 !
DISABLE
)

555 
I2Cx
->
CR2
 |
I2C_IT
;

560 
I2Cx
->
CR2
 &(
uöt16_t
)~
I2C_IT
;

562 
	}
}

570 
	$I2C_SídD©a
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt8_t
 
D©a
)

573 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

575 
I2Cx
->
DR
 = 
D©a
;

576 
	}
}

583 
uöt8_t
 
	$I2C_Re˚iveD©a
(
I2C_Ty≥Def
* 
I2Cx
)

586 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

588  (
uöt8_t
)
I2Cx
->
DR
;

589 
	}
}

601 
	$I2C_Síd7bôAddªss
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt8_t
 
Addªss
, uöt8_à
I2C_Dúe˘i⁄
)

604 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

605 
	`as£π_∑øm
(
	`IS_I2C_DIRECTION
(
I2C_Dúe˘i⁄
));

607 i‡(
I2C_Dúe˘i⁄
 !
I2C_Dúe˘i⁄_Tønsmôãr
)

610 
Addªss
 |
OAR1_ADD0_Së
;

615 
Addªss
 &
OAR1_ADD0_Re£t
;

618 
I2Cx
->
DR
 = 
Addªss
;

619 
	}
}

636 
uöt16_t
 
	$I2C_RódRegi°î
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt8_t
 
I2C_Regi°î
)

638 
__IO
 
uöt32_t
 
tmp
 = 0;

641 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

642 
	`as£π_∑øm
(
	`IS_I2C_REGISTER
(
I2C_Regi°î
));

644 
tmp
 = (
uöt32_t
Ë
I2Cx
;

645 
tmp
 +
I2C_Regi°î
;

648  (*(
__IO
 
uöt16_t
 *Ë
tmp
);

649 
	}
}

658 
	$I2C_So·w¨eRe£tCmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

661 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

662 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

663 i‡(
NewSèã
 !
DISABLE
)

666 
I2Cx
->
CR1
 |
CR1_SWRST_Së
;

671 
I2Cx
->
CR1
 &
CR1_SWRST_Re£t
;

673 
	}
}

696 
	$I2C_NACKPosôi⁄C⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt16_t
 
I2C_NACKPosôi⁄
)

699 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

700 
	`as£π_∑øm
(
	`IS_I2C_NACK_POSITION
(
I2C_NACKPosôi⁄
));

703 i‡(
I2C_NACKPosôi⁄
 =
I2C_NACKPosôi⁄_Next
)

706 
I2Cx
->
CR1
 |
I2C_NACKPosôi⁄_Next
;

711 
I2Cx
->
CR1
 &
I2C_NACKPosôi⁄_Cuºít
;

713 
	}
}

724 
	$I2C_SMBusAÀπC⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt16_t
 
I2C_SMBusAÀπ
)

727 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

728 
	`as£π_∑øm
(
	`IS_I2C_SMBUS_ALERT
(
I2C_SMBusAÀπ
));

729 i‡(
I2C_SMBusAÀπ
 =
I2C_SMBusAÀπ_Low
)

732 
I2Cx
->
CR1
 |
I2C_SMBusAÀπ_Low
;

737 
I2Cx
->
CR1
 &
I2C_SMBusAÀπ_High
;

739 
	}
}

748 
	$I2C_TønsmôPEC
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

751 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

752 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

753 i‡(
NewSèã
 !
DISABLE
)

756 
I2Cx
->
CR1
 |
CR1_PEC_Së
;

761 
I2Cx
->
CR1
 &
CR1_PEC_Re£t
;

763 
	}
}

779 
	$I2C_PECPosôi⁄C⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt16_t
 
I2C_PECPosôi⁄
)

782 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

783 
	`as£π_∑øm
(
	`IS_I2C_PEC_POSITION
(
I2C_PECPosôi⁄
));

784 i‡(
I2C_PECPosôi⁄
 =
I2C_PECPosôi⁄_Next
)

787 
I2Cx
->
CR1
 |
I2C_PECPosôi⁄_Next
;

792 
I2Cx
->
CR1
 &
I2C_PECPosôi⁄_Cuºít
;

794 
	}
}

803 
	$I2C_CÆcuœãPEC
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

806 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

807 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

808 i‡(
NewSèã
 !
DISABLE
)

811 
I2Cx
->
CR1
 |
CR1_ENPEC_Së
;

816 
I2Cx
->
CR1
 &
CR1_ENPEC_Re£t
;

818 
	}
}

825 
uöt8_t
 
	$I2C_GëPEC
(
I2C_Ty≥Def
* 
I2Cx
)

828 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

830  ((
I2Cx
->
SR2
) >> 8);

831 
	}
}

840 
	$I2C_ARPCmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

843 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

844 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

845 i‡(
NewSèã
 !
DISABLE
)

848 
I2Cx
->
CR1
 |
CR1_ENARP_Së
;

853 
I2Cx
->
CR1
 &
CR1_ENARP_Re£t
;

855 
	}
}

864 
	$I2C_SåëchClockCmd
(
I2C_Ty≥Def
* 
I2Cx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

867 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

868 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

869 i‡(
NewSèã
 =
DISABLE
)

872 
I2Cx
->
CR1
 |
CR1_NOSTRETCH_Së
;

877 
I2Cx
->
CR1
 &
CR1_NOSTRETCH_Re£t
;

879 
	}
}

890 
	$I2C_Fa°ModeDutyCy˛eC⁄fig
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt16_t
 
I2C_DutyCy˛e
)

893 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

894 
	`as£π_∑øm
(
	`IS_I2C_DUTY_CYCLE
(
I2C_DutyCy˛e
));

895 i‡(
I2C_DutyCy˛e
 !
I2C_DutyCy˛e_16_9
)

898 
I2Cx
->
CCR
 &
I2C_DutyCy˛e_2
;

903 
I2Cx
->
CCR
 |
I2C_DutyCy˛e_16_9
;

905 
	}
}

1030 
Eº‹Sètus
 
	$I2C_CheckEvít
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt32_t
 
I2C_EVENT
)

1032 
uöt32_t
 
œ°evít
 = 0;

1033 
uöt32_t
 
Êag1
 = 0, 
Êag2
 = 0;

1034 
Eº‹Sètus
 
°©us
 = 
ERROR
;

1037 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1038 
	`as£π_∑øm
(
	`IS_I2C_EVENT
(
I2C_EVENT
));

1041 
Êag1
 = 
I2Cx
->
SR1
;

1042 
Êag2
 = 
I2Cx
->
SR2
;

1043 
Êag2
 = flag2 << 16;

1046 
œ°evít
 = (
Êag1
 | 
Êag2
Ë& 
FLAG_Mask
;

1049 i‡((
œ°evít
 & 
I2C_EVENT
) == I2C_EVENT)

1052 
°©us
 = 
SUCCESS
;

1057 
°©us
 = 
ERROR
;

1060  
°©us
;

1061 
	}
}

1078 
uöt32_t
 
	$I2C_GëLa°Evít
(
I2C_Ty≥Def
* 
I2Cx
)

1080 
uöt32_t
 
œ°evít
 = 0;

1081 
uöt32_t
 
Êag1
 = 0, 
Êag2
 = 0;

1084 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1087 
Êag1
 = 
I2Cx
->
SR1
;

1088 
Êag2
 = 
I2Cx
->
SR2
;

1089 
Êag2
 = flag2 << 16;

1092 
œ°evít
 = (
Êag1
 | 
Êag2
Ë& 
FLAG_Mask
;

1095  
œ°evít
;

1096 
	}
}

1133 
FœgSètus
 
	$I2C_GëFœgSètus
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt32_t
 
I2C_FLAG
)

1135 
FœgSètus
 
bô°©us
 = 
RESET
;

1136 
__IO
 
uöt32_t
 
i2¸eg
 = 0, 
i2cxba£
 = 0;

1139 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1140 
	`as£π_∑øm
(
	`IS_I2C_GET_FLAG
(
I2C_FLAG
));

1143 
i2cxba£
 = (
uöt32_t
)
I2Cx
;

1146 
i2¸eg
 = 
I2C_FLAG
 >> 28;

1149 
I2C_FLAG
 &
FLAG_Mask
;

1151 if(
i2¸eg
 != 0)

1154 
i2cxba£
 += 0x14;

1159 
I2C_FLAG
 = (
uöt32_t
)(I2C_FLAG >> 16);

1161 
i2cxba£
 += 0x18;

1164 if(((*(
__IO
 
uöt32_t
 *)
i2cxba£
Ë& 
I2C_FLAG
Ë!(uöt32_t)
RESET
)

1167 
bô°©us
 = 
SET
;

1172 
bô°©us
 = 
RESET
;

1176  
bô°©us
;

1177 
	}
}

1212 
	$I2C_CÀ¨Fœg
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt32_t
 
I2C_FLAG
)

1214 
uöt32_t
 
Êagpos
 = 0;

1216 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1217 
	`as£π_∑øm
(
	`IS_I2C_CLEAR_FLAG
(
I2C_FLAG
));

1219 
Êagpos
 = 
I2C_FLAG
 & 
FLAG_Mask
;

1221 
I2Cx
->
SR1
 = (
uöt16_t
)~
Êagpos
;

1222 
	}
}

1246 
ITSètus
 
	$I2C_GëITSètus
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt32_t
 
I2C_IT
)

1248 
ITSètus
 
bô°©us
 = 
RESET
;

1249 
uöt32_t
 
íabÀ°©us
 = 0;

1252 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1253 
	`as£π_∑øm
(
	`IS_I2C_GET_IT
(
I2C_IT
));

1256 
íabÀ°©us
 = (
uöt32_t
)(((
I2C_IT
 & 
ITEN_Mask
Ë>> 16Ë& (
I2Cx
->
CR2
)) ;

1259 
I2C_IT
 &
FLAG_Mask
;

1262 i‡(((
I2Cx
->
SR1
 & 
I2C_IT
Ë!(
uöt32_t
)
RESET
Ë&& 
íabÀ°©us
)

1265 
bô°©us
 = 
SET
;

1270 
bô°©us
 = 
RESET
;

1273  
bô°©us
;

1274 
	}
}

1307 
	$I2C_CÀ¨ITPídögBô
(
I2C_Ty≥Def
* 
I2Cx
, 
uöt32_t
 
I2C_IT
)

1309 
uöt32_t
 
Êagpos
 = 0;

1311 
	`as£π_∑øm
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1312 
	`as£π_∑øm
(
	`IS_I2C_CLEAR_IT
(
I2C_IT
));

1314 
Êagpos
 = 
I2C_IT
 & 
FLAG_Mask
;

1316 
I2Cx
->
SR1
 = (
uöt16_t
)~
Êagpos
;

1317 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STCCCA~1.C

23 
	~"°m32f10x_wwdg.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#WWDG_OFFSET
 (
WWDG_BASE
 - 
PERIPH_BASE
)

	)

51 
	#CFR_OFFSET
 (
WWDG_OFFSET
 + 0x04)

	)

52 
	#EWI_BôNumbî
 0x09

	)

53 
	#CFR_EWI_BB
 (
PERIPH_BB_BASE
 + (
CFR_OFFSET
 * 32Ë+ (
EWI_BôNumbî
 * 4))

	)

58 
	#CR_WDGA_Së
 ((
uöt32_t
)0x00000080)

	)

61 
	#CFR_WDGTB_Mask
 ((
uöt32_t
)0xFFFFFE7F)

	)

62 
	#CFR_W_Mask
 ((
uöt32_t
)0xFFFFFF80)

	)

63 
	#BIT_Mask
 ((
uöt8_t
)0x7F)

	)

102 
	$WWDG_DeInô
()

104 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_WWDG
, 
ENABLE
);

105 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_WWDG
, 
DISABLE
);

106 
	}
}

118 
	$WWDG_SëPªsˇÀr
(
uöt32_t
 
WWDG_PªsˇÀr
)

120 
uöt32_t
 
tm¥eg
 = 0;

122 
	`as£π_∑øm
(
	`IS_WWDG_PRESCALER
(
WWDG_PªsˇÀr
));

124 
tm¥eg
 = 
WWDG
->
CFR
 & 
CFR_WDGTB_Mask
;

126 
tm¥eg
 |
WWDG_PªsˇÀr
;

128 
WWDG
->
CFR
 = 
tm¥eg
;

129 
	}
}

137 
	$WWDG_SëWödowVÆue
(
uöt8_t
 
WödowVÆue
)

139 
__IO
 
uöt32_t
 
tm¥eg
 = 0;

142 
	`as£π_∑øm
(
	`IS_WWDG_WINDOW_VALUE
(
WödowVÆue
));

145 
tm¥eg
 = 
WWDG
->
CFR
 & 
CFR_W_Mask
;

148 
tm¥eg
 |
WödowVÆue
 & (
uöt32_t
Ë
BIT_Mask
;

151 
WWDG
->
CFR
 = 
tm¥eg
;

152 
	}
}

159 
	$WWDG_E«bÀIT
()

161 *(
__IO
 
uöt32_t
 *Ë
CFR_EWI_BB
 = (uöt32_t)
ENABLE
;

162 
	}
}

170 
	$WWDG_SëCou¡î
(
uöt8_t
 
Cou¡î
)

173 
	`as£π_∑øm
(
	`IS_WWDG_COUNTER
(
Cou¡î
));

176 
WWDG
->
CR
 = 
Cou¡î
 & 
BIT_Mask
;

177 
	}
}

185 
	$WWDG_E«bÀ
(
uöt8_t
 
Cou¡î
)

188 
	`as£π_∑øm
(
	`IS_WWDG_COUNTER
(
Cou¡î
));

189 
WWDG
->
CR
 = 
CR_WDGA_Së
 | 
Cou¡î
;

190 
	}
}

197 
FœgSètus
 
	$WWDG_GëFœgSètus
()

199  (
FœgSètus
)(
WWDG
->
SR
);

200 
	}
}

207 
	$WWDG_CÀ¨Fœg
()

209 
WWDG
->
SR
 = (
uöt32_t
)
RESET
;

210 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STF68C~1.C

23 
	~"°m32f10x_dbgmcu.h
"

46 
	#IDCODE_DEVID_MASK
 ((
uöt32_t
)0x00000FFF)

	)

84 
uöt32_t
 
	$DBGMCU_GëREVID
()

86 (
DBGMCU
->
IDCODE
 >> 16);

87 
	}
}

94 
uöt32_t
 
	$DBGMCU_GëDEVID
()

96 (
DBGMCU
->
IDCODE
 & 
IDCODE_DEVID_MASK
);

97 
	}
}

134 
	$DBGMCU_C⁄fig
(
uöt32_t
 
DBGMCU_Pîùh
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

137 
	`as£π_∑øm
(
	`IS_DBGMCU_PERIPH
(
DBGMCU_Pîùh
));

138 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

140 i‡(
NewSèã
 !
DISABLE
)

142 
DBGMCU
->
CR
 |
DBGMCU_Pîùh
;

146 
DBGMCU
->
CR
 &~
DBGMCU_Pîùh
;

148 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STF6A9~1.C

23 
	~"°m32f10x_tim.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#SMCR_ETR_Mask
 ((
uöt16_t
)0x00FF)

	)

49 
	#CCMR_Off£t
 ((
uöt16_t
)0x0018)

	)

50 
	#CCER_CCE_Së
 ((
uöt16_t
)0x0001)

	)

51 
	#CCER_CCNE_Së
 ((
uöt16_t
)0x0004)

	)

77 
TI1_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

78 
uöt16_t
 
TIM_ICFûãr
);

79 
TI2_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

80 
uöt16_t
 
TIM_ICFûãr
);

81 
TI3_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

82 
uöt16_t
 
TIM_ICFûãr
);

83 
TI4_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

84 
uöt16_t
 
TIM_ICFûãr
);

122 
	$TIM_DeInô
(
TIM_Ty≥Def
* 
TIMx
)

125 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

127 i‡(
TIMx
 =
TIM1
)

129 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM1
, 
ENABLE
);

130 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM1
, 
DISABLE
);

132 i‡(
TIMx
 =
TIM2
)

134 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM2
, 
ENABLE
);

135 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM2
, 
DISABLE
);

137 i‡(
TIMx
 =
TIM3
)

139 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM3
, 
ENABLE
);

140 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM3
, 
DISABLE
);

142 i‡(
TIMx
 =
TIM4
)

144 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM4
, 
ENABLE
);

145 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM4
, 
DISABLE
);

147 i‡(
TIMx
 =
TIM5
)

149 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM5
, 
ENABLE
);

150 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM5
, 
DISABLE
);

152 i‡(
TIMx
 =
TIM6
)

154 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM6
, 
ENABLE
);

155 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM6
, 
DISABLE
);

157 i‡(
TIMx
 =
TIM7
)

159 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM7
, 
ENABLE
);

160 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM7
, 
DISABLE
);

162 i‡(
TIMx
 =
TIM8
)

164 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM8
, 
ENABLE
);

165 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM8
, 
DISABLE
);

167 i‡(
TIMx
 =
TIM9
)

169 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM9
, 
ENABLE
);

170 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM9
, 
DISABLE
);

172 i‡(
TIMx
 =
TIM10
)

174 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM10
, 
ENABLE
);

175 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM10
, 
DISABLE
);

177 i‡(
TIMx
 =
TIM11
)

179 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM11
, 
ENABLE
);

180 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM11
, 
DISABLE
);

182 i‡(
TIMx
 =
TIM12
)

184 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM12
, 
ENABLE
);

185 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM12
, 
DISABLE
);

187 i‡(
TIMx
 =
TIM13
)

189 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM13
, 
ENABLE
);

190 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM13
, 
DISABLE
);

192 i‡(
TIMx
 =
TIM14
)

194 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM14
, 
ENABLE
);

195 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_TIM14
, 
DISABLE
);

197 i‡(
TIMx
 =
TIM15
)

199 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM15
, 
ENABLE
);

200 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM15
, 
DISABLE
);

202 i‡(
TIMx
 =
TIM16
)

204 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM16
, 
ENABLE
);

205 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM16
, 
DISABLE
);

209 i‡(
TIMx
 =
TIM17
)

211 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM17
, 
ENABLE
);

212 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_TIM17
, 
DISABLE
);

215 
	}
}

226 
	$TIM_TimeBa£Inô
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_TimeBa£InôTy≥Def
* 
TIM_TimeBa£InôSåu˘
)

228 
uöt16_t
 
tmp¸1
 = 0;

231 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

232 
	`as£π_∑øm
(
	`IS_TIM_COUNTER_MODE
(
TIM_TimeBa£InôSåu˘
->
TIM_Cou¡îMode
));

233 
	`as£π_∑øm
(
	`IS_TIM_CKD_DIV
(
TIM_TimeBa£InôSåu˘
->
TIM_ClockDivisi⁄
));

235 
tmp¸1
 = 
TIMx
->
CR1
;

237 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
)|| (TIMx =
TIM2
Ë|| (TIMx =
TIM3
)||

238 (
TIMx
 =
TIM4
Ë|| (TIMx =
TIM5
))

241 
tmp¸1
 &(
uöt16_t
)(~((uöt16_t)(
TIM_CR1_DIR
 | 
TIM_CR1_CMS
)));

242 
tmp¸1
 |(
uöt32_t
)
TIM_TimeBa£InôSåu˘
->
TIM_Cou¡îMode
;

245 if((
TIMx
 !
TIM6
Ë&& (TIMx !
TIM7
))

248 
tmp¸1
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR1_CKD
));

249 
tmp¸1
 |(
uöt32_t
)
TIM_TimeBa£InôSåu˘
->
TIM_ClockDivisi⁄
;

252 
TIMx
->
CR1
 = 
tmp¸1
;

255 
TIMx
->
ARR
 = 
TIM_TimeBa£InôSåu˘
->
TIM_Pîiod
 ;

258 
TIMx
->
PSC
 = 
TIM_TimeBa£InôSåu˘
->
TIM_PªsˇÀr
;

260 i‡((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
)|| (TIMx =
TIM15
)|| (TIMx =
TIM16
Ë|| (TIMx =
TIM17
))

263 
TIMx
->
RCR
 = 
TIM_TimeBa£InôSåu˘
->
TIM_Rïëôi⁄Cou¡î
;

268 
TIMx
->
EGR
 = 
TIM_PSCRñﬂdMode_Immedüã
;

269 
	}
}

279 
	$TIM_OC1Inô
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_OCInôTy≥Def
* 
TIM_OCInôSåu˘
)

281 
uöt16_t
 
tmpccmrx
 = 0, 
tmpc˚r
 = 0, 
tmp¸2
 = 0;

284 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

285 
	`as£π_∑øm
(
	`IS_TIM_OC_MODE
(
TIM_OCInôSåu˘
->
TIM_OCMode
));

286 
	`as£π_∑øm
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
));

287 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
));

289 
TIMx
->
CCER
 &(
uöt16_t
)(~(uöt16_t)
TIM_CCER_CC1E
);

291 
tmpc˚r
 = 
TIMx
->
CCER
;

293 
tmp¸2
 = 
TIMx
->
CR2
;

296 
tmpccmrx
 = 
TIMx
->
CCMR1
;

299 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR1_OC1M
));

300 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR1_CC1S
));

303 
tmpccmrx
 |
TIM_OCInôSåu˘
->
TIM_OCMode
;

306 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC1P
));

308 
tmpc˚r
 |
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
;

311 
tmpc˚r
 |
TIM_OCInôSåu˘
->
TIM_OuçutSèã
;

313 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
)|| (TIMx =
TIM15
)||

314 (
TIMx
 =
TIM16
)|| (TIMx =
TIM17
))

316 
	`as£π_∑øm
(
	`IS_TIM_OUTPUTN_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
));

317 
	`as£π_∑øm
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
));

318 
	`as£π_∑øm
(
	`IS_TIM_OCNIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
));

319 
	`as£π_∑øm
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
));

322 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC1NP
));

324 
tmpc˚r
 |
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
;

327 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC1NE
));

329 
tmpc˚r
 |
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
;

332 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS1
));

333 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS1N
));

336 
tmp¸2
 |
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
;

338 
tmp¸2
 |
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
;

341 
TIMx
->
CR2
 = 
tmp¸2
;

344 
TIMx
->
CCMR1
 = 
tmpccmrx
;

347 
TIMx
->
CCR1
 = 
TIM_OCInôSåu˘
->
TIM_Pul£
;

350 
TIMx
->
CCER
 = 
tmpc˚r
;

351 
	}
}

362 
	$TIM_OC2Inô
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_OCInôTy≥Def
* 
TIM_OCInôSåu˘
)

364 
uöt16_t
 
tmpccmrx
 = 0, 
tmpc˚r
 = 0, 
tmp¸2
 = 0;

367 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

368 
	`as£π_∑øm
(
	`IS_TIM_OC_MODE
(
TIM_OCInôSåu˘
->
TIM_OCMode
));

369 
	`as£π_∑øm
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
));

370 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
));

372 
TIMx
->
CCER
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC2E
));

375 
tmpc˚r
 = 
TIMx
->
CCER
;

377 
tmp¸2
 = 
TIMx
->
CR2
;

380 
tmpccmrx
 = 
TIMx
->
CCMR1
;

383 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR1_OC2M
));

384 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR1_CC2S
));

387 
tmpccmrx
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCMode
 << 8);

390 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC2P
));

392 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
 << 4);

395 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
 << 4);

397 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
))

399 
	`as£π_∑øm
(
	`IS_TIM_OUTPUTN_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
));

400 
	`as£π_∑øm
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
));

401 
	`as£π_∑øm
(
	`IS_TIM_OCNIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
));

402 
	`as£π_∑øm
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
));

405 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC2NP
));

407 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
 << 4);

410 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC2NE
));

412 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
 << 4);

415 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS2
));

416 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS2N
));

419 
tmp¸2
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
 << 2);

421 
tmp¸2
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
 << 2);

424 
TIMx
->
CR2
 = 
tmp¸2
;

427 
TIMx
->
CCMR1
 = 
tmpccmrx
;

430 
TIMx
->
CCR2
 = 
TIM_OCInôSåu˘
->
TIM_Pul£
;

433 
TIMx
->
CCER
 = 
tmpc˚r
;

434 
	}
}

444 
	$TIM_OC3Inô
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_OCInôTy≥Def
* 
TIM_OCInôSåu˘
)

446 
uöt16_t
 
tmpccmrx
 = 0, 
tmpc˚r
 = 0, 
tmp¸2
 = 0;

449 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

450 
	`as£π_∑øm
(
	`IS_TIM_OC_MODE
(
TIM_OCInôSåu˘
->
TIM_OCMode
));

451 
	`as£π_∑øm
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
));

452 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
));

454 
TIMx
->
CCER
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC3E
));

457 
tmpc˚r
 = 
TIMx
->
CCER
;

459 
tmp¸2
 = 
TIMx
->
CR2
;

462 
tmpccmrx
 = 
TIMx
->
CCMR2
;

465 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR2_OC3M
));

466 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR2_CC3S
));

468 
tmpccmrx
 |
TIM_OCInôSåu˘
->
TIM_OCMode
;

471 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC3P
));

473 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
 << 8);

476 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
 << 8);

478 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
))

480 
	`as£π_∑øm
(
	`IS_TIM_OUTPUTN_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
));

481 
	`as£π_∑øm
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
));

482 
	`as£π_∑øm
(
	`IS_TIM_OCNIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
));

483 
	`as£π_∑øm
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
));

486 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC3NP
));

488 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
 << 8);

490 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC3NE
));

493 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
 << 8);

495 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS3
));

496 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS3N
));

498 
tmp¸2
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
 << 4);

500 
tmp¸2
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
 << 4);

503 
TIMx
->
CR2
 = 
tmp¸2
;

506 
TIMx
->
CCMR2
 = 
tmpccmrx
;

509 
TIMx
->
CCR3
 = 
TIM_OCInôSåu˘
->
TIM_Pul£
;

512 
TIMx
->
CCER
 = 
tmpc˚r
;

513 
	}
}

523 
	$TIM_OC4Inô
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_OCInôTy≥Def
* 
TIM_OCInôSåu˘
)

525 
uöt16_t
 
tmpccmrx
 = 0, 
tmpc˚r
 = 0, 
tmp¸2
 = 0;

528 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

529 
	`as£π_∑øm
(
	`IS_TIM_OC_MODE
(
TIM_OCInôSåu˘
->
TIM_OCMode
));

530 
	`as£π_∑øm
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
));

531 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
));

533 
TIMx
->
CCER
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC4E
));

536 
tmpc˚r
 = 
TIMx
->
CCER
;

538 
tmp¸2
 = 
TIMx
->
CR2
;

541 
tmpccmrx
 = 
TIMx
->
CCMR2
;

544 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR2_OC4M
));

545 
tmpccmrx
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCMR2_CC4S
));

548 
tmpccmrx
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCMode
 << 8);

551 
tmpc˚r
 &(
uöt16_t
)(~((uöt16_t)
TIM_CCER_CC4P
));

553 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
 << 12);

556 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OuçutSèã
 << 12);

558 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
))

560 
	`as£π_∑øm
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
));

562 
tmp¸2
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR2_OIS4
));

564 
tmp¸2
 |(
uöt16_t
)(
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
 << 6);

567 
TIMx
->
CR2
 = 
tmp¸2
;

570 
TIMx
->
CCMR2
 = 
tmpccmrx
;

573 
TIMx
->
CCR4
 = 
TIM_OCInôSåu˘
->
TIM_Pul£
;

576 
TIMx
->
CCER
 = 
tmpc˚r
;

577 
	}
}

587 
	$TIM_ICInô
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_ICInôTy≥Def
* 
TIM_ICInôSåu˘
)

590 
	`as£π_∑øm
(
	`IS_TIM_CHANNEL
(
TIM_ICInôSåu˘
->
TIM_Ch™√l
));

591 
	`as£π_∑øm
(
	`IS_TIM_IC_SELECTION
(
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
));

592 
	`as£π_∑øm
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
));

593 
	`as£π_∑øm
(
	`IS_TIM_IC_FILTER
(
TIM_ICInôSåu˘
->
TIM_ICFûãr
));

595 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
Ë|| (TIMx =
TIM2
Ë|| (TIMx =
TIM3
) ||

596 (
TIMx
 =
TIM4
Ë||(TIMx =
TIM5
))

598 
	`as£π_∑øm
(
	`IS_TIM_IC_POLARITY
(
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
));

602 
	`as£π_∑øm
(
	`IS_TIM_IC_POLARITY_LITE
(
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
));

604 i‡(
TIM_ICInôSåu˘
->
TIM_Ch™√l
 =
TIM_Ch™√l_1
)

606 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

608 
	`TI1_C⁄fig
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
,

609 
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
,

610 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

612 
	`TIM_SëIC1PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

614 i‡(
TIM_ICInôSåu˘
->
TIM_Ch™√l
 =
TIM_Ch™√l_2
)

616 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

618 
	`TI2_C⁄fig
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
,

619 
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
,

620 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

622 
	`TIM_SëIC2PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

624 i‡(
TIM_ICInôSåu˘
->
TIM_Ch™√l
 =
TIM_Ch™√l_3
)

626 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

628 
	`TI3_C⁄fig
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
,

629 
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
,

630 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

632 
	`TIM_SëIC3PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

636 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

638 
	`TI4_C⁄fig
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
,

639 
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
,

640 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

642 
	`TIM_SëIC4PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

644 
	}
}

654 
	$TIM_PWMIC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_ICInôTy≥Def
* 
TIM_ICInôSåu˘
)

656 
uöt16_t
 
ic›posôïﬁ¨ôy
 = 
TIM_ICPﬁ¨ôy_Risög
;

657 
uöt16_t
 
ic›posôe£À˘i⁄
 = 
TIM_ICSñe˘i⁄_Dúe˘TI
;

659 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

661 i‡(
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
 =
TIM_ICPﬁ¨ôy_Risög
)

663 
ic›posôïﬁ¨ôy
 = 
TIM_ICPﬁ¨ôy_FÆlög
;

667 
ic›posôïﬁ¨ôy
 = 
TIM_ICPﬁ¨ôy_Risög
;

670 i‡(
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
 =
TIM_ICSñe˘i⁄_Dúe˘TI
)

672 
ic›posôe£À˘i⁄
 = 
TIM_ICSñe˘i⁄_Indúe˘TI
;

676 
ic›posôe£À˘i⁄
 = 
TIM_ICSñe˘i⁄_Dúe˘TI
;

678 i‡(
TIM_ICInôSåu˘
->
TIM_Ch™√l
 =
TIM_Ch™√l_1
)

681 
	`TI1_C⁄fig
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
, TIM_ICInôSåu˘->
TIM_ICSñe˘i⁄
,

682 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

684 
	`TIM_SëIC1PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

686 
	`TI2_C⁄fig
(
TIMx
, 
ic›posôïﬁ¨ôy
, 
ic›posôe£À˘i⁄
, 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

688 
	`TIM_SëIC2PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

693 
	`TI2_C⁄fig
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
, TIM_ICInôSåu˘->
TIM_ICSñe˘i⁄
,

694 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

696 
	`TIM_SëIC2PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

698 
	`TI1_C⁄fig
(
TIMx
, 
ic›posôïﬁ¨ôy
, 
ic›posôe£À˘i⁄
, 
TIM_ICInôSåu˘
->
TIM_ICFûãr
);

700 
	`TIM_SëIC1PªsˇÀr
(
TIMx
, 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
);

702 
	}
}

712 
	$TIM_BDTRC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
TIM_BDTRInôTy≥Def
 *
TIM_BDTRInôSåu˘
)

715 
	`as£π_∑øm
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

716 
	`as£π_∑øm
(
	`IS_TIM_OSSR_STATE
(
TIM_BDTRInôSåu˘
->
TIM_OSSRSèã
));

717 
	`as£π_∑øm
(
	`IS_TIM_OSSI_STATE
(
TIM_BDTRInôSåu˘
->
TIM_OSSISèã
));

718 
	`as£π_∑øm
(
	`IS_TIM_LOCK_LEVEL
(
TIM_BDTRInôSåu˘
->
TIM_LOCKLevñ
));

719 
	`as£π_∑øm
(
	`IS_TIM_BREAK_STATE
(
TIM_BDTRInôSåu˘
->
TIM_Bªak
));

720 
	`as£π_∑øm
(
	`IS_TIM_BREAK_POLARITY
(
TIM_BDTRInôSåu˘
->
TIM_BªakPﬁ¨ôy
));

721 
	`as£π_∑øm
(
	`IS_TIM_AUTOMATIC_OUTPUT_STATE
(
TIM_BDTRInôSåu˘
->
TIM_Autom©icOuçut
));

724 
TIMx
->
BDTR
 = (
uöt32_t
)
TIM_BDTRInôSåu˘
->
TIM_OSSRSèã
 | TIM_BDTRInôSåu˘->
TIM_OSSISèã
 |

725 
TIM_BDTRInôSåu˘
->
TIM_LOCKLevñ
 | TIM_BDTRInôSåu˘->
TIM_DódTime
 |

726 
TIM_BDTRInôSåu˘
->
TIM_Bªak
 | TIM_BDTRInôSåu˘->
TIM_BªakPﬁ¨ôy
 |

727 
TIM_BDTRInôSåu˘
->
TIM_Autom©icOuçut
;

728 
	}
}

736 
	$TIM_TimeBa£Såu˘Inô
(
TIM_TimeBa£InôTy≥Def
* 
TIM_TimeBa£InôSåu˘
)

739 
TIM_TimeBa£InôSåu˘
->
TIM_Pîiod
 = 0xFFFF;

740 
TIM_TimeBa£InôSåu˘
->
TIM_PªsˇÀr
 = 0x0000;

741 
TIM_TimeBa£InôSåu˘
->
TIM_ClockDivisi⁄
 = 
TIM_CKD_DIV1
;

742 
TIM_TimeBa£InôSåu˘
->
TIM_Cou¡îMode
 = 
TIM_Cou¡îMode_Up
;

743 
TIM_TimeBa£InôSåu˘
->
TIM_Rïëôi⁄Cou¡î
 = 0x0000;

744 
	}
}

752 
	$TIM_OCSåu˘Inô
(
TIM_OCInôTy≥Def
* 
TIM_OCInôSåu˘
)

755 
TIM_OCInôSåu˘
->
TIM_OCMode
 = 
TIM_OCMode_Timög
;

756 
TIM_OCInôSåu˘
->
TIM_OuçutSèã
 = 
TIM_OuçutSèã_DißbÀ
;

757 
TIM_OCInôSåu˘
->
TIM_OuçutNSèã
 = 
TIM_OuçutNSèã_DißbÀ
;

758 
TIM_OCInôSåu˘
->
TIM_Pul£
 = 0x0000;

759 
TIM_OCInôSåu˘
->
TIM_OCPﬁ¨ôy
 = 
TIM_OCPﬁ¨ôy_High
;

760 
TIM_OCInôSåu˘
->
TIM_OCNPﬁ¨ôy
 = 
TIM_OCPﬁ¨ôy_High
;

761 
TIM_OCInôSåu˘
->
TIM_OCIdÀSèã
 = 
TIM_OCIdÀSèã_Re£t
;

762 
TIM_OCInôSåu˘
->
TIM_OCNIdÀSèã
 = 
TIM_OCNIdÀSèã_Re£t
;

763 
	}
}

771 
	$TIM_ICSåu˘Inô
(
TIM_ICInôTy≥Def
* 
TIM_ICInôSåu˘
)

774 
TIM_ICInôSåu˘
->
TIM_Ch™√l
 = 
TIM_Ch™√l_1
;

775 
TIM_ICInôSåu˘
->
TIM_ICPﬁ¨ôy
 = 
TIM_ICPﬁ¨ôy_Risög
;

776 
TIM_ICInôSåu˘
->
TIM_ICSñe˘i⁄
 = 
TIM_ICSñe˘i⁄_Dúe˘TI
;

777 
TIM_ICInôSåu˘
->
TIM_ICPªsˇÀr
 = 
TIM_ICPSC_DIV1
;

778 
TIM_ICInôSåu˘
->
TIM_ICFûãr
 = 0x00;

779 
	}
}

787 
	$TIM_BDTRSåu˘Inô
(
TIM_BDTRInôTy≥Def
* 
TIM_BDTRInôSåu˘
)

790 
TIM_BDTRInôSåu˘
->
TIM_OSSRSèã
 = 
TIM_OSSRSèã_DißbÀ
;

791 
TIM_BDTRInôSåu˘
->
TIM_OSSISèã
 = 
TIM_OSSISèã_DißbÀ
;

792 
TIM_BDTRInôSåu˘
->
TIM_LOCKLevñ
 = 
TIM_LOCKLevñ_OFF
;

793 
TIM_BDTRInôSåu˘
->
TIM_DódTime
 = 0x00;

794 
TIM_BDTRInôSåu˘
->
TIM_Bªak
 = 
TIM_Bªak_DißbÀ
;

795 
TIM_BDTRInôSåu˘
->
TIM_BªakPﬁ¨ôy
 = 
TIM_BªakPﬁ¨ôy_Low
;

796 
TIM_BDTRInôSåu˘
->
TIM_Autom©icOuçut
 = 
TIM_Autom©icOuçut_DißbÀ
;

797 
	}
}

806 
	$TIM_Cmd
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

809 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

810 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

812 i‡(
NewSèã
 !
DISABLE
)

815 
TIMx
->
CR1
 |
TIM_CR1_CEN
;

820 
TIMx
->
CR1
 &(
uöt16_t
)(~((uöt16_t)
TIM_CR1_CEN
));

822 
	}
}

831 
	$TIM_CålPWMOuçuts
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

834 
	`as£π_∑øm
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

835 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

836 i‡(
NewSèã
 !
DISABLE
)

839 
TIMx
->
BDTR
 |
TIM_BDTR_MOE
;

844 
TIMx
->
BDTR
 &(
uöt16_t
)(~((uöt16_t)
TIM_BDTR_MOE
));

846 
	}
}

872 
	$TIM_ITC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

875 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

876 
	`as£π_∑øm
(
	`IS_TIM_IT
(
TIM_IT
));

877 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

879 i‡(
NewSèã
 !
DISABLE
)

882 
TIMx
->
DIER
 |
TIM_IT
;

887 
TIMx
->
DIER
 &(
uöt16_t
)~
TIM_IT
;

889 
	}
}

909 
	$TIM_Gíî©eEvít
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_EvítSour˚
)

912 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

913 
	`as£π_∑øm
(
	`IS_TIM_EVENT_SOURCE
(
TIM_EvítSour˚
));

916 
TIMx
->
EGR
 = 
TIM_EvítSour˚
;

917 
	}
}

937 
	$TIM_DMAC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_DMABa£
, uöt16_à
TIM_DMABur°Lígth
)

940 
	`as£π_∑øm
(
	`IS_TIM_LIST4_PERIPH
(
TIMx
));

941 
	`as£π_∑øm
(
	`IS_TIM_DMA_BASE
(
TIM_DMABa£
));

942 
	`as£π_∑øm
(
	`IS_TIM_DMA_LENGTH
(
TIM_DMABur°Lígth
));

944 
TIMx
->
DCR
 = 
TIM_DMABa£
 | 
TIM_DMABur°Lígth
;

945 
	}
}

964 
	$TIM_DMACmd
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_DMASour˚
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

967 
	`as£π_∑øm
(
	`IS_TIM_LIST9_PERIPH
(
TIMx
));

968 
	`as£π_∑øm
(
	`IS_TIM_DMA_SOURCE
(
TIM_DMASour˚
));

969 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

971 i‡(
NewSèã
 !
DISABLE
)

974 
TIMx
->
DIER
 |
TIM_DMASour˚
;

979 
TIMx
->
DIER
 &(
uöt16_t
)~
TIM_DMASour˚
;

981 
	}
}

989 
	$TIM_I¡î«lClockC⁄fig
(
TIM_Ty≥Def
* 
TIMx
)

992 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

994 
TIMx
->
SMCR
 &(
uöt16_t
)(~((uöt16_t)
TIM_SMCR_SMS
));

995 
	}
}

1008 
	$TIM_ITRxExã∫ÆClockC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_I≈utTriggîSour˚
)

1011 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1012 
	`as£π_∑øm
(
	`IS_TIM_INTERNAL_TRIGGER_SELECTION
(
TIM_I≈utTriggîSour˚
));

1014 
	`TIM_Sñe˘I≈utTriggî
(
TIMx
, 
TIM_I≈utTriggîSour˚
);

1016 
TIMx
->
SMCR
 |
TIM_SœveMode_Exã∫Æ1
;

1017 
	}
}

1035 
	$TIM_TIxExã∫ÆClockC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_TIxExã∫ÆCLKSour˚
,

1036 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
ICFûãr
)

1039 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1040 
	`as£π_∑øm
(
	`IS_TIM_TIXCLK_SOURCE
(
TIM_TIxExã∫ÆCLKSour˚
));

1041 
	`as£π_∑øm
(
	`IS_TIM_IC_POLARITY
(
TIM_ICPﬁ¨ôy
));

1042 
	`as£π_∑øm
(
	`IS_TIM_IC_FILTER
(
ICFûãr
));

1044 i‡(
TIM_TIxExã∫ÆCLKSour˚
 =
TIM_TIxExã∫ÆCLK1Sour˚_TI2
)

1046 
	`TI2_C⁄fig
(
TIMx
, 
TIM_ICPﬁ¨ôy
, 
TIM_ICSñe˘i⁄_Dúe˘TI
, 
ICFûãr
);

1050 
	`TI1_C⁄fig
(
TIMx
, 
TIM_ICPﬁ¨ôy
, 
TIM_ICSñe˘i⁄_Dúe˘TI
, 
ICFûãr
);

1053 
	`TIM_Sñe˘I≈utTriggî
(
TIMx
, 
TIM_TIxExã∫ÆCLKSour˚
);

1055 
TIMx
->
SMCR
 |
TIM_SœveMode_Exã∫Æ1
;

1056 
	}
}

1075 
	$TIM_ETRClockMode1C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ExtTRGPªsˇÀr
, uöt16_à
TIM_ExtTRGPﬁ¨ôy
,

1076 
uöt16_t
 
ExtTRGFûãr
)

1078 
uöt16_t
 
tmpsm¸
 = 0;

1080 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1081 
	`as£π_∑øm
(
	`IS_TIM_EXT_PRESCALER
(
TIM_ExtTRGPªsˇÀr
));

1082 
	`as£π_∑øm
(
	`IS_TIM_EXT_POLARITY
(
TIM_ExtTRGPﬁ¨ôy
));

1083 
	`as£π_∑øm
(
	`IS_TIM_EXT_FILTER
(
ExtTRGFûãr
));

1085 
	`TIM_ETRC⁄fig
(
TIMx
, 
TIM_ExtTRGPªsˇÀr
, 
TIM_ExtTRGPﬁ¨ôy
, 
ExtTRGFûãr
);

1088 
tmpsm¸
 = 
TIMx
->
SMCR
;

1090 
tmpsm¸
 &(
uöt16_t
)(~((uöt16_t)
TIM_SMCR_SMS
));

1092 
tmpsm¸
 |
TIM_SœveMode_Exã∫Æ1
;

1094 
tmpsm¸
 &(
uöt16_t
)(~((uöt16_t)
TIM_SMCR_TS
));

1095 
tmpsm¸
 |
TIM_TS_ETRF
;

1097 
TIMx
->
SMCR
 = 
tmpsm¸
;

1098 
	}
}

1117 
	$TIM_ETRClockMode2C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ExtTRGPªsˇÀr
,

1118 
uöt16_t
 
TIM_ExtTRGPﬁ¨ôy
, uöt16_à
ExtTRGFûãr
)

1121 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1122 
	`as£π_∑øm
(
	`IS_TIM_EXT_PRESCALER
(
TIM_ExtTRGPªsˇÀr
));

1123 
	`as£π_∑øm
(
	`IS_TIM_EXT_POLARITY
(
TIM_ExtTRGPﬁ¨ôy
));

1124 
	`as£π_∑øm
(
	`IS_TIM_EXT_FILTER
(
ExtTRGFûãr
));

1126 
	`TIM_ETRC⁄fig
(
TIMx
, 
TIM_ExtTRGPªsˇÀr
, 
TIM_ExtTRGPﬁ¨ôy
, 
ExtTRGFûãr
);

1128 
TIMx
->
SMCR
 |
TIM_SMCR_ECE
;

1129 
	}
}

1148 
	$TIM_ETRC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ExtTRGPªsˇÀr
, uöt16_à
TIM_ExtTRGPﬁ¨ôy
,

1149 
uöt16_t
 
ExtTRGFûãr
)

1151 
uöt16_t
 
tmpsm¸
 = 0;

1153 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1154 
	`as£π_∑øm
(
	`IS_TIM_EXT_PRESCALER
(
TIM_ExtTRGPªsˇÀr
));

1155 
	`as£π_∑øm
(
	`IS_TIM_EXT_POLARITY
(
TIM_ExtTRGPﬁ¨ôy
));

1156 
	`as£π_∑øm
(
	`IS_TIM_EXT_FILTER
(
ExtTRGFûãr
));

1157 
tmpsm¸
 = 
TIMx
->
SMCR
;

1159 
tmpsm¸
 &
SMCR_ETR_Mask
;

1161 
tmpsm¸
 |(
uöt16_t
)(
TIM_ExtTRGPªsˇÀr
 | (uöt16_t)(
TIM_ExtTRGPﬁ¨ôy
 | (uöt16_t)(
ExtTRGFûãr
 << (uint16_t)8)));

1163 
TIMx
->
SMCR
 = 
tmpsm¸
;

1164 
	}
}

1176 
	$TIM_PªsˇÀrC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
PªsˇÀr
, uöt16_à
TIM_PSCRñﬂdMode
)

1179 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

1180 
	`as£π_∑øm
(
	`IS_TIM_PRESCALER_RELOAD
(
TIM_PSCRñﬂdMode
));

1182 
TIMx
->
PSC
 = 
PªsˇÀr
;

1184 
TIMx
->
EGR
 = 
TIM_PSCRñﬂdMode
;

1185 
	}
}

1199 
	$TIM_Cou¡îModeC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_Cou¡îMode
)

1201 
uöt16_t
 
tmp¸1
 = 0;

1203 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1204 
	`as£π_∑øm
(
	`IS_TIM_COUNTER_MODE
(
TIM_Cou¡îMode
));

1205 
tmp¸1
 = 
TIMx
->
CR1
;

1207 
tmp¸1
 &(
uöt16_t
)(~((uöt16_t)(
TIM_CR1_DIR
 | 
TIM_CR1_CMS
)));

1209 
tmp¸1
 |
TIM_Cou¡îMode
;

1211 
TIMx
->
CR1
 = 
tmp¸1
;

1212 
	}
}

1229 
	$TIM_Sñe˘I≈utTriggî
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_I≈utTriggîSour˚
)

1231 
uöt16_t
 
tmpsm¸
 = 0;

1233 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1234 
	`as£π_∑øm
(
	`IS_TIM_TRIGGER_SELECTION
(
TIM_I≈utTriggîSour˚
));

1236 
tmpsm¸
 = 
TIMx
->
SMCR
;

1238 
tmpsm¸
 &(
uöt16_t
)(~((uöt16_t)
TIM_SMCR_TS
));

1240 
tmpsm¸
 |
TIM_I≈utTriggîSour˚
;

1242 
TIMx
->
SMCR
 = 
tmpsm¸
;

1243 
	}
}

1264 
	$TIM_EncodîI¡îÁ˚C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_EncodîMode
,

1265 
uöt16_t
 
TIM_IC1Pﬁ¨ôy
, uöt16_à
TIM_IC2Pﬁ¨ôy
)

1267 
uöt16_t
 
tmpsm¸
 = 0;

1268 
uöt16_t
 
tmpccmr1
 = 0;

1269 
uöt16_t
 
tmpc˚r
 = 0;

1272 
	`as£π_∑øm
(
	`IS_TIM_LIST5_PERIPH
(
TIMx
));

1273 
	`as£π_∑øm
(
	`IS_TIM_ENCODER_MODE
(
TIM_EncodîMode
));

1274 
	`as£π_∑øm
(
	`IS_TIM_IC_POLARITY
(
TIM_IC1Pﬁ¨ôy
));

1275 
	`as£π_∑øm
(
	`IS_TIM_IC_POLARITY
(
TIM_IC2Pﬁ¨ôy
));

1278 
tmpsm¸
 = 
TIMx
->
SMCR
;

1281 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1284 
tmpc˚r
 = 
TIMx
->
CCER
;

1287 
tmpsm¸
 &(
uöt16_t
)(~((uöt16_t)
TIM_SMCR_SMS
));

1288 
tmpsm¸
 |
TIM_EncodîMode
;

1291 
tmpccmr1
 &(
uöt16_t
)(((uöt16_t)~((uöt16_t)
TIM_CCMR1_CC1S
)Ë& (uöt16_t)(~((uöt16_t)
TIM_CCMR1_CC2S
)));

1292 
tmpccmr1
 |
TIM_CCMR1_CC1S_0
 | 
TIM_CCMR1_CC2S_0
;

1295 
tmpc˚r
 &(
uöt16_t
)(((uöt16_t)~((uöt16_t)
TIM_CCER_CC1P
)Ë& ((uöt16_t)~((uöt16_t)
TIM_CCER_CC2P
)));

1296 
tmpc˚r
 |(
uöt16_t
)(
TIM_IC1Pﬁ¨ôy
 | (uöt16_t)(
TIM_IC2Pﬁ¨ôy
 << (uint16_t)4));

1299 
TIMx
->
SMCR
 = 
tmpsm¸
;

1301 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1303 
TIMx
->
CCER
 = 
tmpc˚r
;

1304 
	}
}

1315 
	$TIM_F‹˚dOC1C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_F‹˚dA˘i⁄
)

1317 
uöt16_t
 
tmpccmr1
 = 0;

1319 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1320 
	`as£π_∑øm
(
	`IS_TIM_FORCED_ACTION
(
TIM_F‹˚dA˘i⁄
));

1321 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1323 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC1M
);

1325 
tmpccmr1
 |
TIM_F‹˚dA˘i⁄
;

1327 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1328 
	}
}

1339 
	$TIM_F‹˚dOC2C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_F‹˚dA˘i⁄
)

1341 
uöt16_t
 
tmpccmr1
 = 0;

1343 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1344 
	`as£π_∑øm
(
	`IS_TIM_FORCED_ACTION
(
TIM_F‹˚dA˘i⁄
));

1345 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1347 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC2M
);

1349 
tmpccmr1
 |(
uöt16_t
)(
TIM_F‹˚dA˘i⁄
 << 8);

1351 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1352 
	}
}

1363 
	$TIM_F‹˚dOC3C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_F‹˚dA˘i⁄
)

1365 
uöt16_t
 
tmpccmr2
 = 0;

1367 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1368 
	`as£π_∑øm
(
	`IS_TIM_FORCED_ACTION
(
TIM_F‹˚dA˘i⁄
));

1369 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1371 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC3M
);

1373 
tmpccmr2
 |
TIM_F‹˚dA˘i⁄
;

1375 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1376 
	}
}

1387 
	$TIM_F‹˚dOC4C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_F‹˚dA˘i⁄
)

1389 
uöt16_t
 
tmpccmr2
 = 0;

1391 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1392 
	`as£π_∑øm
(
	`IS_TIM_FORCED_ACTION
(
TIM_F‹˚dA˘i⁄
));

1393 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1395 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC4M
);

1397 
tmpccmr2
 |(
uöt16_t
)(
TIM_F‹˚dA˘i⁄
 << 8);

1399 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1400 
	}
}

1409 
	$TIM_ARRPªlﬂdC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1412 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

1413 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1414 i‡(
NewSèã
 !
DISABLE
)

1417 
TIMx
->
CR1
 |
TIM_CR1_ARPE
;

1422 
TIMx
->
CR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CR1_ARPE
);

1424 
	}
}

1433 
	$TIM_Sñe˘COM
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1436 
	`as£π_∑øm
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

1437 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1438 i‡(
NewSèã
 !
DISABLE
)

1441 
TIMx
->
CR2
 |
TIM_CR2_CCUS
;

1446 
TIMx
->
CR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CR2_CCUS
);

1448 
	}
}

1458 
	$TIM_Sñe˘CCDMA
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1461 
	`as£π_∑øm
(
	`IS_TIM_LIST4_PERIPH
(
TIMx
));

1462 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1463 i‡(
NewSèã
 !
DISABLE
)

1466 
TIMx
->
CR2
 |
TIM_CR2_CCDS
;

1471 
TIMx
->
CR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CR2_CCDS
);

1473 
	}
}

1483 
	$TIM_CCPªlﬂdC⁄åﬁ
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1486 
	`as£π_∑øm
(
	`IS_TIM_LIST5_PERIPH
(
TIMx
));

1487 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1488 i‡(
NewSèã
 !
DISABLE
)

1491 
TIMx
->
CR2
 |
TIM_CR2_CCPC
;

1496 
TIMx
->
CR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CR2_CCPC
);

1498 
	}
}

1509 
	$TIM_OC1PªlﬂdC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPªlﬂd
)

1511 
uöt16_t
 
tmpccmr1
 = 0;

1513 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1514 
	`as£π_∑øm
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPªlﬂd
));

1515 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1517 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC1PE
);

1519 
tmpccmr1
 |
TIM_OCPªlﬂd
;

1521 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1522 
	}
}

1534 
	$TIM_OC2PªlﬂdC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPªlﬂd
)

1536 
uöt16_t
 
tmpccmr1
 = 0;

1538 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1539 
	`as£π_∑øm
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPªlﬂd
));

1540 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1542 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC2PE
);

1544 
tmpccmr1
 |(
uöt16_t
)(
TIM_OCPªlﬂd
 << 8);

1546 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1547 
	}
}

1558 
	$TIM_OC3PªlﬂdC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPªlﬂd
)

1560 
uöt16_t
 
tmpccmr2
 = 0;

1562 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1563 
	`as£π_∑øm
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPªlﬂd
));

1564 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1566 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC3PE
);

1568 
tmpccmr2
 |
TIM_OCPªlﬂd
;

1570 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1571 
	}
}

1582 
	$TIM_OC4PªlﬂdC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPªlﬂd
)

1584 
uöt16_t
 
tmpccmr2
 = 0;

1586 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1587 
	`as£π_∑øm
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPªlﬂd
));

1588 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1590 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC4PE
);

1592 
tmpccmr2
 |(
uöt16_t
)(
TIM_OCPªlﬂd
 << 8);

1594 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1595 
	}
}

1606 
	$TIM_OC1Fa°C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCFa°
)

1608 
uöt16_t
 
tmpccmr1
 = 0;

1610 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1611 
	`as£π_∑øm
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa°
));

1613 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1615 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC1FE
);

1617 
tmpccmr1
 |
TIM_OCFa°
;

1619 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1620 
	}
}

1632 
	$TIM_OC2Fa°C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCFa°
)

1634 
uöt16_t
 
tmpccmr1
 = 0;

1636 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1637 
	`as£π_∑øm
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa°
));

1639 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1641 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC2FE
);

1643 
tmpccmr1
 |(
uöt16_t
)(
TIM_OCFa°
 << 8);

1645 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1646 
	}
}

1657 
	$TIM_OC3Fa°C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCFa°
)

1659 
uöt16_t
 
tmpccmr2
 = 0;

1661 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1662 
	`as£π_∑øm
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa°
));

1664 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1666 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC3FE
);

1668 
tmpccmr2
 |
TIM_OCFa°
;

1670 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1671 
	}
}

1682 
	$TIM_OC4Fa°C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCFa°
)

1684 
uöt16_t
 
tmpccmr2
 = 0;

1686 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1687 
	`as£π_∑øm
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa°
));

1689 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1691 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC4FE
);

1693 
tmpccmr2
 |(
uöt16_t
)(
TIM_OCFa°
 << 8);

1695 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1696 
	}
}

1707 
	$TIM_CÀ¨OC1Ref
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCCÀ¨
)

1709 
uöt16_t
 
tmpccmr1
 = 0;

1711 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1712 
	`as£π_∑øm
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCÀ¨
));

1714 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1717 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC1CE
);

1719 
tmpccmr1
 |
TIM_OCCÀ¨
;

1721 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1722 
	}
}

1733 
	$TIM_CÀ¨OC2Ref
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCCÀ¨
)

1735 
uöt16_t
 
tmpccmr1
 = 0;

1737 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1738 
	`as£π_∑øm
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCÀ¨
));

1739 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1741 
tmpccmr1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_OC2CE
);

1743 
tmpccmr1
 |(
uöt16_t
)(
TIM_OCCÀ¨
 << 8);

1745 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1746 
	}
}

1757 
	$TIM_CÀ¨OC3Ref
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCCÀ¨
)

1759 
uöt16_t
 
tmpccmr2
 = 0;

1761 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1762 
	`as£π_∑øm
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCÀ¨
));

1763 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1765 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC3CE
);

1767 
tmpccmr2
 |
TIM_OCCÀ¨
;

1769 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1770 
	}
}

1781 
	$TIM_CÀ¨OC4Ref
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCCÀ¨
)

1783 
uöt16_t
 
tmpccmr2
 = 0;

1785 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1786 
	`as£π_∑øm
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCÀ¨
));

1787 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1789 
tmpccmr2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_OC4CE
);

1791 
tmpccmr2
 |(
uöt16_t
)(
TIM_OCCÀ¨
 << 8);

1793 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1794 
	}
}

1805 
	$TIM_OC1Pﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPﬁ¨ôy
)

1807 
uöt16_t
 
tmpc˚r
 = 0;

1809 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1810 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPﬁ¨ôy
));

1811 
tmpc˚r
 = 
TIMx
->
CCER
;

1813 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC1P
);

1814 
tmpc˚r
 |
TIM_OCPﬁ¨ôy
;

1816 
TIMx
->
CCER
 = 
tmpc˚r
;

1817 
	}
}

1828 
	$TIM_OC1NPﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCNPﬁ¨ôy
)

1830 
uöt16_t
 
tmpc˚r
 = 0;

1832 
	`as£π_∑øm
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

1833 
	`as£π_∑øm
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCNPﬁ¨ôy
));

1835 
tmpc˚r
 = 
TIMx
->
CCER
;

1837 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC1NP
);

1838 
tmpc˚r
 |
TIM_OCNPﬁ¨ôy
;

1840 
TIMx
->
CCER
 = 
tmpc˚r
;

1841 
	}
}

1852 
	$TIM_OC2Pﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPﬁ¨ôy
)

1854 
uöt16_t
 
tmpc˚r
 = 0;

1856 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1857 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPﬁ¨ôy
));

1858 
tmpc˚r
 = 
TIMx
->
CCER
;

1860 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC2P
);

1861 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCPﬁ¨ôy
 << 4);

1863 
TIMx
->
CCER
 = 
tmpc˚r
;

1864 
	}
}

1875 
	$TIM_OC2NPﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCNPﬁ¨ôy
)

1877 
uöt16_t
 
tmpc˚r
 = 0;

1879 
	`as£π_∑øm
(
	`IS_TIM_LIST1_PERIPH
(
TIMx
));

1880 
	`as£π_∑øm
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCNPﬁ¨ôy
));

1882 
tmpc˚r
 = 
TIMx
->
CCER
;

1884 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC2NP
);

1885 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCNPﬁ¨ôy
 << 4);

1887 
TIMx
->
CCER
 = 
tmpc˚r
;

1888 
	}
}

1899 
	$TIM_OC3Pﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPﬁ¨ôy
)

1901 
uöt16_t
 
tmpc˚r
 = 0;

1903 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1904 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPﬁ¨ôy
));

1905 
tmpc˚r
 = 
TIMx
->
CCER
;

1907 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC3P
);

1908 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCPﬁ¨ôy
 << 8);

1910 
TIMx
->
CCER
 = 
tmpc˚r
;

1911 
	}
}

1922 
	$TIM_OC3NPﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCNPﬁ¨ôy
)

1924 
uöt16_t
 
tmpc˚r
 = 0;

1927 
	`as£π_∑øm
(
	`IS_TIM_LIST1_PERIPH
(
TIMx
));

1928 
	`as£π_∑øm
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCNPﬁ¨ôy
));

1930 
tmpc˚r
 = 
TIMx
->
CCER
;

1932 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC3NP
);

1933 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCNPﬁ¨ôy
 << 8);

1935 
TIMx
->
CCER
 = 
tmpc˚r
;

1936 
	}
}

1947 
	$TIM_OC4Pﬁ¨ôyC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OCPﬁ¨ôy
)

1949 
uöt16_t
 
tmpc˚r
 = 0;

1951 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1952 
	`as£π_∑øm
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPﬁ¨ôy
));

1953 
tmpc˚r
 = 
TIMx
->
CCER
;

1955 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC4P
);

1956 
tmpc˚r
 |(
uöt16_t
)(
TIM_OCPﬁ¨ôy
 << 12);

1958 
TIMx
->
CCER
 = 
tmpc˚r
;

1959 
	}
}

1974 
	$TIM_CCxCmd
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_Ch™√l
, uöt16_à
TIM_CCx
)

1976 
uöt16_t
 
tmp
 = 0;

1979 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1980 
	`as£π_∑øm
(
	`IS_TIM_CHANNEL
(
TIM_Ch™√l
));

1981 
	`as£π_∑øm
(
	`IS_TIM_CCX
(
TIM_CCx
));

1983 
tmp
 = 
CCER_CCE_Së
 << 
TIM_Ch™√l
;

1986 
TIMx
->
CCER
 &(
uöt16_t
)~ 
tmp
;

1989 
TIMx
->
CCER
 |(
uöt16_t
)(
TIM_CCx
 << 
TIM_Ch™√l
);

1990 
	}
}

2004 
	$TIM_CCxNCmd
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_Ch™√l
, uöt16_à
TIM_CCxN
)

2006 
uöt16_t
 
tmp
 = 0;

2009 
	`as£π_∑øm
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

2010 
	`as£π_∑øm
(
	`IS_TIM_COMPLEMENTARY_CHANNEL
(
TIM_Ch™√l
));

2011 
	`as£π_∑øm
(
	`IS_TIM_CCXN
(
TIM_CCxN
));

2013 
tmp
 = 
CCER_CCNE_Së
 << 
TIM_Ch™√l
;

2016 
TIMx
->
CCER
 &(
uöt16_t
Ë~
tmp
;

2019 
TIMx
->
CCER
 |(
uöt16_t
)(
TIM_CCxN
 << 
TIM_Ch™√l
);

2020 
	}
}

2045 
	$TIM_Sñe˘OCxM
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_Ch™√l
, uöt16_à
TIM_OCMode
)

2047 
uöt32_t
 
tmp
 = 0;

2048 
uöt16_t
 
tmp1
 = 0;

2051 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2052 
	`as£π_∑øm
(
	`IS_TIM_CHANNEL
(
TIM_Ch™√l
));

2053 
	`as£π_∑øm
(
	`IS_TIM_OCM
(
TIM_OCMode
));

2055 
tmp
 = (
uöt32_t
Ë
TIMx
;

2056 
tmp
 +
CCMR_Off£t
;

2058 
tmp1
 = 
CCER_CCE_Së
 << (
uöt16_t
)
TIM_Ch™√l
;

2061 
TIMx
->
CCER
 &(
uöt16_t
Ë~
tmp1
;

2063 if((
TIM_Ch™√l
 =
TIM_Ch™√l_1
Ë||(TIM_Ch™√»=
TIM_Ch™√l_3
))

2065 
tmp
 +(
TIM_Ch™√l
>>1);

2068 *(
__IO
 
uöt32_t
 *Ë
tmp
 &(uöt32_t)~((uöt32_t)
TIM_CCMR1_OC1M
);

2071 *(
__IO
 
uöt32_t
 *Ë
tmp
 |
TIM_OCMode
;

2075 
tmp
 +(
uöt16_t
)(
TIM_Ch™√l
 - (uint16_t)4)>> (uint16_t)1;

2078 *(
__IO
 
uöt32_t
 *Ë
tmp
 &(uöt32_t)~((uöt32_t)
TIM_CCMR1_OC2M
);

2081 *(
__IO
 
uöt32_t
 *Ë
tmp
 |(
uöt16_t
)(
TIM_OCMode
 << 8);

2083 
	}
}

2092 
	$TIM_Upd©eDißbÀC⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

2095 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2096 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

2097 i‡(
NewSèã
 !
DISABLE
)

2100 
TIMx
->
CR1
 |
TIM_CR1_UDIS
;

2105 
TIMx
->
CR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CR1_UDIS
);

2107 
	}
}

2120 
	$TIM_Upd©eReque°C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_Upd©eSour˚
)

2123 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2124 
	`as£π_∑øm
(
	`IS_TIM_UPDATE_SOURCE
(
TIM_Upd©eSour˚
));

2125 i‡(
TIM_Upd©eSour˚
 !
TIM_Upd©eSour˚_GlobÆ
)

2128 
TIMx
->
CR1
 |
TIM_CR1_URS
;

2133 
TIMx
->
CR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CR1_URS
);

2135 
	}
}

2144 
	$TIM_Sñe˘HÆlSís‹
(
TIM_Ty≥Def
* 
TIMx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

2147 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2148 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

2149 i‡(
NewSèã
 !
DISABLE
)

2152 
TIMx
->
CR2
 |
TIM_CR2_TI1S
;

2157 
TIMx
->
CR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CR2_TI1S
);

2159 
	}
}

2170 
	$TIM_Sñe˘O√Pul£Mode
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_OPMode
)

2173 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2174 
	`as£π_∑øm
(
	`IS_TIM_OPM_MODE
(
TIM_OPMode
));

2176 
TIMx
->
CR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CR1_OPM
);

2178 
TIMx
->
CR1
 |
TIM_OPMode
;

2179 
	}
}

2202 
	$TIM_Sñe˘OuçutTriggî
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_TRGOSour˚
)

2205 
	`as£π_∑øm
(
	`IS_TIM_LIST7_PERIPH
(
TIMx
));

2206 
	`as£π_∑øm
(
	`IS_TIM_TRGO_SOURCE
(
TIM_TRGOSour˚
));

2208 
TIMx
->
CR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CR2_MMS
);

2210 
TIMx
->
CR2
 |
TIM_TRGOSour˚
;

2211 
	}
}

2225 
	$TIM_Sñe˘SœveMode
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_SœveMode
)

2228 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2229 
	`as£π_∑øm
(
	`IS_TIM_SLAVE_MODE
(
TIM_SœveMode
));

2231 
TIMx
->
SMCR
 &(
uöt16_t
)~((uöt16_t)
TIM_SMCR_SMS
);

2233 
TIMx
->
SMCR
 |
TIM_SœveMode
;

2234 
	}
}

2246 
	$TIM_Sñe˘Ma°îSœveMode
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_Ma°îSœveMode
)

2249 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2250 
	`as£π_∑øm
(
	`IS_TIM_MSM_STATE
(
TIM_Ma°îSœveMode
));

2252 
TIMx
->
SMCR
 &(
uöt16_t
)~((uöt16_t)
TIM_SMCR_MSM
);

2255 
TIMx
->
SMCR
 |
TIM_Ma°îSœveMode
;

2256 
	}
}

2264 
	$TIM_SëCou¡î
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
Cou¡î
)

2267 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2269 
TIMx
->
CNT
 = 
Cou¡î
;

2270 
	}
}

2278 
	$TIM_SëAut‹ñﬂd
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
Aut‹ñﬂd
)

2281 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2283 
TIMx
->
ARR
 = 
Aut‹ñﬂd
;

2284 
	}
}

2292 
	$TIM_SëCom∑ª1
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
Com∑ª1
)

2295 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2297 
TIMx
->
CCR1
 = 
Com∑ª1
;

2298 
	}
}

2306 
	$TIM_SëCom∑ª2
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
Com∑ª2
)

2309 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2311 
TIMx
->
CCR2
 = 
Com∑ª2
;

2312 
	}
}

2320 
	$TIM_SëCom∑ª3
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
Com∑ª3
)

2323 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2325 
TIMx
->
CCR3
 = 
Com∑ª3
;

2326 
	}
}

2334 
	$TIM_SëCom∑ª4
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
Com∑ª4
)

2337 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2339 
TIMx
->
CCR4
 = 
Com∑ª4
;

2340 
	}
}

2353 
	$TIM_SëIC1PªsˇÀr
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPSC
)

2356 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2357 
	`as£π_∑øm
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2359 
TIMx
->
CCMR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_IC1PSC
);

2361 
TIMx
->
CCMR1
 |
TIM_ICPSC
;

2362 
	}
}

2375 
	$TIM_SëIC2PªsˇÀr
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPSC
)

2378 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2379 
	`as£π_∑øm
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2381 
TIMx
->
CCMR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR1_IC2PSC
);

2383 
TIMx
->
CCMR1
 |(
uöt16_t
)(
TIM_ICPSC
 << 8);

2384 
	}
}

2397 
	$TIM_SëIC3PªsˇÀr
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPSC
)

2400 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2401 
	`as£π_∑øm
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2403 
TIMx
->
CCMR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_IC3PSC
);

2405 
TIMx
->
CCMR2
 |
TIM_ICPSC
;

2406 
	}
}

2419 
	$TIM_SëIC4PªsˇÀr
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPSC
)

2422 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2423 
	`as£π_∑øm
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2425 
TIMx
->
CCMR2
 &(
uöt16_t
)~((uöt16_t)
TIM_CCMR2_IC4PSC
);

2427 
TIMx
->
CCMR2
 |(
uöt16_t
)(
TIM_ICPSC
 << 8);

2428 
	}
}

2441 
	$TIM_SëClockDivisi⁄
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_CKD
)

2444 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2445 
	`as£π_∑øm
(
	`IS_TIM_CKD_DIV
(
TIM_CKD
));

2447 
TIMx
->
CR1
 &(
uöt16_t
)~((uöt16_t)
TIM_CR1_CKD
);

2449 
TIMx
->
CR1
 |
TIM_CKD
;

2450 
	}
}

2457 
uöt16_t
 
	$TIM_GëC≠tuª1
(
TIM_Ty≥Def
* 
TIMx
)

2460 
	`as£π_∑øm
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2462  
TIMx
->
CCR1
;

2463 
	}
}

2470 
uöt16_t
 
	$TIM_GëC≠tuª2
(
TIM_Ty≥Def
* 
TIMx
)

2473 
	`as£π_∑øm
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2475  
TIMx
->
CCR2
;

2476 
	}
}

2483 
uöt16_t
 
	$TIM_GëC≠tuª3
(
TIM_Ty≥Def
* 
TIMx
)

2486 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2488  
TIMx
->
CCR3
;

2489 
	}
}

2496 
uöt16_t
 
	$TIM_GëC≠tuª4
(
TIM_Ty≥Def
* 
TIMx
)

2499 
	`as£π_∑øm
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2501  
TIMx
->
CCR4
;

2502 
	}
}

2509 
uöt16_t
 
	$TIM_GëCou¡î
(
TIM_Ty≥Def
* 
TIMx
)

2512 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2514  
TIMx
->
CNT
;

2515 
	}
}

2522 
uöt16_t
 
	$TIM_GëPªsˇÀr
(
TIM_Ty≥Def
* 
TIMx
)

2525 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2527  
TIMx
->
PSC
;

2528 
	}
}

2556 
FœgSètus
 
	$TIM_GëFœgSètus
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_FLAG
)

2558 
ITSètus
 
bô°©us
 = 
RESET
;

2560 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2561 
	`as£π_∑øm
(
	`IS_TIM_GET_FLAG
(
TIM_FLAG
));

2563 i‡((
TIMx
->
SR
 & 
TIM_FLAG
Ë!(
uöt16_t
)
RESET
)

2565 
bô°©us
 = 
SET
;

2569 
bô°©us
 = 
RESET
;

2571  
bô°©us
;

2572 
	}
}

2600 
	$TIM_CÀ¨Fœg
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_FLAG
)

2603 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2604 
	`as£π_∑øm
(
	`IS_TIM_CLEAR_FLAG
(
TIM_FLAG
));

2607 
TIMx
->
SR
 = (
uöt16_t
)~
TIM_FLAG
;

2608 
	}
}

2632 
ITSètus
 
	$TIM_GëITSètus
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_IT
)

2634 
ITSètus
 
bô°©us
 = 
RESET
;

2635 
uöt16_t
 
ô°©us
 = 0x0, 
ôíabÀ
 = 0x0;

2637 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2638 
	`as£π_∑øm
(
	`IS_TIM_GET_IT
(
TIM_IT
));

2640 
ô°©us
 = 
TIMx
->
SR
 & 
TIM_IT
;

2642 
ôíabÀ
 = 
TIMx
->
DIER
 & 
TIM_IT
;

2643 i‡((
ô°©us
 !(
uöt16_t
)
RESET
Ë&& (
ôíabÀ
 != (uint16_t)RESET))

2645 
bô°©us
 = 
SET
;

2649 
bô°©us
 = 
RESET
;

2651  
bô°©us
;

2652 
	}
}

2676 
	$TIM_CÀ¨ITPídögBô
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_IT
)

2679 
	`as£π_∑øm
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2680 
	`as£π_∑øm
(
	`IS_TIM_IT
(
TIM_IT
));

2682 
TIMx
->
SR
 = (
uöt16_t
)~
TIM_IT
;

2683 
	}
}

2701 
	$TI1_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

2702 
uöt16_t
 
TIM_ICFûãr
)

2704 
uöt16_t
 
tmpccmr1
 = 0, 
tmpc˚r
 = 0;

2706 
TIMx
->
CCER
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC1E
);

2707 
tmpccmr1
 = 
TIMx
->
CCMR1
;

2708 
tmpc˚r
 = 
TIMx
->
CCER
;

2710 
tmpccmr1
 &(
uöt16_t
)(((uöt16_t)~((uöt16_t)
TIM_CCMR1_CC1S
)Ë& ((uöt16_t)~((uöt16_t)
TIM_CCMR1_IC1F
)));

2711 
tmpccmr1
 |(
uöt16_t
)(
TIM_ICSñe˘i⁄
 | (uöt16_t)(
TIM_ICFûãr
 << (uint16_t)4));

2713 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
Ë|| (TIMx =
TIM2
Ë|| (TIMx =
TIM3
) ||

2714 (
TIMx
 =
TIM4
Ë||(TIMx =
TIM5
))

2717 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC1P
));

2718 
tmpc˚r
 |(
uöt16_t
)(
TIM_ICPﬁ¨ôy
 | (uöt16_t)
TIM_CCER_CC1E
);

2723 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC1P
 | 
TIM_CCER_CC1NP
));

2724 
tmpc˚r
 |(
uöt16_t
)(
TIM_ICPﬁ¨ôy
 | (uöt16_t)
TIM_CCER_CC1E
);

2728 
TIMx
->
CCMR1
 = 
tmpccmr1
;

2729 
TIMx
->
CCER
 = 
tmpc˚r
;

2730 
	}
}

2748 
	$TI2_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

2749 
uöt16_t
 
TIM_ICFûãr
)

2751 
uöt16_t
 
tmpccmr1
 = 0, 
tmpc˚r
 = 0, 
tmp
 = 0;

2753 
TIMx
->
CCER
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC2E
);

2754 
tmpccmr1
 = 
TIMx
->
CCMR1
;

2755 
tmpc˚r
 = 
TIMx
->
CCER
;

2756 
tmp
 = (
uöt16_t
)(
TIM_ICPﬁ¨ôy
 << 4);

2758 
tmpccmr1
 &(
uöt16_t
)(((uöt16_t)~((uöt16_t)
TIM_CCMR1_CC2S
)Ë& ((uöt16_t)~((uöt16_t)
TIM_CCMR1_IC2F
)));

2759 
tmpccmr1
 |(
uöt16_t
)(
TIM_ICFûãr
 << 12);

2760 
tmpccmr1
 |(
uöt16_t
)(
TIM_ICSñe˘i⁄
 << 8);

2762 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
Ë|| (TIMx =
TIM2
Ë|| (TIMx =
TIM3
) ||

2763 (
TIMx
 =
TIM4
Ë||(TIMx =
TIM5
))

2766 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC2P
));

2767 
tmpc˚r
 |(
uöt16_t
)(
tmp
 | (uöt16_t)
TIM_CCER_CC2E
);

2772 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC2P
 | 
TIM_CCER_CC2NP
));

2773 
tmpc˚r
 |(
uöt16_t
)(
TIM_ICPﬁ¨ôy
 | (uöt16_t)
TIM_CCER_CC2E
);

2777 
TIMx
->
CCMR1
 = 
tmpccmr1
 ;

2778 
TIMx
->
CCER
 = 
tmpc˚r
;

2779 
	}
}

2797 
	$TI3_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

2798 
uöt16_t
 
TIM_ICFûãr
)

2800 
uöt16_t
 
tmpccmr2
 = 0, 
tmpc˚r
 = 0, 
tmp
 = 0;

2802 
TIMx
->
CCER
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC3E
);

2803 
tmpccmr2
 = 
TIMx
->
CCMR2
;

2804 
tmpc˚r
 = 
TIMx
->
CCER
;

2805 
tmp
 = (
uöt16_t
)(
TIM_ICPﬁ¨ôy
 << 8);

2807 
tmpccmr2
 &(
uöt16_t
)(((uöt16_t)~((uöt16_t)
TIM_CCMR2_CC3S
)Ë& ((uöt16_t)~((uöt16_t)
TIM_CCMR2_IC3F
)));

2808 
tmpccmr2
 |(
uöt16_t
)(
TIM_ICSñe˘i⁄
 | (uöt16_t)(
TIM_ICFûãr
 << (uint16_t)4));

2810 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
Ë|| (TIMx =
TIM2
Ë|| (TIMx =
TIM3
) ||

2811 (
TIMx
 =
TIM4
Ë||(TIMx =
TIM5
))

2814 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC3P
));

2815 
tmpc˚r
 |(
uöt16_t
)(
tmp
 | (uöt16_t)
TIM_CCER_CC3E
);

2820 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC3P
 | 
TIM_CCER_CC3NP
));

2821 
tmpc˚r
 |(
uöt16_t
)(
TIM_ICPﬁ¨ôy
 | (uöt16_t)
TIM_CCER_CC3E
);

2825 
TIMx
->
CCMR2
 = 
tmpccmr2
;

2826 
TIMx
->
CCER
 = 
tmpc˚r
;

2827 
	}
}

2845 
	$TI4_C⁄fig
(
TIM_Ty≥Def
* 
TIMx
, 
uöt16_t
 
TIM_ICPﬁ¨ôy
, uöt16_à
TIM_ICSñe˘i⁄
,

2846 
uöt16_t
 
TIM_ICFûãr
)

2848 
uöt16_t
 
tmpccmr2
 = 0, 
tmpc˚r
 = 0, 
tmp
 = 0;

2851 
TIMx
->
CCER
 &(
uöt16_t
)~((uöt16_t)
TIM_CCER_CC4E
);

2852 
tmpccmr2
 = 
TIMx
->
CCMR2
;

2853 
tmpc˚r
 = 
TIMx
->
CCER
;

2854 
tmp
 = (
uöt16_t
)(
TIM_ICPﬁ¨ôy
 << 12);

2856 
tmpccmr2
 &(
uöt16_t
)((uöt16_t)(~(uöt16_t)
TIM_CCMR2_CC4S
Ë& ((uöt16_t)~((uöt16_t)
TIM_CCMR2_IC4F
)));

2857 
tmpccmr2
 |(
uöt16_t
)(
TIM_ICSñe˘i⁄
 << 8);

2858 
tmpccmr2
 |(
uöt16_t
)(
TIM_ICFûãr
 << 12);

2860 if((
TIMx
 =
TIM1
Ë|| (TIMx =
TIM8
Ë|| (TIMx =
TIM2
Ë|| (TIMx =
TIM3
) ||

2861 (
TIMx
 =
TIM4
Ë||(TIMx =
TIM5
))

2864 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC4P
));

2865 
tmpc˚r
 |(
uöt16_t
)(
tmp
 | (uöt16_t)
TIM_CCER_CC4E
);

2870 
tmpc˚r
 &(
uöt16_t
)~((uöt16_t)(
TIM_CCER_CC3P
 | 
TIM_CCER_CC4NP
));

2871 
tmpc˚r
 |(
uöt16_t
)(
TIM_ICPﬁ¨ôy
 | (uöt16_t)
TIM_CCER_CC4E
);

2874 
TIMx
->
CCMR2
 = 
tmpccmr2
;

2875 
TIMx
->
CCER
 = 
tmpc˚r
;

2876 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STFD4F~1.C

23 
	~"°m32f10x_pwr.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#PWR_OFFSET
 (
PWR_BASE
 - 
PERIPH_BASE
)

	)

53 
	#CR_OFFSET
 (
PWR_OFFSET
 + 0x00)

	)

54 
	#DBP_BôNumbî
 0x08

	)

55 
	#CR_DBP_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
DBP_BôNumbî
 * 4))

	)

58 
	#PVDE_BôNumbî
 0x04

	)

59 
	#CR_PVDE_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
PVDE_BôNumbî
 * 4))

	)

64 
	#CSR_OFFSET
 (
PWR_OFFSET
 + 0x04)

	)

65 
	#EWUP_BôNumbî
 0x08

	)

66 
	#CSR_EWUP_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
EWUP_BôNumbî
 * 4))

	)

71 
	#CR_DS_MASK
 ((
uöt32_t
)0xFFFFFFFC)

	)

72 
	#CR_PLS_MASK
 ((
uöt32_t
)0xFFFFFF1F)

	)

112 
	$PWR_DeInô
()

114 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_PWR
, 
ENABLE
);

115 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_PWR
, 
DISABLE
);

116 
	}
}

124 
	$PWR_BackupAc˚ssCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

127 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

128 *(
__IO
 
uöt32_t
 *Ë
CR_DBP_BB
 = (uöt32_t)
NewSèã
;

129 
	}
}

137 
	$PWR_PVDCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

140 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

141 *(
__IO
 
uöt32_t
 *Ë
CR_PVDE_BB
 = (uöt32_t)
NewSèã
;

142 
	}
}

158 
	$PWR_PVDLevñC⁄fig
(
uöt32_t
 
PWR_PVDLevñ
)

160 
uöt32_t
 
tm¥eg
 = 0;

162 
	`as£π_∑øm
(
	`IS_PWR_PVD_LEVEL
(
PWR_PVDLevñ
));

163 
tm¥eg
 = 
PWR
->
CR
;

165 
tm¥eg
 &
CR_PLS_MASK
;

167 
tm¥eg
 |
PWR_PVDLevñ
;

169 
PWR
->
CR
 = 
tm¥eg
;

170 
	}
}

178 
	$PWR_WakeUpPöCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

181 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

182 *(
__IO
 
uöt32_t
 *Ë
CSR_EWUP_BB
 = (uöt32_t)
NewSèã
;

183 
	}
}

197 
	$PWR_E¡îSTOPMode
(
uöt32_t
 
PWR_Reguœt‹
, 
uöt8_t
 
PWR_STOPE¡ry
)

199 
uöt32_t
 
tm¥eg
 = 0;

201 
	`as£π_∑øm
(
	`IS_PWR_REGULATOR
(
PWR_Reguœt‹
));

202 
	`as£π_∑øm
(
	`IS_PWR_STOP_ENTRY
(
PWR_STOPE¡ry
));

205 
tm¥eg
 = 
PWR
->
CR
;

207 
tm¥eg
 &
CR_DS_MASK
;

209 
tm¥eg
 |
PWR_Reguœt‹
;

211 
PWR
->
CR
 = 
tm¥eg
;

213 
SCB
->
SCR
 |
SCB_SCR_SLEEPDEEP
;

216 if(
PWR_STOPE¡ry
 =
PWR_STOPE¡ry_WFI
)

219 
	`__WFI
();

224 
	`__WFE
();

228 
SCB
->
SCR
 &(
uöt32_t
)~((uöt32_t)
SCB_SCR_SLEEPDEEP
);

229 
	}
}

236 
	$PWR_E¡îSTANDBYMode
()

239 
PWR
->
CR
 |
PWR_CR_CWUF
;

241 
PWR
->
CR
 |
PWR_CR_PDDS
;

243 
SCB
->
SCR
 |
SCB_SCR_SLEEPDEEP
;

245 #i‡
	`deföed
 ( 
__CC_ARM
 )

246 
	`__f‹˚_°‹es
();

249 
	`__WFI
();

250 
	}
}

261 
FœgSètus
 
	$PWR_GëFœgSètus
(
uöt32_t
 
PWR_FLAG
)

263 
FœgSètus
 
bô°©us
 = 
RESET
;

265 
	`as£π_∑øm
(
	`IS_PWR_GET_FLAG
(
PWR_FLAG
));

267 i‡((
PWR
->
CSR
 & 
PWR_FLAG
Ë!(
uöt32_t
)
RESET
)

269 
bô°©us
 = 
SET
;

273 
bô°©us
 = 
RESET
;

276  
bô°©us
;

277 
	}
}

287 
	$PWR_CÀ¨Fœg
(
uöt32_t
 
PWR_FLAG
)

290 
	`as£π_∑øm
(
	`IS_PWR_CLEAR_FLAG
(
PWR_FLAG
));

292 
PWR
->
CR
 |
PWR_FLAG
 << 2;

293 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~1.C

23 
	~"°m32f10x_adc.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#CR1_DISCNUM_Re£t
 ((
uöt32_t
)0xFFFF1FFF)

	)

51 
	#CR1_DISCEN_Së
 ((
uöt32_t
)0x00000800)

	)

52 
	#CR1_DISCEN_Re£t
 ((
uöt32_t
)0xFFFFF7FF)

	)

55 
	#CR1_JAUTO_Së
 ((
uöt32_t
)0x00000400)

	)

56 
	#CR1_JAUTO_Re£t
 ((
uöt32_t
)0xFFFFFBFF)

	)

59 
	#CR1_JDISCEN_Së
 ((
uöt32_t
)0x00001000)

	)

60 
	#CR1_JDISCEN_Re£t
 ((
uöt32_t
)0xFFFFEFFF)

	)

63 
	#CR1_AWDCH_Re£t
 ((
uöt32_t
)0xFFFFFFE0)

	)

66 
	#CR1_AWDMode_Re£t
 ((
uöt32_t
)0xFF3FFDFF)

	)

69 
	#CR1_CLEAR_Mask
 ((
uöt32_t
)0xFFF0FEFF)

	)

72 
	#CR2_ADON_Së
 ((
uöt32_t
)0x00000001)

	)

73 
	#CR2_ADON_Re£t
 ((
uöt32_t
)0xFFFFFFFE)

	)

76 
	#CR2_DMA_Së
 ((
uöt32_t
)0x00000100)

	)

77 
	#CR2_DMA_Re£t
 ((
uöt32_t
)0xFFFFFEFF)

	)

80 
	#CR2_RSTCAL_Së
 ((
uöt32_t
)0x00000008)

	)

83 
	#CR2_CAL_Së
 ((
uöt32_t
)0x00000004)

	)

86 
	#CR2_SWSTART_Së
 ((
uöt32_t
)0x00400000)

	)

89 
	#CR2_EXTTRIG_Së
 ((
uöt32_t
)0x00100000)

	)

90 
	#CR2_EXTTRIG_Re£t
 ((
uöt32_t
)0xFFEFFFFF)

	)

93 
	#CR2_EXTTRIG_SWSTART_Së
 ((
uöt32_t
)0x00500000)

	)

94 
	#CR2_EXTTRIG_SWSTART_Re£t
 ((
uöt32_t
)0xFFAFFFFF)

	)

97 
	#CR2_JEXTSEL_Re£t
 ((
uöt32_t
)0xFFFF8FFF)

	)

100 
	#CR2_JEXTTRIG_Së
 ((
uöt32_t
)0x00008000)

	)

101 
	#CR2_JEXTTRIG_Re£t
 ((
uöt32_t
)0xFFFF7FFF)

	)

104 
	#CR2_JSWSTART_Së
 ((
uöt32_t
)0x00200000)

	)

107 
	#CR2_JEXTTRIG_JSWSTART_Së
 ((
uöt32_t
)0x00208000)

	)

108 
	#CR2_JEXTTRIG_JSWSTART_Re£t
 ((
uöt32_t
)0xFFDF7FFF)

	)

111 
	#CR2_TSVREFE_Së
 ((
uöt32_t
)0x00800000)

	)

112 
	#CR2_TSVREFE_Re£t
 ((
uöt32_t
)0xFF7FFFFF)

	)

115 
	#CR2_CLEAR_Mask
 ((
uöt32_t
)0xFFF1F7FD)

	)

118 
	#SQR3_SQ_Së
 ((
uöt32_t
)0x0000001F)

	)

119 
	#SQR2_SQ_Së
 ((
uöt32_t
)0x0000001F)

	)

120 
	#SQR1_SQ_Së
 ((
uöt32_t
)0x0000001F)

	)

123 
	#SQR1_CLEAR_Mask
 ((
uöt32_t
)0xFF0FFFFF)

	)

126 
	#JSQR_JSQ_Së
 ((
uöt32_t
)0x0000001F)

	)

129 
	#JSQR_JL_Së
 ((
uöt32_t
)0x00300000)

	)

130 
	#JSQR_JL_Re£t
 ((
uöt32_t
)0xFFCFFFFF)

	)

133 
	#SMPR1_SMP_Së
 ((
uöt32_t
)0x00000007)

	)

134 
	#SMPR2_SMP_Së
 ((
uöt32_t
)0x00000007)

	)

137 
	#JDR_Off£t
 ((
uöt8_t
)0x28)

	)

140 
	#DR_ADDRESS
 ((
uöt32_t
)0x4001244C)

	)

179 
	$ADC_DeInô
(
ADC_Ty≥Def
* 
ADCx
)

182 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

184 i‡(
ADCx
 =
ADC1
)

187 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_ADC1
, 
ENABLE
);

189 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_ADC1
, 
DISABLE
);

191 i‡(
ADCx
 =
ADC2
)

194 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_ADC2
, 
ENABLE
);

196 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_ADC2
, 
DISABLE
);

200 i‡(
ADCx
 =
ADC3
)

203 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_ADC3
, 
ENABLE
);

205 
	`RCC_APB2PîùhRe£tCmd
(
RCC_APB2Pîùh_ADC3
, 
DISABLE
);

208 
	}
}

218 
	$ADC_Inô
(
ADC_Ty≥Def
* 
ADCx
, 
ADC_InôTy≥Def
* 
ADC_InôSåu˘
)

220 
uöt32_t
 
tm¥eg1
 = 0;

221 
uöt8_t
 
tm¥eg2
 = 0;

223 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

224 
	`as£π_∑øm
(
	`IS_ADC_MODE
(
ADC_InôSåu˘
->
ADC_Mode
));

225 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
ADC_InôSåu˘
->
ADC_SˇnC⁄vMode
));

226 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
ADC_InôSåu˘
->
ADC_C⁄töuousC⁄vMode
));

227 
	`as£π_∑øm
(
	`IS_ADC_EXT_TRIG
(
ADC_InôSåu˘
->
ADC_Exã∫ÆTrigC⁄v
));

228 
	`as£π_∑øm
(
	`IS_ADC_DATA_ALIGN
(
ADC_InôSåu˘
->
ADC_D©aAlign
));

229 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_LENGTH
(
ADC_InôSåu˘
->
ADC_NbrOfCh™√l
));

233 
tm¥eg1
 = 
ADCx
->
CR1
;

235 
tm¥eg1
 &
CR1_CLEAR_Mask
;

239 
tm¥eg1
 |(
uöt32_t
)(
ADC_InôSåu˘
->
ADC_Mode
 | ((uöt32_t)ADC_InôSåu˘->
ADC_SˇnC⁄vMode
 << 8));

241 
ADCx
->
CR1
 = 
tm¥eg1
;

245 
tm¥eg1
 = 
ADCx
->
CR2
;

247 
tm¥eg1
 &
CR2_CLEAR_Mask
;

252 
tm¥eg1
 |(
uöt32_t
)(
ADC_InôSåu˘
->
ADC_D©aAlign
 | ADC_InôSåu˘->
ADC_Exã∫ÆTrigC⁄v
 |

253 ((
uöt32_t
)
ADC_InôSåu˘
->
ADC_C⁄töuousC⁄vMode
 << 1));

255 
ADCx
->
CR2
 = 
tm¥eg1
;

259 
tm¥eg1
 = 
ADCx
->
SQR1
;

261 
tm¥eg1
 &
SQR1_CLEAR_Mask
;

264 
tm¥eg2
 |(
uöt8_t
Ë(
ADC_InôSåu˘
->
ADC_NbrOfCh™√l
 - (uint8_t)1);

265 
tm¥eg1
 |(
uöt32_t
)
tm¥eg2
 << 20;

267 
ADCx
->
SQR1
 = 
tm¥eg1
;

268 
	}
}

275 
	$ADC_Såu˘Inô
(
ADC_InôTy≥Def
* 
ADC_InôSåu˘
)

279 
ADC_InôSåu˘
->
ADC_Mode
 = 
ADC_Mode_Indïídít
;

281 
ADC_InôSåu˘
->
ADC_SˇnC⁄vMode
 = 
DISABLE
;

283 
ADC_InôSåu˘
->
ADC_C⁄töuousC⁄vMode
 = 
DISABLE
;

285 
ADC_InôSåu˘
->
ADC_Exã∫ÆTrigC⁄v
 = 
ADC_Exã∫ÆTrigC⁄v_T1_CC1
;

287 
ADC_InôSåu˘
->
ADC_D©aAlign
 = 
ADC_D©aAlign_Right
;

289 
ADC_InôSåu˘
->
ADC_NbrOfCh™√l
 = 1;

290 
	}
}

299 
	$ADC_Cmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

302 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

303 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

304 i‡(
NewSèã
 !
DISABLE
)

307 
ADCx
->
CR2
 |
CR2_ADON_Së
;

312 
ADCx
->
CR2
 &
CR2_ADON_Re£t
;

314 
	}
}

324 
	$ADC_DMACmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

327 
	`as£π_∑øm
(
	`IS_ADC_DMA_PERIPH
(
ADCx
));

328 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

329 i‡(
NewSèã
 !
DISABLE
)

332 
ADCx
->
CR2
 |
CR2_DMA_Së
;

337 
ADCx
->
CR2
 &
CR2_DMA_Re£t
;

339 
	}
}

353 
	$ADC_ITC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt16_t
 
ADC_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

355 
uöt8_t
 
ômask
 = 0;

357 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

358 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

359 
	`as£π_∑øm
(
	`IS_ADC_IT
(
ADC_IT
));

361 
ômask
 = (
uöt8_t
)
ADC_IT
;

362 i‡(
NewSèã
 !
DISABLE
)

365 
ADCx
->
CR1
 |
ômask
;

370 
ADCx
->
CR1
 &(~(
uöt32_t
)
ômask
);

372 
	}
}

379 
	$ADC_Re£tCÆibøti⁄
(
ADC_Ty≥Def
* 
ADCx
)

382 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

384 
ADCx
->
CR2
 |
CR2_RSTCAL_Së
;

385 
	}
}

392 
FœgSètus
 
	$ADC_GëRe£tCÆibøti⁄Sètus
(
ADC_Ty≥Def
* 
ADCx
)

394 
FœgSètus
 
bô°©us
 = 
RESET
;

396 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

398 i‡((
ADCx
->
CR2
 & 
CR2_RSTCAL_Së
Ë!(
uöt32_t
)
RESET
)

401 
bô°©us
 = 
SET
;

406 
bô°©us
 = 
RESET
;

409  
bô°©us
;

410 
	}
}

417 
	$ADC_SèπCÆibøti⁄
(
ADC_Ty≥Def
* 
ADCx
)

420 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

422 
ADCx
->
CR2
 |
CR2_CAL_Së
;

423 
	}
}

430 
FœgSètus
 
	$ADC_GëCÆibøti⁄Sètus
(
ADC_Ty≥Def
* 
ADCx
)

432 
FœgSètus
 
bô°©us
 = 
RESET
;

434 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

436 i‡((
ADCx
->
CR2
 & 
CR2_CAL_Së
Ë!(
uöt32_t
)
RESET
)

439 
bô°©us
 = 
SET
;

444 
bô°©us
 = 
RESET
;

447  
bô°©us
;

448 
	}
}

457 
	$ADC_So·w¨eSèπC⁄vCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

460 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

461 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

462 i‡(
NewSèã
 !
DISABLE
)

466 
ADCx
->
CR2
 |
CR2_EXTTRIG_SWSTART_Së
;

472 
ADCx
->
CR2
 &
CR2_EXTTRIG_SWSTART_Re£t
;

474 
	}
}

481 
FœgSètus
 
	$ADC_GëSo·w¨eSèπC⁄vSètus
(
ADC_Ty≥Def
* 
ADCx
)

483 
FœgSètus
 
bô°©us
 = 
RESET
;

485 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

487 i‡((
ADCx
->
CR2
 & 
CR2_SWSTART_Së
Ë!(
uöt32_t
)
RESET
)

490 
bô°©us
 = 
SET
;

495 
bô°©us
 = 
RESET
;

498  
bô°©us
;

499 
	}
}

509 
	$ADC_DiscModeCh™√lCou¡C⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
Numbî
)

511 
uöt32_t
 
tm¥eg1
 = 0;

512 
uöt32_t
 
tm¥eg2
 = 0;

514 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

515 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_DISC_NUMBER
(
Numbî
));

517 
tm¥eg1
 = 
ADCx
->
CR1
;

519 
tm¥eg1
 &
CR1_DISCNUM_Re£t
;

521 
tm¥eg2
 = 
Numbî
 - 1;

522 
tm¥eg1
 |
tm¥eg2
 << 13;

524 
ADCx
->
CR1
 = 
tm¥eg1
;

525 
	}
}

536 
	$ADC_DiscModeCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

539 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

540 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

541 i‡(
NewSèã
 !
DISABLE
)

544 
ADCx
->
CR1
 |
CR1_DISCEN_Së
;

549 
ADCx
->
CR1
 &
CR1_DISCEN_Re£t
;

551 
	}
}

590 
	$ADC_ReguœrCh™√lC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_Ch™√l
, uöt8_à
R™k
, uöt8_à
ADC_Sam∂eTime
)

592 
uöt32_t
 
tm¥eg1
 = 0, 
tm¥eg2
 = 0;

594 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

595 
	`as£π_∑øm
(
	`IS_ADC_CHANNEL
(
ADC_Ch™√l
));

596 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_RANK
(
R™k
));

597 
	`as£π_∑øm
(
	`IS_ADC_SAMPLE_TIME
(
ADC_Sam∂eTime
));

599 i‡(
ADC_Ch™√l
 > 
ADC_Ch™√l_9
)

602 
tm¥eg1
 = 
ADCx
->
SMPR1
;

604 
tm¥eg2
 = 
SMPR1_SMP_Së
 << (3 * (
ADC_Ch™√l
 - 10));

606 
tm¥eg1
 &~
tm¥eg2
;

608 
tm¥eg2
 = (
uöt32_t
)
ADC_Sam∂eTime
 << (3 * (
ADC_Ch™√l
 - 10));

610 
tm¥eg1
 |
tm¥eg2
;

612 
ADCx
->
SMPR1
 = 
tm¥eg1
;

617 
tm¥eg1
 = 
ADCx
->
SMPR2
;

619 
tm¥eg2
 = 
SMPR2_SMP_Së
 << (3 * 
ADC_Ch™√l
);

621 
tm¥eg1
 &~
tm¥eg2
;

623 
tm¥eg2
 = (
uöt32_t
)
ADC_Sam∂eTime
 << (3 * 
ADC_Ch™√l
);

625 
tm¥eg1
 |
tm¥eg2
;

627 
ADCx
->
SMPR2
 = 
tm¥eg1
;

630 i‡(
R™k
 < 7)

633 
tm¥eg1
 = 
ADCx
->
SQR3
;

635 
tm¥eg2
 = 
SQR3_SQ_Së
 << (5 * (
R™k
 - 1));

637 
tm¥eg1
 &~
tm¥eg2
;

639 
tm¥eg2
 = (
uöt32_t
)
ADC_Ch™√l
 << (5 * (
R™k
 - 1));

641 
tm¥eg1
 |
tm¥eg2
;

643 
ADCx
->
SQR3
 = 
tm¥eg1
;

646 i‡(
R™k
 < 13)

649 
tm¥eg1
 = 
ADCx
->
SQR2
;

651 
tm¥eg2
 = 
SQR2_SQ_Së
 << (5 * (
R™k
 - 7));

653 
tm¥eg1
 &~
tm¥eg2
;

655 
tm¥eg2
 = (
uöt32_t
)
ADC_Ch™√l
 << (5 * (
R™k
 - 7));

657 
tm¥eg1
 |
tm¥eg2
;

659 
ADCx
->
SQR2
 = 
tm¥eg1
;

665 
tm¥eg1
 = 
ADCx
->
SQR1
;

667 
tm¥eg2
 = 
SQR1_SQ_Së
 << (5 * (
R™k
 - 13));

669 
tm¥eg1
 &~
tm¥eg2
;

671 
tm¥eg2
 = (
uöt32_t
)
ADC_Ch™√l
 << (5 * (
R™k
 - 13));

673 
tm¥eg1
 |
tm¥eg2
;

675 
ADCx
->
SQR1
 = 
tm¥eg1
;

677 
	}
}

686 
	$ADC_Exã∫ÆTrigC⁄vCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

689 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

690 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

691 i‡(
NewSèã
 !
DISABLE
)

694 
ADCx
->
CR2
 |
CR2_EXTTRIG_Së
;

699 
ADCx
->
CR2
 &
CR2_EXTTRIG_Re£t
;

701 
	}
}

708 
uöt16_t
 
	$ADC_GëC⁄vîsi⁄VÆue
(
ADC_Ty≥Def
* 
ADCx
)

711 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

713  (
uöt16_t
Ë
ADCx
->
DR
;

714 
	}
}

720 
uöt32_t
 
	$ADC_GëDuÆModeC⁄vîsi⁄VÆue
()

723  (*(
__IO
 
uöt32_t
 *Ë
DR_ADDRESS
);

724 
	}
}

734 
	$ADC_AutoInje˘edC⁄vCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

737 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

738 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

739 i‡(
NewSèã
 !
DISABLE
)

742 
ADCx
->
CR1
 |
CR1_JAUTO_Së
;

747 
ADCx
->
CR1
 &
CR1_JAUTO_Re£t
;

749 
	}
}

760 
	$ADC_Inje˘edDiscModeCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

763 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

764 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

765 i‡(
NewSèã
 !
DISABLE
)

768 
ADCx
->
CR1
 |
CR1_JDISCEN_Së
;

773 
ADCx
->
CR1
 &
CR1_JDISCEN_Re£t
;

775 
	}
}

799 
	$ADC_Exã∫ÆTrigInje˘edC⁄vC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt32_t
 
ADC_Exã∫ÆTrigInjecC⁄v
)

801 
uöt32_t
 
tm¥eg
 = 0;

803 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

804 
	`as£π_∑øm
(
	`IS_ADC_EXT_INJEC_TRIG
(
ADC_Exã∫ÆTrigInjecC⁄v
));

806 
tm¥eg
 = 
ADCx
->
CR2
;

808 
tm¥eg
 &
CR2_JEXTSEL_Re£t
;

810 
tm¥eg
 |
ADC_Exã∫ÆTrigInjecC⁄v
;

812 
ADCx
->
CR2
 = 
tm¥eg
;

813 
	}
}

824 
	$ADC_Exã∫ÆTrigInje˘edC⁄vCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

827 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

828 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

829 i‡(
NewSèã
 !
DISABLE
)

832 
ADCx
->
CR2
 |
CR2_JEXTTRIG_Së
;

837 
ADCx
->
CR2
 &
CR2_JEXTTRIG_Re£t
;

839 
	}
}

849 
	$ADC_So·w¨eSèπInje˘edC⁄vCmd
(
ADC_Ty≥Def
* 
ADCx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

852 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

853 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

854 i‡(
NewSèã
 !
DISABLE
)

858 
ADCx
->
CR2
 |
CR2_JEXTTRIG_JSWSTART_Së
;

864 
ADCx
->
CR2
 &
CR2_JEXTTRIG_JSWSTART_Re£t
;

866 
	}
}

873 
FœgSètus
 
	$ADC_GëSo·w¨eSèπInje˘edC⁄vCmdSètus
(
ADC_Ty≥Def
* 
ADCx
)

875 
FœgSètus
 
bô°©us
 = 
RESET
;

877 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

879 i‡((
ADCx
->
CR2
 & 
CR2_JSWSTART_Së
Ë!(
uöt32_t
)
RESET
)

882 
bô°©us
 = 
SET
;

887 
bô°©us
 = 
RESET
;

890  
bô°©us
;

891 
	}
}

930 
	$ADC_Inje˘edCh™√lC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_Ch™√l
, uöt8_à
R™k
, uöt8_à
ADC_Sam∂eTime
)

932 
uöt32_t
 
tm¥eg1
 = 0, 
tm¥eg2
 = 0, 
tm¥eg3
 = 0;

934 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

935 
	`as£π_∑øm
(
	`IS_ADC_CHANNEL
(
ADC_Ch™√l
));

936 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_RANK
(
R™k
));

937 
	`as£π_∑øm
(
	`IS_ADC_SAMPLE_TIME
(
ADC_Sam∂eTime
));

939 i‡(
ADC_Ch™√l
 > 
ADC_Ch™√l_9
)

942 
tm¥eg1
 = 
ADCx
->
SMPR1
;

944 
tm¥eg2
 = 
SMPR1_SMP_Së
 << (3*(
ADC_Ch™√l
 - 10));

946 
tm¥eg1
 &~
tm¥eg2
;

948 
tm¥eg2
 = (
uöt32_t
)
ADC_Sam∂eTime
 << (3*(
ADC_Ch™√l
 - 10));

950 
tm¥eg1
 |
tm¥eg2
;

952 
ADCx
->
SMPR1
 = 
tm¥eg1
;

957 
tm¥eg1
 = 
ADCx
->
SMPR2
;

959 
tm¥eg2
 = 
SMPR2_SMP_Së
 << (3 * 
ADC_Ch™√l
);

961 
tm¥eg1
 &~
tm¥eg2
;

963 
tm¥eg2
 = (
uöt32_t
)
ADC_Sam∂eTime
 << (3 * 
ADC_Ch™√l
);

965 
tm¥eg1
 |
tm¥eg2
;

967 
ADCx
->
SMPR2
 = 
tm¥eg1
;

971 
tm¥eg1
 = 
ADCx
->
JSQR
;

973 
tm¥eg3
 = (
tm¥eg1
 & 
JSQR_JL_Së
)>> 20;

975 
tm¥eg2
 = 
JSQR_JSQ_Së
 << (5 * (
uöt8_t
)((
R™k
 + 3Ë- (
tm¥eg3
 + 1)));

977 
tm¥eg1
 &~
tm¥eg2
;

979 
tm¥eg2
 = (
uöt32_t
)
ADC_Ch™√l
 << (5 * (
uöt8_t
)((
R™k
 + 3Ë- (
tm¥eg3
 + 1)));

981 
tm¥eg1
 |
tm¥eg2
;

983 
ADCx
->
JSQR
 = 
tm¥eg1
;

984 
	}
}

993 
	$ADC_Inje˘edSequí˚rLígthC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
Lígth
)

995 
uöt32_t
 
tm¥eg1
 = 0;

996 
uöt32_t
 
tm¥eg2
 = 0;

998 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

999 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_LENGTH
(
Lígth
));

1002 
tm¥eg1
 = 
ADCx
->
JSQR
;

1004 
tm¥eg1
 &
JSQR_JL_Re£t
;

1006 
tm¥eg2
 = 
Lígth
 - 1;

1007 
tm¥eg1
 |
tm¥eg2
 << 20;

1009 
ADCx
->
JSQR
 = 
tm¥eg1
;

1010 
	}
}

1025 
	$ADC_SëInje˘edOff£t
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_Inje˘edCh™√l
, 
uöt16_t
 
Off£t
)

1027 
__IO
 
uöt32_t
 
tmp
 = 0;

1030 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1031 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_CHANNEL
(
ADC_Inje˘edCh™√l
));

1032 
	`as£π_∑øm
(
	`IS_ADC_OFFSET
(
Off£t
));

1034 
tmp
 = (
uöt32_t
)
ADCx
;

1035 
tmp
 +
ADC_Inje˘edCh™√l
;

1038 *(
__IO
 
uöt32_t
 *Ë
tmp
 = (uöt32_t)
Off£t
;

1039 
	}
}

1052 
uöt16_t
 
	$ADC_GëInje˘edC⁄vîsi⁄VÆue
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_Inje˘edCh™√l
)

1054 
__IO
 
uöt32_t
 
tmp
 = 0;

1057 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1058 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_CHANNEL
(
ADC_Inje˘edCh™√l
));

1060 
tmp
 = (
uöt32_t
)
ADCx
;

1061 
tmp
 +
ADC_Inje˘edCh™√l
 + 
JDR_Off£t
;

1064  (
uöt16_t
Ë(*(
__IO
 
uöt32_t
*Ë
tmp
);

1065 
	}
}

1082 
	$ADC_A«logW©chdogCmd
(
ADC_Ty≥Def
* 
ADCx
, 
uöt32_t
 
ADC_A«logW©chdog
)

1084 
uöt32_t
 
tm¥eg
 = 0;

1086 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1087 
	`as£π_∑øm
(
	`IS_ADC_ANALOG_WATCHDOG
(
ADC_A«logW©chdog
));

1089 
tm¥eg
 = 
ADCx
->
CR1
;

1091 
tm¥eg
 &
CR1_AWDMode_Re£t
;

1093 
tm¥eg
 |
ADC_A«logW©chdog
;

1095 
ADCx
->
CR1
 = 
tm¥eg
;

1096 
	}
}

1107 
	$ADC_A«logW©chdogThªshﬁdsC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt16_t
 
HighThªshﬁd
,

1108 
uöt16_t
 
LowThªshﬁd
)

1111 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1112 
	`as£π_∑øm
(
	`IS_ADC_THRESHOLD
(
HighThªshﬁd
));

1113 
	`as£π_∑øm
(
	`IS_ADC_THRESHOLD
(
LowThªshﬁd
));

1115 
ADCx
->
HTR
 = 
HighThªshﬁd
;

1117 
ADCx
->
LTR
 = 
LowThªshﬁd
;

1118 
	}
}

1145 
	$ADC_A«logW©chdogSögÀCh™√lC⁄fig
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_Ch™√l
)

1147 
uöt32_t
 
tm¥eg
 = 0;

1149 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1150 
	`as£π_∑øm
(
	`IS_ADC_CHANNEL
(
ADC_Ch™√l
));

1152 
tm¥eg
 = 
ADCx
->
CR1
;

1154 
tm¥eg
 &
CR1_AWDCH_Re£t
;

1156 
tm¥eg
 |
ADC_Ch™√l
;

1158 
ADCx
->
CR1
 = 
tm¥eg
;

1159 
	}
}

1167 
	$ADC_TempSís‹VªfötCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

1170 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1171 i‡(
NewSèã
 !
DISABLE
)

1174 
ADC1
->
CR2
 |
CR2_TSVREFE_Së
;

1179 
ADC1
->
CR2
 &
CR2_TSVREFE_Re£t
;

1181 
	}
}

1195 
FœgSètus
 
	$ADC_GëFœgSètus
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_FLAG
)

1197 
FœgSètus
 
bô°©us
 = 
RESET
;

1199 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1200 
	`as£π_∑øm
(
	`IS_ADC_GET_FLAG
(
ADC_FLAG
));

1202 i‡((
ADCx
->
SR
 & 
ADC_FLAG
Ë!(
uöt8_t
)
RESET
)

1205 
bô°©us
 = 
SET
;

1210 
bô°©us
 = 
RESET
;

1213  
bô°©us
;

1214 
	}
}

1228 
	$ADC_CÀ¨Fœg
(
ADC_Ty≥Def
* 
ADCx
, 
uöt8_t
 
ADC_FLAG
)

1231 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1232 
	`as£π_∑øm
(
	`IS_ADC_CLEAR_FLAG
(
ADC_FLAG
));

1234 
ADCx
->
SR
 = ~(
uöt32_t
)
ADC_FLAG
;

1235 
	}
}

1247 
ITSètus
 
	$ADC_GëITSètus
(
ADC_Ty≥Def
* 
ADCx
, 
uöt16_t
 
ADC_IT
)

1249 
ITSètus
 
bô°©us
 = 
RESET
;

1250 
uöt32_t
 
ômask
 = 0, 
íabÀ°©us
 = 0;

1252 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1253 
	`as£π_∑øm
(
	`IS_ADC_GET_IT
(
ADC_IT
));

1255 
ômask
 = 
ADC_IT
 >> 8;

1257 
íabÀ°©us
 = (
ADCx
->
CR1
 & (
uöt8_t
)
ADC_IT
) ;

1259 i‡(((
ADCx
->
SR
 & 
ômask
Ë!(
uöt32_t
)
RESET
Ë&& 
íabÀ°©us
)

1262 
bô°©us
 = 
SET
;

1267 
bô°©us
 = 
RESET
;

1270  
bô°©us
;

1271 
	}
}

1283 
	$ADC_CÀ¨ITPídögBô
(
ADC_Ty≥Def
* 
ADCx
, 
uöt16_t
 
ADC_IT
)

1285 
uöt8_t
 
ômask
 = 0;

1287 
	`as£π_∑øm
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1288 
	`as£π_∑øm
(
	`IS_ADC_IT
(
ADC_IT
));

1290 
ômask
 = (
uöt8_t
)(
ADC_IT
 >> 8);

1292 
ADCx
->
SR
 = ~(
uöt32_t
)
ômask
;

1293 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~2.C

23 
	~"°m32f10x_bkp.h
"

24 
	~"°m32f10x_rcc.h
"

48 
	#BKP_OFFSET
 (
BKP_BASE
 - 
PERIPH_BASE
)

	)

53 
	#CR_OFFSET
 (
BKP_OFFSET
 + 0x30)

	)

54 
	#TPAL_BôNumbî
 0x01

	)

55 
	#CR_TPAL_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
TPAL_BôNumbî
 * 4))

	)

58 
	#TPE_BôNumbî
 0x00

	)

59 
	#CR_TPE_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32Ë+ (
TPE_BôNumbî
 * 4))

	)

64 
	#CSR_OFFSET
 (
BKP_OFFSET
 + 0x34)

	)

65 
	#TPIE_BôNumbî
 0x02

	)

66 
	#CSR_TPIE_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
TPIE_BôNumbî
 * 4))

	)

69 
	#TIF_BôNumbî
 0x09

	)

70 
	#CSR_TIF_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
TIF_BôNumbî
 * 4))

	)

73 
	#TEF_BôNumbî
 0x08

	)

74 
	#CSR_TEF_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
TEF_BôNumbî
 * 4))

	)

79 
	#RTCCR_CAL_MASK
 ((
uöt16_t
)0xFF80)

	)

80 
	#RTCCR_MASK
 ((
uöt16_t
)0xFC7F)

	)

120 
	$BKP_DeInô
()

122 
	`RCC_BackupRe£tCmd
(
ENABLE
);

123 
	`RCC_BackupRe£tCmd
(
DISABLE
);

124 
	}
}

134 
	$BKP_Tam≥rPöLevñC⁄fig
(
uöt16_t
 
BKP_Tam≥rPöLevñ
)

137 
	`as£π_∑øm
(
	`IS_BKP_TAMPER_PIN_LEVEL
(
BKP_Tam≥rPöLevñ
));

138 *(
__IO
 
uöt32_t
 *Ë
CR_TPAL_BB
 = 
BKP_Tam≥rPöLevñ
;

139 
	}
}

147 
	$BKP_Tam≥rPöCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

150 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

151 *(
__IO
 
uöt32_t
 *Ë
CR_TPE_BB
 = (uöt32_t)
NewSèã
;

152 
	}
}

160 
	$BKP_ITC⁄fig
(
Fun˘i⁄ÆSèã
 
NewSèã
)

163 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

164 *(
__IO
 
uöt32_t
 *Ë
CSR_TPIE_BB
 = (uöt32_t)
NewSèã
;

165 
	}
}

180 
	$BKP_RTCOuçutC⁄fig
(
uöt16_t
 
BKP_RTCOuçutSour˚
)

182 
uöt16_t
 
tm¥eg
 = 0;

184 
	`as£π_∑øm
(
	`IS_BKP_RTC_OUTPUT_SOURCE
(
BKP_RTCOuçutSour˚
));

185 
tm¥eg
 = 
BKP
->
RTCCR
;

187 
tm¥eg
 &
RTCCR_MASK
;

190 
tm¥eg
 |
BKP_RTCOuçutSour˚
;

192 
BKP
->
RTCCR
 = 
tm¥eg
;

193 
	}
}

201 
	$BKP_SëRTCCÆibøti⁄VÆue
(
uöt8_t
 
CÆibøti⁄VÆue
)

203 
uöt16_t
 
tm¥eg
 = 0;

205 
	`as£π_∑øm
(
	`IS_BKP_CALIBRATION_VALUE
(
CÆibøti⁄VÆue
));

206 
tm¥eg
 = 
BKP
->
RTCCR
;

208 
tm¥eg
 &
RTCCR_CAL_MASK
;

210 
tm¥eg
 |
CÆibøti⁄VÆue
;

212 
BKP
->
RTCCR
 = 
tm¥eg
;

213 
	}
}

222 
	$BKP_WrôeBackupRegi°î
(
uöt16_t
 
BKP_DR
, uöt16_à
D©a
)

224 
__IO
 
uöt32_t
 
tmp
 = 0;

227 
	`as£π_∑øm
(
	`IS_BKP_DR
(
BKP_DR
));

229 
tmp
 = (
uöt32_t
)
BKP_BASE
;

230 
tmp
 +
BKP_DR
;

232 *(
__IO
 
uöt32_t
 *Ë
tmp
 = 
D©a
;

233 
	}
}

241 
uöt16_t
 
	$BKP_RódBackupRegi°î
(
uöt16_t
 
BKP_DR
)

243 
__IO
 
uöt32_t
 
tmp
 = 0;

246 
	`as£π_∑øm
(
	`IS_BKP_DR
(
BKP_DR
));

248 
tmp
 = (
uöt32_t
)
BKP_BASE
;

249 
tmp
 +
BKP_DR
;

251  (*(
__IO
 
uöt16_t
 *Ë
tmp
);

252 
	}
}

259 
FœgSètus
 
	$BKP_GëFœgSètus
()

261  (
FœgSètus
)(*(
__IO
 
uöt32_t
 *Ë
CSR_TEF_BB
);

262 
	}
}

269 
	$BKP_CÀ¨Fœg
()

272 
BKP
->
CSR
 |
BKP_CSR_CTE
;

273 
	}
}

280 
ITSètus
 
	$BKP_GëITSètus
()

282  (
ITSètus
)(*(
__IO
 
uöt32_t
 *Ë
CSR_TIF_BB
);

283 
	}
}

290 
	$BKP_CÀ¨ITPídögBô
()

293 
BKP
->
CSR
 |
BKP_CSR_CTI
;

294 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~3.C

23 
	~"°m32f10x_ˇn.h
"

24 
	~"°m32f10x_rcc.h
"

49 
	#MCR_DBF
 ((
uöt32_t
)0x00010000Ë

	)

52 
	#TMIDxR_TXRQ
 ((
uöt32_t
)0x00000001Ë

	)

55 
	#FMR_FINIT
 ((
uöt32_t
)0x00000001Ë

	)

58 
	#INAK_TIMEOUT
 ((
uöt32_t
)0x0000FFFF)

	)

60 
	#SLAK_TIMEOUT
 ((
uöt32_t
)0x0000FFFF)

	)

65 
	#CAN_FLAGS_TSR
 ((
uöt32_t
)0x08000000)

	)

67 
	#CAN_FLAGS_RF1R
 ((
uöt32_t
)0x04000000)

	)

69 
	#CAN_FLAGS_RF0R
 ((
uöt32_t
)0x02000000)

	)

71 
	#CAN_FLAGS_MSR
 ((
uöt32_t
)0x01000000)

	)

73 
	#CAN_FLAGS_ESR
 ((
uöt32_t
)0x00F00000)

	)

76 
	#CAN_TXMAILBOX_0
 ((
uöt8_t
)0x00)

	)

77 
	#CAN_TXMAILBOX_1
 ((
uöt8_t
)0x01)

	)

78 
	#CAN_TXMAILBOX_2
 ((
uöt8_t
)0x02)

	)

82 
	#CAN_MODE_MASK
 ((
uöt32_t
Ë0x00000003)

	)

107 
ITSètus
 
CheckITSètus
(
uöt32_t
 
CAN_Reg
, uöt32_à
It_Bô
);

122 
	$CAN_DeInô
(
CAN_Ty≥Def
* 
CANx
)

125 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

127 i‡(
CANx
 =
CAN1
)

130 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_CAN1
, 
ENABLE
);

132 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_CAN1
, 
DISABLE
);

137 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_CAN2
, 
ENABLE
);

139 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_CAN2
, 
DISABLE
);

141 
	}
}

154 
uöt8_t
 
	$CAN_Inô
(
CAN_Ty≥Def
* 
CANx
, 
CAN_InôTy≥Def
* 
CAN_InôSåu˘
)

156 
uöt8_t
 
InôSètus
 = 
CAN_InôSètus_Faûed
;

157 
uöt32_t
 
waô_ack
 = 0x00000000;

159 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

160 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_InôSåu˘
->
CAN_TTCM
));

161 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_InôSåu˘
->
CAN_ABOM
));

162 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_InôSåu˘
->
CAN_AWUM
));

163 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_InôSåu˘
->
CAN_NART
));

164 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_InôSåu˘
->
CAN_RFLM
));

165 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_InôSåu˘
->
CAN_TXFP
));

166 
	`as£π_∑øm
(
	`IS_CAN_MODE
(
CAN_InôSåu˘
->
CAN_Mode
));

167 
	`as£π_∑øm
(
	`IS_CAN_SJW
(
CAN_InôSåu˘
->
CAN_SJW
));

168 
	`as£π_∑øm
(
	`IS_CAN_BS1
(
CAN_InôSåu˘
->
CAN_BS1
));

169 
	`as£π_∑øm
(
	`IS_CAN_BS2
(
CAN_InôSåu˘
->
CAN_BS2
));

170 
	`as£π_∑øm
(
	`IS_CAN_PRESCALER
(
CAN_InôSåu˘
->
CAN_PªsˇÀr
));

173 
CANx
->
MCR
 &(~(
uöt32_t
)
CAN_MCR_SLEEP
);

176 
CANx
->
MCR
 |
CAN_MCR_INRQ
 ;

179 ((
CANx
->
MSR
 & 
CAN_MSR_INAK
Ë!CAN_MSR_INAKË&& (
waô_ack
 !
INAK_TIMEOUT
))

181 
waô_ack
++;

185 i‡((
CANx
->
MSR
 & 
CAN_MSR_INAK
) != CAN_MSR_INAK)

187 
InôSètus
 = 
CAN_InôSètus_Faûed
;

192 i‡(
CAN_InôSåu˘
->
CAN_TTCM
 =
ENABLE
)

194 
CANx
->
MCR
 |
CAN_MCR_TTCM
;

198 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_TTCM
;

202 i‡(
CAN_InôSåu˘
->
CAN_ABOM
 =
ENABLE
)

204 
CANx
->
MCR
 |
CAN_MCR_ABOM
;

208 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_ABOM
;

212 i‡(
CAN_InôSåu˘
->
CAN_AWUM
 =
ENABLE
)

214 
CANx
->
MCR
 |
CAN_MCR_AWUM
;

218 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_AWUM
;

222 i‡(
CAN_InôSåu˘
->
CAN_NART
 =
ENABLE
)

224 
CANx
->
MCR
 |
CAN_MCR_NART
;

228 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_NART
;

232 i‡(
CAN_InôSåu˘
->
CAN_RFLM
 =
ENABLE
)

234 
CANx
->
MCR
 |
CAN_MCR_RFLM
;

238 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_RFLM
;

242 i‡(
CAN_InôSåu˘
->
CAN_TXFP
 =
ENABLE
)

244 
CANx
->
MCR
 |
CAN_MCR_TXFP
;

248 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_TXFP
;

252 
CANx
->
BTR
 = (
uöt32_t
)((uöt32_t)
CAN_InôSåu˘
->
CAN_Mode
 << 30) | \

253 ((
uöt32_t
)
CAN_InôSåu˘
->
CAN_SJW
 << 24) | \

254 ((
uöt32_t
)
CAN_InôSåu˘
->
CAN_BS1
 << 16) | \

255 ((
uöt32_t
)
CAN_InôSåu˘
->
CAN_BS2
 << 20) | \

256 ((
uöt32_t
)
CAN_InôSåu˘
->
CAN_PªsˇÀr
 - 1);

259 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_INRQ
;

262 
waô_ack
 = 0;

264 ((
CANx
->
MSR
 & 
CAN_MSR_INAK
Ë=CAN_MSR_INAKË&& (
waô_ack
 !
INAK_TIMEOUT
))

266 
waô_ack
++;

270 i‡((
CANx
->
MSR
 & 
CAN_MSR_INAK
) == CAN_MSR_INAK)

272 
InôSètus
 = 
CAN_InôSètus_Faûed
;

276 
InôSètus
 = 
CAN_InôSètus_Suc˚ss
 ;

281  
InôSètus
;

282 
	}
}

292 
	$CAN_FûãrInô
(
CAN_FûãrInôTy≥Def
* 
CAN_FûãrInôSåu˘
)

294 
uöt32_t
 
fûãr_numbî_bô_pos
 = 0;

296 
	`as£π_∑øm
(
	`IS_CAN_FILTER_NUMBER
(
CAN_FûãrInôSåu˘
->
CAN_FûãrNumbî
));

297 
	`as£π_∑øm
(
	`IS_CAN_FILTER_MODE
(
CAN_FûãrInôSåu˘
->
CAN_FûãrMode
));

298 
	`as£π_∑øm
(
	`IS_CAN_FILTER_SCALE
(
CAN_FûãrInôSåu˘
->
CAN_FûãrSˇÀ
));

299 
	`as£π_∑øm
(
	`IS_CAN_FILTER_FIFO
(
CAN_FûãrInôSåu˘
->
CAN_FûãrFIFOAssignmít
));

300 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
CAN_FûãrInôSåu˘
->
CAN_FûãrA˘iv©i⁄
));

302 
fûãr_numbî_bô_pos
 = ((
uöt32_t
)1Ë<< 
CAN_FûãrInôSåu˘
->
CAN_FûãrNumbî
;

305 
CAN1
->
FMR
 |
FMR_FINIT
;

308 
CAN1
->
FA1R
 &~(
uöt32_t
)
fûãr_numbî_bô_pos
;

311 i‡(
CAN_FûãrInôSåu˘
->
CAN_FûãrSˇÀ
 =
CAN_FûãrSˇÀ_16bô
)

314 
CAN1
->
FS1R
 &~(
uöt32_t
)
fûãr_numbî_bô_pos
;

318 
CAN1
->
sFûãrRegi°î
[
CAN_FûãrInôSåu˘
->
CAN_FûãrNumbî
].
FR1
 =

319 ((0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrMaskIdLow
) << 16) |

320 (0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrIdLow
);

324 
CAN1
->
sFûãrRegi°î
[
CAN_FûãrInôSåu˘
->
CAN_FûãrNumbî
].
FR2
 =

325 ((0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrMaskIdHigh
) << 16) |

326 (0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrIdHigh
);

329 i‡(
CAN_FûãrInôSåu˘
->
CAN_FûãrSˇÀ
 =
CAN_FûãrSˇÀ_32bô
)

332 
CAN1
->
FS1R
 |
fûãr_numbî_bô_pos
;

334 
CAN1
->
sFûãrRegi°î
[
CAN_FûãrInôSåu˘
->
CAN_FûãrNumbî
].
FR1
 =

335 ((0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrIdHigh
) << 16) |

336 (0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrIdLow
);

338 
CAN1
->
sFûãrRegi°î
[
CAN_FûãrInôSåu˘
->
CAN_FûãrNumbî
].
FR2
 =

339 ((0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrMaskIdHigh
) << 16) |

340 (0x0000FFFF & (
uöt32_t
)
CAN_FûãrInôSåu˘
->
CAN_FûãrMaskIdLow
);

344 i‡(
CAN_FûãrInôSåu˘
->
CAN_FûãrMode
 =
CAN_FûãrMode_IdMask
)

347 
CAN1
->
FM1R
 &~(
uöt32_t
)
fûãr_numbî_bô_pos
;

352 
CAN1
->
FM1R
 |(
uöt32_t
)
fûãr_numbî_bô_pos
;

356 i‡(
CAN_FûãrInôSåu˘
->
CAN_FûãrFIFOAssignmít
 =
CAN_Fûãr_FIFO0
)

359 
CAN1
->
FFA1R
 &~(
uöt32_t
)
fûãr_numbî_bô_pos
;

362 i‡(
CAN_FûãrInôSåu˘
->
CAN_FûãrFIFOAssignmít
 =
CAN_Fûãr_FIFO1
)

365 
CAN1
->
FFA1R
 |(
uöt32_t
)
fûãr_numbî_bô_pos
;

369 i‡(
CAN_FûãrInôSåu˘
->
CAN_FûãrA˘iv©i⁄
 =
ENABLE
)

371 
CAN1
->
FA1R
 |
fûãr_numbî_bô_pos
;

375 
CAN1
->
FMR
 &~
FMR_FINIT
;

376 
	}
}

384 
	$CAN_Såu˘Inô
(
CAN_InôTy≥Def
* 
CAN_InôSåu˘
)

389 
CAN_InôSåu˘
->
CAN_TTCM
 = 
DISABLE
;

392 
CAN_InôSåu˘
->
CAN_ABOM
 = 
DISABLE
;

395 
CAN_InôSåu˘
->
CAN_AWUM
 = 
DISABLE
;

398 
CAN_InôSåu˘
->
CAN_NART
 = 
DISABLE
;

401 
CAN_InôSåu˘
->
CAN_RFLM
 = 
DISABLE
;

404 
CAN_InôSåu˘
->
CAN_TXFP
 = 
DISABLE
;

407 
CAN_InôSåu˘
->
CAN_Mode
 = 
CAN_Mode_N‹mÆ
;

410 
CAN_InôSåu˘
->
CAN_SJW
 = 
CAN_SJW_1tq
;

413 
CAN_InôSåu˘
->
CAN_BS1
 = 
CAN_BS1_4tq
;

416 
CAN_InôSåu˘
->
CAN_BS2
 = 
CAN_BS2_3tq
;

419 
CAN_InôSåu˘
->
CAN_PªsˇÀr
 = 1;

420 
	}
}

428 
	$CAN_SœveSèπB™k
(
uöt8_t
 
CAN_B™kNumbî
)

431 
	`as£π_∑øm
(
	`IS_CAN_BANKNUMBER
(
CAN_B™kNumbî
));

434 
CAN1
->
FMR
 |
FMR_FINIT
;

437 
CAN1
->
FMR
 &(
uöt32_t
)0xFFFFC0F1 ;

438 
CAN1
->
FMR
 |(
uöt32_t
)(
CAN_B™kNumbî
)<<8;

441 
CAN1
->
FMR
 &~
FMR_FINIT
;

442 
	}
}

451 
	$CAN_DBGFªeze
(
CAN_Ty≥Def
* 
CANx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

454 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

455 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

457 i‡(
NewSèã
 !
DISABLE
)

460 
CANx
->
MCR
 |
MCR_DBF
;

465 
CANx
->
MCR
 &~
MCR_DBF
;

467 
	}
}

481 
	$CAN_TTComModeCmd
(
CAN_Ty≥Def
* 
CANx
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

484 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

485 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

486 i‡(
NewSèã
 !
DISABLE
)

489 
CANx
->
MCR
 |
CAN_MCR_TTCM
;

492 
CANx
->
sTxMaûBox
[0].
TDTR
 |((
uöt32_t
)
CAN_TDT0R_TGT
);

493 
CANx
->
sTxMaûBox
[1].
TDTR
 |((
uöt32_t
)
CAN_TDT1R_TGT
);

494 
CANx
->
sTxMaûBox
[2].
TDTR
 |((
uöt32_t
)
CAN_TDT2R_TGT
);

499 
CANx
->
MCR
 &(
uöt32_t
)(~(uöt32_t)
CAN_MCR_TTCM
);

502 
CANx
->
sTxMaûBox
[0].
TDTR
 &((
uöt32_t
)~
CAN_TDT0R_TGT
);

503 
CANx
->
sTxMaûBox
[1].
TDTR
 &((
uöt32_t
)~
CAN_TDT1R_TGT
);

504 
CANx
->
sTxMaûBox
[2].
TDTR
 &((
uöt32_t
)~
CAN_TDT2R_TGT
);

506 
	}
}

515 
uöt8_t
 
	$CAN_Tønsmô
(
CAN_Ty≥Def
* 
CANx
, 
C™TxMsg
* 
TxMesßge
)

517 
uöt8_t
 
å™smô_maûbox
 = 0;

519 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

520 
	`as£π_∑øm
(
	`IS_CAN_IDTYPE
(
TxMesßge
->
IDE
));

521 
	`as£π_∑øm
(
	`IS_CAN_RTR
(
TxMesßge
->
RTR
));

522 
	`as£π_∑øm
(
	`IS_CAN_DLC
(
TxMesßge
->
DLC
));

525 i‡((
CANx
->
TSR
&
CAN_TSR_TME0
) == CAN_TSR_TME0)

527 
å™smô_maûbox
 = 0;

529 i‡((
CANx
->
TSR
&
CAN_TSR_TME1
) == CAN_TSR_TME1)

531 
å™smô_maûbox
 = 1;

533 i‡((
CANx
->
TSR
&
CAN_TSR_TME2
) == CAN_TSR_TME2)

535 
å™smô_maûbox
 = 2;

539 
å™smô_maûbox
 = 
CAN_TxSètus_NoMaûBox
;

542 i‡(
å™smô_maûbox
 !
CAN_TxSètus_NoMaûBox
)

545 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TIR
 &
TMIDxR_TXRQ
;

546 i‡(
TxMesßge
->
IDE
 =
CAN_Id_Sènd¨d
)

548 
	`as£π_∑øm
(
	`IS_CAN_STDID
(
TxMesßge
->
StdId
));

549 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TIR
 |((
TxMesßge
->
StdId
 << 21) | \

550 
TxMesßge
->
RTR
);

554 
	`as£π_∑øm
(
	`IS_CAN_EXTID
(
TxMesßge
->
ExtId
));

555 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TIR
 |((
TxMesßge
->
ExtId
 << 3) | \

556 
TxMesßge
->
IDE
 | \

557 
TxMesßge
->
RTR
);

561 
TxMesßge
->
DLC
 &(
uöt8_t
)0x0000000F;

562 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TDTR
 &(
uöt32_t
)0xFFFFFFF0;

563 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TDTR
 |
TxMesßge
->
DLC
;

566 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TDLR
 = (((
uöt32_t
)
TxMesßge
->
D©a
[3] << 24) |

567 ((
uöt32_t
)
TxMesßge
->
D©a
[2] << 16) |

568 ((
uöt32_t
)
TxMesßge
->
D©a
[1] << 8) |

569 ((
uöt32_t
)
TxMesßge
->
D©a
[0]));

570 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TDHR
 = (((
uöt32_t
)
TxMesßge
->
D©a
[7] << 24) |

571 ((
uöt32_t
)
TxMesßge
->
D©a
[6] << 16) |

572 ((
uöt32_t
)
TxMesßge
->
D©a
[5] << 8) |

573 ((
uöt32_t
)
TxMesßge
->
D©a
[4]));

575 
CANx
->
sTxMaûBox
[
å™smô_maûbox
].
TIR
 |
TMIDxR_TXRQ
;

577  
å™smô_maûbox
;

578 
	}
}

589 
uöt8_t
 
	$CAN_TønsmôSètus
(
CAN_Ty≥Def
* 
CANx
, 
uöt8_t
 
TønsmôMaûbox
)

591 
uöt32_t
 
°©e
 = 0;

594 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

595 
	`as£π_∑øm
(
	`IS_CAN_TRANSMITMAILBOX
(
TønsmôMaûbox
));

597 
TønsmôMaûbox
)

599 (
CAN_TXMAILBOX_0
):

600 
°©e
 = 
CANx
->
TSR
 & (
CAN_TSR_RQCP0
 | 
CAN_TSR_TXOK0
 | 
CAN_TSR_TME0
);

602 (
CAN_TXMAILBOX_1
):

603 
°©e
 = 
CANx
->
TSR
 & (
CAN_TSR_RQCP1
 | 
CAN_TSR_TXOK1
 | 
CAN_TSR_TME1
);

605 (
CAN_TXMAILBOX_2
):

606 
°©e
 = 
CANx
->
TSR
 & (
CAN_TSR_RQCP2
 | 
CAN_TSR_TXOK2
 | 
CAN_TSR_TME2
);

609 
°©e
 = 
CAN_TxSètus_Faûed
;

612 
°©e
)

615 (0x0): 
°©e
 = 
CAN_TxSètus_Pídög
;

618 (
CAN_TSR_RQCP0
 | 
CAN_TSR_TME0
): 
°©e
 = 
CAN_TxSètus_Faûed
;

620 (
CAN_TSR_RQCP1
 | 
CAN_TSR_TME1
): 
°©e
 = 
CAN_TxSètus_Faûed
;

622 (
CAN_TSR_RQCP2
 | 
CAN_TSR_TME2
): 
°©e
 = 
CAN_TxSètus_Faûed
;

625 (
CAN_TSR_RQCP0
 | 
CAN_TSR_TXOK0
 | 
CAN_TSR_TME0
):
°©e
 = 
CAN_TxSètus_Ok
;

627 (
CAN_TSR_RQCP1
 | 
CAN_TSR_TXOK1
 | 
CAN_TSR_TME1
):
°©e
 = 
CAN_TxSètus_Ok
;

629 (
CAN_TSR_RQCP2
 | 
CAN_TSR_TXOK2
 | 
CAN_TSR_TME2
):
°©e
 = 
CAN_TxSètus_Ok
;

631 : 
°©e
 = 
CAN_TxSètus_Faûed
;

634  (
uöt8_t
Ë
°©e
;

635 
	}
}

643 
	$CAN_C™˚lTønsmô
(
CAN_Ty≥Def
* 
CANx
, 
uöt8_t
 
Maûbox
)

646 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

647 
	`as£π_∑øm
(
	`IS_CAN_TRANSMITMAILBOX
(
Maûbox
));

649 
Maûbox
)

651 (
CAN_TXMAILBOX_0
): 
CANx
->
TSR
 |
CAN_TSR_ABRQ0
;

653 (
CAN_TXMAILBOX_1
): 
CANx
->
TSR
 |
CAN_TSR_ABRQ1
;

655 (
CAN_TXMAILBOX_2
): 
CANx
->
TSR
 |
CAN_TSR_ABRQ2
;

660 
	}
}

671 
	$CAN_Re˚ive
(
CAN_Ty≥Def
* 
CANx
, 
uöt8_t
 
FIFONumbî
, 
C™RxMsg
* 
RxMesßge
)

674 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

675 
	`as£π_∑øm
(
	`IS_CAN_FIFO
(
FIFONumbî
));

677 
RxMesßge
->
IDE
 = (
uöt8_t
)0x04 & 
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RIR
;

678 i‡(
RxMesßge
->
IDE
 =
CAN_Id_Sènd¨d
)

680 
RxMesßge
->
StdId
 = (
uöt32_t
)0x000007FF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RIR
 >> 21);

684 
RxMesßge
->
ExtId
 = (
uöt32_t
)0x1FFFFFFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RIR
 >> 3);

687 
RxMesßge
->
RTR
 = (
uöt8_t
)0x02 & 
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RIR
;

689 
RxMesßge
->
DLC
 = (
uöt8_t
)0x0F & 
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDTR
;

691 
RxMesßge
->
FMI
 = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDTR
 >> 8);

693 
RxMesßge
->
D©a
[0] = (
uöt8_t
)0xFF & 
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDLR
;

694 
RxMesßge
->
D©a
[1] = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDLR
 >> 8);

695 
RxMesßge
->
D©a
[2] = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDLR
 >> 16);

696 
RxMesßge
->
D©a
[3] = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDLR
 >> 24);

697 
RxMesßge
->
D©a
[4] = (
uöt8_t
)0xFF & 
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDHR
;

698 
RxMesßge
->
D©a
[5] = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDHR
 >> 8);

699 
RxMesßge
->
D©a
[6] = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDHR
 >> 16);

700 
RxMesßge
->
D©a
[7] = (
uöt8_t
)0xFF & (
CANx
->
sFIFOMaûBox
[
FIFONumbî
].
RDHR
 >> 24);

703 i‡(
FIFONumbî
 =
CAN_FIFO0
)

705 
CANx
->
RF0R
 |
CAN_RF0R_RFOM0
;

710 
CANx
->
RF1R
 |
CAN_RF1R_RFOM1
;

712 
	}
}

720 
	$CAN_FIFORñó£
(
CAN_Ty≥Def
* 
CANx
, 
uöt8_t
 
FIFONumbî
)

723 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

724 
	`as£π_∑øm
(
	`IS_CAN_FIFO
(
FIFONumbî
));

726 i‡(
FIFONumbî
 =
CAN_FIFO0
)

728 
CANx
->
RF0R
 |
CAN_RF0R_RFOM0
;

733 
CANx
->
RF1R
 |
CAN_RF1R_RFOM1
;

735 
	}
}

743 
uöt8_t
 
	$CAN_MesßgePídög
(
CAN_Ty≥Def
* 
CANx
, 
uöt8_t
 
FIFONumbî
)

745 
uöt8_t
 
mesßge_≥ndög
=0;

747 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

748 
	`as£π_∑øm
(
	`IS_CAN_FIFO
(
FIFONumbî
));

749 i‡(
FIFONumbî
 =
CAN_FIFO0
)

751 
mesßge_≥ndög
 = (
uöt8_t
)(
CANx
->
RF0R
&(
uöt32_t
)0x03);

753 i‡(
FIFONumbî
 =
CAN_FIFO1
)

755 
mesßge_≥ndög
 = (
uöt8_t
)(
CANx
->
RF1R
&(
uöt32_t
)0x03);

759 
mesßge_≥ndög
 = 0;

761  
mesßge_≥ndög
;

762 
	}
}

774 
uöt8_t
 
	$CAN_O≥øtögModeReque°
(
CAN_Ty≥Def
* 
CANx
, 
uöt8_t
 
CAN_O≥øtögMode
)

776 
uöt8_t
 
°©us
 = 
CAN_ModeSètus_Faûed
;

779 
uöt32_t
 
timeout
 = 
INAK_TIMEOUT
;

782 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

783 
	`as£π_∑øm
(
	`IS_CAN_OPERATING_MODE
(
CAN_O≥øtögMode
));

785 i‡(
CAN_O≥øtögMode
 =
CAN_O≥øtögMode_Inôüliz©i⁄
)

788 
CANx
->
MCR
 = (
uöt32_t
)((CANx->MCR & (uöt32_t)(~(uöt32_t)
CAN_MCR_SLEEP
)Ë| 
CAN_MCR_INRQ
);

791 ((
CANx
->
MSR
 & 
CAN_MODE_MASK
Ë!
CAN_MSR_INAK
Ë&& (
timeout
 != 0))

793 
timeout
--;

795 i‡((
CANx
->
MSR
 & 
CAN_MODE_MASK
Ë!
CAN_MSR_INAK
)

797 
°©us
 = 
CAN_ModeSètus_Faûed
;

801 
°©us
 = 
CAN_ModeSètus_Suc˚ss
;

804 i‡(
CAN_O≥øtögMode
 =
CAN_O≥øtögMode_N‹mÆ
)

807 
CANx
->
MCR
 &(
uöt32_t
)(~(
CAN_MCR_SLEEP
|
CAN_MCR_INRQ
));

810 ((
CANx
->
MSR
 & 
CAN_MODE_MASK
Ë!0Ë&& (
timeout
!=0))

812 
timeout
--;

814 i‡((
CANx
->
MSR
 & 
CAN_MODE_MASK
) != 0)

816 
°©us
 = 
CAN_ModeSètus_Faûed
;

820 
°©us
 = 
CAN_ModeSètus_Suc˚ss
;

823 i‡(
CAN_O≥øtögMode
 =
CAN_O≥øtögMode_SÀï
)

826 
CANx
->
MCR
 = (
uöt32_t
)((CANx->MCR & (uöt32_t)(~(uöt32_t)
CAN_MCR_INRQ
)Ë| 
CAN_MCR_SLEEP
);

829 ((
CANx
->
MSR
 & 
CAN_MODE_MASK
Ë!
CAN_MSR_SLAK
Ë&& (
timeout
!=0))

831 
timeout
--;

833 i‡((
CANx
->
MSR
 & 
CAN_MODE_MASK
Ë!
CAN_MSR_SLAK
)

835 
°©us
 = 
CAN_ModeSètus_Faûed
;

839 
°©us
 = 
CAN_ModeSètus_Suc˚ss
;

844 
°©us
 = 
CAN_ModeSètus_Faûed
;

847  (
uöt8_t
Ë
°©us
;

848 
	}
}

856 
uöt8_t
 
	$CAN_SÀï
(
CAN_Ty≥Def
* 
CANx
)

858 
uöt8_t
 
¶ìp°©us
 = 
CAN_SÀï_Faûed
;

861 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

864 
CANx
->
MCR
 = (((CANx->MCRË& (
uöt32_t
)(~(uöt32_t)
CAN_MCR_INRQ
)Ë| 
CAN_MCR_SLEEP
);

867 i‡((
CANx
->
MSR
 & (
CAN_MSR_SLAK
|
CAN_MSR_INAK
)) == CAN_MSR_SLAK)

870 
¶ìp°©us
 = 
CAN_SÀï_Ok
;

873  (
uöt8_t
)
¶ìp°©us
;

874 
	}
}

882 
uöt8_t
 
	$CAN_WakeUp
(
CAN_Ty≥Def
* 
CANx
)

884 
uöt32_t
 
waô_¶ak
 = 
SLAK_TIMEOUT
;

885 
uöt8_t
 
wakeup°©us
 = 
CAN_WakeUp_Faûed
;

888 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

891 
CANx
->
MCR
 &~(
uöt32_t
)
CAN_MCR_SLEEP
;

894 ((
CANx
->
MSR
 & 
CAN_MSR_SLAK
Ë=CAN_MSR_SLAK)&&(
waô_¶ak
!=0x00))

896 
waô_¶ak
--;

898 if((
CANx
->
MSR
 & 
CAN_MSR_SLAK
) != CAN_MSR_SLAK)

901 
wakeup°©us
 = 
CAN_WakeUp_Ok
;

904  (
uöt8_t
)
wakeup°©us
;

905 
	}
}

922 
uöt8_t
 
	$CAN_GëLa°Eº‹Code
(
CAN_Ty≥Def
* 
CANx
)

924 
uöt8_t
 
îr‹code
=0;

927 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

930 
îr‹code
 = (((
uöt8_t
)
CANx
->
ESR
Ë& (uöt8_t)
CAN_ESR_LEC
);

933  
îr‹code
;

934 
	}
}

946 
uöt8_t
 
	$CAN_GëRe˚iveEº‹Cou¡î
(
CAN_Ty≥Def
* 
CANx
)

948 
uöt8_t
 
cou¡î
=0;

951 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

954 
cou¡î
 = (
uöt8_t
)((
CANx
->
ESR
 & 
CAN_ESR_REC
)>> 24);

957  
cou¡î
;

958 
	}
}

966 
uöt8_t
 
	$CAN_GëLSBTønsmôEº‹Cou¡î
(
CAN_Ty≥Def
* 
CANx
)

968 
uöt8_t
 
cou¡î
=0;

971 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

974 
cou¡î
 = (
uöt8_t
)((
CANx
->
ESR
 & 
CAN_ESR_TEC
)>> 16);

977  
cou¡î
;

978 
	}
}

1003 
	$CAN_ITC⁄fig
(
CAN_Ty≥Def
* 
CANx
, 
uöt32_t
 
CAN_IT
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

1006 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

1007 
	`as£π_∑øm
(
	`IS_CAN_IT
(
CAN_IT
));

1008 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

1010 i‡(
NewSèã
 !
DISABLE
)

1013 
CANx
->
IER
 |
CAN_IT
;

1018 
CANx
->
IER
 &~
CAN_IT
;

1020 
	}
}

1043 
FœgSètus
 
	$CAN_GëFœgSètus
(
CAN_Ty≥Def
* 
CANx
, 
uöt32_t
 
CAN_FLAG
)

1045 
FœgSètus
 
bô°©us
 = 
RESET
;

1048 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

1049 
	`as£π_∑øm
(
	`IS_CAN_GET_FLAG
(
CAN_FLAG
));

1052 if((
CAN_FLAG
 & 
CAN_FLAGS_ESR
Ë!(
uöt32_t
)
RESET
)

1055 i‡((
CANx
->
ESR
 & (
CAN_FLAG
 & 0x000FFFFF)Ë!(
uöt32_t
)
RESET
)

1058 
bô°©us
 = 
SET
;

1063 
bô°©us
 = 
RESET
;

1066 if((
CAN_FLAG
 & 
CAN_FLAGS_MSR
Ë!(
uöt32_t
)
RESET
)

1069 i‡((
CANx
->
MSR
 & (
CAN_FLAG
 & 0x000FFFFF)Ë!(
uöt32_t
)
RESET
)

1072 
bô°©us
 = 
SET
;

1077 
bô°©us
 = 
RESET
;

1080 if((
CAN_FLAG
 & 
CAN_FLAGS_TSR
Ë!(
uöt32_t
)
RESET
)

1083 i‡((
CANx
->
TSR
 & (
CAN_FLAG
 & 0x000FFFFF)Ë!(
uöt32_t
)
RESET
)

1086 
bô°©us
 = 
SET
;

1091 
bô°©us
 = 
RESET
;

1094 if((
CAN_FLAG
 & 
CAN_FLAGS_RF0R
Ë!(
uöt32_t
)
RESET
)

1097 i‡((
CANx
->
RF0R
 & (
CAN_FLAG
 & 0x000FFFFF)Ë!(
uöt32_t
)
RESET
)

1100 
bô°©us
 = 
SET
;

1105 
bô°©us
 = 
RESET
;

1111 i‡((
uöt32_t
)(
CANx
->
RF1R
 & (
CAN_FLAG
 & 0x000FFFFF)Ë!(uöt32_t)
RESET
)

1114 
bô°©us
 = 
SET
;

1119 
bô°©us
 = 
RESET
;

1123  
bô°©us
;

1124 
	}
}

1143 
	$CAN_CÀ¨Fœg
(
CAN_Ty≥Def
* 
CANx
, 
uöt32_t
 
CAN_FLAG
)

1145 
uöt32_t
 
Êagtmp
=0;

1147 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

1148 
	`as£π_∑øm
(
	`IS_CAN_CLEAR_FLAG
(
CAN_FLAG
));

1150 i‡(
CAN_FLAG
 =
CAN_FLAG_LEC
)

1153 
CANx
->
ESR
 = (
uöt32_t
)
RESET
;

1157 
Êagtmp
 = 
CAN_FLAG
 & 0x000FFFFF;

1159 i‡((
CAN_FLAG
 & 
CAN_FLAGS_RF0R
)!=(
uöt32_t
)
RESET
)

1162 
CANx
->
RF0R
 = (
uöt32_t
)(
Êagtmp
);

1164 i‡((
CAN_FLAG
 & 
CAN_FLAGS_RF1R
)!=(
uöt32_t
)
RESET
)

1167 
CANx
->
RF1R
 = (
uöt32_t
)(
Êagtmp
);

1169 i‡((
CAN_FLAG
 & 
CAN_FLAGS_TSR
)!=(
uöt32_t
)
RESET
)

1172 
CANx
->
TSR
 = (
uöt32_t
)(
Êagtmp
);

1177 
CANx
->
MSR
 = (
uöt32_t
)(
Êagtmp
);

1180 
	}
}

1203 
ITSètus
 
	$CAN_GëITSètus
(
CAN_Ty≥Def
* 
CANx
, 
uöt32_t
 
CAN_IT
)

1205 
ITSètus
 
ô°©us
 = 
RESET
;

1207 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

1208 
	`as£π_∑øm
(
	`IS_CAN_IT
(
CAN_IT
));

1211 if((
CANx
->
IER
 & 
CAN_IT
Ë!
RESET
)

1214 
CAN_IT
)

1216 
CAN_IT_TME
:

1218 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
TSR
, 
CAN_TSR_RQCP0
|
CAN_TSR_RQCP1
|
CAN_TSR_RQCP2
);

1220 
CAN_IT_FMP0
:

1222 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
RF0R
, 
CAN_RF0R_FMP0
);

1224 
CAN_IT_FF0
:

1226 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
RF0R
, 
CAN_RF0R_FULL0
);

1228 
CAN_IT_FOV0
:

1230 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
RF0R
, 
CAN_RF0R_FOVR0
);

1232 
CAN_IT_FMP1
:

1234 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
RF1R
, 
CAN_RF1R_FMP1
);

1236 
CAN_IT_FF1
:

1238 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
RF1R
, 
CAN_RF1R_FULL1
);

1240 
CAN_IT_FOV1
:

1242 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
RF1R
, 
CAN_RF1R_FOVR1
);

1244 
CAN_IT_WKU
:

1246 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
MSR
, 
CAN_MSR_WKUI
);

1248 
CAN_IT_SLK
:

1250 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
MSR
, 
CAN_MSR_SLAKI
);

1252 
CAN_IT_EWG
:

1254 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
ESR
, 
CAN_ESR_EWGF
);

1256 
CAN_IT_EPV
:

1258 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
ESR
, 
CAN_ESR_EPVF
);

1260 
CAN_IT_BOF
:

1262 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
ESR
, 
CAN_ESR_BOFF
);

1264 
CAN_IT_LEC
:

1266 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
ESR
, 
CAN_ESR_LEC
);

1268 
CAN_IT_ERR
:

1270 
ô°©us
 = 
	`CheckITSètus
(
CANx
->
MSR
, 
CAN_MSR_ERRI
);

1274 
ô°©us
 = 
RESET
;

1281 
ô°©us
 = 
RESET
;

1285  
ô°©us
;

1286 
	}
}

1306 
	$CAN_CÀ¨ITPídögBô
(
CAN_Ty≥Def
* 
CANx
, 
uöt32_t
 
CAN_IT
)

1309 
	`as£π_∑øm
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

1310 
	`as£π_∑øm
(
	`IS_CAN_CLEAR_IT
(
CAN_IT
));

1312 
CAN_IT
)

1314 
CAN_IT_TME
:

1316 
CANx
->
TSR
 = 
CAN_TSR_RQCP0
|
CAN_TSR_RQCP1
|
CAN_TSR_RQCP2
;

1318 
CAN_IT_FF0
:

1320 
CANx
->
RF0R
 = 
CAN_RF0R_FULL0
;

1322 
CAN_IT_FOV0
:

1324 
CANx
->
RF0R
 = 
CAN_RF0R_FOVR0
;

1326 
CAN_IT_FF1
:

1328 
CANx
->
RF1R
 = 
CAN_RF1R_FULL1
;

1330 
CAN_IT_FOV1
:

1332 
CANx
->
RF1R
 = 
CAN_RF1R_FOVR1
;

1334 
CAN_IT_WKU
:

1336 
CANx
->
MSR
 = 
CAN_MSR_WKUI
;

1338 
CAN_IT_SLK
:

1340 
CANx
->
MSR
 = 
CAN_MSR_SLAKI
;

1342 
CAN_IT_EWG
:

1344 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1348 
CAN_IT_EPV
:

1350 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1354 
CAN_IT_BOF
:

1356 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1360 
CAN_IT_LEC
:

1362 
CANx
->
ESR
 = 
RESET
;

1364 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1366 
CAN_IT_ERR
:

1368 
CANx
->
ESR
 = 
RESET
;

1370 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1377 
	}
}

1385 
ITSètus
 
	$CheckITSètus
(
uöt32_t
 
CAN_Reg
, uöt32_à
It_Bô
)

1387 
ITSètus
 
≥ndögbô°©us
 = 
RESET
;

1389 i‡((
CAN_Reg
 & 
It_Bô
Ë!(
uöt32_t
)
RESET
)

1392 
≥ndögbô°©us
 = 
SET
;

1397 
≥ndögbô°©us
 = 
RESET
;

1399  
≥ndögbô°©us
;

1400 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~4.C

23 
	~"°m32f10x_˚c.h
"

24 
	~"°m32f10x_rcc.h
"

49 
	#CEC_OFFSET
 (
CEC_BASE
 - 
PERIPH_BASE
)

	)

54 
	#CFGR_OFFSET
 (
CEC_OFFSET
 + 0x00)

	)

55 
	#PE_BôNumbî
 0x00

	)

56 
	#CFGR_PE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32Ë+ (
PE_BôNumbî
 * 4))

	)

59 
	#IE_BôNumbî
 0x01

	)

60 
	#CFGR_IE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32Ë+ (
IE_BôNumbî
 * 4))

	)

65 
	#CSR_OFFSET
 (
CEC_OFFSET
 + 0x10)

	)

66 
	#TSOM_BôNumbî
 0x00

	)

67 
	#CSR_TSOM_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
TSOM_BôNumbî
 * 4))

	)

70 
	#TEOM_BôNumbî
 0x01

	)

71 
	#CSR_TEOM_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32Ë+ (
TEOM_BôNumbî
 * 4))

	)

73 
	#CFGR_CLEAR_Mask
 (
uöt8_t
)(0xF3Ë

	)

74 
	#FLAG_Mask
 ((
uöt32_t
)0x00FFFFFFË

	)

118 
	$CEC_DeInô
()

121 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_CEC
, 
ENABLE
);

123 
	`RCC_APB1PîùhRe£tCmd
(
RCC_APB1Pîùh_CEC
, 
DISABLE
);

124 
	}
}

135 
	$CEC_Inô
(
CEC_InôTy≥Def
* 
CEC_InôSåu˘
)

137 
uöt16_t
 
tm¥eg
 = 0;

140 
	`as£π_∑øm
(
	`IS_CEC_BIT_TIMING_ERROR_MODE
(
CEC_InôSåu˘
->
CEC_BôTimögMode
));

141 
	`as£π_∑øm
(
	`IS_CEC_BIT_PERIOD_ERROR_MODE
(
CEC_InôSåu˘
->
CEC_BôPîiodMode
));

145 
tm¥eg
 = 
CEC
->
CFGR
;

148 
tm¥eg
 &
CFGR_CLEAR_Mask
;

151 
tm¥eg
 |(
uöt16_t
)(
CEC_InôSåu˘
->
CEC_BôTimögMode
 | CEC_InôSåu˘->
CEC_BôPîiodMode
);

154 
CEC
->
CFGR
 = 
tm¥eg
;

156 
	}
}

164 
	$CEC_Cmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

167 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

169 *(
__IO
 
uöt32_t
 *Ë
CFGR_PE_BB
 = (uöt32_t)
NewSèã
;

171 if(
NewSèã
 =
DISABLE
)

174 (
CEC
->
CFGR
 & 
CEC_CFGR_PE
Ë!(
uöt32_t
)
RESET
)

178 
	}
}

186 
	$CEC_ITC⁄fig
(
Fun˘i⁄ÆSèã
 
NewSèã
)

189 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

191 *(
__IO
 
uöt32_t
 *Ë
CFGR_IE_BB
 = (uöt32_t)
NewSèã
;

192 
	}
}

199 
	$CEC_OwnAddªssC⁄fig
(
uöt8_t
 
CEC_OwnAddªss
)

202 
	`as£π_∑øm
(
	`IS_CEC_ADDRESS
(
CEC_OwnAddªss
));

205 
CEC
->
OAR
 = 
CEC_OwnAddªss
;

206 
	}
}

213 
	$CEC_SëPªsˇÀr
(
uöt16_t
 
CEC_PªsˇÀr
)

216 
	`as£π_∑øm
(
	`IS_CEC_PRESCALER
(
CEC_PªsˇÀr
));

219 
CEC
->
PRES
 = 
CEC_PªsˇÀr
;

220 
	}
}

227 
	$CEC_SídD©aByã
(
uöt8_t
 
D©a
)

230 
CEC
->
TXD
 = 
D©a
 ;

231 
	}
}

239 
uöt8_t
 
	$CEC_Re˚iveD©aByã
()

242  (
uöt8_t
)(
CEC
->
RXD
);

243 
	}
}

250 
	$CEC_SèπOfMesßge
()

253 *(
__IO
 
uöt32_t
 *Ë
CSR_TSOM_BB
 = (uint32_t)0x1;

254 
	}
}

262 
	$CEC_EndOfMesßgeCmd
(
Fun˘i⁄ÆSèã
 
NewSèã
)

265 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

268 *(
__IO
 
uöt32_t
 *Ë
CSR_TEOM_BB
 = (uöt32_t)
NewSèã
;

269 
	}
}

291 
FœgSètus
 
	$CEC_GëFœgSètus
(
uöt32_t
 
CEC_FLAG
)

293 
FœgSètus
 
bô°©us
 = 
RESET
;

294 
uöt32_t
 
˚¸eg
 = 0, 
˚cba£
 = 0;

297 
	`as£π_∑øm
(
	`IS_CEC_GET_FLAG
(
CEC_FLAG
));

300 
˚cba£
 = (
uöt32_t
)(
CEC_BASE
);

303 
˚¸eg
 = 
CEC_FLAG
 >> 28;

306 
CEC_FLAG
 &
FLAG_Mask
;

308 if(
˚¸eg
 != 0)

311 
CEC_FLAG
 = (
uöt32_t
)(CEC_FLAG >> 16);

314 
˚cba£
 += 0xC;

319 
˚cba£
 += 0x10;

322 if(((*(
__IO
 
uöt32_t
 *)
˚cba£
Ë& 
CEC_FLAG
Ë!(uöt32_t)
RESET
)

325 
bô°©us
 = 
SET
;

330 
bô°©us
 = 
RESET
;

334  
bô°©us
;

335 
	}
}

349 
	$CEC_CÀ¨Fœg
(
uöt32_t
 
CEC_FLAG
)

351 
uöt32_t
 
tmp
 = 0x0;

354 
	`as£π_∑øm
(
	`IS_CEC_CLEAR_FLAG
(
CEC_FLAG
));

356 
tmp
 = 
CEC
->
CSR
 & 0x2;

359 
CEC
->
CSR
 &(
uöt32_t
)(((~(uöt32_t)
CEC_FLAG
Ë& 0xFFFFFFFCË| 
tmp
);

360 
	}
}

372 
ITSètus
 
	$CEC_GëITSètus
(
uöt8_t
 
CEC_IT
)

374 
ITSètus
 
bô°©us
 = 
RESET
;

375 
uöt32_t
 
íabÀ°©us
 = 0;

378 
	`as£π_∑øm
(
	`IS_CEC_GET_IT
(
CEC_IT
));

381 
íabÀ°©us
 = (
CEC
->
CFGR
 & (
uöt8_t
)
CEC_CFGR_IE
) ;

384 i‡(((
CEC
->
CSR
 & 
CEC_IT
Ë!(
uöt32_t
)
RESET
Ë&& 
íabÀ°©us
)

387 
bô°©us
 = 
SET
;

392 
bô°©us
 = 
RESET
;

395  
bô°©us
;

396 
	}
}

408 
	$CEC_CÀ¨ITPídögBô
(
uöt16_t
 
CEC_IT
)

410 
uöt32_t
 
tmp
 = 0x0;

413 
	`as£π_∑øm
(
	`IS_CEC_GET_IT
(
CEC_IT
));

415 
tmp
 = 
CEC
->
CSR
 & 0x2;

418 
CEC
->
CSR
 &(
uöt32_t
)(((~(uöt32_t)
CEC_IT
Ë& 0xFFFFFFFCË| 
tmp
);

419 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FWlib\src\misc.c

24 
	~"misc.h
"

47 
	#AIRCR_VECTKEY_MASK
 ((
uöt32_t
)0x05FA0000)

	)

96 
	$NVIC_Pri‹ôyGroupC⁄fig
(
uöt32_t
 
NVIC_Pri‹ôyGroup
)

99 
	`as£π_∑øm
(
	`IS_NVIC_PRIORITY_GROUP
(
NVIC_Pri‹ôyGroup
));

102 
SCB
->
AIRCR
 = 
AIRCR_VECTKEY_MASK
 | 
NVIC_Pri‹ôyGroup
;

103 
	}
}

112 
	$NVIC_Inô
(
NVIC_InôTy≥Def
* 
NVIC_InôSåu˘
)

114 
uöt32_t
 
tmµri‹ôy
 = 0x00, 
tmµª
 = 0x00, 
tmpsub
 = 0x0F;

117 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NVIC_InôSåu˘
->
NVIC_IRQCh™√lCmd
));

118 
	`as£π_∑øm
(
	`IS_NVIC_PREEMPTION_PRIORITY
(
NVIC_InôSåu˘
->
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
));

119 
	`as£π_∑øm
(
	`IS_NVIC_SUB_PRIORITY
(
NVIC_InôSåu˘
->
NVIC_IRQCh™√lSubPri‹ôy
));

121 i‡(
NVIC_InôSåu˘
->
NVIC_IRQCh™√lCmd
 !
DISABLE
)

124 
tmµri‹ôy
 = (0x700 - ((
SCB
->
AIRCR
Ë& (
uöt32_t
)0x700))>> 0x08;

125 
tmµª
 = (0x4 - 
tmµri‹ôy
);

126 
tmpsub
 =Åmpsub >> 
tmµri‹ôy
;

128 
tmµri‹ôy
 = (
uöt32_t
)
NVIC_InôSåu˘
->
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
 << 
tmµª
;

129 
tmµri‹ôy
 |
NVIC_InôSåu˘
->
NVIC_IRQCh™√lSubPri‹ôy
 & 
tmpsub
;

130 
tmµri‹ôy
 =Åmppriority << 0x04;

132 
NVIC
->
IP
[
NVIC_InôSåu˘
->
NVIC_IRQCh™√l
] = 
tmµri‹ôy
;

135 
NVIC
->
ISER
[
NVIC_InôSåu˘
->
NVIC_IRQCh™√l
 >> 0x05] =

136 (
uöt32_t
)0x01 << (
NVIC_InôSåu˘
->
NVIC_IRQCh™√l
 & (
uöt8_t
)0x1F);

141 
NVIC
->
ICER
[
NVIC_InôSåu˘
->
NVIC_IRQCh™√l
 >> 0x05] =

142 (
uöt32_t
)0x01 << (
NVIC_InôSåu˘
->
NVIC_IRQCh™√l
 & (
uöt8_t
)0x1F);

144 
	}
}

156 
	$NVIC_SëVe˘‹TabÀ
(
uöt32_t
 
NVIC_Ve˘Tab
, uöt32_à
Off£t
)

159 
	`as£π_∑øm
(
	`IS_NVIC_VECTTAB
(
NVIC_Ve˘Tab
));

160 
	`as£π_∑øm
(
	`IS_NVIC_OFFSET
(
Off£t
));

162 
SCB
->
VTOR
 = 
NVIC_Ve˘Tab
 | (
Off£t
 & (
uöt32_t
)0x1FFFFF80);

163 
	}
}

175 
	$NVIC_Sy°emLPC⁄fig
(
uöt8_t
 
LowPowîMode
, 
Fun˘i⁄ÆSèã
 
NewSèã
)

178 
	`as£π_∑øm
(
	`IS_NVIC_LP
(
LowPowîMode
));

179 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
NewSèã
));

181 i‡(
NewSèã
 !
DISABLE
)

183 
SCB
->
SCR
 |
LowPowîMode
;

187 
SCB
->
SCR
 &(
uöt32_t
)(~(uöt32_t)
LowPowîMode
);

189 
	}
}

199 
	$SysTick_CLKSour˚C⁄fig
(
uöt32_t
 
SysTick_CLKSour˚
)

202 
	`as£π_∑øm
(
	`IS_SYSTICK_CLK_SOURCE
(
SysTick_CLKSour˚
));

203 i‡(
SysTick_CLKSour˚
 =
SysTick_CLKSour˚_HCLK
)

205 
SysTick
->
CTRL
 |
SysTick_CLKSour˚_HCLK
;

209 
SysTick
->
CTRL
 &
SysTick_CLKSour˚_HCLK_Div8
;

211 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\croutine.c

54 
	~"FªeRTOS.h
"

55 
	~"èsk.h
"

56 
	~"¸outöe.h
"

62 #ifde‡
p‹tREMOVE_STATIC_QUALIFIER


63 

	)

68 
xLi°
 
	gpxRódyCoRoutöeLi°s
[ 
c⁄figMAX_CO_ROUTINE_PRIORITIES
 ];

69 
xLi°
 
	gxDñayedCoRoutöeLi°1
;

70 
xLi°
 
	gxDñayedCoRoutöeLi°2
;

71 
xLi°
 * 
	gpxDñayedCoRoutöeLi°
;

72 
xLi°
 * 
	gpxOvîÊowDñayedCoRoutöeLi°
;

73 
xLi°
 
	gxPídögRódyCoRoutöeLi°
;

76 
c‹CRCB
 * 
	gpxCuºítCoRoutöe
 = 
NULL
;

77 
p‹tBASE_TYPE
 
	guxT›CoRoutöeRódyPri‹ôy
 = 0;

78 
p‹tTickTy≥
 
	gxCoRoutöeTickCou¡
 = 0, 
	gxLa°TickCou¡
 = 0, 
	gxPas£dTicks
 = 0;

81 
	#c‹INITIAL_STATE
 ( 0 )

	)

90 
	#¥vAddCoRoutöeToRódyQueue
–
pxCRCB
 ) \

92 if–
pxCRCB
->
uxPri‹ôy
 > 
uxT›CoRoutöeRódyPri‹ôy
 ) \

94 
uxT›CoRoutöeRódyPri‹ôy
 = 
pxCRCB
->
uxPri‹ôy
; \

96 
	`vLi°In£πEnd
––
xLi°
 * ) &–
pxRódyCoRoutöeLi°s
[ 
pxCRCB
->
uxPri‹ôy
 ] ), &–pxCRCB->
xGíîicLi°Iãm
 ) ); \

97 }

	)

103 
¥vInôüli£CoRoutöeLi°s
( );

111 
¥vCheckPídögRódyLi°
( );

121 
¥vCheckDñayedLi°
( );

125 sig√d 
p‹tBASE_TYPE
 
	$xCoRoutöeCª©e
–
¸COROUTINE_CODE
 
pxCoRoutöeCode
, 
p‹tBASE_TYPE
 
uxPri‹ôy
, p‹tBASE_TYPE 
uxIndex
 )

127 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

128 
c‹CRCB
 *
pxCoRoutöe
;

131 
pxCoRoutöe
 = ( 
c‹CRCB
 * ) 
	`pvP‹tMÆloc
( ( corCRCB ) );

132 if–
pxCoRoutöe
 )

136 if–
pxCuºítCoRoutöe
 =
NULL
 )

138 
pxCuºítCoRoutöe
 = 
pxCoRoutöe
;

139 
	`¥vInôüli£CoRoutöeLi°s
();

143 if–
uxPri‹ôy
 >
c⁄figMAX_CO_ROUTINE_PRIORITIES
 )

145 
uxPri‹ôy
 = 
c⁄figMAX_CO_ROUTINE_PRIORITIES
 - 1;

149 
pxCoRoutöe
->
uxSèã
 = 
c‹INITIAL_STATE
;

150 
pxCoRoutöe
->
uxPri‹ôy
 = uxPriority;

151 
pxCoRoutöe
->
uxIndex
 = uxIndex;

152 
pxCoRoutöe
->
pxCoRoutöeFun˘i⁄
 = 
pxCoRoutöeCode
;

155 
	`vLi°Inôüli£Iãm
–&–
pxCoRoutöe
->
xGíîicLi°Iãm
 ) );

156 
	`vLi°Inôüli£Iãm
–&–
pxCoRoutöe
->
xEvítLi°Iãm
 ) );

161 
	`li°SET_LIST_ITEM_OWNER
–&–
pxCoRoutöe
->
xGíîicLi°Iãm
 ),ÖxCoRoutine );

162 
	`li°SET_LIST_ITEM_OWNER
–&–
pxCoRoutöe
->
xEvítLi°Iãm
 ),ÖxCoRoutine );

165 
	`li°SET_LIST_ITEM_VALUE
–&–
pxCoRoutöe
->
xEvítLi°Iãm
 ), 
c⁄figMAX_PRIORITIES
 - ( 
p‹tTickTy≥
 ) 
uxPri‹ôy
 );

169 
	`¥vAddCoRoutöeToRódyQueue
–
pxCoRoutöe
 );

171 
xRëu∫
 = 
pdPASS
;

175 
xRëu∫
 = 
îrCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
;

178  
xRëu∫
;

179 
	}
}

182 
	$vCoRoutöeAddToDñayedLi°
–
p‹tTickTy≥
 
xTicksToDñay
, 
xLi°
 *
pxEvítLi°
 )

184 
p‹tTickTy≥
 
xTimeToWake
;

188 
xTimeToWake
 = 
xCoRoutöeTickCou¡
 + 
xTicksToDñay
;

193 
	`vLi°Remove
––
xLi°Iãm
 * ) &–
pxCuºítCoRoutöe
->
xGíîicLi°Iãm
 ) );

196 
	`li°SET_LIST_ITEM_VALUE
–&–
pxCuºítCoRoutöe
->
xGíîicLi°Iãm
 ), 
xTimeToWake
 );

198 if–
xTimeToWake
 < 
xCoRoutöeTickCou¡
 )

202 
	`vLi°In£π
––
xLi°
 * ) 
pxOvîÊowDñayedCoRoutöeLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítCoRoutöe
->
xGíîicLi°Iãm
 ) );

208 
	`vLi°In£π
––
xLi°
 * ) 
pxDñayedCoRoutöeLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítCoRoutöe
->
xGíîicLi°Iãm
 ) );

211 if–
pxEvítLi°
 )

215 
	`vLi°In£π
–
pxEvítLi°
, &–
pxCuºítCoRoutöe
->
xEvítLi°Iãm
 ) );

217 
	}
}

220 
	$¥vCheckPídögRódyLi°
( )

225  
	`li°LIST_IS_EMPTY
–&
xPídögRódyCoRoutöeLi°
 ) =
pdFALSE
 )

227 
c‹CRCB
 *
pxUnblockedCRCB
;

230 
	`p‹tDISABLE_INTERRUPTS
();

232 
pxUnblockedCRCB
 = ( 
c‹CRCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–(&
xPídögRódyCoRoutöeLi°
) );

233 
	`vLi°Remove
–&–
pxUnblockedCRCB
->
xEvítLi°Iãm
 ) );

235 
	`p‹tENABLE_INTERRUPTS
();

237 
	`vLi°Remove
–&–
pxUnblockedCRCB
->
xGíîicLi°Iãm
 ) );

238 
	`¥vAddCoRoutöeToRódyQueue
–
pxUnblockedCRCB
 );

240 
	}
}

243 
	$¥vCheckDñayedLi°
( )

245 
c‹CRCB
 *
pxCRCB
;

247 
xPas£dTicks
 = 
	`xTaskGëTickCou¡
(Ë- 
xLa°TickCou¡
;

248  
xPas£dTicks
 )

250 
xCoRoutöeTickCou¡
++;

251 
xPas£dTicks
--;

254 if–
xCoRoutöeTickCou¡
 == 0 )

256 
xLi°
 * 
pxTemp
;

260 
pxTemp
 = 
pxDñayedCoRoutöeLi°
;

261 
pxDñayedCoRoutöeLi°
 = 
pxOvîÊowDñayedCoRoutöeLi°
;

262 
pxOvîÊowDñayedCoRoutöeLi°
 = 
pxTemp
;

266  
	`li°LIST_IS_EMPTY
–
pxDñayedCoRoutöeLi°
 ) =
pdFALSE
 )

268 
pxCRCB
 = ( 
c‹CRCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxDñayedCoRoutöeLi°
 );

270 if–
xCoRoutöeTickCou¡
 < 
	`li°GET_LIST_ITEM_VALUE
–&–
pxCRCB
->
xGíîicLi°Iãm
 ) ) )

276 
	`p‹tDISABLE_INTERRUPTS
();

283 
	`vLi°Remove
–&–
pxCRCB
->
xGíîicLi°Iãm
 ) );

286 if–
pxCRCB
->
xEvítLi°Iãm
.
pvC⁄èöî
 )

288 
	`vLi°Remove
–&–
pxCRCB
->
xEvítLi°Iãm
 ) );

291 
	`p‹tENABLE_INTERRUPTS
();

293 
	`¥vAddCoRoutöeToRódyQueue
–
pxCRCB
 );

297 
xLa°TickCou¡
 = 
xCoRoutöeTickCou¡
;

298 
	}
}

301 
	$vCoRoutöeScheduÀ
( )

304 
	`¥vCheckPídögRódyLi°
();

307 
	`¥vCheckDñayedLi°
();

310  
	`li°LIST_IS_EMPTY
–&–
pxRódyCoRoutöeLi°s
[ 
uxT›CoRoutöeRódyPri‹ôy
 ] ) ) )

312 if–
uxT›CoRoutöeRódyPri‹ôy
 == 0 )

317 --
uxT›CoRoutöeRódyPri‹ôy
;

322 
	`li°GET_OWNER_OF_NEXT_ENTRY
–
pxCuºítCoRoutöe
, &–
pxRódyCoRoutöeLi°s
[ 
uxT›CoRoutöeRódyPri‹ôy
 ] ) );

325 –
pxCuºítCoRoutöe
->
pxCoRoutöeFun˘i⁄
 )–pxCuºítCoRoutöe,ÖxCuºítCoRoutöe->
uxIndex
 );

328 
	}
}

331 
	$¥vInôüli£CoRoutöeLi°s
( )

333 
p‹tBASE_TYPE
 
uxPri‹ôy
;

335  
uxPri‹ôy
 = 0; uxPri‹ôy < 
c⁄figMAX_CO_ROUTINE_PRIORITIES
; uxPriority++ )

337 
	`vLi°Inôüli£
––
xLi°
 * ) &–
pxRódyCoRoutöeLi°s
[ 
uxPri‹ôy
 ] ) );

340 
	`vLi°Inôüli£
––
xLi°
 * ) &
xDñayedCoRoutöeLi°1
 );

341 
	`vLi°Inôüli£
––
xLi°
 * ) &
xDñayedCoRoutöeLi°2
 );

342 
	`vLi°Inôüli£
––
xLi°
 * ) &
xPídögRódyCoRoutöeLi°
 );

346 
pxDñayedCoRoutöeLi°
 = &
xDñayedCoRoutöeLi°1
;

347 
pxOvîÊowDñayedCoRoutöeLi°
 = &
xDñayedCoRoutöeLi°2
;

348 
	}
}

351 sig√d 
p‹tBASE_TYPE
 
	$xCoRoutöeRemoveFromEvítLi°
–c⁄° 
xLi°
 *
pxEvítLi°
 )

353 
c‹CRCB
 *
pxUnblockedCRCB
;

354 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

359 
pxUnblockedCRCB
 = ( 
c‹CRCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxEvítLi°
 );

360 
	`vLi°Remove
–&–
pxUnblockedCRCB
->
xEvítLi°Iãm
 ) );

361 
	`vLi°In£πEnd
––
xLi°
 * ) &–
xPídögRódyCoRoutöeLi°
 ), &–
pxUnblockedCRCB
->
xEvítLi°Iãm
 ) );

363 if–
pxUnblockedCRCB
->
uxPri‹ôy
 >
pxCuºítCoRoutöe
->uxPriority )

365 
xRëu∫
 = 
pdTRUE
;

369 
xRëu∫
 = 
pdFALSE
;

372  
xRëu∫
;

373 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\heap_2.c

62 
	~<°dlib.h
>

67 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

69 
	~"FªeRTOS.h
"

70 
	~"èsk.h
"

72 #unde‡
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


76 
	uxRTOS_HEAP


78 #i‡
p‹tBYTE_ALIGNMENT
 == 8

79 vﬁ©ûê
p‹tDOUBLE
 
	mdDummy
;

81 vﬁ©ûê
	mulDummy
;

83 
	mucHóp
[ 
c⁄figTOTAL_HEAP_SIZE
 ];

84 } 
	gxHóp
;

88 
	sA_BLOCK_LINK


90 
A_BLOCK_LINK
 *
	mpxNextFªeBlock
;

91 
size_t
 
	mxBlockSize
;

92 } 
	txBlockLök
;

95 c⁄° 
	ghópSTRUCT_SIZE
 = ( –
xBlockLök
 ) + 
p‹tBYTE_ALIGNMENT
 - ( ( xBlockLink ) %ÖortBYTE_ALIGNMENT ) );

96 
	#hópMINIMUM_BLOCK_SIZE
 ( ( 
size_t
 ) ( 
hópSTRUCT_SIZE
 * 2 ) )

	)

99 
xBlockLök
 
	gxSèπ
, 
	gxEnd
;

103 
size_t
 
	gxFªeByãsRemaöög
 = 
c⁄figTOTAL_HEAP_SIZE
;

112 
	#¥vIn£πBlockI¡oFªeLi°
–
pxBlockToIn£π
 ) \

114 
xBlockLök
 *
pxIãøt‹
; \

115 
size_t
 
xBlockSize
; \

117 
xBlockSize
 = 
pxBlockToIn£π
->xBlockSize; \

121  
pxIãøt‹
 = &
xSèπ
;ÖxIãøt‹->
pxNextFªeBlock
->
xBlockSize
 < xBlockSize;ÖxIterator =ÖxIterator->pxNextFreeBlock ) \

128 
pxBlockToIn£π
->
pxNextFªeBlock
 = 
pxIãøt‹
->pxNextFreeBlock; \

129 
pxIãøt‹
->
pxNextFªeBlock
 = 
pxBlockToIn£π
; \

130 }

	)

133 
	#¥vHópInô
() \

135 
xBlockLök
 *
pxFú°FªeBlock
; \

139 
xSèπ
.
pxNextFªeBlock
 = ( * ) 
xHóp
.
ucHóp
; \

140 
xSèπ
.
xBlockSize
 = ( 
size_t
 ) 0; \

143 
xEnd
.
xBlockSize
 = 
c⁄figTOTAL_HEAP_SIZE
; \

144 
xEnd
.
pxNextFªeBlock
 = 
NULL
; \

148 
pxFú°FªeBlock
 = ( * ) 
xHóp
.
ucHóp
; \

149 
pxFú°FªeBlock
->
xBlockSize
 = 
c⁄figTOTAL_HEAP_SIZE
; \

150 
pxFú°FªeBlock
->
pxNextFªeBlock
 = &
xEnd
; \

151 }

	)

154 *
	$pvP‹tMÆloc
–
size_t
 
xW™ãdSize
 )

156 
xBlockLök
 *
pxBlock
, *
pxPªviousBlock
, *
pxNewBlockLök
;

157 
p‹tBASE_TYPE
 
xHópHasBìnInôüli£d
 = 
pdFALSE
;

158 *
pvRëu∫
 = 
NULL
;

160 
	`vTaskSu•ídAŒ
();

164 if–
xHópHasBìnInôüli£d
 =
pdFALSE
 )

166 
	`¥vHópInô
();

167 
xHópHasBìnInôüli£d
 = 
pdTRUE
;

172 if–
xW™ãdSize
 > 0 )

174 
xW™ãdSize
 +
hópSTRUCT_SIZE
;

177 if–
xW™ãdSize
 & 
p‹tBYTE_ALIGNMENT_MASK
 )

180 
xW™ãdSize
 +–
p‹tBYTE_ALIGNMENT
 - ( xW™ãdSizê& 
p‹tBYTE_ALIGNMENT_MASK
 ) );

184 if––
xW™ãdSize
 > 0 ) && ( xW™ãdSizê< 
c⁄figTOTAL_HEAP_SIZE
 ) )

188 
pxPªviousBlock
 = &
xSèπ
;

189 
pxBlock
 = 
xSèπ
.
pxNextFªeBlock
;

190  ( 
pxBlock
->
xBlockSize
 < 
xW™ãdSize
 ) && (ÖxBlock->
pxNextFªeBlock
 ) )

192 
pxPªviousBlock
 = 
pxBlock
;

193 
pxBlock
 =ÖxBlock->
pxNextFªeBlock
;

197 if–
pxBlock
 !&
xEnd
 )

201 
pvRëu∫
 = ( * ) ( ( ( * ) 
pxPªviousBlock
->
pxNextFªeBlock
 ) + 
hópSTRUCT_SIZE
 );

205 
pxPªviousBlock
->
pxNextFªeBlock
 = 
pxBlock
->pxNextFreeBlock;

208 if––
pxBlock
->
xBlockSize
 - 
xW™ãdSize
 ) > 
hópMINIMUM_BLOCK_SIZE
 )

213 
pxNewBlockLök
 = ( * ) ( ( ( * ) 
pxBlock
 ) + 
xW™ãdSize
 );

217 
pxNewBlockLök
->
xBlockSize
 = 
pxBlock
->xBlockSizê- 
xW™ãdSize
;

218 
pxBlock
->
xBlockSize
 = 
xW™ãdSize
;

221 
	`¥vIn£πBlockI¡oFªeLi°
––
pxNewBlockLök
 ) );

224 
xFªeByãsRemaöög
 -
pxBlock
->
xBlockSize
;

228 
	`xTaskResumeAŒ
();

230 #if–
c⁄figUSE_MALLOC_FAILED_HOOK
 == 1 )

232 if–
pvRëu∫
 =
NULL
 )

234 
	`vAµliˇti⁄MÆlocFaûedHook
( );

235 
	`vAµliˇti⁄MÆlocFaûedHook
();

240  
pvRëu∫
;

241 
	}
}

244 
	$vP‹tFªe
–*
pv
 )

246 *
puc
 = ( * ) 
pv
;

247 
xBlockLök
 *
pxLök
;

249 if–
pv
 )

253 
puc
 -
hópSTRUCT_SIZE
;

256 
pxLök
 = ( * ) 
puc
;

258 
	`vTaskSu•ídAŒ
();

261 
	`¥vIn£πBlockI¡oFªeLi°
–––
xBlockLök
 * ) 
pxLök
 ) );

262 
xFªeByãsRemaöög
 +
pxLök
->
xBlockSize
;

264 
	`xTaskResumeAŒ
();

266 
	}
}

269 
size_t
 
	$xP‹tGëFªeHópSize
( )

271  
xFªeByãsRemaöög
;

272 
	}
}

275 
	$vP‹tInôüli£Blocks
( )

278 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\FREERT~1.H

54 #i‚de‡
FREERTOS_CONFIG_H


55 
	#FREERTOS_CONFIG_H


	)

69 
	#c⁄figUSE_PREEMPTION
 1

	)

70 
	#c⁄figUSE_IDLE_HOOK
 0

	)

71 
	#c⁄figUSE_TICK_HOOK
 0

	)

72 
	#c⁄figCPU_CLOCK_HZ
 ( ( Ë72000000 )

	)

73 
	#c⁄figTICK_RATE_HZ
 ( ( 
p‹tTickTy≥
 ) 1000 )

	)

74 
	#c⁄figMAX_PRIORITIES
 ( ( 
p‹tBASE_TYPE
 ) 5 )

	)

75 
	#c⁄figMINIMAL_STACK_SIZE
 ( ( Ë128 )

	)

76 
	#c⁄figMIDMAL_STACK_SIZE
 ( ( Ë256 )

	)

77 
	#c⁄figMAXMAL_STACK_SIZE
 ( ( Ë516 )

	)

78 
	#c⁄figTOTAL_HEAP_SIZE
 ( ( 
size_t
 ) ( 12 * 1024 ) )

	)

79 
	#c⁄figMAX_TASK_NAME_LEN
 ( 16 )

	)

80 
	#c⁄figUSE_TRACE_FACILITY
 0

	)

81 
	#c⁄figUSE_16_BIT_TICKS
 0

	)

82 
	#c⁄figIDLE_SHOULD_YIELD
 1

	)

85 
	#c⁄figUSE_CO_ROUTINES
 0

	)

86 
	#c⁄figMAX_CO_ROUTINE_PRIORITIES
 ( 2 )

	)

91 
	#INCLUDE_vTaskPri‹ôySë
 1

	)

92 
	#INCLUDE_uxTaskPri‹ôyGë
 1

	)

93 
	#INCLUDE_vTaskDñëe
 1

	)

94 
	#INCLUDE_vTaskCÀ™UpResour˚s
 0

	)

95 
	#INCLUDE_vTaskSu•íd
 1

	)

96 
	#INCLUDE_vTaskDñayU¡û
 1

	)

97 
	#INCLUDE_vTaskDñay
 1

	)

101 
	#c⁄figKERNEL_INTERRUPT_PRIORITY
 15

102 
	#c⁄figMAX_SYSCALL_INTERRUPT_PRIORITY
 3

	)

109 
	#c⁄figLIBRARY_KERNEL_INTERRUPT_PRIORITY
 15

	)

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\FreeRTOS.h

54 #i‚de‡
INC_FREERTOS_H


55 
	#INC_FREERTOS_H


	)

61 
	~<°ddef.h
>

64 
	~"¥ojdefs.h
"

67 
	~"FªeRTOSC⁄fig.h
"

70 
	~"p‹èbÀ.h
"

75 
	$p‹tBASE_TYPE
 (*
	tpdTASK_HOOK_CODE
)( * );

87 #i‚de‡
c⁄figUSE_PREEMPTION


88 #îr‹ 
Missög
 
deföôi⁄
: 
c⁄figUSE_PREEMPTION
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

91 #i‚de‡
c⁄figUSE_IDLE_HOOK


92 #îr‹ 
Missög
 
deföôi⁄
: 
c⁄figUSE_IDLE_HOOK
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

95 #i‚de‡
c⁄figUSE_TICK_HOOK


96 #îr‹ 
Missög
 
deföôi⁄
: 
c⁄figUSE_TICK_HOOK
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

99 #i‚de‡
c⁄figUSE_CO_ROUTINES


100 #îr‹ 
Missög
 
deföôi⁄
: 
c⁄figUSE_CO_ROUTINES
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

103 #i‚de‡
INCLUDE_vTaskPri‹ôySë


104 #îr‹ 
Missög
 
deföôi⁄
: 
INCLUDE_vTaskPri‹ôySë
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

107 #i‚de‡
INCLUDE_uxTaskPri‹ôyGë


108 #îr‹ 
Missög
 
deföôi⁄
: 
INCLUDE_uxTaskPri‹ôyGë
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

111 #i‚de‡
INCLUDE_vTaskDñëe


112 #îr‹ 
Missög
 
deföôi⁄
: 
INCLUDE_vTaskDñëe
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

115 #i‚de‡
INCLUDE_vTaskSu•íd


116 #îr‹ 
Missög
 
deföôi⁄
: 
INCLUDE_vTaskSu•íd
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

119 #i‚de‡
INCLUDE_vTaskDñayU¡û


120 #îr‹ 
Missög
 
deföôi⁄
: 
INCLUDE_vTaskDñayU¡û
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

123 #i‚de‡
INCLUDE_vTaskDñay


124 #îr‹ 
Missög
 
deföôi⁄
: 
INCLUDE_vTaskDñay
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

127 #i‚de‡
c⁄figUSE_16_BIT_TICKS


128 #îr‹ 
Missög
 
deföôi⁄
: 
c⁄figUSE_16_BIT_TICKS
 
should
 
be
 
deföed
 
ö
 
FªeRTOSC⁄fig
.
h
 
as
 
eôhî
 1 
‹
 0. 
Sì
 
the
 
C⁄figuøti⁄
 
£˘i⁄
 
of
Åhê
FªeRTOS
 
API
 
documíèti⁄
 
dëaûs
.

131 #i‚de‡
INCLUDE_xTaskGëIdÀTaskH™dÀ


132 
	#INCLUDE_xTaskGëIdÀTaskH™dÀ
 0

	)

135 #i‚de‡
INCLUDE_xTimîGëTimîD´m⁄TaskH™dÀ


136 
	#INCLUDE_xTimîGëTimîD´m⁄TaskH™dÀ
 0

	)

139 #i‚de‡
INCLUDE_pcTaskGëTaskName


140 
	#INCLUDE_pcTaskGëTaskName
 0

	)

143 #i‚de‡
c⁄figUSE_APPLICATION_TASK_TAG


144 
	#c⁄figUSE_APPLICATION_TASK_TAG
 0

	)

147 #i‚de‡
INCLUDE_uxTaskGëSèckHighW©îM¨k


148 
	#INCLUDE_uxTaskGëSèckHighW©îM¨k
 0

	)

151 #i‚de‡
c⁄figUSE_RECURSIVE_MUTEXES


152 
	#c⁄figUSE_RECURSIVE_MUTEXES
 0

	)

155 #i‚de‡
c⁄figUSE_MUTEXES


156 
	#c⁄figUSE_MUTEXES
 0

	)

159 #i‚de‡
c⁄figUSE_TIMERS


160 
	#c⁄figUSE_TIMERS
 0

	)

163 #i‚de‡
c⁄figUSE_COUNTING_SEMAPHORES


164 
	#c⁄figUSE_COUNTING_SEMAPHORES
 0

	)

167 #i‚de‡
c⁄figUSE_ALTERNATIVE_API


168 
	#c⁄figUSE_ALTERNATIVE_API
 0

	)

171 #i‚de‡
p‹tCRITICAL_NESTING_IN_TCB


172 
	#p‹tCRITICAL_NESTING_IN_TCB
 0

	)

175 #i‚de‡
c⁄figMAX_TASK_NAME_LEN


176 
	#c⁄figMAX_TASK_NAME_LEN
 16

	)

179 #i‚de‡
c⁄figIDLE_SHOULD_YIELD


180 
	#c⁄figIDLE_SHOULD_YIELD
 1

	)

183 #i‡
c⁄figMAX_TASK_NAME_LEN
 < 1

184 #îr‹ 
c⁄figMAX_TASK_NAME_LEN
 
mu°
 
be
 
£t
 
to
 
a
 
möimum
 
of
 1 
ö
 
FªeRTOSC⁄fig
.
h


187 #i‚de‡
INCLUDE_xTaskResumeFromISR


188 
	#INCLUDE_xTaskResumeFromISR
 1

	)

191 #i‚de‡
c⁄figASSERT


192 
	#c⁄figASSERT
–
x
 )

	)

196 #i‡
c⁄figUSE_TIMERS
 == 1

198 #i‚de‡
c⁄figTIMER_TASK_PRIORITY


199 #îr‹ 
If
 
c⁄figUSE_TIMERS
 
is
 
£t
 
to
 1 
thí
 
c⁄figTIMER_TASK_PRIORITY
 
mu°
 
Æso
 
be
 
deföed
.

202 #i‚de‡
c⁄figTIMER_QUEUE_LENGTH


203 #îr‹ 
If
 
c⁄figUSE_TIMERS
 
is
 
£t
 
to
 1 
thí
 
c⁄figTIMER_QUEUE_LENGTH
 
mu°
 
Æso
 
be
 
deföed
.

206 #i‚de‡
c⁄figTIMER_TASK_STACK_DEPTH


207 #îr‹ 
If
 
c⁄figUSE_TIMERS
 
is
 
£t
 
to
 1 
thí
 
c⁄figTIMER_TASK_STACK_DEPTH
 
mu°
 
Æso
 
be
 
deföed
.

212 #i‚de‡
INCLUDE_xTaskGëScheduÀrSèã


213 
	#INCLUDE_xTaskGëScheduÀrSèã
 0

	)

216 #i‚de‡
INCLUDE_xTaskGëCuºítTaskH™dÀ


217 
	#INCLUDE_xTaskGëCuºítTaskH™dÀ
 0

	)

221 #i‚de‡
p‹tSET_INTERRUPT_MASK_FROM_ISR


222 
	#p‹tSET_INTERRUPT_MASK_FROM_ISR
(Ë0

	)

225 #i‚de‡
p‹tCLEAR_INTERRUPT_MASK_FROM_ISR


226 
	#p‹tCLEAR_INTERRUPT_MASK_FROM_ISR
–
uxSavedSètusVÆue
 ) ( Ë
	)
uxSavedStatusValue

230 #i‚de‡
c⁄figQUEUE_REGISTRY_SIZE


231 
	#c⁄figQUEUE_REGISTRY_SIZE
 0U

	)

234 #i‡–
c⁄figQUEUE_REGISTRY_SIZE
 < 1 )

235 
	#vQueueAddToRegi°ry
–
xQueue
, 
pcName
 )

	)

236 
	#vQueueUƒegi°îQueue
–
xQueue
 )

	)

239 #i‚de‡
p‹tPOINTER_SIZE_TYPE


240 
	#p‹tPOINTER_SIZE_TYPE
 

	)

244 #i‚de‡
åa˚START


247 
	#åa˚START
()

	)

250 #i‚de‡
åa˚END


253 
	#åa˚END
()

	)

256 #i‚de‡
åa˚TASK_SWITCHED_IN


259 
	#åa˚TASK_SWITCHED_IN
()

	)

262 #i‚de‡
åa˚TASK_SWITCHED_OUT


265 
	#åa˚TASK_SWITCHED_OUT
()

	)

268 #i‚de‡
åa˚BLOCKING_ON_QUEUE_RECEIVE


273 
	#åa˚BLOCKING_ON_QUEUE_RECEIVE
–
pxQueue
 )

	)

276 #i‚de‡
åa˚BLOCKING_ON_QUEUE_SEND


281 
	#åa˚BLOCKING_ON_QUEUE_SEND
–
pxQueue
 )

	)

284 #i‚de‡
c⁄figCHECK_FOR_STACK_OVERFLOW


285 
	#c⁄figCHECK_FOR_STACK_OVERFLOW
 0

	)

290 #i‚de‡
åa˚QUEUE_CREATE


291 
	#åa˚QUEUE_CREATE
–
pxNewQueue
 )

	)

294 #i‚de‡
åa˚QUEUE_CREATE_FAILED


295 
	#åa˚QUEUE_CREATE_FAILED
()

	)

298 #i‚de‡
åa˚CREATE_MUTEX


299 
	#åa˚CREATE_MUTEX
–
pxNewQueue
 )

	)

302 #i‚de‡
åa˚CREATE_MUTEX_FAILED


303 
	#åa˚CREATE_MUTEX_FAILED
()

	)

306 #i‚de‡
åa˚GIVE_MUTEX_RECURSIVE


307 
	#åa˚GIVE_MUTEX_RECURSIVE
–
pxMuãx
 )

	)

310 #i‚de‡
åa˚GIVE_MUTEX_RECURSIVE_FAILED


311 
	#åa˚GIVE_MUTEX_RECURSIVE_FAILED
–
pxMuãx
 )

	)

314 #i‚de‡
åa˚TAKE_MUTEX_RECURSIVE


315 
	#åa˚TAKE_MUTEX_RECURSIVE
–
pxMuãx
 )

	)

318 #i‚de‡
åa˚TAKE_MUTEX_RECURSIVE_FAILED


319 
	#åa˚TAKE_MUTEX_RECURSIVE_FAILED
–
pxMuãx
 )

	)

322 #i‚de‡
åa˚CREATE_COUNTING_SEMAPHORE


323 
	#åa˚CREATE_COUNTING_SEMAPHORE
()

	)

326 #i‚de‡
åa˚CREATE_COUNTING_SEMAPHORE_FAILED


327 
	#åa˚CREATE_COUNTING_SEMAPHORE_FAILED
()

	)

330 #i‚de‡
åa˚QUEUE_SEND


331 
	#åa˚QUEUE_SEND
–
pxQueue
 )

	)

334 #i‚de‡
åa˚QUEUE_SEND_FAILED


335 
	#åa˚QUEUE_SEND_FAILED
–
pxQueue
 )

	)

338 #i‚de‡
åa˚QUEUE_RECEIVE


339 
	#åa˚QUEUE_RECEIVE
–
pxQueue
 )

	)

342 #i‚de‡
åa˚QUEUE_PEEK


343 
	#åa˚QUEUE_PEEK
–
pxQueue
 )

	)

346 #i‚de‡
åa˚QUEUE_RECEIVE_FAILED


347 
	#åa˚QUEUE_RECEIVE_FAILED
–
pxQueue
 )

	)

350 #i‚de‡
åa˚QUEUE_SEND_FROM_ISR


351 
	#åa˚QUEUE_SEND_FROM_ISR
–
pxQueue
 )

	)

354 #i‚de‡
åa˚QUEUE_SEND_FROM_ISR_FAILED


355 
	#åa˚QUEUE_SEND_FROM_ISR_FAILED
–
pxQueue
 )

	)

358 #i‚de‡
åa˚QUEUE_RECEIVE_FROM_ISR


359 
	#åa˚QUEUE_RECEIVE_FROM_ISR
–
pxQueue
 )

	)

362 #i‚de‡
åa˚QUEUE_RECEIVE_FROM_ISR_FAILED


363 
	#åa˚QUEUE_RECEIVE_FROM_ISR_FAILED
–
pxQueue
 )

	)

366 #i‚de‡
åa˚QUEUE_DELETE


367 
	#åa˚QUEUE_DELETE
–
pxQueue
 )

	)

370 #i‚de‡
åa˚TASK_CREATE


371 
	#åa˚TASK_CREATE
–
pxNewTCB
 )

	)

374 #i‚de‡
åa˚TASK_CREATE_FAILED


375 
	#åa˚TASK_CREATE_FAILED
()

	)

378 #i‚de‡
åa˚TASK_DELETE


379 
	#åa˚TASK_DELETE
–
pxTaskToDñëe
 )

	)

382 #i‚de‡
åa˚TASK_DELAY_UNTIL


383 
	#åa˚TASK_DELAY_UNTIL
()

	)

386 #i‚de‡
åa˚TASK_DELAY


387 
	#åa˚TASK_DELAY
()

	)

390 #i‚de‡
åa˚TASK_PRIORITY_SET


391 
	#åa˚TASK_PRIORITY_SET
–
pxTask
, 
uxNewPri‹ôy
 )

	)

394 #i‚de‡
åa˚TASK_SUSPEND


395 
	#åa˚TASK_SUSPEND
–
pxTaskToSu•íd
 )

	)

398 #i‚de‡
åa˚TASK_RESUME


399 
	#åa˚TASK_RESUME
–
pxTaskToResume
 )

	)

402 #i‚de‡
åa˚TASK_RESUME_FROM_ISR


403 
	#åa˚TASK_RESUME_FROM_ISR
–
pxTaskToResume
 )

	)

406 #i‚de‡
åa˚TASK_INCREMENT_TICK


407 
	#åa˚TASK_INCREMENT_TICK
–
xTickCou¡
 )

	)

410 #i‚de‡
åa˚TIMER_CREATE


411 
	#åa˚TIMER_CREATE
–
pxNewTimî
 )

	)

414 #i‚de‡
åa˚TIMER_CREATE_FAILED


415 
	#åa˚TIMER_CREATE_FAILED
()

	)

418 #i‚de‡
åa˚TIMER_COMMAND_SEND


419 
	#åa˚TIMER_COMMAND_SEND
–
xTimî
, 
xMesßgeID
, 
xMesßgeVÆueVÆue
, 
xRëu∫
 )

	)

422 #i‚de‡
åa˚TIMER_EXPIRED


423 
	#åa˚TIMER_EXPIRED
–
pxTimî
 )

	)

426 #i‚de‡
åa˚TIMER_COMMAND_RECEIVED


427 
	#åa˚TIMER_COMMAND_RECEIVED
–
pxTimî
, 
xMesßgeID
, 
xMesßgeVÆue
 )

	)

430 #i‚de‡
c⁄figGENERATE_RUN_TIME_STATS


431 
	#c⁄figGENERATE_RUN_TIME_STATS
 0

	)

434 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

436 #i‚de‡
p‹tCONFIGURE_TIMER_FOR_RUN_TIME_STATS


437 #îr‹ 
If
 
c⁄figGENERATE_RUN_TIME_STATS
 
is
 
deföed
 
thí
 
p‹tCONFIGURE_TIMER_FOR_RUN_TIME_STATS
 
mu°
 
Æso
 
be
 deföed.Ö‹tCONFIGURE_TIMER_FOR_RUN_TIME_STATS 
should
 
ˇŒ
 
a
 
p‹t
 
œyî
 
fun˘i⁄
 
to
 
£tup
á 
≥rùhîÆ
 
timî
/
cou¡î
 
th©
 
ˇn
Åhí bê
u£d
 
as
 
the
 
run
 
time
 cou¡îÅimê
ba£
.

440 #i‚de‡
p‹tGET_RUN_TIME_COUNTER_VALUE


441 #i‚de‡
p‹tALT_GET_RUN_TIME_COUNTER_VALUE


442 #îr‹ 
If
 
c⁄figGENERATE_RUN_TIME_STATS
 
is
 
deföed
 
thí
 
eôhî
 
p‹tGET_RUN_TIME_COUNTER_VALUE
 
‹
 
p‹tALT_GET_RUN_TIME_COUNTER_VALUE
 
mu°
 
Æso
 
be
 deföed. 
Sì
 
the
 
exam∂es
 
¥ovided
 
™d
Åhê
FªeRTOS
 
web
 
sôe
 
m‹e
 
öf‹m©i⁄
.

448 #i‚de‡
p‹tCONFIGURE_TIMER_FOR_RUN_TIME_STATS


449 
	#p‹tCONFIGURE_TIMER_FOR_RUN_TIME_STATS
()

	)

452 #i‚de‡
c⁄figUSE_MALLOC_FAILED_HOOK


453 
	#c⁄figUSE_MALLOC_FAILED_HOOK
 0

	)

456 #i‚de‡
p‹tPRIVILEGE_BIT


457 
	#p‹tPRIVILEGE_BIT
 ( ( 
p‹tBASE_TYPE
 ) 0x00 )

	)

460 #i‚de‡
p‹tYIELD_WITHIN_API


461 
	#p‹tYIELD_WITHIN_API
 
p‹tYIELD


	)

464 #i‚de‡
pvP‹tMÆlocAlig√d


465 
	#pvP‹tMÆlocAlig√d
–
x
, 
puxSèckBuf„r
 ) ( ( (ÖuxSèckBuf„∏Ë=
NULL
 ) ? ( 
	`pvP‹tMÆloc
––x ) ) ) : (ÖuxSèckBuf„∏Ë)

	)

468 #i‚de‡
vP‹tFªeAlig√d


469 
	#vP‹tFªeAlig√d
–
pvBlockToFªe
 ) 
	`vP‹tFªe
–pvBlockToFªê)

	)

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\MPU_WR~1.H

54 #i‚de‡
MPU_WRAPPERS_H


55 
	#MPU_WRAPPERS_H


	)

59 #ifde‡
p‹tUSING_MPU_WRAPPERS


64 #i‚de‡
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


66 
	#xTaskGíîicCª©e
 
MPU_xTaskGíîicCª©e


	)

67 
	#vTaskAŒoˇãMPURegi⁄s
 
MPU_vTaskAŒoˇãMPURegi⁄s


	)

68 
	#vTaskDñëe
 
MPU_vTaskDñëe


	)

69 
	#vTaskDñayU¡û
 
MPU_vTaskDñayU¡û


	)

70 
	#vTaskDñay
 
MPU_vTaskDñay


	)

71 
	#uxTaskPri‹ôyGë
 
MPU_uxTaskPri‹ôyGë


	)

72 
	#vTaskPri‹ôySë
 
MPU_vTaskPri‹ôySë


	)

73 
	#vTaskSu•íd
 
MPU_vTaskSu•íd


	)

74 
	#xTaskIsTaskSu•íded
 
MPU_xTaskIsTaskSu•íded


	)

75 
	#vTaskResume
 
MPU_vTaskResume


	)

76 
	#vTaskSu•ídAŒ
 
MPU_vTaskSu•ídAŒ


	)

77 
	#xTaskResumeAŒ
 
MPU_xTaskResumeAŒ


	)

78 
	#xTaskGëTickCou¡
 
MPU_xTaskGëTickCou¡


	)

79 
	#uxTaskGëNumbîOfTasks
 
MPU_uxTaskGëNumbîOfTasks


	)

80 
	#vTaskLi°
 
MPU_vTaskLi°


	)

81 
	#vTaskGëRunTimeSèts
 
MPU_vTaskGëRunTimeSèts


	)

82 
	#vTaskSèπTø˚
 
MPU_vTaskSèπTø˚


	)

83 
	#ulTaskEndTø˚
 
MPU_ulTaskEndTø˚


	)

84 
	#vTaskSëAµliˇti⁄TaskTag
 
MPU_vTaskSëAµliˇti⁄TaskTag


	)

85 
	#xTaskGëAµliˇti⁄TaskTag
 
MPU_xTaskGëAµliˇti⁄TaskTag


	)

86 
	#xTaskCÆlAµliˇti⁄TaskHook
 
MPU_xTaskCÆlAµliˇti⁄TaskHook


	)

87 
	#uxTaskGëSèckHighW©îM¨k
 
MPU_uxTaskGëSèckHighW©îM¨k


	)

88 
	#xTaskGëCuºítTaskH™dÀ
 
MPU_xTaskGëCuºítTaskH™dÀ


	)

89 
	#xTaskGëScheduÀrSèã
 
MPU_xTaskGëScheduÀrSèã


	)

91 
	#xQueueCª©e
 
MPU_xQueueCª©e


	)

92 
	#xQueueCª©eMuãx
 
MPU_xQueueCª©eMuãx


	)

93 
	#xQueueGiveMuãxRecursive
 
MPU_xQueueGiveMuãxRecursive


	)

94 
	#xQueueTakeMuãxRecursive
 
MPU_xQueueTakeMuãxRecursive


	)

95 
	#xQueueCª©eCou¡ögSem≠h‹e
 
MPU_xQueueCª©eCou¡ögSem≠h‹e


	)

96 
	#xQueueGíîicSíd
 
MPU_xQueueGíîicSíd


	)

97 
	#xQueueA…GíîicSíd
 
MPU_xQueueA…GíîicSíd


	)

98 
	#xQueueA…GíîicRe˚ive
 
MPU_xQueueA…GíîicRe˚ive


	)

99 
	#xQueueGíîicRe˚ive
 
MPU_xQueueGíîicRe˚ive


	)

100 
	#uxQueueMesßgesWaôög
 
MPU_uxQueueMesßgesWaôög


	)

101 
	#vQueueDñëe
 
MPU_vQueueDñëe


	)

103 
	#pvP‹tMÆloc
 
MPU_pvP‹tMÆloc


	)

104 
	#vP‹tFªe
 
MPU_vP‹tFªe


	)

105 
	#xP‹tGëFªeHópSize
 
MPU_xP‹tGëFªeHópSize


	)

106 
	#vP‹tInôüli£Blocks
 
MPU_vP‹tInôüli£Blocks


	)

108 #i‡
c⁄figQUEUE_REGISTRY_SIZE
 > 0

109 
	#vQueueAddToRegi°ry
 
MPU_vQueueAddToRegi°ry


	)

110 
	#vQueueUƒegi°îQueue
 
MPU_vQueueUƒegi°îQueue


	)

114 
	#PRIVILEGED_FUNCTION


	)

119 
	#PRIVILEGED_FUNCTION
 
	`__©åibuã__
((
	`£˘i⁄
("¥ivûeged_fun˘i⁄s")))

	)

120 
	#PRIVILEGED_DATA
 
	`__©åibuã__
((
	`£˘i⁄
("¥ivûeged_d©a")))

	)

127 
	#PRIVILEGED_FUNCTION


	)

128 
	#PRIVILEGED_DATA


	)

129 
	#p‹tUSING_MPU_WRAPPERS
 0

	)

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\PORTMA~1.H

55 #i‚de‡
PORTMACRO_H


56 
	#PORTMACRO_H


	)

58 #ifde‡
__˝lu•lus


73 
	#p‹tCHAR
 

	)

74 
	#p‹tFLOAT
 

	)

75 
	#p‹tDOUBLE
 

	)

76 
	#p‹tLONG
 

	)

77 
	#p‹tSHORT
 

	)

78 
	#p‹tSTACK_TYPE
 
p‹tLONG


	)

79 
	#p‹tBASE_TYPE
 

	)

81 #if–
c⁄figUSE_16_BIT_TICKS
 == 1 )

82 
	tp‹tSHORT
 
	tp‹tTickTy≥
;

83 
	#p‹tMAX_DELAY
 ( 
p‹tTickTy≥
 ) 0xffff

	)

85 
	tp‹tLONG
 
	tp‹tTickTy≥
;

86 
	#p‹tMAX_DELAY
 ( 
p‹tTickTy≥
 ) 0xffffffff

	)

91 
	#p‹tSTACK_GROWTH
 ( -1 )

	)

92 
	#p‹tTICK_RATE_MS
 ( ( 
p‹tTickTy≥
 ) 1000 / 
c⁄figTICK_RATE_HZ
 )

	)

93 
	#p‹tBYTE_ALIGNMENT
 8

	)

98 
vP‹tYõld
( );

99 
vP‹tYõldFromISR
( );

101 
	#p‹tYIELD
(Ë
	`vP‹tYõldFromISR
()

	)

102 
	#p‹tEND_SWITCHING_ISR
–
xSwôchRequúed
 ) if–xSwôchRequúed ) 
	`vP‹tYõldFromISR
()

	)

108 
vP‹tSëI¡îru±Mask
( );

109 
vP‹tCÀ¨I¡îru±Mask
( );

110 
vP‹tE¡îCrôiˇl
( );

111 
vP‹tExôCrôiˇl
( );

113 
	#p‹tDISABLE_INTERRUPTS
(Ë
	`vP‹tSëI¡îru±Mask
()

	)

114 
	#p‹tENABLE_INTERRUPTS
(Ë
	`vP‹tCÀ¨I¡îru±Mask
()

	)

115 
	#p‹tENTER_CRITICAL
(Ë
	`vP‹tE¡îCrôiˇl
()

	)

116 
	#p‹tEXIT_CRITICAL
(Ë
	`vP‹tExôCrôiˇl
()

	)

117 
	#p‹tSET_INTERRUPT_MASK_FROM_ISR
(Ë0;
	`vP‹tSëI¡îru±Mask
()

	)

118 
	#p‹tCLEAR_INTERRUPT_MASK_FROM_ISR
(
x
Ë
	`vP‹tCÀ¨I¡îru±Mask
();()
	)
x

123 
	#p‹tTASK_FUNCTION_PROTO
–
vFun˘i⁄
, 
pvP¨amëîs
 ) 
	`vFun˘i⁄
–*pvP¨amëî†)

	)

124 
	#p‹tTASK_FUNCTION
–
vFun˘i⁄
, 
pvP¨amëîs
 ) 
	`vFun˘i⁄
–*pvP¨amëî†)

	)

126 
	#p‹tNOP
()

	)

128 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\STACKM~1.H

54 #i‚de‡
STACK_MACROS_H


55 
	#STACK_MACROS_H


	)

73 #if–
c⁄figCHECK_FOR_STACK_OVERFLOW
 == 0 )

76 
	#èskFIRST_CHECK_FOR_STACK_OVERFLOW
()

	)

77 
	#èskSECOND_CHECK_FOR_STACK_OVERFLOW
()

	)

82 #if–
c⁄figCHECK_FOR_STACK_OVERFLOW
 == 1 )

86 
	#èskSECOND_CHECK_FOR_STACK_OVERFLOW
()

	)

91 #if––
c⁄figCHECK_FOR_STACK_OVERFLOW
 > 0 ) && ( 
p‹tSTACK_GROWTH
 < 0 ) )

94 
	#èskFIRST_CHECK_FOR_STACK_OVERFLOW
() \

97 if–
pxCuºítTCB
->
pxT›OfSèck
 <pxCuºítTCB->
pxSèck
 ) \

99 
	`vAµliˇti⁄SèckOvîÊowHook
––
xTaskH™dÀ
 ) 
pxCuºítTCB
,ÖxCuºítTCB->
pcTaskName
 ); \

101 }

	)

106 #if––
c⁄figCHECK_FOR_STACK_OVERFLOW
 > 0 ) && ( 
p‹tSTACK_GROWTH
 > 0 ) )

109 
	#èskFIRST_CHECK_FOR_STACK_OVERFLOW
() \

113 if–
pxCuºítTCB
->
pxT›OfSèck
 >pxCuºítTCB->
pxEndOfSèck
 ) \

115 
	`vAµliˇti⁄SèckOvîÊowHook
––
xTaskH™dÀ
 ) 
pxCuºítTCB
,ÖxCuºítTCB->
pcTaskName
 ); \

117 }

	)

122 #if––
c⁄figCHECK_FOR_STACK_OVERFLOW
 > 1 ) && ( 
p‹tSTACK_GROWTH
 < 0 ) )

124 
	#èskSECOND_CHECK_FOR_STACK_OVERFLOW
() \

126 c⁄° 
ucEx≥˘edSèckByãs
[] = { 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

127 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

128 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

129 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

130 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE }; \

134 if–
	`memcmp
––* ) 
pxCuºítTCB
->
pxSèck
, ( * ) 
ucEx≥˘edSèckByãs
, ( ucExpectedStackBytes ) ) != 0 ) \

136 
	`vAµliˇti⁄SèckOvîÊowHook
––
xTaskH™dÀ
 ) 
pxCuºítTCB
,ÖxCuºítTCB->
pcTaskName
 ); \

138 }

	)

143 #if––
c⁄figCHECK_FOR_STACK_OVERFLOW
 > 1 ) && ( 
p‹tSTACK_GROWTH
 > 0 ) )

145 
	#èskSECOND_CHECK_FOR_STACK_OVERFLOW
() \

147 *
pcEndOfSèck
 = ( * ) 
pxCuºítTCB
->
pxEndOfSèck
; \

148 c⁄° 
ucEx≥˘edSèckByãs
[] = { 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

149 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

150 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

151 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE, \

152 
tskSTACK_FILL_BYTE
,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE,ÅskSTACK_FILL_BYTE }; \

155 
pcEndOfSèck
 -–
ucEx≥˘edSèckByãs
 ); \

158 if–
	`memcmp
––* ) 
pcEndOfSèck
, ( * ) 
ucEx≥˘edSèckByãs
, ( ucExpectedStackBytes ) ) != 0 ) \

160 
	`vAµliˇti⁄SèckOvîÊowHook
––
xTaskH™dÀ
 ) 
pxCuºítTCB
,ÖxCuºítTCB->
pcTaskName
 ); \

162 }

	)

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\croutine.h

54 #i‚de‡
CO_ROUTINE_H


55 
	#CO_ROUTINE_H


	)

57 #i‚de‡
INC_FREERTOS_H


61 
	~"li°.h
"

63 #ifde‡
__˝lu•lus


70 * 
	txCoRoutöeH™dÀ
;

73 (*
¸COROUTINE_CODE
)–
	txCoRoutöeH™dÀ
, 
	tp‹tBASE_TYPE
 );

75 
	sc‹CoRoutöeC⁄åﬁBlock


77 
¸COROUTINE_CODE
 
pxCoRoutöeFun˘i⁄
;

78 
xLi°Iãm
 
xGíîicLi°Iãm
;

79 
xLi°Iãm
 
xEvítLi°Iãm
;

80 
p‹tBASE_TYPE
 
uxPri‹ôy
;

81 
p‹tBASE_TYPE
 
uxIndex
;

82 
uxSèã
;

83 } 
	tc‹CRCB
;

157 sig√d 
p‹tBASE_TYPE
 
xCoRoutöeCª©e
–
¸COROUTINE_CODE
 
pxCoRoutöeCode
, p‹tBASE_TYPE 
uxPri‹ôy
, p‹tBASE_TYPE 
uxIndex
 );

199 
vCoRoutöeScheduÀ
( );

230 
	#¸START
–
pxCRCB
 )  ( ( 
c‹CRCB
 * )–pxCRCB ) )->
uxSèã
 ) { 0:

	)

261 
	#¸END
(Ë}

	)

267 
	#¸SET_STATE0
–
xH™dÀ
 ) ( ( 
c‹CRCB
 * )–xH™dÀ ) )->
uxSèã
 = (
__LINE__
 * 2); ; (__LINE__ * 2):

	)

268 
	#¸SET_STATE1
–
xH™dÀ
 ) ( ( 
c‹CRCB
 * )–xH™dÀ ) )->
uxSèã
 = ((
__LINE__
 * 2)+1); ; ((__LINE__ * 2)+1):

	)

316 
	#¸DELAY
–
xH™dÀ
, 
xTicksToDñay
 ) \

317 if––
xTicksToDñay
 ) > 0 ) \

319 
	`vCoRoutöeAddToDñayedLi°
––
xTicksToDñay
 ), 
NULL
 ); \

321 
	`¸SET_STATE0
––
xH™dÀ
 ) );

	)

406 
	#¸QUEUE_SEND
–
xH™dÀ
, 
pxQueue
, 
pvIãmToQueue
, 
xTicksToWaô
, 
pxResu…
 ) \

408 *–
pxResu…
 ) = 
	`xQueueCRSíd
––
pxQueue
Ë, ( 
pvIãmToQueue
Ë, ( 
xTicksToWaô
 ) ); \

409 if–*–
pxResu…
 ) =
îrQUEUE_BLOCKED
 ) \

411 
	`¸SET_STATE0
––
xH™dÀ
 ) ); \

412 *
pxResu…
 = 
	`xQueueCRSíd
––
pxQueue
 ), ( 
pvIãmToQueue
 ), 0 ); \

414 if–*
pxResu…
 =
îrQUEUE_YIELD
 ) \

416 
	`¸SET_STATE1
––
xH™dÀ
 ) ); \

417 *
pxResu…
 = 
pdPASS
; \

419 }

	)

498 
	#¸QUEUE_RECEIVE
–
xH™dÀ
, 
pxQueue
, 
pvBuf„r
, 
xTicksToWaô
, 
pxResu…
 ) \

500 *–
pxResu…
 ) = 
	`xQueueCRRe˚ive
––
pxQueue
Ë, ( 
pvBuf„r
 ), ( 
xTicksToWaô
 ) ); \

501 if–*–
pxResu…
 ) =
îrQUEUE_BLOCKED
 ) \

503 
	`¸SET_STATE0
––
xH™dÀ
 ) ); \

504 *–
pxResu…
 ) = 
	`xQueueCRRe˚ive
––
pxQueue
Ë, ( 
pvBuf„r
 ), 0 ); \

506 if–*–
pxResu…
 ) =
îrQUEUE_YIELD
 ) \

508 
	`¸SET_STATE1
––
xH™dÀ
 ) ); \

509 *–
pxResu…
 ) = 
pdPASS
; \

511 }

	)

607 
	#¸QUEUE_SEND_FROM_ISR
–
pxQueue
, 
pvIãmToQueue
, 
xCoRoutöePªviou¶yWokí
 ) 
	`xQueueCRSídFromISR
––pxQueuê), (ÖvIãmToQueuê), ( xCoRoutöePªviou¶yWokí ) )

	)

720 
	#¸QUEUE_RECEIVE_FROM_ISR
–
pxQueue
, 
pvBuf„r
, 
pxCoRoutöeWokí
 ) 
	`xQueueCRRe˚iveFromISR
––pxQueuê), (ÖvBuf„∏), (ÖxCoRoutöeWokí ) )

	)

731 
vCoRoutöeAddToDñayedLi°
–
p‹tTickTy≥
 
xTicksToDñay
, 
xLi°
 *
pxEvítLi°
 );

740 sig√d 
p‹tBASE_TYPE
 
xCoRoutöeRemoveFromEvítLi°
–c⁄° 
xLi°
 *
pxEvítLi°
 );

742 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\list.h

83 #i‚de‡
LIST_H


84 
	#LIST_H


	)

86 #ifde‡
__˝lu•lus


92 
	sxLIST_ITEM


94 
p‹tTickTy≥
 
xIãmVÆue
;

95 vﬁ©ûê
xLIST_ITEM
 * 
pxNext
;

96 vﬁ©ûê
xLIST_ITEM
 * 
pxPªvious
;

97 * 
pvOw√r
;

98 * 
pvC⁄èöî
;

100 
xLIST_ITEM
 
	txLi°Iãm
;

102 
	sxMINI_LIST_ITEM


104 
p‹tTickTy≥
 
xIãmVÆue
;

105 vﬁ©ûê
xLIST_ITEM
 *
pxNext
;

106 vﬁ©ûê
xLIST_ITEM
 *
pxPªvious
;

108 
xMINI_LIST_ITEM
 
	txMöiLi°Iãm
;

113 
	sxLIST


115 vﬁ©ûê
p‹tBASE_TYPE
 
uxNumbîOfIãms
;

116 vﬁ©ûê
xLi°Iãm
 * 
pxIndex
;

117 vﬁ©ûê
xMöiLi°Iãm
 
xLi°End
;

118 } 
	txLi°
;

127 
	#li°SET_LIST_ITEM_OWNER
–
pxLi°Iãm
, 
pxOw√r
 ) (ÖxLi°Iãm )->
pvOw√r
 = ( * ) (ÖxOw√∏)

	)

136 
	#li°SET_LIST_ITEM_VALUE
–
pxLi°Iãm
, 
xVÆue
 ) (ÖxLi°Iãm )->
xIãmVÆue
 = ( xVÆuê)

	)

146 
	#li°GET_LIST_ITEM_VALUE
–
pxLi°Iãm
 ) ( (ÖxLi°Iãm )->
xIãmVÆue
 )

	)

155 
	#li°GET_ITEM_VALUE_OF_HEAD_ENTRY
–
pxLi°
 ) ( (&––pxLi° )->
xLi°End
 ))->
pxNext
->
xIãmVÆue
 )

	)

164 
	#li°LIST_IS_EMPTY
–
pxLi°
 ) ( (ÖxLi° )->
uxNumbîOfIãms
 =–
p‹tBASE_TYPE
 ) 0 )

	)

169 
	#li°CURRENT_LIST_LENGTH
–
pxLi°
 ) ( (ÖxLi° )->
uxNumbîOfIãms
 )

	)

190 
	#li°GET_OWNER_OF_NEXT_ENTRY
–
pxTCB
, 
pxLi°
 ) \

192 
xLi°
 * c⁄° 
pxC⁄°Li°
 = ( 
pxLi°
 ); \

195 –
pxC⁄°Li°
 )->
pxIndex
 = (ÖxC⁄°Li° )->pxIndex->
pxNext
; \

196 if––
pxC⁄°Li°
 )->
pxIndex
 =–
xLi°Iãm
 * ) &––pxC⁄°Li° )->
xLi°End
 ) ) \

198 –
pxC⁄°Li°
 )->
pxIndex
 = (ÖxC⁄°Li° )->pxIndex->
pxNext
; \

200 –
pxTCB
 ) = ( 
pxC⁄°Li°
 )->
pxIndex
->
pvOw√r
; \

201 }

	)

220 
	#li°GET_OWNER_OF_HEAD_ENTRY
–
pxLi°
 ) ( (&––pxLi° )->
xLi°End
 ))->
pxNext
->
pvOw√r
 )

	)

232 
	#li°IS_CONTAINED_WITHIN
–
pxLi°
, 
pxLi°Iãm
 ) ( (ÖxLi°Iãm )->
pvC⁄èöî
 =–* ) (ÖxLi° ) )

	)

244 
vLi°Inôüli£
–
xLi°
 *
pxLi°
 );

255 
vLi°Inôüli£Iãm
–
xLi°Iãm
 *
pxIãm
 );

268 
vLi°In£π
–
xLi°
 *
pxLi°
, 
xLi°Iãm
 *
pxNewLi°Iãm
 );

289 
vLi°In£πEnd
–
xLi°
 *
pxLi°
, 
xLi°Iãm
 *
pxNewLi°Iãm
 );

301 
vLi°Remove
–
xLi°Iãm
 *
pxIãmToRemove
 );

303 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\portable.h

58 #i‚de‡
PORTABLE_H


59 
	#PORTABLE_H


	)

63 #ifde‡
OPEN_WATCOM_INDUSTRIAL_PC_PORT


64 
	~"..\..\Sour˚\p‹èbÀ\ow©com\16bôdos\pc\p‹tma¸o.h
"

65 –
__öãºu±
 
	t__Ár
 *
	tpxISR
 )();

68 #ifde‡
OPEN_WATCOM_FLASH_LITE_186_PORT


69 
	~"..\..\Sour˚\p‹èbÀ\ow©com\16bôdos\Êsh186\p‹tma¸o.h
"

70 –
__öãºu±
 
	t__Ár
 *
	tpxISR
 )();

73 #ifde‡
GCC_MEGA_AVR


74 
	~"../p‹èbÀ/GCC/ATMega323/p‹tma¸o.h
"

77 #ifde‡
IAR_MEGA_AVR


78 
	~"../p‹èbÀ/IAR/ATMega323/p‹tma¸o.h
"

81 #ifde‡
MPLAB_PIC24_PORT


82 
	~"..\..\Sour˚\p‹èbÀ\MPLAB\PIC24_dsPIC\p‹tma¸o.h
"

85 #ifde‡
MPLAB_DSPIC_PORT


86 
	~"..\..\Sour˚\p‹èbÀ\MPLAB\PIC24_dsPIC\p‹tma¸o.h
"

89 #ifde‡
MPLAB_PIC18F_PORT


90 
	~"..\..\Sour˚\p‹èbÀ\MPLAB\PIC18F\p‹tma¸o.h
"

93 #ifde‡
MPLAB_PIC32MX_PORT


94 
	~"..\..\Sour˚\p‹èbÀ\MPLAB\PIC32MX\p‹tma¸o.h
"

97 #ifde‡
_FEDPICC


98 
	~"libFªeRTOS/In˛ude/p‹tma¸o.h
"

101 #ifde‡
SDCC_CYGNAL


102 
	~"../../Sour˚/p‹èbÀ/SDCC/Cyg«l/p‹tma¸o.h
"

105 #ifde‡
GCC_ARM7


106 
	~"../../Sour˚/p‹èbÀ/GCC/ARM7_LPC2000/p‹tma¸o.h
"

109 #ifde‡
GCC_ARM7_ECLIPSE


110 
	~"p‹tma¸o.h
"

113 #ifde‡
ROWLEY_LPC23xx


114 
	~"../../Sour˚/p‹èbÀ/GCC/ARM7_LPC23xx/p‹tma¸o.h
"

117 #ifde‡
IAR_MSP430


118 
	~"..\..\Sour˚\p‹èbÀ\IAR\MSP430\p‹tma¸o.h
"

121 #ifde‡
GCC_MSP430


122 
	~"../../Sour˚/p‹èbÀ/GCC/MSP430F449/p‹tma¸o.h
"

125 #ifde‡
ROWLEY_MSP430


126 
	~"../../Sour˚/p‹èbÀ/RowÀy/MSP430F449/p‹tma¸o.h
"

129 #ifde‡
ARM7_LPC21xx_KEIL_RVDS


130 
	~"..\..\Sour˚\p‹èbÀ\RVDS\ARM7_LPC21xx\p‹tma¸o.h
"

133 #ifde‡
SAM7_GCC


134 
	~"../../Sour˚/p‹èbÀ/GCC/ARM7_AT91SAM7S/p‹tma¸o.h
"

137 #ifde‡
SAM7_IAR


138 
	~"..\..\Sour˚\p‹èbÀ\IAR\AtmñSAM7S64\p‹tma¸o.h
"

141 #ifde‡
SAM9XE_IAR


142 
	~"..\..\Sour˚\p‹èbÀ\IAR\AtmñSAM9XE\p‹tma¸o.h
"

145 #ifde‡
LPC2000_IAR


146 
	~"..\..\Sour˚\p‹èbÀ\IAR\LPC2000\p‹tma¸o.h
"

149 #ifde‡
STR71X_IAR


150 
	~"..\..\Sour˚\p‹èbÀ\IAR\STR71x\p‹tma¸o.h
"

153 #ifde‡
STR75X_IAR


154 
	~"..\..\Sour˚\p‹èbÀ\IAR\STR75x\p‹tma¸o.h
"

157 #ifde‡
STR75X_GCC


158 
	~"..\..\Sour˚\p‹èbÀ\GCC\STR75x\p‹tma¸o.h
"

161 #ifde‡
STR91X_IAR


162 
	~"..\..\Sour˚\p‹èbÀ\IAR\STR91x\p‹tma¸o.h
"

165 #ifde‡
GCC_H8S


166 
	~"../../Sour˚/p‹èbÀ/GCC/H8S2329/p‹tma¸o.h
"

169 #ifde‡
GCC_AT91FR40008


170 
	~"../../Sour˚/p‹èbÀ/GCC/ARM7_AT91FR40008/p‹tma¸o.h
"

173 #ifde‡
RVDS_ARMCM3_LM3S102


174 
	~"../../Sour˚/p‹èbÀ/RVDS/ARM_CM3/p‹tma¸o.h
"

177 #ifde‡
GCC_ARMCM3_LM3S102


178 
	~"../../Sour˚/p‹èbÀ/GCC/ARM_CM3/p‹tma¸o.h
"

181 #ifde‡
GCC_ARMCM3


182 
	~"../../Sour˚/p‹èbÀ/GCC/ARM_CM3/p‹tma¸o.h
"

185 #ifde‡
IAR_ARM_CM3


186 
	~"../../Sour˚/p‹èbÀ/IAR/ARM_CM3/p‹tma¸o.h
"

189 #ifde‡
IAR_ARMCM3_LM


190 
	~"../../Sour˚/p‹èbÀ/IAR/ARM_CM3/p‹tma¸o.h
"

193 #ifde‡
HCS12_CODE_WARRIOR


194 
	~"../../Sour˚/p‹èbÀ/CodeW¨ri‹/HCS12/p‹tma¸o.h
"

197 #ifde‡
MICROBLAZE_GCC


198 
	~"../../Sour˚/p‹èbÀ/GCC/Mi¸oBœze/p‹tma¸o.h
"

201 #ifde‡
TERN_EE


202 
	~"..\..\Sour˚\p‹èbÀ\P¨adigm\Tîn_EE\smÆl\p‹tma¸o.h
"

205 #ifde‡
GCC_HCS12


206 
	~"../../Sour˚/p‹èbÀ/GCC/HCS12/p‹tma¸o.h
"

209 #ifde‡
GCC_MCF5235


210 
	~"../../Sour˚/p‹èbÀ/GCC/MCF5235/p‹tma¸o.h
"

213 #ifde‡
COLDFIRE_V2_GCC


214 
	~"../../../Sour˚/p‹èbÀ/GCC/CﬁdFúe_V2/p‹tma¸o.h
"

217 #ifde‡
COLDFIRE_V2_CODEWARRIOR


218 
	~"../../Sour˚/p‹èbÀ/CodeW¨ri‹/CﬁdFúe_V2/p‹tma¸o.h
"

221 #ifde‡
GCC_PPC405


222 
	~"../../Sour˚/p‹èbÀ/GCC/PPC405_Xûöx/p‹tma¸o.h
"

225 #ifde‡
GCC_PPC440


226 
	~"../../Sour˚/p‹èbÀ/GCC/PPC440_Xûöx/p‹tma¸o.h
"

229 #ifde‡
_16FX_SOFTUNE


230 
	~"..\..\Sour˚\p‹èbÀ\So·u√\MB96340\p‹tma¸o.h
"

233 #ifde‡
BCC_INDUSTRIAL_PC_PORT


236 
	~"‰c⁄fig.h
"

237 
	~"..\p‹èbÀ\BCC\16BôDOS\PC\¥tma¸o.h
"

238 –
__öãºu±
 
	t__Ár
 *
	tpxISR
 )();

241 #ifde‡
BCC_FLASH_LITE_186_PORT


244 
	~"‰c⁄fig.h
"

245 
	~"..\p‹èbÀ\BCC\16BôDOS\Êsh186\¥tma¸o.h
"

246 –
__öãºu±
 
	t__Ár
 *
	tpxISR
 )();

249 #ifde‡
__GNUC__


250 #ifde‡
__AVR32_AVR32A__


251 
	~"p‹tma¸o.h
"

255 #ifde‡
__ICCAVR32__


256 #ifde‡
__CORE__


257 #i‡
__CORE__
 =
__AVR32A__


258 
	~"p‹tma¸o.h
"

263 #ifde‡
__91467D


264 
	~"p‹tma¸o.h
"

267 #ifde‡
__96340


268 
	~"p‹tma¸o.h
"

272 #ifde‡
__IAR_V850ES_Fx3__


273 
	~"../../Sour˚/p‹èbÀ/IAR/V850ES/p‹tma¸o.h
"

276 #ifde‡
__IAR_V850ES_Jx3__


277 
	~"../../Sour˚/p‹èbÀ/IAR/V850ES/p‹tma¸o.h
"

280 #ifde‡
__IAR_V850ES_Jx3_L__


281 
	~"../../Sour˚/p‹èbÀ/IAR/V850ES/p‹tma¸o.h
"

284 #ifde‡
__IAR_V850ES_Jx2__


285 
	~"../../Sour˚/p‹èbÀ/IAR/V850ES/p‹tma¸o.h
"

288 #ifde‡
__IAR_V850ES_Hx2__


289 
	~"../../Sour˚/p‹èbÀ/IAR/V850ES/p‹tma¸o.h
"

292 #ifde‡
__IAR_78K0R_Kx3__


293 
	~"../../Sour˚/p‹èbÀ/IAR/78K0R/p‹tma¸o.h
"

296 #ifde‡
__IAR_78K0R_Kx3L__


297 
	~"../../Sour˚/p‹èbÀ/IAR/78K0R/p‹tma¸o.h
"

306 #i‚de‡
p‹tENTER_CRITICAL


307 
	~"p‹tma¸o.h
"

310 #i‡
p‹tBYTE_ALIGNMENT
 == 8

311 
	#p‹tBYTE_ALIGNMENT_MASK
 ( 0x0007 )

	)

314 #i‡
p‹tBYTE_ALIGNMENT
 == 4

315 
	#p‹tBYTE_ALIGNMENT_MASK
 ( 0x0003 )

	)

318 #i‡
p‹tBYTE_ALIGNMENT
 == 2

319 
	#p‹tBYTE_ALIGNMENT_MASK
 ( 0x0001 )

	)

322 #i‡
p‹tBYTE_ALIGNMENT
 == 1

323 
	#p‹tBYTE_ALIGNMENT_MASK
 ( 0x0000 )

	)

326 #i‚de‡
p‹tBYTE_ALIGNMENT_MASK


330 #i‚de‡
p‹tNUM_CONFIGURABLE_REGIONS


331 
	#p‹tNUM_CONFIGURABLE_REGIONS
 1

	)

334 #ifde‡
__˝lu•lus


338 
	~"mpu_wøµîs.h
"

346 #if–
p‹tUSING_MPU_WRAPPERS
 == 1 )

347 
p‹tSTACK_TYPE
 *
pxP‹tInôüli£Sèck
–p‹tSTACK_TYPE *
pxT›OfSèck
, 
pdTASK_CODE
 
pxCode
, *
pvP¨amëîs
, 
p‹tBASE_TYPE
 
xRunPrivûeged
 ) 
PRIVILEGED_FUNCTION
;

349 
p‹tSTACK_TYPE
 *
pxP‹tInôüli£Sèck
–p‹tSTACK_TYPE *
pxT›OfSèck
, 
pdTASK_CODE
 
pxCode
, *
pvP¨amëîs
 );

355 *
pvP‹tMÆloc
–
size_t
 
xSize
 ) 
	gPRIVILEGED_FUNCTION
;

356 
vP‹tFªe
–*
pv
 ) 
	gPRIVILEGED_FUNCTION
;

357 
vP‹tInôüli£Blocks
–Ë
	gPRIVILEGED_FUNCTION
;

358 
size_t
 
xP‹tGëFªeHópSize
–Ë
	gPRIVILEGED_FUNCTION
;

364 
p‹tBASE_TYPE
 
xP‹tSèπScheduÀr
–Ë
	gPRIVILEGED_FUNCTION
;

371 
vP‹tEndScheduÀr
–Ë
	gPRIVILEGED_FUNCTION
;

380 #if–
p‹tUSING_MPU_WRAPPERS
 == 1 )

381 
	gxMEMORY_REGION
;

382 
vP‹tSt‹eTaskMPUSëtögs
–
xMPU_SETTINGS
 *
xMPUSëtögs
, c⁄° 
xMEMORY_REGION
 * c⁄° 
xRegi⁄s
, 
p‹tSTACK_TYPE
 *
pxBŸtomOfSèck
, 
usSèckDïth
 ) 
	gPRIVILEGED_FUNCTION
;

385 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\projdefs.h

54 #i‚de‡
PROJDEFS_H


55 
	#PROJDEFS_H


	)

58 (*
	tpdTASK_CODE
)( * );

60 
	#pdTRUE
 ( 1 )

	)

61 
	#pdFALSE
 ( 0 )

	)

63 
	#pdPASS
 ( 1 )

	)

64 
	#pdFAIL
 ( 0 )

	)

65 
	#îrQUEUE_EMPTY
 ( 0 )

	)

66 
	#îrQUEUE_FULL
 ( 0 )

	)

69 
	#îrCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
 ( -1 )

	)

70 
	#îrNO_TASK_TO_RUN
 ( -2 )

	)

71 
	#îrQUEUE_BLOCKED
 ( -4 )

	)

72 
	#îrQUEUE_YIELD
 ( -5 )

	)

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\queue.h

55 #i‚de‡
QUEUE_H


56 
	#QUEUE_H


	)

58 #i‚de‡
INC_FREERTOS_H


59 #îr‹ "#ö˛udêFªeRTOS.h" 
mu°
 
≠≥¨
 
ö
 
sour˚
 
fûes
 
bef‹e
 "#include queue.h"

62 #ifde‡
__˝lu•lus


67 
	~"mpu_wøµîs.h
"

74 * 
	txQueueH™dÀ
;

78 
	#queueSEND_TO_BACK
 ( 0 )

	)

79 
	#queueSEND_TO_FRONT
 ( 1 )

	)

138 
xQueueH™dÀ
 
xQueueCª©e
–
p‹tBASE_TYPE
 
uxQueueLígth
, p‹tBASE_TYPE 
uxIãmSize
 );

220 
	#xQueueSídToFr⁄t
–
xQueue
, 
pvIãmToQueue
, 
xTicksToWaô
 ) 
	`xQueueGíîicSíd
––xQueuê), (ÖvIãmToQueuê), ( xTicksToWaô ), 
queueSEND_TO_FRONT
 )

	)

302 
	#xQueueSídToBack
–
xQueue
, 
pvIãmToQueue
, 
xTicksToWaô
 ) 
	`xQueueGíîicSíd
––xQueuê), (ÖvIãmToQueuê), ( xTicksToWaô ), 
queueSEND_TO_BACK
 )

	)

386 
	#xQueueSíd
–
xQueue
, 
pvIãmToQueue
, 
xTicksToWaô
 ) 
	`xQueueGíîicSíd
––xQueuê), (ÖvIãmToQueuê), ( xTicksToWaô ), 
queueSEND_TO_BACK
 )

	)

474 sig√d 
p‹tBASE_TYPE
 
xQueueGíîicSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
,Ö‹tBASE_TYPE 
xC›yPosôi⁄
 );

568 
	#xQueuePìk
–
xQueue
, 
pvBuf„r
, 
xTicksToWaô
 ) 
	`xQueueGíîicRe˚ive
––xQueuê), (ÖvBuf„∏), ( xTicksToWaô ), 
pdTRUE
 )

	)

661 
	#xQueueRe˚ive
–
xQueue
, 
pvBuf„r
, 
xTicksToWaô
 ) 
	`xQueueGíîicRe˚ive
––xQueuê), (ÖvBuf„∏), ( xTicksToWaô ), 
pdFALSE
 )

	)

760 sig√d 
p‹tBASE_TYPE
 
xQueueGíîicRe˚ive
–
xQueueH™dÀ
 
xQueue
, * c⁄° 
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
,Ö‹tBASE_TYPE 
xJu°Pìk
 );

775 
p‹tBASE_TYPE
 
uxQueueMesßgesWaôög
–c⁄° 
xQueueH™dÀ
 
xQueue
 );

789 
vQueueDñëe
–
xQueueH™dÀ
 
pxQueue
 );

859 
	#xQueueSídToFr⁄tFromISR
–
pxQueue
, 
pvIãmToQueue
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xQueueGíîicSídFromISR
––pxQueuê), (ÖvIãmToQueuê), (ÖxHighîPri‹ôyTaskWokí ), 
queueSEND_TO_FRONT
 )

	)

930 
	#xQueueSídToBackFromISR
–
pxQueue
, 
pvIãmToQueue
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xQueueGíîicSídFromISR
––pxQueuê), (ÖvIãmToQueuê), (ÖxHighîPri‹ôyTaskWokí ), 
queueSEND_TO_BACK
 )

	)

1004 
	#xQueueSídFromISR
–
pxQueue
, 
pvIãmToQueue
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xQueueGíîicSídFromISR
––pxQueuê), (ÖvIãmToQueuê), (ÖxHighîPri‹ôyTaskWokí ), 
queueSEND_TO_BACK
 )

	)

1082 sig√d 
p‹tBASE_TYPE
 
xQueueGíîicSídFromISR
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, sig√dÖ‹tBASE_TYPE *
pxHighîPri‹ôyTaskWokí
,Ö‹tBASE_TYPE 
xC›yPosôi⁄
 );

1171 sig√d 
p‹tBASE_TYPE
 
xQueueRe˚iveFromISR
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, sig√dÖ‹tBASE_TYPE *
pxTaskWokí
 );

1177 sig√d 
p‹tBASE_TYPE
 
xQueueIsQueueEm±yFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 );

1178 sig√d 
p‹tBASE_TYPE
 
xQueueIsQueueFuŒFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 );

1179 
p‹tBASE_TYPE
 
uxQueueMesßgesWaôögFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 );

1196 sig√d 
p‹tBASE_TYPE
 
xQueueA…GíîicSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
,Ö‹tBASE_TYPE 
xC›yPosôi⁄
 );

1197 sig√d 
p‹tBASE_TYPE
 
xQueueA…GíîicRe˚ive
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
,Ö‹tBASE_TYPE 
xJu°Pìkög
 );

1198 
	#xQueueA…SídToFr⁄t
–
xQueue
, 
pvIãmToQueue
, 
xTicksToWaô
 ) 
	`xQueueA…GíîicSíd
––xQueuê), (ÖvIãmToQueuê), ( xTicksToWaô ), 
queueSEND_TO_FRONT
 )

	)

1199 
	#xQueueA…SídToBack
–
xQueue
, 
pvIãmToQueue
, 
xTicksToWaô
 ) 
	`xQueueA…GíîicSíd
––xQueuê), (ÖvIãmToQueuê), ( xTicksToWaô ), 
queueSEND_TO_BACK
 )

	)

1200 
	#xQueueA…Re˚ive
–
xQueue
, 
pvBuf„r
, 
xTicksToWaô
 ) 
	`xQueueA…GíîicRe˚ive
––xQueuê), (ÖvBuf„∏), ( xTicksToWaô ), 
pdFALSE
 )

	)

1201 
	#xQueueA…Pìk
–
xQueue
, 
pvBuf„r
, 
xTicksToWaô
 ) 
	`xQueueA…GíîicRe˚ive
––xQueuê), (ÖvBuf„∏), ( xTicksToWaô ), 
pdTRUE
 )

	)

1212 sig√d 
p‹tBASE_TYPE
 
xQueueCRSídFromISR
–
xQueueH™dÀ
 
pxQueue
, c⁄° *
pvIãmToQueue
, sig√dÖ‹tBASE_TYPE 
xCoRoutöePªviou¶yWokí
 );

1213 sig√d 
p‹tBASE_TYPE
 
xQueueCRRe˚iveFromISR
–
xQueueH™dÀ
 
pxQueue
, *
pvBuf„r
, sig√dÖ‹tBASE_TYPE *
pxTaskWokí
 );

1214 sig√d 
p‹tBASE_TYPE
 
xQueueCRSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° *
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
 );

1215 sig√d 
p‹tBASE_TYPE
 
xQueueCRRe˚ive
–
xQueueH™dÀ
 
pxQueue
, *
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
 );

1221 
xQueueH™dÀ
 
xQueueCª©eMuãx
( );

1222 
xQueueH™dÀ
 
xQueueCª©eCou¡ögSem≠h‹e
–
p‹tBASE_TYPE
 
uxCou¡VÆue
, p‹tBASE_TYPE 
uxInôülCou¡
 );

1228 
p‹tBASE_TYPE
 
xQueueTakeMuãxRecursive
–
xQueueH™dÀ
 
pxMuãx
, 
p‹tTickTy≥
 
xBlockTime
 );

1229 
p‹tBASE_TYPE
 
xQueueGiveMuãxRecursive
–
xQueueH™dÀ
 
pxMuãx
 );

1251 #i‡
c⁄figQUEUE_REGISTRY_SIZE
 > 0U

1252 
vQueueAddToRegi°ry
–
xQueueH™dÀ
 
xQueue
, sig√d *
pcName
 );

1256 
vQueueWaôF‹MesßgeRe°ri˘ed
–
xQueueH™dÀ
 
pxQueue
, 
p‹tTickTy≥
 
xTicksToWaô
 );

1259 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\semphr.h

54 #i‚de‡
SEMAPHORE_H


55 
	#SEMAPHORE_H


	)

57 #i‚de‡
INC_FREERTOS_H


58 #îr‹ "#ö˛udêFªeRTOS.h" 
mu°
 
≠≥¨
 
ö
 
sour˚
 
fûes
 
bef‹e
 "#include semphr.h"

61 
	~"queue.h
"

63 
xQueueH™dÀ
 
	txSem≠h‹eH™dÀ
;

65 
	#£mBINARY_SEMAPHORE_QUEUE_LENGTH
 ( ( Ë1U )

	)

66 
	#£mSEMAPHORE_QUEUE_ITEM_LENGTH
 ( ( Ë0U )

	)

67 
	#£mGIVE_BLOCK_TIME
 ( ( 
p‹tTickTy≥
 ) 0U )

	)

108 
	#vSem≠h‹eCª©eBö¨y
–
xSem≠h‹e
 ) { \

109 –
xSem≠h‹e
 ) = 
	`xQueueCª©e
––
p‹tBASE_TYPE
 ) 1, 
£mSEMAPHORE_QUEUE_ITEM_LENGTH
 ); \

110 if––
xSem≠h‹e
 ) !
NULL
 ) \

112 
	`xSem≠h‹eGive
––
xSem≠h‹e
 ) ); \

114 }

	)

181 
	#xSem≠h‹eTake
–
xSem≠h‹e
, 
xBlockTime
 ) 
	`xQueueGíîicRe˚ive
––
xQueueH™dÀ
 ) ( xSem≠h‹ê), 
NULL
, ( xBlockTimê), 
pdFALSE
 )

	)

274 
	#xSem≠h‹eTakeRecursive
–
xMuãx
, 
xBlockTime
 ) 
	`xQueueTakeMuãxRecursive
––xMuãx ), ( xBlockTimêË)

	)

289 
	#xSem≠h‹eA…Take
–
xSem≠h‹e
, 
xBlockTime
 ) 
	`xQueueA…GíîicRe˚ive
––
xQueueH™dÀ
 ) ( xSem≠h‹ê), 
NULL
, ( xBlockTimê), 
pdFALSE
 )

	)

352 
	#xSem≠h‹eGive
–
xSem≠h‹e
 ) 
	`xQueueGíîicSíd
––
xQueueH™dÀ
 ) ( xSem≠h‹ê), 
NULL
, 
£mGIVE_BLOCK_TIME
, 
queueSEND_TO_BACK
 )

	)

436 
	#xSem≠h‹eGiveRecursive
–
xMuãx
 ) 
	`xQueueGiveMuãxRecursive
––xMuãx ) )

	)

450 
	#xSem≠h‹eA…Give
–
xSem≠h‹e
 ) 
	`xQueueA…GíîicSíd
––
xQueueH™dÀ
 ) ( xSem≠h‹ê), 
NULL
, 
£mGIVE_BLOCK_TIME
, 
queueSEND_TO_BACK
 )

	)

541 
	#xSem≠h‹eGiveFromISR
–
xSem≠h‹e
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xQueueGíîicSídFromISR
––
xQueueH™dÀ
 ) ( xSem≠h‹ê), 
NULL
, (ÖxHighîPri‹ôyTaskWokí ), 
queueSEND_TO_BACK
 )

	)

588 
	#xSem≠h‹eCª©eMuãx
(Ë
	`xQueueCª©eMuãx
()

	)

643 
	#xSem≠h‹eCª©eRecursiveMuãx
(Ë
	`xQueueCª©eMuãx
()

	)

706 
	#xSem≠h‹eCª©eCou¡ög
–
uxMaxCou¡
, 
uxInôülCou¡
 ) 
	`xQueueCª©eCou¡ögSem≠h‹e
––uxMaxCou¡ ), ( uxInôülCou¡ ) )

	)

720 
	#vSem≠h‹eDñëe
–
xSem≠h‹e
 ) 
	`vQueueDñëe
––
xQueueH™dÀ
 ) xSem≠h‹ê)

	)

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\task.h

55 #i‚de‡
TASK_H


56 
	#TASK_H


	)

58 #i‚de‡
INC_FREERTOS_H


62 
	~"p‹èbÀ.h
"

63 
	~"li°.h
"

65 #ifde‡
__˝lu•lus


73 
	#tskKERNEL_VERSION_NUMBER
 "V7.0.1"

	)

85 * 
	txTaskH™dÀ
;

90 
	sxTIME_OUT


92 
p‹tBASE_TYPE
 
xOvîÊowCou¡
;

93 
p‹tTickTy≥
 
xTimeOnE¡îög
;

94 } 
	txTimeOutTy≥
;

99 
	sxMEMORY_REGION


101 *
pvBa£Addªss
;

102 
ulLígthInByãs
;

103 
ulP¨amëîs
;

104 } 
	txMem‹yRegi⁄
;

109 
	sxTASK_PARAMTERS


111 
pdTASK_CODE
 
pvTaskCode
;

112 c⁄° sig√d * c⁄° 
pcName
;

113 
usSèckDïth
;

114 *
pvP¨amëîs
;

115 
p‹tBASE_TYPE
 
uxPri‹ôy
;

116 
p‹tSTACK_TYPE
 *
puxSèckBuf„r
;

117 
xMem‹yRegi⁄
 
xRegi⁄s
[ 
p‹tNUM_CONFIGURABLE_REGIONS
 ];

118 } 
	txTaskP¨amëîs
;

125 
	#tskIDLE_PRIORITY
 ( ( 
p‹tBASE_TYPE
 ) 0U )

	)

135 
	#èskYIELD
(Ë
	`p‹tYIELD
()

	)

149 
	#èskENTER_CRITICAL
(Ë
	`p‹tENTER_CRITICAL
()

	)

163 
	#èskEXIT_CRITICAL
(Ë
	`p‹tEXIT_CRITICAL
()

	)

173 
	#èskDISABLE_INTERRUPTS
(Ë
	`p‹tDISABLE_INTERRUPTS
()

	)

183 
	#èskENABLE_INTERRUPTS
(Ë
	`p‹tENABLE_INTERRUPTS
()

	)

186 
	#èskSCHEDULER_NOT_STARTED
 0

	)

187 
	#èskSCHEDULER_RUNNING
 1

	)

188 
	#èskSCHEDULER_SUSPENDED
 2

	)

270 
	#xTaskCª©e
–
pvTaskCode
, 
pcName
, 
usSèckDïth
, 
pvP¨amëîs
, 
uxPri‹ôy
, 
pxCª©edTask
 ) 
	`xTaskGíîicCª©e
––pvTaskCodê), (ÖcNamê), ( usSèckDïth ), (ÖvP¨amëî†), ( uxPri‹ôy ), (ÖxCª©edTask ), ( 
NULL
 ), ( NULL ) )

	)

339 
	#xTaskCª©eRe°ri˘ed
–
x
, 
pxCª©edTask
 ) 
	`xTaskGíîicCª©e
–((x)->
pvTaskCode
), ((x)->
pcName
), ((x)->
usSèckDïth
), ((x)->
pvP¨amëîs
), ((x)->
uxPri‹ôy
), (pxCª©edTask), ((x)->
puxSèckBuf„r
), ((x)->
xRegi⁄s
Ë)

	)

387 
vTaskAŒoˇãMPURegi⁄s
–
xTaskH™dÀ
 
xTask
, c⁄° 
xMem‹yRegi⁄
 * c⁄° 
pxRegi⁄s
 ) 
PRIVILEGED_FUNCTION
;

428 
vTaskDñëe
–
xTaskH™dÀ
 
pxTaskToDñëe
 ) 
PRIVILEGED_FUNCTION
;

482 
vTaskDñay
–
p‹tTickTy≥
 
xTicksToDñay
 ) 
PRIVILEGED_FUNCTION
;

541 
vTaskDñayU¡û
–
p‹tTickTy≥
 * c⁄° 
pxPªviousWakeTime
,Ö‹tTickTy≥ 
xTimeIn¸emít
 ) 
PRIVILEGED_FUNCTION
;

588 
p‹tBASE_TYPE
 
uxTaskPri‹ôyGë
–
xTaskH™dÀ
 
pxTask
 ) 
PRIVILEGED_FUNCTION
;

630 
vTaskPri‹ôySë
–
xTaskH™dÀ
 
pxTask
, 
p‹tBASE_TYPE
 
uxNewPri‹ôy
 ) 
PRIVILEGED_FUNCTION
;

681 
vTaskSu•íd
–
xTaskH™dÀ
 
pxTaskToSu•íd
 ) 
PRIVILEGED_FUNCTION
;

730 
vTaskResume
–
xTaskH™dÀ
 
pxTaskToResume
 ) 
PRIVILEGED_FUNCTION
;

750 
p‹tBASE_TYPE
 
xTaskResumeFromISR
–
xTaskH™dÀ
 
pxTaskToResume
 ) 
PRIVILEGED_FUNCTION
;

788 
vTaskSèπScheduÀr
–Ë
PRIVILEGED_FUNCTION
;

841 
vTaskEndScheduÀr
–Ë
PRIVILEGED_FUNCTION
;

892 
vTaskSu•ídAŒ
–Ë
PRIVILEGED_FUNCTION
;

944 sig√d 
p‹tBASE_TYPE
 
xTaskResumeAŒ
–Ë
PRIVILEGED_FUNCTION
;

955 sig√d 
p‹tBASE_TYPE
 
xTaskIsTaskSu•íded
–
xTaskH™dÀ
 
xTask
 ) 
PRIVILEGED_FUNCTION
;

970 
p‹tTickTy≥
 
xTaskGëTickCou¡
–Ë
PRIVILEGED_FUNCTION
;

986 
p‹tTickTy≥
 
xTaskGëTickCou¡FromISR
–Ë
PRIVILEGED_FUNCTION
;

1000 
p‹tBASE_TYPE
 
uxTaskGëNumbîOfTasks
–Ë
PRIVILEGED_FUNCTION
;

1014 sig√d *
pcTaskGëTaskName
–
xTaskH™dÀ
 
xTaskToQuîy
 );

1040 
vTaskLi°
–sig√d *
pcWrôeBuf„r
 ) 
PRIVILEGED_FUNCTION
;

1072 
vTaskGëRunTimeSèts
–sig√d *
pcWrôeBuf„r
 ) 
PRIVILEGED_FUNCTION
;

1093 
vTaskSèπTø˚
–sig√d * 
pcBuf„r
, 
ulBuf„rSize
 ) 
PRIVILEGED_FUNCTION
;

1106 
ulTaskEndTø˚
–Ë
PRIVILEGED_FUNCTION
;

1126 
p‹tBASE_TYPE
 
uxTaskGëSèckHighW©îM¨k
–
xTaskH™dÀ
 
xTask
 ) 
PRIVILEGED_FUNCTION
;

1134 #ifde‡
c⁄figUSE_APPLICATION_TASK_TAG


1135 #i‡
c⁄figUSE_APPLICATION_TASK_TAG
 == 1

1144 
vTaskSëAµliˇti⁄TaskTag
–
xTaskH™dÀ
 
xTask
, 
pdTASK_HOOK_CODE
 
pxHookFun˘i⁄
 ) 
PRIVILEGED_FUNCTION
;

1152 
pdTASK_HOOK_CODE
 
xTaskGëAµliˇti⁄TaskTag
–
xTaskH™dÀ
 
xTask
 ) 
PRIVILEGED_FUNCTION
;

1166 
p‹tBASE_TYPE
 
xTaskCÆlAµliˇti⁄TaskHook
–
xTaskH™dÀ
 
xTask
, *
pvP¨amëî
 ) 
PRIVILEGED_FUNCTION
;

1175 
xTaskH™dÀ
 
xTaskGëIdÀTaskH™dÀ
( );

1191 
vTaskIn¸emítTick
–Ë
PRIVILEGED_FUNCTION
;

1214 
vTaskPœ˚OnEvítLi°
–c⁄° 
xLi°
 * c⁄° 
pxEvítLi°
, 
p‹tTickTy≥
 
xTicksToWaô
 ) 
PRIVILEGED_FUNCTION
;

1229 
vTaskPœ˚OnEvítLi°Re°ri˘ed
–c⁄° 
xLi°
 * c⁄° 
pxEvítLi°
, 
p‹tTickTy≥
 
xTicksToWaô
 ) 
PRIVILEGED_FUNCTION
;

1246 sig√d 
p‹tBASE_TYPE
 
xTaskRemoveFromEvítLi°
–c⁄° 
xLi°
 * c⁄° 
pxEvítLi°
 ) 
PRIVILEGED_FUNCTION
;

1256 
vTaskSwôchC⁄ãxt
–Ë
PRIVILEGED_FUNCTION
;

1261 
xTaskH™dÀ
 
xTaskGëCuºítTaskH™dÀ
–Ë
PRIVILEGED_FUNCTION
;

1266 
vTaskSëTimeOutSèã
–
xTimeOutTy≥
 * c⁄° 
pxTimeOut
 ) 
PRIVILEGED_FUNCTION
;

1272 
p‹tBASE_TYPE
 
xTaskCheckF‹TimeOut
–
xTimeOutTy≥
 * c⁄° 
pxTimeOut
, 
p‹tTickTy≥
 * c⁄° 
pxTicksToWaô
 ) 
PRIVILEGED_FUNCTION
;

1278 
vTaskMis£dYõld
–Ë
PRIVILEGED_FUNCTION
;

1284 
p‹tBASE_TYPE
 
xTaskGëScheduÀrSèã
–Ë
PRIVILEGED_FUNCTION
;

1290 
vTaskPri‹ôyInhîô
–
xTaskH™dÀ
 * c⁄° 
pxMuãxHﬁdî
 ) 
PRIVILEGED_FUNCTION
;

1296 
vTaskPri‹ôyDisöhîô
–
xTaskH™dÀ
 * c⁄° 
pxMuãxHﬁdî
 ) 
PRIVILEGED_FUNCTION
;

1302 sig√d 
p‹tBASE_TYPE
 
xTaskGíîicCª©e
–
pdTASK_CODE
 
pxTaskCode
, c⁄° sig√d * c⁄° 
pcName
, 
usSèckDïth
, *
pvP¨amëîs
, p‹tBASE_TYPE 
uxPri‹ôy
, 
xTaskH™dÀ
 *
pxCª©edTask
, 
p‹tSTACK_TYPE
 *
puxSèckBuf„r
, c⁄° 
xMem‹yRegi⁄
 * c⁄° 
xRegi⁄s
 ) 
PRIVILEGED_FUNCTION
;

1304 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\timers.h

55 #i‚de‡
TIMERS_H


56 
	#TIMERS_H


	)

58 #i‚de‡
INC_FREERTOS_H


62 
	~"p‹èbÀ.h
"

63 
	~"li°.h
"

64 
	~"èsk.h
"

66 #ifde‡
__˝lu•lus


73 
	#tmrCOMMAND_START
 0

	)

74 
	#tmrCOMMAND_STOP
 1

	)

75 
	#tmrCOMMAND_CHANGE_PERIOD
 2

	)

76 
	#tmrCOMMAND_DELETE
 3

	)

88 * 
	txTimîH™dÀ
;

91 (*
tmrTIMER_CALLBACK
)–
	txTimîH™dÀ
 
	txTimî
 );

221 
xTimîH™dÀ
 
xTimîCª©e
–c⁄° sig√d *
pcTimîName
, 
p‹tTickTy≥
 
xTimîPîiodInTicks
, 
p‹tBASE_TYPE
 
uxAutoRñﬂd
, * 
pvTimîID
, 
tmrTIMER_CALLBACK
 
pxCÆlbackFun˘i⁄
 ) 
PRIVILEGED_FUNCTION
;

243 *
pvTimîGëTimîID
–
xTimîH™dÀ
 
xTimî
 ) 
PRIVILEGED_FUNCTION
;

279 
p‹tBASE_TYPE
 
xTimîIsTimîA˘ive
–
xTimîH™dÀ
 
xTimî
 ) 
PRIVILEGED_FUNCTION
;

288 
xTaskH™dÀ
 
xTimîGëTimîD´m⁄TaskH™dÀ
( );

340 
	#xTimîSèπ
–
xTimî
, 
xBlockTime
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_START
, ( 
	`xTaskGëTickCou¡
(Ë), 
NULL
, ( xBlockTimêË)

	)

382 
	#xTimîSt›
–
xTimî
, 
xBlockTime
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_STOP
, 0U, 
NULL
, ( xBlockTimêË)

	)

461 
	#xTimîCh™gePîiod
–
xTimî
, 
xNewPîiod
, 
xBlockTime
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_CHANGE_PERIOD
, ( xNewPîiod ), 
NULL
, ( xBlockTimêË)

	)

499 
	#xTimîDñëe
–
xTimî
, 
xBlockTime
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_DELETE
, 0U, 
NULL
, ( xBlockTimêË)

	)

622 
	#xTimîRe£t
–
xTimî
, 
xBlockTime
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_START
, ( 
	`xTaskGëTickCou¡
(Ë), 
NULL
, ( xBlockTimêË)

	)

706 
	#xTimîSèπFromISR
–
xTimî
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_START
, ( 
	`xTaskGëTickCou¡FromISR
(Ë), (ÖxHighîPri‹ôyTaskWokí ), 0U )

	)

768 
	#xTimîSt›FromISR
–
xTimî
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_STOP
, 0, (ÖxHighîPri‹ôyTaskWokí ), 0U )

	)

840 
	#xTimîCh™gePîiodFromISR
–
xTimî
, 
xNewPîiod
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_CHANGE_PERIOD
, ( xNewPîiod ), (ÖxHighîPri‹ôyTaskWokí ), 0U )

	)

925 
	#xTimîRe£tFromISR
–
xTimî
, 
pxHighîPri‹ôyTaskWokí
 ) 
	`xTimîGíîicComm™d
––xTimî ), 
tmrCOMMAND_START
, ( 
	`xTaskGëTickCou¡FromISR
(Ë), (ÖxHighîPri‹ôyTaskWokí ), 0U )

	)

931 
p‹tBASE_TYPE
 
xTimîCª©eTimîTask
–Ë
PRIVILEGED_FUNCTION
;

932 
p‹tBASE_TYPE
 
xTimîGíîicComm™d
–
xTimîH™dÀ
 
xTimî
,Ö‹tBASE_TYPE 
xComm™dID
, 
p‹tTickTy≥
 
xO±i⁄ÆVÆue
,Ö‹tBASE_TYPE *
pxHighîPri‹ôyTaskWokí
,Ö‹tTickTy≥ 
xBlockTime
 ) 
PRIVILEGED_FUNCTION
;

934 #ifde‡
__˝lu•lus


	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\list.c

55 
	~<°dlib.h
>

56 
	~"FªeRTOS.h
"

57 
	~"li°.h
"

63 
	$vLi°Inôüli£
–
xLi°
 *
pxLi°
 )

68 
pxLi°
->
pxIndex
 = ( 
xLi°Iãm
 * ) &–pxLi°->
xLi°End
 );

72 
pxLi°
->
xLi°End
.
xIãmVÆue
 = 
p‹tMAX_DELAY
;

76 
pxLi°
->
xLi°End
.
pxNext
 = ( 
xLi°Iãm
 * ) &(ÖxList->xListEnd );

77 
pxLi°
->
xLi°End
.
pxPªvious
 = ( 
xLi°Iãm
 * ) &(ÖxList->xListEnd );

79 
pxLi°
->
uxNumbîOfIãms
 = ( 
p‹tBASE_TYPE
 ) 0U;

80 
	}
}

83 
	$vLi°Inôüli£Iãm
–
xLi°Iãm
 *
pxIãm
 )

86 
pxIãm
->
pvC⁄èöî
 = 
NULL
;

87 
	}
}

90 
	$vLi°In£πEnd
–
xLi°
 *
pxLi°
, 
xLi°Iãm
 *
pxNewLi°Iãm
 )

92 vﬁ©ûê
xLi°Iãm
 * 
pxIndex
;

98 
pxIndex
 = 
pxLi°
->pxIndex;

100 
pxNewLi°Iãm
->
pxNext
 = 
pxIndex
->pxNext;

101 
pxNewLi°Iãm
->
pxPªvious
 = 
pxLi°
->
pxIndex
;

102 
pxIndex
->
pxNext
->
pxPªvious
 = ( vﬁ©ûê
xLi°Iãm
 * ) 
pxNewLi°Iãm
;

103 
pxIndex
->
pxNext
 = ( vﬁ©ûê
xLi°Iãm
 * ) 
pxNewLi°Iãm
;

104 
pxLi°
->
pxIndex
 = ( vﬁ©ûê
xLi°Iãm
 * ) 
pxNewLi°Iãm
;

107 
pxNewLi°Iãm
->
pvC⁄èöî
 = ( * ) 
pxLi°
;

109 –
pxLi°
->
uxNumbîOfIãms
 )++;

110 
	}
}

113 
	$vLi°In£π
–
xLi°
 *
pxLi°
, 
xLi°Iãm
 *
pxNewLi°Iãm
 )

115 vﬁ©ûê
xLi°Iãm
 *
pxIãøt‹
;

116 
p‹tTickTy≥
 
xVÆueOfIn£πi⁄
;

119 
xVÆueOfIn£πi⁄
 = 
pxNewLi°Iãm
->
xIãmVÆue
;

128 if–
xVÆueOfIn£πi⁄
 =
p‹tMAX_DELAY
 )

130 
pxIãøt‹
 = 
pxLi°
->
xLi°End
.
pxPªvious
;

150  
pxIãøt‹
 = ( 
xLi°Iãm
 * ) &–
pxLi°
->
xLi°End
 );ÖxIãøt‹->
pxNext
->
xIãmVÆue
 <
xVÆueOfIn£πi⁄
;ÖxIterator =ÖxIterator->pxNext )

157 
pxNewLi°Iãm
->
pxNext
 = 
pxIãøt‹
->pxNext;

158 
pxNewLi°Iãm
->
pxNext
->
pxPªvious
 = ( vﬁ©ûê
xLi°Iãm
 * )ÖxNewListItem;

159 
pxNewLi°Iãm
->
pxPªvious
 = 
pxIãøt‹
;

160 
pxIãøt‹
->
pxNext
 = ( vﬁ©ûê
xLi°Iãm
 * ) 
pxNewLi°Iãm
;

164 
pxNewLi°Iãm
->
pvC⁄èöî
 = ( * ) 
pxLi°
;

166 –
pxLi°
->
uxNumbîOfIãms
 )++;

167 
	}
}

170 
	$vLi°Remove
–
xLi°Iãm
 *
pxIãmToRemove
 )

172 
xLi°
 * 
pxLi°
;

174 
pxIãmToRemove
->
pxNext
->
pxPªvious
 =ÖxItemToRemove->pxPrevious;

175 
pxIãmToRemove
->
pxPªvious
->
pxNext
 =ÖxItemToRemove->pxNext;

179 
pxLi°
 = ( 
xLi°
 * ) 
pxIãmToRemove
->
pvC⁄èöî
;

182 if–
pxLi°
->
pxIndex
 =
pxIãmToRemove
 )

184 
pxLi°
->
pxIndex
 = 
pxIãmToRemove
->
pxPªvious
;

187 
pxIãmToRemove
->
pvC⁄èöî
 = 
NULL
;

188 –
pxLi°
->
uxNumbîOfIãms
 )--;

189 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\port.c

59 
	~"FªeRTOS.h
"

60 
	~"èsk.h
"

62 #i‚de‡
c⁄figKERNEL_INTERRUPT_PRIORITY


63 
	#c⁄figKERNEL_INTERRUPT_PRIORITY
 255

	)

67 
	#p‹tNVIC_SYSTICK_CTRL
 ( ( vﬁ©ûê*Ë0xe000e010 )

	)

68 
	#p‹tNVIC_SYSTICK_LOAD
 ( ( vﬁ©ûê*Ë0xe000e014 )

	)

69 
	#p‹tNVIC_INT_CTRL
 ( ( vﬁ©ûê*Ë0xe000ed04 )

	)

70 
	#p‹tNVIC_SYSPRI2
 ( ( vﬁ©ûê*Ë0xe000ed20 )

	)

71 
	#p‹tNVIC_SYSTICK_CLK
 0x00000004

	)

72 
	#p‹tNVIC_SYSTICK_INT
 0x00000002

	)

73 
	#p‹tNVIC_SYSTICK_ENABLE
 0x00000001

	)

74 
	#p‹tNVIC_PENDSVSET
 0x10000000

	)

75 
	#p‹tNVIC_PENDSV_PRI
 ( ( ( Ë
c⁄figKERNEL_INTERRUPT_PRIORITY
 ) << 16 )

	)

76 
	#p‹tNVIC_SYSTICK_PRI
 ( ( ( Ë
c⁄figKERNEL_INTERRUPT_PRIORITY
 ) << 24 )

	)

79 
	#p‹tINITIAL_XPSR
 ( 0x01000000 )

	)

83 
p‹tBASE_TYPE
 
	guxCrôiˇlNe°ög
 = 0xaaaaaaaa;

88 
¥vSëupTimîI¡îru±
( );

93 
xP‹tPídSVH™dÀr
( );

94 
xP‹tSysTickH™dÀr
( );

95 
vP‹tSVCH™dÀr
( );

100 
vP‹tSèπFú°Task
( );

107 
p‹tSTACK_TYPE
 *
	$pxP‹tInôüli£Sèck
–
p‹tSTACK_TYPE
 *
pxT›OfSèck
, 
pdTASK_CODE
 
pxCode
, *
pvP¨amëîs
 )

111 
pxT›OfSèck
--;

112 *
pxT›OfSèck
 = 
p‹tINITIAL_XPSR
;

113 
pxT›OfSèck
--;

114 *
pxT›OfSèck
 = ( 
p‹tSTACK_TYPE
 ) 
pxCode
;

115 
pxT›OfSèck
--;

116 *
pxT›OfSèck
 = 0;

117 
pxT›OfSèck
 -= 5;

118 *
pxT›OfSèck
 = ( 
p‹tSTACK_TYPE
 ) 
pvP¨amëîs
;

119 
pxT›OfSèck
 -= 8;

121  
pxT›OfSèck
;

122 
	}
}

125 
__asm
 
	$vP‹tSVCH™dÀr
( )

127 
PRESERVE8


129 
ldr
 
r3
, =
pxCuºítTCB


130 
ldr
 
r1
, [
r3
]

131 
ldr
 
r0
, [
r1
]

132 
ldmü
 
r0
!, {
r4
-
r11
}

133 
m§
 
p•
, 
r0


134 
mov
 
r0
, #0

135 
m§
 
ba£¥i
, 
r0


136 
‹r
 
r14
, #0
xd


137 
bx
 
r14


138 
	}
}

141 
__asm
 
	$vP‹tSèπFú°Task
( )

143 
PRESERVE8


146 
ldr
 
r0
, =0xE000ED08

147 
ldr
 
r0
, [r0]

148 
ldr
 
r0
, [r0]

150 
m§
 
m•
, 
r0


152 
˝sõ
 
i


154 
svc
 0

155 
n›


156 
	}
}

162 
p‹tBASE_TYPE
 
	$xP‹tSèπScheduÀr
( )

165 *(
p‹tNVIC_SYSPRI2
Ë|
p‹tNVIC_PENDSV_PRI
;

166 *(
p‹tNVIC_SYSPRI2
Ë|
p‹tNVIC_SYSTICK_PRI
;

170 
	`¥vSëupTimîI¡îru±
();

173 
uxCrôiˇlNe°ög
 = 0;

176 
	`vP‹tSèπFú°Task
();

180 
	}
}

183 
	$vP‹tEndScheduÀr
( )

187 
	}
}

190 
	$vP‹tYõldFromISR
( )

193 *(
p‹tNVIC_INT_CTRL
Ë
p‹tNVIC_PENDSVSET
;

194 
	}
}

197 
	$vP‹tE¡îCrôiˇl
( )

199 
	`p‹tDISABLE_INTERRUPTS
();

200 
uxCrôiˇlNe°ög
++;

201 
	}
}

204 
	$vP‹tExôCrôiˇl
( )

206 
uxCrôiˇlNe°ög
--;

207 if–
uxCrôiˇlNe°ög
 == 0 )

209 
	`p‹tENABLE_INTERRUPTS
();

211 
	}
}

214 
__asm
 
	$xP‹tPídSVH™dÀr
( )

216 
uxCrôiˇlNe°ög
;

217 
pxCuºítTCB
;

218 
vTaskSwôchC⁄ãxt
;

220 
PRESERVE8


222 
mrs
 
r0
, 
p•


224 
ldr
 
r3
, =
pxCuºítTCB


225 
ldr
 
r2
, [
r3
]

227 
°mdb
 
r0
!, {
r4
-
r11
}

228 
°r
 
r0
, [
r2
]

230 
°mdb
 
•
!, {
r3
, 
r14
}

231 
mov
 
r0
, #configMAX_SYSCALL_INTERRUPT_PRIORITY

232 
m§
 
ba£¥i
, 
r0


233 
bl
 
vTaskSwôchC⁄ãxt


234 
mov
 
r0
, #0

235 
m§
 
ba£¥i
, 
r0


236 
ldmü
 
•
!, {
r3
, 
r14
}

238 
ldr
 
r1
, [
r3
]

239 
ldr
 
r0
, [
r1
]

240 
ldmü
 
r0
!, {
r4
-
r11
}

241 
m§
 
p•
, 
r0


242 
bx
 
r14


243 
n›


244 
	}
}

247 
	$xP‹tSysTickH™dÀr
( )

249 
ulDummy
;

252 #i‡
c⁄figUSE_PREEMPTION
 == 1

253 *(
p‹tNVIC_INT_CTRL
Ë
p‹tNVIC_PENDSVSET
;

256 
ulDummy
 = 
	`p‹tSET_INTERRUPT_MASK_FROM_ISR
();

258 
	`vTaskIn¸emítTick
();

260 
	`p‹tCLEAR_INTERRUPT_MASK_FROM_ISR
–
ulDummy
 );

261 
	}
}

268 
	$¥vSëupTimîI¡îru±
( )

271 *(
p‹tNVIC_SYSTICK_LOAD
Ë–
c⁄figCPU_CLOCK_HZ
 / 
c⁄figTICK_RATE_HZ
 ) - 1UL;

272 *(
p‹tNVIC_SYSTICK_CTRL
Ë
p‹tNVIC_SYSTICK_CLK
 | 
p‹tNVIC_SYSTICK_INT
 | 
p‹tNVIC_SYSTICK_ENABLE
;

273 
	}
}

276 
__asm
 
	$vP‹tSëI¡îru±Mask
( )

278 
PRESERVE8


280 
push
 { 
r0
 }

281 
mov
 
r0
, #configMAX_SYSCALL_INTERRUPT_PRIORITY

282 
m§
 
ba£¥i
, 
r0


283 
p›
 { 
r0
 }

284 
bx
 
r14


285 
	}
}

289 
__asm
 
	$vP‹tCÀ¨I¡îru±Mask
( )

291 
PRESERVE8


293 
push
 { 
r0
 }

294 
mov
 
r0
, #0

295 
m§
 
ba£¥i
, 
r0


296 
p›
 { 
r0
 }

297 
bx
 
r14


298 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\queue.c

54 
	~<°dlib.h
>

55 
	~<°rög.h
>

60 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

62 
	~"FªeRTOS.h
"

63 
	~"èsk.h
"

65 #i‡–
c⁄figUSE_CO_ROUTINES
 == 1 )

66 
	~"¸outöe.h
"

69 #unde‡
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


76 
	#queueUNLOCKED
 ( ( sig√d 
p‹tBASE_TYPE
 ) -1 )

	)

77 
	#queueLOCKED_UNMODIFIED
 ( ( sig√d 
p‹tBASE_TYPE
 ) 0 )

	)

79 
	#queueERRONEOUS_UNBLOCK
 ( -1 )

	)

82 
	#queueSEND_TO_BACK
 ( 0 )

	)

83 
	#queueSEND_TO_FRONT
 ( 1 )

	)

86 
	#pxMuãxHﬁdî
 
pcTaû


	)

87 
	#uxQueueTy≥
 
pcHód


	)

88 
	#uxRecursiveCÆlCou¡
 
pcRódFrom


	)

89 
	#queueQUEUE_IS_MUTEX
 
NULL


	)

93 
	#queueSEMAPHORE_QUEUE_ITEM_LENGTH
 ( ( 
p‹tBASE_TYPE
 ) 0 )

	)

94 
	#queueDONT_BLOCK
 ( ( 
p‹tTickTy≥
 ) 0U )

	)

95 
	#queueMUTEX_GIVE_BLOCK_TIME
 ( ( 
p‹tTickTy≥
 ) 0U )

	)

101 
	sQueueDeföôi⁄


103 sig√d *
	mpcHód
;

104 sig√d *
	mpcTaû
;

106 sig√d *
	mpcWrôeTo
;

107 sig√d *
	mpcRódFrom
;

109 
xLi°
 
	mxTasksWaôögToSíd
;

110 
xLi°
 
	mxTasksWaôögToRe˚ive
;

112 vﬁ©ûê
p‹tBASE_TYPE
 
	muxMesßgesWaôög
;

113 
p‹tBASE_TYPE
 
	muxLígth
;

114 
p‹tBASE_TYPE
 
	muxIãmSize
;

116 sig√d 
p‹tBASE_TYPE
 
	mxRxLock
;

117 sig√d 
p‹tBASE_TYPE
 
	mxTxLock
;

119 } 
	txQUEUE
;

127 
xQUEUE
 * 
	txQueueH™dÀ
;

134 
xQueueH™dÀ
 
	$xQueueCª©e
–
p‹tBASE_TYPE
 
uxQueueLígth
, p‹tBASE_TYPE 
uxIãmSize
 ) 
PRIVILEGED_FUNCTION
;

135 sig√d 
p‹tBASE_TYPE
 
	$xQueueGíîicSíd
–
xQueueH™dÀ
 
xQueue
, c⁄° * c⁄° 
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xC›yPosôi⁄
 ) 
PRIVILEGED_FUNCTION
;

136 
p‹tBASE_TYPE
 
	$uxQueueMesßgesWaôög
–c⁄° 
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

137 
	$vQueueDñëe
–
xQueueH™dÀ
 
xQueue
 ) 
PRIVILEGED_FUNCTION
;

138 sig√d 
p‹tBASE_TYPE
 
	$xQueueGíîicSídFromISR
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, sig√d 
p‹tBASE_TYPE
 *
pxHighîPri‹ôyTaskWokí
,Ö‹tBASE_TYPE 
xC›yPosôi⁄
 ) 
PRIVILEGED_FUNCTION
;

139 sig√d 
p‹tBASE_TYPE
 
	$xQueueGíîicRe˚ive
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xJu°Pìkög
 ) 
PRIVILEGED_FUNCTION
;

140 sig√d 
p‹tBASE_TYPE
 
	$xQueueRe˚iveFromISR
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, sig√d 
p‹tBASE_TYPE
 *
pxTaskWokí
 ) 
PRIVILEGED_FUNCTION
;

141 
xQueueH™dÀ
 
	$xQueueCª©eMuãx
–Ë
PRIVILEGED_FUNCTION
;

142 
xQueueH™dÀ
 
	$xQueueCª©eCou¡ögSem≠h‹e
–
p‹tBASE_TYPE
 
uxCou¡VÆue
, p‹tBASE_TYPE 
uxInôülCou¡
 ) 
PRIVILEGED_FUNCTION
;

143 
p‹tBASE_TYPE
 
	$xQueueTakeMuãxRecursive
–
xQueueH™dÀ
 
xMuãx
, 
p‹tTickTy≥
 
xBlockTime
 ) 
PRIVILEGED_FUNCTION
;

144 
p‹tBASE_TYPE
 
	$xQueueGiveMuãxRecursive
–
xQueueH™dÀ
 
xMuãx
 ) 
PRIVILEGED_FUNCTION
;

145 sig√d 
p‹tBASE_TYPE
 
	$xQueueA…GíîicSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xC›yPosôi⁄
 ) 
PRIVILEGED_FUNCTION
;

146 sig√d 
p‹tBASE_TYPE
 
	$xQueueA…GíîicRe˚ive
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xJu°Pìkög
 ) 
PRIVILEGED_FUNCTION
;

147 sig√d 
p‹tBASE_TYPE
 
	$xQueueIsQueueEm±yFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

148 sig√d 
p‹tBASE_TYPE
 
	$xQueueIsQueueFuŒFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

149 
p‹tBASE_TYPE
 
	$uxQueueMesßgesWaôögFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

150 
	$vQueueWaôF‹MesßgeRe°ri˘ed
–
xQueueH™dÀ
 
pxQueue
, 
p‹tTickTy≥
 
xTicksToWaô
 ) 
PRIVILEGED_FUNCTION
;

156 #i‡
c⁄figUSE_CO_ROUTINES
 == 1

157 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRSídFromISR
–
xQueueH™dÀ
 
pxQueue
, c⁄° *
pvIãmToQueue
, sig√d 
p‹tBASE_TYPE
 
xCoRoutöePªviou¶yWokí
 ) 
PRIVILEGED_FUNCTION
;

158 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRRe˚iveFromISR
–
xQueueH™dÀ
 
pxQueue
, *
pvBuf„r
, sig√d 
p‹tBASE_TYPE
 *
pxTaskWokí
 ) 
PRIVILEGED_FUNCTION
;

159 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° *
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
 ) 
PRIVILEGED_FUNCTION
;

160 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRRe˚ive
–
xQueueH™dÀ
 
pxQueue
, *
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
 ) 
PRIVILEGED_FUNCTION
;

167 #i‡
c⁄figQUEUE_REGISTRY_SIZE
 > 0

172 
	sQUEUE_REGISTRY_ITEM


174 sig√d *
pcQueueName
;

175 
xQueueH™dÀ
 
xH™dÀ
;

176 } 
	txQueueRegi°ryIãm
;

181 
xQueueRegi°ryIãm
 
xQueueRegi°ry
[ 
c⁄figQUEUE_REGISTRY_SIZE
 ];

185 
	$vQueueUƒegi°îQueue
–
xQueueH™dÀ
 
xQueue
 ) 
PRIVILEGED_FUNCTION
;

186 
	$vQueueAddToRegi°ry
–
xQueueH™dÀ
 
xQueue
, sig√d *
pcQueueName
 ) 
PRIVILEGED_FUNCTION
;

197 
	$¥vU∆ockQueue
–
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

204 sig√d 
p‹tBASE_TYPE
 
	$¥vIsQueueEm±y
–c⁄° 
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

211 sig√d 
p‹tBASE_TYPE
 
	$¥vIsQueueFuŒ
–c⁄° 
xQueueH™dÀ
 
pxQueue
 ) 
PRIVILEGED_FUNCTION
;

217 
	$¥vC›yD©aToQueue
–
xQUEUE
 *
pxQueue
, c⁄° *
pvIãmToQueue
, 
p‹tBASE_TYPE
 
xPosôi⁄
 ) 
PRIVILEGED_FUNCTION
;

222 
	$¥vC›yD©aFromQueue
–
xQUEUE
 * c⁄° 
pxQueue
, c⁄° *
pvBuf„r
 ) 
PRIVILEGED_FUNCTION
;

229 
	#¥vLockQueue
–
pxQueue
 ) \

230 
	`èskENTER_CRITICAL
(); \

232 if––
pxQueue
 )->
xRxLock
 =
queueUNLOCKED
 ) \

234 –
pxQueue
 )->
xRxLock
 = 
queueLOCKED_UNMODIFIED
; \

236 if––
pxQueue
 )->
xTxLock
 =
queueUNLOCKED
 ) \

238 –
pxQueue
 )->
xTxLock
 = 
queueLOCKED_UNMODIFIED
; \

240 
	}
} \

241 
	`èskEXIT_CRITICAL
()

	)

249 
xQueueH™dÀ
 
	$xQueueCª©e
–
p‹tBASE_TYPE
 
uxQueueLígth
, p‹tBASE_TYPE 
uxIãmSize
 )

251 
xQUEUE
 *
pxNewQueue
;

252 
size_t
 
xQueueSizeInByãs
;

253 
xQueueH™dÀ
 
xRëu∫
 = 
NULL
;

256 if–
uxQueueLígth
 > ( 
p‹tBASE_TYPE
 ) 0 )

258 
pxNewQueue
 = ( 
xQUEUE
 * ) 
	`pvP‹tMÆloc
( ( xQUEUE ) );

259 if–
pxNewQueue
 !
NULL
 )

263 
xQueueSizeInByãs
 = ( 
size_t
 ) ( 
uxQueueLígth
 * 
uxIãmSize
 ) + ( size_t ) 1;

265 
pxNewQueue
->
pcHód
 = ( sig√d * ) 
	`pvP‹tMÆloc
–
xQueueSizeInByãs
 );

266 if–
pxNewQueue
->
pcHód
 !
NULL
 )

270 
pxNewQueue
->
pcTaû
 =ÖxNewQueue->
pcHód
 + ( 
uxQueueLígth
 * 
uxIãmSize
 );

271 
pxNewQueue
->
uxMesßgesWaôög
 = ( 
p‹tBASE_TYPE
 ) 0U;

272 
pxNewQueue
->
pcWrôeTo
 =ÖxNewQueue->
pcHód
;

273 
pxNewQueue
->
pcRódFrom
 =ÖxNewQueue->
pcHód
 + ( ( 
uxQueueLígth
 - ( 
p‹tBASE_TYPE
 ) 1U ) * 
uxIãmSize
 );

274 
pxNewQueue
->
uxLígth
 = 
uxQueueLígth
;

275 
pxNewQueue
->
uxIãmSize
 = uxItemSize;

276 
pxNewQueue
->
xRxLock
 = 
queueUNLOCKED
;

277 
pxNewQueue
->
xTxLock
 = 
queueUNLOCKED
;

280 
	`vLi°Inôüli£
–&–
pxNewQueue
->
xTasksWaôögToSíd
 ) );

281 
	`vLi°Inôüli£
–&–
pxNewQueue
->
xTasksWaôögToRe˚ive
 ) );

283 
	`åa˚QUEUE_CREATE
–
pxNewQueue
 );

284 
xRëu∫
 = 
pxNewQueue
;

288 
	`åa˚QUEUE_CREATE_FAILED
();

289 
	`vP‹tFªe
–
pxNewQueue
 );

294 
	`c⁄figASSERT
–
xRëu∫
 );

296  
xRëu∫
;

297 
	}
}

300 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

302 
xQueueH™dÀ
 
	$xQueueCª©eMuãx
( )

304 
xQUEUE
 *
pxNewQueue
;

307 
pxNewQueue
 = ( 
xQUEUE
 * ) 
	`pvP‹tMÆloc
( ( xQUEUE ) );

308 if–
pxNewQueue
 !
NULL
 )

311 
pxNewQueue
->
pxMuãxHﬁdî
 = 
NULL
;

312 
pxNewQueue
->
uxQueueTy≥
 = 
queueQUEUE_IS_MUTEX
;

316 
pxNewQueue
->
pcWrôeTo
 = 
NULL
;

317 
pxNewQueue
->
pcRódFrom
 = 
NULL
;

322 
pxNewQueue
->
uxMesßgesWaôög
 = ( 
p‹tBASE_TYPE
 ) 0U;

323 
pxNewQueue
->
uxLígth
 = ( 
p‹tBASE_TYPE
 ) 1U;

324 
pxNewQueue
->
uxIãmSize
 = ( 
p‹tBASE_TYPE
 ) 0U;

325 
pxNewQueue
->
xRxLock
 = 
queueUNLOCKED
;

326 
pxNewQueue
->
xTxLock
 = 
queueUNLOCKED
;

329 
	`vLi°Inôüli£
–&–
pxNewQueue
->
xTasksWaôögToSíd
 ) );

330 
	`vLi°Inôüli£
–&–
pxNewQueue
->
xTasksWaôögToRe˚ive
 ) );

333 
	`xQueueGíîicSíd
–
pxNewQueue
, 
NULL
, ( 
p‹tTickTy≥
 ) 0U, 
queueSEND_TO_BACK
 );

335 
	`åa˚CREATE_MUTEX
–
pxNewQueue
 );

339 
	`åa˚CREATE_MUTEX_FAILED
();

342 
	`c⁄figASSERT
–
pxNewQueue
 );

343  
pxNewQueue
;

344 
	}
}

349 #i‡
c⁄figUSE_RECURSIVE_MUTEXES
 == 1

351 
p‹tBASE_TYPE
 
	$xQueueGiveMuãxRecursive
–
xQueueH™dÀ
 
pxMuãx
 )

353 
p‹tBASE_TYPE
 
xRëu∫
;

355 
	`c⁄figASSERT
–
pxMuãx
 );

363 if–
pxMuãx
->
pxMuãxHﬁdî
 =
	`xTaskGëCuºítTaskH™dÀ
() )

365 
	`åa˚GIVE_MUTEX_RECURSIVE
–
pxMuãx
 );

372 –
pxMuãx
->
uxRecursiveCÆlCou¡
 )--;

375 if–
pxMuãx
->
uxRecursiveCÆlCou¡
 == 0 )

379 
	`xQueueGíîicSíd
–
pxMuãx
, 
NULL
, 
queueMUTEX_GIVE_BLOCK_TIME
, 
queueSEND_TO_BACK
 );

382 
xRëu∫
 = 
pdPASS
;

387 
xRëu∫
 = 
pdFAIL
;

389 
	`åa˚GIVE_MUTEX_RECURSIVE_FAILED
–
pxMuãx
 );

392  
xRëu∫
;

393 
	}
}

398 #i‡
c⁄figUSE_RECURSIVE_MUTEXES
 == 1

400 
p‹tBASE_TYPE
 
	$xQueueTakeMuãxRecursive
–
xQueueH™dÀ
 
pxMuãx
, 
p‹tTickTy≥
 
xBlockTime
 )

402 
p‹tBASE_TYPE
 
xRëu∫
;

404 
	`c⁄figASSERT
–
pxMuãx
 );

409 
	`åa˚TAKE_MUTEX_RECURSIVE
–
pxMuãx
 );

411 if–
pxMuãx
->
pxMuãxHﬁdî
 =
	`xTaskGëCuºítTaskH™dÀ
() )

413 –
pxMuãx
->
uxRecursiveCÆlCou¡
 )++;

414 
xRëu∫
 = 
pdPASS
;

418 
xRëu∫
 = 
	`xQueueGíîicRe˚ive
–
pxMuãx
, 
NULL
, 
xBlockTime
, 
pdFALSE
 );

422 if–
xRëu∫
 =
pdPASS
 )

424 –
pxMuãx
->
uxRecursiveCÆlCou¡
 )++;

428 
	`åa˚TAKE_MUTEX_RECURSIVE_FAILED
–
pxMuãx
 );

432  
xRëu∫
;

433 
	}
}

438 #i‡
c⁄figUSE_COUNTING_SEMAPHORES
 == 1

440 
xQueueH™dÀ
 
	$xQueueCª©eCou¡ögSem≠h‹e
–
p‹tBASE_TYPE
 
uxCou¡VÆue
, p‹tBASE_TYPE 
uxInôülCou¡
 )

442 
xQueueH™dÀ
 
pxH™dÀ
;

444 
pxH™dÀ
 = 
	`xQueueCª©e
––
p‹tBASE_TYPE
 ) 
uxCou¡VÆue
, 
queueSEMAPHORE_QUEUE_ITEM_LENGTH
 );

446 if–
pxH™dÀ
 !
NULL
 )

448 
pxH™dÀ
->
uxMesßgesWaôög
 = 
uxInôülCou¡
;

450 
	`åa˚CREATE_COUNTING_SEMAPHORE
();

454 
	`åa˚CREATE_COUNTING_SEMAPHORE_FAILED
();

457 
	`c⁄figASSERT
–
pxH™dÀ
 );

458  
pxH™dÀ
;

459 
	}
}

464 sig√d 
p‹tBASE_TYPE
 
	$xQueueGíîicSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xC›yPosôi⁄
 )

466 sig√d 
p‹tBASE_TYPE
 
xE¡ryTimeSë
 = 
pdFALSE
;

467 
xTimeOutTy≥
 
xTimeOut
;

469 
	`c⁄figASSERT
–
pxQueue
 );

470 
	`c⁄figASSERT
–!––
pvIãmToQueue
 =
NULL
 ) && ( 
pxQueue
->
uxIãmSize
 !–
p‹tBASE_TYPE
 ) 0U ) ) );

477 
	`èskENTER_CRITICAL
();

481 if–
pxQueue
->
uxMesßgesWaôög
 <ÖxQueue->
uxLígth
 )

483 
	`åa˚QUEUE_SEND
–
pxQueue
 );

484 
	`¥vC›yD©aToQueue
–
pxQueue
, 
pvIãmToQueue
, 
xC›yPosôi⁄
 );

488 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

490 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdTRUE
 )

496 
	`p‹tYIELD_WITHIN_API
();

500 
	`èskEXIT_CRITICAL
();

504  
pdPASS
;

508 if–
xTicksToWaô
 =–
p‹tTickTy≥
 ) 0 )

512 
	`èskEXIT_CRITICAL
();

516 
	`åa˚QUEUE_SEND_FAILED
–
pxQueue
 );

517  
îrQUEUE_FULL
;

519 if–
xE¡ryTimeSë
 =
pdFALSE
 )

523 
	`vTaskSëTimeOutSèã
–&
xTimeOut
 );

524 
xE¡ryTimeSë
 = 
pdTRUE
;

528 
	`èskEXIT_CRITICAL
();

533 
	`vTaskSu•ídAŒ
();

534 
	`¥vLockQueue
–
pxQueue
 );

537 if–
	`xTaskCheckF‹TimeOut
–&
xTimeOut
, &
xTicksToWaô
 ) =
pdFALSE
 )

539 if–
	`¥vIsQueueFuŒ
–
pxQueue
 ) !
pdFALSE
 )

541 
	`åa˚BLOCKING_ON_QUEUE_SEND
–
pxQueue
 );

542 
	`vTaskPœ˚OnEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ), 
xTicksToWaô
 );

549 
	`¥vU∆ockQueue
–
pxQueue
 );

556 if–
	`xTaskResumeAŒ
(Ë=
pdFALSE
 )

558 
	`p‹tYIELD_WITHIN_API
();

564 
	`¥vU∆ockQueue
–
pxQueue
 );

565 –Ë
	`xTaskResumeAŒ
();

571 
	`¥vU∆ockQueue
–
pxQueue
 );

572 –Ë
	`xTaskResumeAŒ
();

576 
	`åa˚QUEUE_SEND_FAILED
–
pxQueue
 );

577  
îrQUEUE_FULL
;

580 
	}
}

583 #i‡
c⁄figUSE_ALTERNATIVE_API
 == 1

585 sig√d 
p‹tBASE_TYPE
 
	$xQueueA…GíîicSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xC›yPosôi⁄
 )

587 sig√d 
p‹tBASE_TYPE
 
xE¡ryTimeSë
 = 
pdFALSE
;

588 
xTimeOutTy≥
 
xTimeOut
;

590 
	`c⁄figASSERT
–
pxQueue
 );

591 
	`c⁄figASSERT
–!––
pvIãmToQueue
 =
NULL
 ) && ( 
pxQueue
->
uxIãmSize
 !–
p‹tBASE_TYPE
 ) 0U ) ) );

595 
	`èskENTER_CRITICAL
();

599 if–
pxQueue
->
uxMesßgesWaôög
 <ÖxQueue->
uxLígth
 )

601 
	`åa˚QUEUE_SEND
–
pxQueue
 );

602 
	`¥vC›yD©aToQueue
–
pxQueue
, 
pvIãmToQueue
, 
xC›yPosôi⁄
 );

606 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

608 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdTRUE
 )

612 
	`p‹tYIELD_WITHIN_API
();

616 
	`èskEXIT_CRITICAL
();

617  
pdPASS
;

621 if–
xTicksToWaô
 =–
p‹tTickTy≥
 ) 0 )

623 
	`èskEXIT_CRITICAL
();

624  
îrQUEUE_FULL
;

626 if–
xE¡ryTimeSë
 =
pdFALSE
 )

628 
	`vTaskSëTimeOutSèã
–&
xTimeOut
 );

629 
xE¡ryTimeSë
 = 
pdTRUE
;

633 
	`èskEXIT_CRITICAL
();

635 
	`èskENTER_CRITICAL
();

637 if–
	`xTaskCheckF‹TimeOut
–&
xTimeOut
, &
xTicksToWaô
 ) =
pdFALSE
 )

639 if–
	`¥vIsQueueFuŒ
–
pxQueue
 ) !
pdFALSE
 )

641 
	`åa˚BLOCKING_ON_QUEUE_SEND
–
pxQueue
 );

642 
	`vTaskPœ˚OnEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ), 
xTicksToWaô
 );

643 
	`p‹tYIELD_WITHIN_API
();

648 
	`èskEXIT_CRITICAL
();

649 
	`åa˚QUEUE_SEND_FAILED
–
pxQueue
 );

650  
îrQUEUE_FULL
;

653 
	`èskEXIT_CRITICAL
();

655 
	}
}

660 #i‡
c⁄figUSE_ALTERNATIVE_API
 == 1

662 sig√d 
p‹tBASE_TYPE
 
	$xQueueA…GíîicRe˚ive
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xJu°Pìkög
 )

664 sig√d 
p‹tBASE_TYPE
 
xE¡ryTimeSë
 = 
pdFALSE
;

665 
xTimeOutTy≥
 
xTimeOut
;

666 sig√d *
pcOrigöÆRódPosôi⁄
;

668 
	`c⁄figASSERT
–
pxQueue
 );

669 
	`c⁄figASSERT
–!––
pvBuf„r
 =
NULL
 ) && ( 
pxQueue
->
uxIãmSize
 !–
p‹tBASE_TYPE
 ) 0U ) ) );

673 
	`èskENTER_CRITICAL
();

675 if–
pxQueue
->
uxMesßgesWaôög
 > ( 
p‹tBASE_TYPE
 ) 0 )

678 
pcOrigöÆRódPosôi⁄
 = 
pxQueue
->
pcRódFrom
;

680 
	`¥vC›yD©aFromQueue
–
pxQueue
, 
pvBuf„r
 );

682 if–
xJu°Pìkög
 =
pdFALSE
 )

684 
	`åa˚QUEUE_RECEIVE
–
pxQueue
 );

687 --–
pxQueue
->
uxMesßgesWaôög
 );

689 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

691 if–
pxQueue
->
uxQueueTy≥
 =
queueQUEUE_IS_MUTEX
 )

695 
pxQueue
->
pxMuãxHﬁdî
 = 
	`xTaskGëCuºítTaskH™dÀ
();

700 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdFALSE
 )

702 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdTRUE
 )

704 
	`p‹tYIELD_WITHIN_API
();

710 
	`åa˚QUEUE_PEEK
–
pxQueue
 );

714 
pxQueue
->
pcRódFrom
 = 
pcOrigöÆRódPosôi⁄
;

718 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

722 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) !
pdFALSE
 )

725 
	`p‹tYIELD_WITHIN_API
();

731 
	`èskEXIT_CRITICAL
();

732  
pdPASS
;

736 if–
xTicksToWaô
 =–
p‹tTickTy≥
 ) 0 )

738 
	`èskEXIT_CRITICAL
();

739 
	`åa˚QUEUE_RECEIVE_FAILED
–
pxQueue
 );

740  
îrQUEUE_EMPTY
;

742 if–
xE¡ryTimeSë
 =
pdFALSE
 )

744 
	`vTaskSëTimeOutSèã
–&
xTimeOut
 );

745 
xE¡ryTimeSë
 = 
pdTRUE
;

749 
	`èskEXIT_CRITICAL
();

751 
	`èskENTER_CRITICAL
();

753 if–
	`xTaskCheckF‹TimeOut
–&
xTimeOut
, &
xTicksToWaô
 ) =
pdFALSE
 )

755 if–
	`¥vIsQueueEm±y
–
pxQueue
 ) !
pdFALSE
 )

757 
	`åa˚BLOCKING_ON_QUEUE_RECEIVE
–
pxQueue
 );

759 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

761 if–
pxQueue
->
uxQueueTy≥
 =
queueQUEUE_IS_MUTEX
 )

763 
	`p‹tENTER_CRITICAL
();

764 
	`vTaskPri‹ôyInhîô
––* ) 
pxQueue
->
pxMuãxHﬁdî
 );

765 
	`p‹tEXIT_CRITICAL
();

770 
	`vTaskPœ˚OnEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ), 
xTicksToWaô
 );

771 
	`p‹tYIELD_WITHIN_API
();

776 
	`èskEXIT_CRITICAL
();

777 
	`åa˚QUEUE_RECEIVE_FAILED
–
pxQueue
 );

778  
îrQUEUE_EMPTY
;

781 
	`èskEXIT_CRITICAL
();

783 
	}
}

789 sig√d 
p‹tBASE_TYPE
 
	$xQueueGíîicSídFromISR
–
xQueueH™dÀ
 
pxQueue
, c⁄° * c⁄° 
pvIãmToQueue
, sig√d 
p‹tBASE_TYPE
 *
pxHighîPri‹ôyTaskWokí
,Ö‹tBASE_TYPE 
xC›yPosôi⁄
 )

791 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

792 
p‹tBASE_TYPE
 
uxSavedI¡îru±Sètus
;

794 
	`c⁄figASSERT
–
pxQueue
 );

795 
	`c⁄figASSERT
–
pxHighîPri‹ôyTaskWokí
 );

796 
	`c⁄figASSERT
–!––
pvIãmToQueue
 =
NULL
 ) && ( 
pxQueue
->
uxIãmSize
 !–
p‹tBASE_TYPE
 ) 0U ) ) );

803 
uxSavedI¡îru±Sètus
 = 
	`p‹tSET_INTERRUPT_MASK_FROM_ISR
();

805 if–
pxQueue
->
uxMesßgesWaôög
 <ÖxQueue->
uxLígth
 )

807 
	`åa˚QUEUE_SEND_FROM_ISR
–
pxQueue
 );

809 
	`¥vC›yD©aToQueue
–
pxQueue
, 
pvIãmToQueue
, 
xC›yPosôi⁄
 );

813 if–
pxQueue
->
xTxLock
 =
queueUNLOCKED
 )

815 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

817 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) !
pdFALSE
 )

821 *
pxHighîPri‹ôyTaskWokí
 = 
pdTRUE
;

829 ++–
pxQueue
->
xTxLock
 );

832 
xRëu∫
 = 
pdPASS
;

836 
	`åa˚QUEUE_SEND_FROM_ISR_FAILED
–
pxQueue
 );

837 
xRëu∫
 = 
îrQUEUE_FULL
;

840 
	`p‹tCLEAR_INTERRUPT_MASK_FROM_ISR
–
uxSavedI¡îru±Sètus
 );

842  
xRëu∫
;

843 
	}
}

846 sig√d 
p‹tBASE_TYPE
 
	$xQueueGíîicRe˚ive
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
, 
p‹tBASE_TYPE
 
xJu°Pìkög
 )

848 sig√d 
p‹tBASE_TYPE
 
xE¡ryTimeSë
 = 
pdFALSE
;

849 
xTimeOutTy≥
 
xTimeOut
;

850 sig√d *
pcOrigöÆRódPosôi⁄
;

852 
	`c⁄figASSERT
–
pxQueue
 );

853 
	`c⁄figASSERT
–!––
pvBuf„r
 =
NULL
 ) && ( 
pxQueue
->
uxIãmSize
 !–
p‹tBASE_TYPE
 ) 0U ) ) );

861 
	`èskENTER_CRITICAL
();

865 if–
pxQueue
->
uxMesßgesWaôög
 > ( 
p‹tBASE_TYPE
 ) 0 )

868 
pcOrigöÆRódPosôi⁄
 = 
pxQueue
->
pcRódFrom
;

870 
	`¥vC›yD©aFromQueue
–
pxQueue
, 
pvBuf„r
 );

872 if–
xJu°Pìkög
 =
pdFALSE
 )

874 
	`åa˚QUEUE_RECEIVE
–
pxQueue
 );

877 --–
pxQueue
->
uxMesßgesWaôög
 );

879 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

881 if–
pxQueue
->
uxQueueTy≥
 =
queueQUEUE_IS_MUTEX
 )

885 
pxQueue
->
pxMuãxHﬁdî
 = 
	`xTaskGëCuºítTaskH™dÀ
();

890 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdFALSE
 )

892 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdTRUE
 )

894 
	`p‹tYIELD_WITHIN_API
();

900 
	`åa˚QUEUE_PEEK
–
pxQueue
 );

904 
pxQueue
->
pcRódFrom
 = 
pcOrigöÆRódPosôi⁄
;

908 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

912 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) !
pdFALSE
 )

915 
	`p‹tYIELD_WITHIN_API
();

921 
	`èskEXIT_CRITICAL
();

922  
pdPASS
;

926 if–
xTicksToWaô
 =–
p‹tTickTy≥
 ) 0 )

930 
	`èskEXIT_CRITICAL
();

931 
	`åa˚QUEUE_RECEIVE_FAILED
–
pxQueue
 );

932  
îrQUEUE_EMPTY
;

934 if–
xE¡ryTimeSë
 =
pdFALSE
 )

938 
	`vTaskSëTimeOutSèã
–&
xTimeOut
 );

939 
xE¡ryTimeSë
 = 
pdTRUE
;

943 
	`èskEXIT_CRITICAL
();

948 
	`vTaskSu•ídAŒ
();

949 
	`¥vLockQueue
–
pxQueue
 );

952 if–
	`xTaskCheckF‹TimeOut
–&
xTimeOut
, &
xTicksToWaô
 ) =
pdFALSE
 )

954 if–
	`¥vIsQueueEm±y
–
pxQueue
 ) !
pdFALSE
 )

956 
	`åa˚BLOCKING_ON_QUEUE_RECEIVE
–
pxQueue
 );

958 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

960 if–
pxQueue
->
uxQueueTy≥
 =
queueQUEUE_IS_MUTEX
 )

962 
	`p‹tENTER_CRITICAL
();

964 
	`vTaskPri‹ôyInhîô
––* ) 
pxQueue
->
pxMuãxHﬁdî
 );

966 
	`p‹tEXIT_CRITICAL
();

971 
	`vTaskPœ˚OnEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ), 
xTicksToWaô
 );

972 
	`¥vU∆ockQueue
–
pxQueue
 );

973 if–
	`xTaskResumeAŒ
(Ë=
pdFALSE
 )

975 
	`p‹tYIELD_WITHIN_API
();

981 
	`¥vU∆ockQueue
–
pxQueue
 );

982 –Ë
	`xTaskResumeAŒ
();

987 
	`¥vU∆ockQueue
–
pxQueue
 );

988 –Ë
	`xTaskResumeAŒ
();

989 
	`åa˚QUEUE_RECEIVE_FAILED
–
pxQueue
 );

990  
îrQUEUE_EMPTY
;

993 
	}
}

996 sig√d 
p‹tBASE_TYPE
 
	$xQueueRe˚iveFromISR
–
xQueueH™dÀ
 
pxQueue
, * c⁄° 
pvBuf„r
, sig√d 
p‹tBASE_TYPE
 *
pxTaskWokí
 )

998 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

999 
p‹tBASE_TYPE
 
uxSavedI¡îru±Sètus
;

1001 
	`c⁄figASSERT
–
pxQueue
 );

1002 
	`c⁄figASSERT
–
pxTaskWokí
 );

1003 
	`c⁄figASSERT
–!––
pvBuf„r
 =
NULL
 ) && ( 
pxQueue
->
uxIãmSize
 !–
p‹tBASE_TYPE
 ) 0U ) ) );

1005 
uxSavedI¡îru±Sètus
 = 
	`p‹tSET_INTERRUPT_MASK_FROM_ISR
();

1008 if–
pxQueue
->
uxMesßgesWaôög
 > ( 
p‹tBASE_TYPE
 ) 0 )

1010 
	`åa˚QUEUE_RECEIVE_FROM_ISR
–
pxQueue
 );

1012 
	`¥vC›yD©aFromQueue
–
pxQueue
, 
pvBuf„r
 );

1013 --–
pxQueue
->
uxMesßgesWaôög
 );

1018 if–
pxQueue
->
xRxLock
 =
queueUNLOCKED
 )

1020 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdFALSE
 )

1022 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) !
pdFALSE
 )

1026 *
pxTaskWokí
 = 
pdTRUE
;

1034 ++–
pxQueue
->
xRxLock
 );

1037 
xRëu∫
 = 
pdPASS
;

1041 
xRëu∫
 = 
pdFAIL
;

1042 
	`åa˚QUEUE_RECEIVE_FROM_ISR_FAILED
–
pxQueue
 );

1045 
	`p‹tCLEAR_INTERRUPT_MASK_FROM_ISR
–
uxSavedI¡îru±Sètus
 );

1047  
xRëu∫
;

1048 
	}
}

1051 
p‹tBASE_TYPE
 
	$uxQueueMesßgesWaôög
–c⁄° 
xQueueH™dÀ
 
pxQueue
 )

1053 
p‹tBASE_TYPE
 
uxRëu∫
;

1055 
	`c⁄figASSERT
–
pxQueue
 );

1057 
	`èskENTER_CRITICAL
();

1058 
uxRëu∫
 = 
pxQueue
->
uxMesßgesWaôög
;

1059 
	`èskEXIT_CRITICAL
();

1061  
uxRëu∫
;

1062 
	}
}

1065 
p‹tBASE_TYPE
 
	$uxQueueMesßgesWaôögFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 )

1067 
p‹tBASE_TYPE
 
uxRëu∫
;

1069 
	`c⁄figASSERT
–
pxQueue
 );

1071 
uxRëu∫
 = 
pxQueue
->
uxMesßgesWaôög
;

1073  
uxRëu∫
;

1074 
	}
}

1077 
	$vQueueDñëe
–
xQueueH™dÀ
 
pxQueue
 )

1079 
	`c⁄figASSERT
–
pxQueue
 );

1081 
	`åa˚QUEUE_DELETE
–
pxQueue
 );

1082 
	`vQueueUƒegi°îQueue
–
pxQueue
 );

1083 
	`vP‹tFªe
–
pxQueue
->
pcHód
 );

1084 
	`vP‹tFªe
–
pxQueue
 );

1085 
	}
}

1088 
	$¥vC›yD©aToQueue
–
xQUEUE
 *
pxQueue
, c⁄° *
pvIãmToQueue
, 
p‹tBASE_TYPE
 
xPosôi⁄
 )

1090 if–
pxQueue
->
uxIãmSize
 =–
p‹tBASE_TYPE
 ) 0 )

1092 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

1094 if–
pxQueue
->
uxQueueTy≥
 =
queueQUEUE_IS_MUTEX
 )

1097 
	`vTaskPri‹ôyDisöhîô
––* ) 
pxQueue
->
pxMuãxHﬁdî
 );

1098 
pxQueue
->
pxMuãxHﬁdî
 = 
NULL
;

1103 if–
xPosôi⁄
 =
queueSEND_TO_BACK
 )

1105 
	`mem˝y
––* ) 
pxQueue
->
pcWrôeTo
, 
pvIãmToQueue
, ( ËpxQueue->
uxIãmSize
 );

1106 
pxQueue
->
pcWrôeTo
 +pxQueue->
uxIãmSize
;

1107 if–
pxQueue
->
pcWrôeTo
 >pxQueue->
pcTaû
 )

1109 
pxQueue
->
pcWrôeTo
 =ÖxQueue->
pcHód
;

1114 
	`mem˝y
––* ) 
pxQueue
->
pcRódFrom
, 
pvIãmToQueue
, ( ËpxQueue->
uxIãmSize
 );

1115 
pxQueue
->
pcRódFrom
 -pxQueue->
uxIãmSize
;

1116 if–
pxQueue
->
pcRódFrom
 <ÖxQueue->
pcHód
 )

1118 
pxQueue
->
pcRódFrom
 = (ÖxQueue->
pcTaû
 -ÖxQueue->
uxIãmSize
 );

1122 ++–
pxQueue
->
uxMesßgesWaôög
 );

1123 
	}
}

1126 
	$¥vC›yD©aFromQueue
–
xQUEUE
 * c⁄° 
pxQueue
, c⁄° *
pvBuf„r
 )

1128 if–
pxQueue
->
uxQueueTy≥
 !
queueQUEUE_IS_MUTEX
 )

1130 
pxQueue
->
pcRódFrom
 +pxQueue->
uxIãmSize
;

1131 if–
pxQueue
->
pcRódFrom
 >pxQueue->
pcTaû
 )

1133 
pxQueue
->
pcRódFrom
 =ÖxQueue->
pcHód
;

1135 
	`mem˝y
––* ) 
pvBuf„r
, ( * ) 
pxQueue
->
pcRódFrom
, ( ËpxQueue->
uxIãmSize
 );

1137 
	}
}

1140 
	$¥vU∆ockQueue
–
xQueueH™dÀ
 
pxQueue
 )

1148 
	`èskENTER_CRITICAL
();

1151  
pxQueue
->
xTxLock
 > 
queueLOCKED_UNMODIFIED
 )

1155 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

1159 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) !
pdFALSE
 )

1163 
	`vTaskMis£dYõld
();

1166 --–
pxQueue
->
xTxLock
 );

1174 
pxQueue
->
xTxLock
 = 
queueUNLOCKED
;

1176 
	`èskEXIT_CRITICAL
();

1179 
	`èskENTER_CRITICAL
();

1181  
pxQueue
->
xRxLock
 > 
queueLOCKED_UNMODIFIED
 )

1183 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdFALSE
 )

1185 if–
	`xTaskRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) !
pdFALSE
 )

1187 
	`vTaskMis£dYõld
();

1190 --–
pxQueue
->
xRxLock
 );

1198 
pxQueue
->
xRxLock
 = 
queueUNLOCKED
;

1200 
	`èskEXIT_CRITICAL
();

1201 
	}
}

1204 sig√d 
p‹tBASE_TYPE
 
	$¥vIsQueueEm±y
–c⁄° 
xQueueH™dÀ
 
pxQueue
 )

1206 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1208 
	`èskENTER_CRITICAL
();

1209 
xRëu∫
 = ( 
pxQueue
->
uxMesßgesWaôög
 =–
p‹tBASE_TYPE
 ) 0 );

1210 
	`èskEXIT_CRITICAL
();

1212  
xRëu∫
;

1213 
	}
}

1216 sig√d 
p‹tBASE_TYPE
 
	$xQueueIsQueueEm±yFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 )

1218 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1220 
	`c⁄figASSERT
–
pxQueue
 );

1221 
xRëu∫
 = ( 
pxQueue
->
uxMesßgesWaôög
 =–
p‹tBASE_TYPE
 ) 0 );

1223  
xRëu∫
;

1224 
	}
}

1227 sig√d 
p‹tBASE_TYPE
 
	$¥vIsQueueFuŒ
–c⁄° 
xQueueH™dÀ
 
pxQueue
 )

1229 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1231 
	`èskENTER_CRITICAL
();

1232 
xRëu∫
 = ( 
pxQueue
->
uxMesßgesWaôög
 =pxQueue->
uxLígth
 );

1233 
	`èskEXIT_CRITICAL
();

1235  
xRëu∫
;

1236 
	}
}

1239 sig√d 
p‹tBASE_TYPE
 
	$xQueueIsQueueFuŒFromISR
–c⁄° 
xQueueH™dÀ
 
pxQueue
 )

1241 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1243 
	`c⁄figASSERT
–
pxQueue
 );

1244 
xRëu∫
 = ( 
pxQueue
->
uxMesßgesWaôög
 =pxQueue->
uxLígth
 );

1246  
xRëu∫
;

1247 
	}
}

1250 #i‡
c⁄figUSE_CO_ROUTINES
 == 1

1251 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRSíd
–
xQueueH™dÀ
 
pxQueue
, c⁄° *
pvIãmToQueue
, 
p‹tTickTy≥
 
xTicksToWaô
 )

1253 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1258 
	`p‹tDISABLE_INTERRUPTS
();

1260 if–
	`¥vIsQueueFuŒ
–
pxQueue
 ) !
pdFALSE
 )

1264 if–
xTicksToWaô
 > ( 
p‹tTickTy≥
 ) 0 )

1268 
	`vCoRoutöeAddToDñayedLi°
–
xTicksToWaô
, &–
pxQueue
->
xTasksWaôögToSíd
 ) );

1269 
	`p‹tENABLE_INTERRUPTS
();

1270  
îrQUEUE_BLOCKED
;

1274 
	`p‹tENABLE_INTERRUPTS
();

1275  
îrQUEUE_FULL
;

1279 
	`p‹tENABLE_INTERRUPTS
();

1281 
	`p‹tNOP
();

1283 
	`p‹tDISABLE_INTERRUPTS
();

1285 if–
pxQueue
->
uxMesßgesWaôög
 <ÖxQueue->
uxLígth
 )

1288 
	`¥vC›yD©aToQueue
–
pxQueue
, 
pvIãmToQueue
, 
queueSEND_TO_BACK
 );

1289 
xRëu∫
 = 
pdPASS
;

1292 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

1298 if–
	`xCoRoutöeRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) !
pdFALSE
 )

1302 
xRëu∫
 = 
îrQUEUE_YIELD
;

1308 
xRëu∫
 = 
îrQUEUE_FULL
;

1311 
	`p‹tENABLE_INTERRUPTS
();

1313  
xRëu∫
;

1314 
	}
}

1318 #i‡
c⁄figUSE_CO_ROUTINES
 == 1

1319 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRRe˚ive
–
xQueueH™dÀ
 
pxQueue
, *
pvBuf„r
, 
p‹tTickTy≥
 
xTicksToWaô
 )

1321 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1326 
	`p‹tDISABLE_INTERRUPTS
();

1328 if–
pxQueue
->
uxMesßgesWaôög
 =–
p‹tBASE_TYPE
 ) 0 )

1332 if–
xTicksToWaô
 > ( 
p‹tTickTy≥
 ) 0 )

1336 
	`vCoRoutöeAddToDñayedLi°
–
xTicksToWaô
, &–
pxQueue
->
xTasksWaôögToRe˚ive
 ) );

1337 
	`p‹tENABLE_INTERRUPTS
();

1338  
îrQUEUE_BLOCKED
;

1342 
	`p‹tENABLE_INTERRUPTS
();

1343  
îrQUEUE_FULL
;

1347 
	`p‹tENABLE_INTERRUPTS
();

1349 
	`p‹tNOP
();

1351 
	`p‹tDISABLE_INTERRUPTS
();

1353 if–
pxQueue
->
uxMesßgesWaôög
 > ( 
p‹tBASE_TYPE
 ) 0 )

1356 
pxQueue
->
pcRódFrom
 +pxQueue->
uxIãmSize
;

1357 if–
pxQueue
->
pcRódFrom
 >pxQueue->
pcTaû
 )

1359 
pxQueue
->
pcRódFrom
 =ÖxQueue->
pcHód
;

1361 --–
pxQueue
->
uxMesßgesWaôög
 );

1362 
	`mem˝y
––* ) 
pvBuf„r
, ( * ) 
pxQueue
->
pcRódFrom
, ( ËpxQueue->
uxIãmSize
 );

1364 
xRëu∫
 = 
pdPASS
;

1367 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdFALSE
 )

1373 if–
	`xCoRoutöeRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) !
pdFALSE
 )

1375 
xRëu∫
 = 
îrQUEUE_YIELD
;

1381 
xRëu∫
 = 
pdFAIL
;

1384 
	`p‹tENABLE_INTERRUPTS
();

1386  
xRëu∫
;

1387 
	}
}

1393 #i‡
c⁄figUSE_CO_ROUTINES
 == 1

1394 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRSídFromISR
–
xQueueH™dÀ
 
pxQueue
, c⁄° *
pvIãmToQueue
, sig√d 
p‹tBASE_TYPE
 
xCoRoutöePªviou¶yWokí
 )

1398 if–
pxQueue
->
uxMesßgesWaôög
 <ÖxQueue->
uxLígth
 )

1400 
	`¥vC›yD©aToQueue
–
pxQueue
, 
pvIãmToQueue
, 
queueSEND_TO_BACK
 );

1404 if–
xCoRoutöePªviou¶yWokí
 =
pdFALSE
 )

1406 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) =
pdFALSE
 )

1408 if–
	`xCoRoutöeRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ) ) !
pdFALSE
 )

1410  
pdTRUE
;

1416  
xCoRoutöePªviou¶yWokí
;

1417 
	}
}

1421 #i‡
c⁄figUSE_CO_ROUTINES
 == 1

1422 sig√d 
p‹tBASE_TYPE
 
	$xQueueCRRe˚iveFromISR
–
xQueueH™dÀ
 
pxQueue
, *
pvBuf„r
, sig√d 
p‹tBASE_TYPE
 *
pxCoRoutöeWokí
 )

1424 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

1428 if–
pxQueue
->
uxMesßgesWaôög
 > ( 
p‹tBASE_TYPE
 ) 0 )

1431 
pxQueue
->
pcRódFrom
 +pxQueue->
uxIãmSize
;

1432 if–
pxQueue
->
pcRódFrom
 >pxQueue->
pcTaû
 )

1434 
pxQueue
->
pcRódFrom
 =ÖxQueue->
pcHód
;

1436 --–
pxQueue
->
uxMesßgesWaôög
 );

1437 
	`mem˝y
––* ) 
pvBuf„r
, ( * ) 
pxQueue
->
pcRódFrom
, ( ËpxQueue->
uxIãmSize
 );

1439 if––*
pxCoRoutöeWokí
 ) =
pdFALSE
 )

1441 if–
	`li°LIST_IS_EMPTY
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) =
pdFALSE
 )

1443 if–
	`xCoRoutöeRemoveFromEvítLi°
–&–
pxQueue
->
xTasksWaôögToSíd
 ) ) !
pdFALSE
 )

1445 *
pxCoRoutöeWokí
 = 
pdTRUE
;

1450 
xRëu∫
 = 
pdPASS
;

1454 
xRëu∫
 = 
pdFAIL
;

1457  
xRëu∫
;

1458 
	}
}

1462 #i‡
c⁄figQUEUE_REGISTRY_SIZE
 > 0

1464 
	$vQueueAddToRegi°ry
–
xQueueH™dÀ
 
xQueue
, sig√d *
pcQueueName
 )

1466 
p‹tBASE_TYPE
 
ux
;

1470  
ux
 = ( 
p‹tBASE_TYPE
 ) 0U; ux < ( p‹tBASE_TYPE ) 
c⁄figQUEUE_REGISTRY_SIZE
; ux++ )

1472 if–
xQueueRegi°ry
[ 
ux
 ].
pcQueueName
 =
NULL
 )

1475 
xQueueRegi°ry
[ 
ux
 ].
pcQueueName
 =ÖcQueueName;

1476 
xQueueRegi°ry
[ 
ux
 ].
xH™dÀ
 = 
xQueue
;

1480 
	}
}

1485 #i‡
c⁄figQUEUE_REGISTRY_SIZE
 > 0

1487 
	$vQueueUƒegi°îQueue
–
xQueueH™dÀ
 
xQueue
 )

1489 
p‹tBASE_TYPE
 
ux
;

1493  
ux
 = ( 
p‹tBASE_TYPE
 ) 0U; ux < ( p‹tBASE_TYPE ) 
c⁄figQUEUE_REGISTRY_SIZE
; ux++ )

1495 if–
xQueueRegi°ry
[ 
ux
 ].
xH™dÀ
 =
xQueue
 )

1498 
xQueueRegi°ry
[ 
ux
 ].
pcQueueName
 = 
NULL
;

1503 
	}
}

1508 #i‡
c⁄figUSE_TIMERS
 == 1

1510 
	$vQueueWaôF‹MesßgeRe°ri˘ed
–
xQueueH™dÀ
 
pxQueue
, 
p‹tTickTy≥
 
xTicksToWaô
 )

1526 
	`¥vLockQueue
–
pxQueue
 );

1527 if–
pxQueue
->
uxMesßgesWaôög
 =–
p‹tBASE_TYPE
 ) 0U )

1530 
	`vTaskPœ˚OnEvítLi°Re°ri˘ed
–&–
pxQueue
->
xTasksWaôögToRe˚ive
 ), 
xTicksToWaô
 );

1532 
	`¥vU∆ockQueue
–
pxQueue
 );

1533 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\tasks.c

55 
	~<°dio.h
>

56 
	~<°dlib.h
>

57 
	~<°rög.h
>

62 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

64 
	~"FªeRTOS.h
"

65 
	~"èsk.h
"

66 
	~"timîs.h
"

67 
	~"SèckMa¸os.h
"

69 #unde‡
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


74 
	#tskIDLE_STACK_SIZE
 
c⁄figMINIMAL_STACK_SIZE


	)

80 
	stskTaskC⁄åﬁBlock


82 vﬁ©ûê
p‹tSTACK_TYPE
 *
	mpxT›OfSèck
;

84 #i‡–
p‹tUSING_MPU_WRAPPERS
 == 1 )

85 
xMPU_SETTINGS
 
	mxMPUSëtögs
;

88 
xLi°Iãm
 
	mxGíîicLi°Iãm
;

89 
xLi°Iãm
 
	mxEvítLi°Iãm
;

90 
p‹tBASE_TYPE
 
	muxPri‹ôy
;

91 
p‹tSTACK_TYPE
 *
	mpxSèck
;

92 sig√d 
	mpcTaskName
[ 
c⁄figMAX_TASK_NAME_LEN
 ];

94 #i‡–
p‹tSTACK_GROWTH
 > 0 )

95 
p‹tSTACK_TYPE
 *
	mpxEndOfSèck
;

98 #i‡–
p‹tCRITICAL_NESTING_IN_TCB
 == 1 )

99 
p‹tBASE_TYPE
 
	muxCrôiˇlNe°ög
;

102 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

103 
p‹tBASE_TYPE
 
	muxTCBNumbî
;

106 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

107 
p‹tBASE_TYPE
 
	muxBa£Pri‹ôy
;

110 #i‡–
c⁄figUSE_APPLICATION_TASK_TAG
 == 1 )

111 
pdTASK_HOOK_CODE
 
	mpxTaskTag
;

114 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

115 
	mulRunTimeCou¡î
;

118 } 
	ttskTCB
;

125 #ifde‡
p‹tREMOVE_STATIC_QUALIFIER


126 

	)

130 
PRIVILEGED_DATA
 
tskTCB
 * vﬁ©ûê
	gpxCuºítTCB
 = 
NULL
;

134 
PRIVILEGED_DATA
 
xLi°
 
	gpxRódyTasksLi°s
[ 
c⁄figMAX_PRIORITIES
 ];

135 
PRIVILEGED_DATA
 
xLi°
 
	gxDñayedTaskLi°1
;

136 
PRIVILEGED_DATA
 
xLi°
 
	gxDñayedTaskLi°2
;

137 
PRIVILEGED_DATA
 
xLi°
 * vﬁ©ûê
	gpxDñayedTaskLi°
 ;

138 
PRIVILEGED_DATA
 
xLi°
 * vﬁ©ûê
	gpxOvîÊowDñayedTaskLi°
;

139 
PRIVILEGED_DATA
 
xLi°
 
	gxPídögRódyLi°
;

141 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

143 
PRIVILEGED_DATA
 
xLi°
 
	gxTasksWaôögTîmö©i⁄
;

144 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	guxTasksDñëed
 = ( portBASE_TYPE ) 0U;

148 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

150 
PRIVILEGED_DATA
 
xLi°
 
	gxSu•ídedTaskLi°
;

154 #i‡–
INCLUDE_xTaskGëIdÀTaskH™dÀ
 == 1 )

156 
PRIVILEGED_DATA
 
xTaskH™dÀ
 
	gxIdÀTaskH™dÀ
 = 
NULL
;

161 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	guxCuºítNumbîOfTasks
 = ( portBASE_TYPE ) 0U;

162 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tTickTy≥
 
	gxTickCou¡
 = (ÖortTickType ) 0U;

163 
PRIVILEGED_DATA
 
p‹tBASE_TYPE
 
	guxT›U£dPri‹ôy
 = 
tskIDLE_PRIORITY
;

164 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	guxT›RódyPri‹ôy
 = 
tskIDLE_PRIORITY
;

165 
PRIVILEGED_DATA
 vﬁ©ûêsig√d 
p‹tBASE_TYPE
 
	gxScheduÀrRu¬ög
 = 
pdFALSE
;

166 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	guxScheduÀrSu•íded
 = ( p‹tBASE_TYPE ) 
pdFALSE
;

167 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	guxMis£dTicks
 = ( portBASE_TYPE ) 0U;

168 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	gxMis£dYõld
 = (Ö‹tBASE_TYPE ) 
pdFALSE
;

169 
PRIVILEGED_DATA
 vﬁ©ûê
p‹tBASE_TYPE
 
	gxNumOfOvîÊows
 = (ÖortBASE_TYPE ) 0;

170 
PRIVILEGED_DATA
 
p‹tBASE_TYPE
 
	guxTaskNumbî
 = ( portBASE_TYPE ) 0U;

171 
PRIVILEGED_DATA
 
p‹tTickTy≥
 
	gxNextTaskUnblockTime
 = (Ö‹tTickTy≥ ) 
p‹tMAX_DELAY
;

173 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

175 
PRIVILEGED_DATA
 
	gpcSètsSåög
[ 50 ] ;

176 
PRIVILEGED_DATA
 
	gulTaskSwôchedInTime
 = 0UL;

177 
	$¥vGíî©eRunTimeSètsF‹TasksInLi°
–c⁄° sig√d *
pcWrôeBuf„r
, 
xLi°
 *
pxLi°
, 
ulTŸÆRunTime
 ) 
PRIVILEGED_FUNCTION
;

187 
	#tskSTACK_FILL_BYTE
 ( 0xa5U )

	)

192 
	#tskBLOCKED_CHAR
 ( ( sig√d Ë'B' )

	)

193 
	#tskREADY_CHAR
 ( ( sig√d Ë'R' )

	)

194 
	#tskDELETED_CHAR
 ( ( sig√d Ë'D' )

	)

195 
	#tskSUSPENDED_CHAR
 ( ( sig√d Ë'S' )

	)

200 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

202 
	#tskSIZE_OF_EACH_TRACE_LINE
 ( ( Ë––Ë+ –ËË)

	)

203 
PRIVILEGED_DATA
 vﬁ©ûêsig√d * vﬁ©ûê
pcTø˚Buf„r
;

204 
PRIVILEGED_DATA
 sig√d *
pcTø˚Buf„rSèπ
;

205 
PRIVILEGED_DATA
 sig√d *
pcTø˚Buf„rEnd
;

206 
PRIVILEGED_DATA
 sig√d 
p‹tBASE_TYPE
 
xTøcög
 = 
pdFALSE
;

207 
p‹tBASE_TYPE
 
uxPªviousTask
 = 255U;

208 
PRIVILEGED_DATA
 
pcSètusSåög
[ 50 ];

220 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

222 
	#vWrôeTø˚ToBuf„r
() \

224 if–
xTøcög
 !
pdFALSE
 ) \

226 if–
uxPªviousTask
 !
pxCuºítTCB
->
uxTCBNumbî
 ) \

228 if––
pcTø˚Buf„r
 + 
tskSIZE_OF_EACH_TRACE_LINE
 ) < 
pcTø˚Buf„rEnd
 ) \

230 
uxPªviousTask
 = 
pxCuºítTCB
->
uxTCBNumbî
; \

231 *–* ) 
pcTø˚Buf„r
 = ( Ë
xTickCou¡
; \

232 
pcTø˚Buf„r
 += ( ); \

233 *–* ) 
pcTø˚Buf„r
 = ( Ë
uxPªviousTask
; \

234 
pcTø˚Buf„r
 += ( ); \

238 
xTøcög
 = 
pdFALSE
; \

242 
	}

	)
}

246 
	#vWrôeTø˚ToBuf„r
()

	)

258 
	#¥vAddTaskToRódyQueue
–
pxTCB
 ) \

259 if––
pxTCB
 )->
uxPri‹ôy
 > 
uxT›RódyPri‹ôy
 ) \

261 
uxT›RódyPri‹ôy
 = ( 
pxTCB
 )->
uxPri‹ôy
; \

263 
	`vLi°In£πEnd
––
xLi°
 * ) &–
pxRódyTasksLi°s
[ ( 
pxTCB
 )->
uxPri‹ôy
 ] ), &––pxTCB )->
xGíîicLi°Iãm
 ) )

	)

274 
	#¥vCheckDñayedTasks
() \

276 
p‹tTickTy≥
 
xIãmVÆue
; \

280 if–
xTickCou¡
 >
xNextTaskUnblockTime
 ) \

284 if–
	`li°LIST_IS_EMPTY
–
pxDñayedTaskLi°
 ) !
pdFALSE
 ) \

290 
xNextTaskUnblockTime
 = 
p‹tMAX_DELAY
; \

299 
pxTCB
 = ( 
tskTCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxDñayedTaskLi°
 ); \

300 
xIãmVÆue
 = 
	`li°GET_LIST_ITEM_VALUE
–&–
pxTCB
->
xGíîicLi°Iãm
 ) ); \

302 if–
xTickCou¡
 < 
xIãmVÆue
 ) \

308 
xNextTaskUnblockTime
 = 
xIãmVÆue
; \

313 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) ); \

316 if–
pxTCB
->
xEvítLi°Iãm
.
pvC⁄èöî
 !
NULL
 ) \

318 
	`vLi°Remove
–&–
pxTCB
->
xEvítLi°Iãm
 ) ); \

320 
	`¥vAddTaskToRódyQueue
–
pxTCB
 ); \

324 }

	)

333 
	#¥vGëTCBFromH™dÀ
–
pxH™dÀ
 ) ( ( (ÖxH™dÀ ) =
NULL
 ) ? ( 
tskTCB
 * ) 
pxCuºítTCB
 : (ÅskTCB * ) (ÖxH™dÀ ) )

	)

336 
vAµliˇti⁄SèckOvîÊowHook
–
xTaskH™dÀ
 *
pxTask
, sig√d *
pcTaskName
 );

337 
vAµliˇti⁄TickHook
( );

345 
	$¥vInôüli£TCBV¨übÀs
–
tskTCB
 *
pxTCB
, c⁄° sig√d * c⁄° 
pcName
, 
p‹tBASE_TYPE
 
uxPri‹ôy
, c⁄° 
xMem‹yRegi⁄
 * c⁄° 
xRegi⁄s
, 
usSèckDïth
 ) 
PRIVILEGED_FUNCTION
;

351 
	$¥vInôüli£TaskLi°s
–Ë
PRIVILEGED_FUNCTION
;

364 
	`p‹tTASK_FUNCTION_PROTO
–
¥vIdÀTask
, 
pvP¨amëîs
 );

373 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

375 
	$¥vDñëeTCB
–
tskTCB
 *
pxTCB
 ) 
PRIVILEGED_FUNCTION
;

384 
	$¥vCheckTasksWaôögTîmö©i⁄
–Ë
PRIVILEGED_FUNCTION
;

390 
	$¥vAddCuºítTaskToDñayedLi°
–
p‹tTickTy≥
 
xTimeToWake
 ) 
PRIVILEGED_FUNCTION
;

396 
tskTCB
 *
	$¥vAŒoˇãTCBAndSèck
–
usSèckDïth
, 
p‹tSTACK_TYPE
 *
puxSèckBuf„r
 ) 
PRIVILEGED_FUNCTION
;

407 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

409 
	$¥vLi°TaskWôhöSögÀLi°
–c⁄° sig√d *
pcWrôeBuf„r
, 
xLi°
 *
pxLi°
, sig√d 
cSètus
 ) 
PRIVILEGED_FUNCTION
;

418 #i‡––
c⁄figUSE_TRACE_FACILITY
 =1 ) || ( 
INCLUDE_uxTaskGëSèckHighW©îM¨k
 == 1 ) )

420 
	$usTaskCheckFªeSèckS∑˚
–c⁄° * 
pucSèckByã
 ) 
PRIVILEGED_FUNCTION
;

433 sig√d 
p‹tBASE_TYPE
 
	$xTaskGíîicCª©e
–
pdTASK_CODE
 
pxTaskCode
, c⁄° sig√d * c⁄° 
pcName
, 
usSèckDïth
, *
pvP¨amëîs
, 
p‹tBASE_TYPE
 
uxPri‹ôy
, 
xTaskH™dÀ
 *
pxCª©edTask
, 
p‹tSTACK_TYPE
 *
puxSèckBuf„r
, c⁄° 
xMem‹yRegi⁄
 * c⁄° 
xRegi⁄s
 )

435 sig√d 
p‹tBASE_TYPE
 
xRëu∫
;

436 
tskTCB
 * 
pxNewTCB
;

438 
	`c⁄figASSERT
–
pxTaskCode
 );

439 
	`c⁄figASSERT
––
uxPri‹ôy
 < 
c⁄figMAX_PRIORITIES
 ) );

443 
pxNewTCB
 = 
	`¥vAŒoˇãTCBAndSèck
–
usSèckDïth
, 
puxSèckBuf„r
 );

445 if–
pxNewTCB
 !
NULL
 )

447 
p‹tSTACK_TYPE
 *
pxT›OfSèck
;

449 #if–
p‹tUSING_MPU_WRAPPERS
 == 1 )

451 
p‹tBASE_TYPE
 
xRunPrivûeged
;

452 if––
uxPri‹ôy
 & 
p‹tPRIVILEGE_BIT
 ) != 0U )

454 
xRunPrivûeged
 = 
pdTRUE
;

458 
xRunPrivûeged
 = 
pdFALSE
;

460 
uxPri‹ôy
 &~
p‹tPRIVILEGE_BIT
;

467 #if–
p‹tSTACK_GROWTH
 < 0 )

469 
pxT›OfSèck
 = 
pxNewTCB
->
pxSèck
 + ( 
usSèckDïth
 - ( ) 1 );

470 
pxT›OfSèck
 = ( 
p‹tSTACK_TYPE
 * ) ( ( ( 
p‹tPOINTER_SIZE_TYPE
 )ÖxT›OfSèck ) & ( (Ö‹tPOINTER_SIZE_TYPE ) ~
p‹tBYTE_ALIGNMENT_MASK
 ) );

473 
	`c⁄figASSERT
––––Ë
pxT›OfSèck
 & ( Ë
p‹tBYTE_ALIGNMENT_MASK
 ) == 0UL ) );

477 
pxT›OfSèck
 = 
pxNewTCB
->
pxSèck
;

480 
	`c⁄figASSERT
––––Ë
pxNewTCB
->
pxSèck
 & ( Ë
p‹tBYTE_ALIGNMENT_MASK
 ) == 0UL ) );

485 
pxNewTCB
->
pxEndOfSèck
 =ÖxNewTCB->
pxSèck
 + ( 
usSèckDïth
 - 1 );

490 
	`¥vInôüli£TCBV¨übÀs
–
pxNewTCB
, 
pcName
, 
uxPri‹ôy
, 
xRegi⁄s
, 
usSèckDïth
 );

496 #if–
p‹tUSING_MPU_WRAPPERS
 == 1 )

498 
pxNewTCB
->
pxT›OfSèck
 = 
	`pxP‹tInôüli£Sèck
–pxT›OfSèck, 
pxTaskCode
, 
pvP¨amëîs
, 
xRunPrivûeged
 );

502 
pxNewTCB
->
pxT›OfSèck
 = 
	`pxP‹tInôüli£Sèck
–pxT›OfSèck, 
pxTaskCode
, 
pvP¨amëîs
 );

507 
	`c⁄figASSERT
––––Ë
pxNewTCB
->
pxT›OfSèck
 & ( Ë
p‹tBYTE_ALIGNMENT_MASK
 ) == 0UL ) );

509 if––* ) 
pxCª©edTask
 !
NULL
 )

514 *
pxCª©edTask
 = ( 
xTaskH™dÀ
 ) 
pxNewTCB
;

519 
	`èskENTER_CRITICAL
();

521 
uxCuºítNumbîOfTasks
++;

522 if–
pxCuºítTCB
 =
NULL
 )

526 
pxCuºítTCB
 = 
pxNewTCB
;

528 if–
uxCuºítNumbîOfTasks
 =–
p‹tBASE_TYPE
 ) 1 )

533 
	`¥vInôüli£TaskLi°s
();

541 if–
xScheduÀrRu¬ög
 =
pdFALSE
 )

543 if–
pxCuºítTCB
->
uxPri‹ôy
 <= uxPriority )

545 
pxCuºítTCB
 = 
pxNewTCB
;

552 if–
pxNewTCB
->
uxPri‹ôy
 > 
uxT›U£dPri‹ôy
 )

554 
uxT›U£dPri‹ôy
 = 
pxNewTCB
->
uxPri‹ôy
;

557 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

560 
pxNewTCB
->
uxTCBNumbî
 = 
uxTaskNumbî
;

563 
uxTaskNumbî
++;

565 
	`¥vAddTaskToRódyQueue
–
pxNewTCB
 );

567 
xRëu∫
 = 
pdPASS
;

568 
	`åa˚TASK_CREATE
–
pxNewTCB
 );

570 
	`èskEXIT_CRITICAL
();

574 
xRëu∫
 = 
îrCOULD_NOT_ALLOCATE_REQUIRED_MEMORY
;

575 
	`åa˚TASK_CREATE_FAILED
();

578 if–
xRëu∫
 =
pdPASS
 )

580 if–
xScheduÀrRu¬ög
 !
pdFALSE
 )

584 if–
pxCuºítTCB
->
uxPri‹ôy
 < uxPriority )

586 
	`p‹tYIELD_WITHIN_API
();

591  
xRëu∫
;

592 
	}
}

595 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

597 
	$vTaskDñëe
–
xTaskH™dÀ
 
pxTaskToDñëe
 )

599 
tskTCB
 *
pxTCB
;

601 
	`èskENTER_CRITICAL
();

605 if–
pxTaskToDñëe
 =
pxCuºítTCB
 )

607 
pxTaskToDñëe
 = 
NULL
;

611 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
pxTaskToDñëe
 );

617 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

620 if–
pxTCB
->
xEvítLi°Iãm
.
pvC⁄èöî
 !
NULL
 )

622 
	`vLi°Remove
–&–
pxTCB
->
xEvítLi°Iãm
 ) );

625 
	`vLi°In£πEnd
––
xLi°
 * ) &
xTasksWaôögTîmö©i⁄
, &–
pxTCB
->
xGíîicLi°Iãm
 ) );

630 ++
uxTasksDñëed
;

634 
uxTaskNumbî
++;

636 
	`åa˚TASK_DELETE
–
pxTCB
 );

638 
	`èskEXIT_CRITICAL
();

641 if–
xScheduÀrRu¬ög
 !
pdFALSE
 )

643 if––* ) 
pxTaskToDñëe
 =
NULL
 )

645 
	`p‹tYIELD_WITHIN_API
();

648 
	}
}

661 #i‡–
INCLUDE_vTaskDñayU¡û
 == 1 )

663 
	$vTaskDñayU¡û
–
p‹tTickTy≥
 * c⁄° 
pxPªviousWakeTime
,Ö‹tTickTy≥ 
xTimeIn¸emít
 )

665 
p‹tTickTy≥
 
xTimeToWake
;

666 
p‹tBASE_TYPE
 
xAÃódyYõlded
, 
xShouldDñay
 = 
pdFALSE
;

668 
	`c⁄figASSERT
–
pxPªviousWakeTime
 );

669 
	`c⁄figASSERT
––
xTimeIn¸emít
 > 0U ) );

671 
	`vTaskSu•ídAŒ
();

674 
xTimeToWake
 = *
pxPªviousWakeTime
 + 
xTimeIn¸emít
;

676 if–
xTickCou¡
 < *
pxPªviousWakeTime
 )

683 if––
xTimeToWake
 < *
pxPªviousWakeTime
 ) && ( xTimeToWakê> 
xTickCou¡
 ) )

685 
xShouldDñay
 = 
pdTRUE
;

693 if––
xTimeToWake
 < *
pxPªviousWakeTime
 ) || ( xTimeToWakê> 
xTickCou¡
 ) )

695 
xShouldDñay
 = 
pdTRUE
;

700 *
pxPªviousWakeTime
 = 
xTimeToWake
;

702 if–
xShouldDñay
 !
pdFALSE
 )

704 
	`åa˚TASK_DELAY_UNTIL
();

709 
	`vLi°Remove
––
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

710 
	`¥vAddCuºítTaskToDñayedLi°
–
xTimeToWake
 );

713 
xAÃódyYõlded
 = 
	`xTaskResumeAŒ
();

717 if–
xAÃódyYõlded
 =
pdFALSE
 )

719 
	`p‹tYIELD_WITHIN_API
();

721 
	}
}

726 #i‡–
INCLUDE_vTaskDñay
 == 1 )

728 
	$vTaskDñay
–
p‹tTickTy≥
 
xTicksToDñay
 )

730 
p‹tTickTy≥
 
xTimeToWake
;

731 sig√d 
p‹tBASE_TYPE
 
xAÃódyYõlded
 = 
pdFALSE
;

734 if–
xTicksToDñay
 > ( 
p‹tTickTy≥
 ) 0U )

736 
	`vTaskSu•ídAŒ
();

738 
	`åa˚TASK_DELAY
();

750 
xTimeToWake
 = 
xTickCou¡
 + 
xTicksToDñay
;

755 
	`vLi°Remove
––
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

756 
	`¥vAddCuºítTaskToDñayedLi°
–
xTimeToWake
 );

758 
xAÃódyYõlded
 = 
	`xTaskResumeAŒ
();

763 if–
xAÃódyYõlded
 =
pdFALSE
 )

765 
	`p‹tYIELD_WITHIN_API
();

767 
	}
}

772 #i‡–
INCLUDE_uxTaskPri‹ôyGë
 == 1 )

774 
p‹tBASE_TYPE
 
	$uxTaskPri‹ôyGë
–
xTaskH™dÀ
 
pxTask
 )

776 
tskTCB
 *
pxTCB
;

777 
p‹tBASE_TYPE
 
uxRëu∫
;

779 
	`èskENTER_CRITICAL
();

783 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
pxTask
 );

784 
uxRëu∫
 = 
pxTCB
->
uxPri‹ôy
;

786 
	`èskEXIT_CRITICAL
();

788  
uxRëu∫
;

789 
	}
}

794 #i‡–
INCLUDE_vTaskPri‹ôySë
 == 1 )

796 
	$vTaskPri‹ôySë
–
xTaskH™dÀ
 
pxTask
, 
p‹tBASE_TYPE
 
uxNewPri‹ôy
 )

798 
tskTCB
 *
pxTCB
;

799 
p‹tBASE_TYPE
 
uxCuºítPri‹ôy
;

800 
p‹tBASE_TYPE
 
xYõldRequúed
 = 
pdFALSE
;

802 
	`c⁄figASSERT
––
uxNewPri‹ôy
 < 
c⁄figMAX_PRIORITIES
 ) );

805 if–
uxNewPri‹ôy
 >
c⁄figMAX_PRIORITIES
 )

807 
uxNewPri‹ôy
 = 
c⁄figMAX_PRIORITIES
 - ( 
p‹tBASE_TYPE
 ) 1U;

810 
	`èskENTER_CRITICAL
();

812 if–
pxTask
 =
pxCuºítTCB
 )

814 
pxTask
 = 
NULL
;

819 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
pxTask
 );

821 
	`åa˚TASK_PRIORITY_SET
–
pxTask
, 
uxNewPri‹ôy
 );

823 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

825 
uxCuºítPri‹ôy
 = 
pxTCB
->
uxBa£Pri‹ôy
;

829 
uxCuºítPri‹ôy
 = 
pxTCB
->
uxPri‹ôy
;

833 if–
uxCuºítPri‹ôy
 !
uxNewPri‹ôy
 )

837 if–
uxNewPri‹ôy
 > 
uxCuºítPri‹ôy
 )

839 if–
pxTask
 !
NULL
 )

845 
xYõldRequúed
 = 
pdTRUE
;

848 if–
pxTask
 =
NULL
 )

852 
xYõldRequúed
 = 
pdTRUE
;

857 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

861 if–
pxTCB
->
uxBa£Pri‹ôy
 =pxTCB->
uxPri‹ôy
 )

863 
pxTCB
->
uxPri‹ôy
 = 
uxNewPri‹ôy
;

867 
pxTCB
->
uxBa£Pri‹ôy
 = 
uxNewPri‹ôy
;

871 
pxTCB
->
uxPri‹ôy
 = 
uxNewPri‹ôy
;

875 
	`li°SET_LIST_ITEM_VALUE
–&–
pxTCB
->
xEvítLi°Iãm
 ), ( 
c⁄figMAX_PRIORITIES
 - ( 
p‹tTickTy≥
 ) 
uxNewPri‹ôy
 ) );

881 if–
	`li°IS_CONTAINED_WITHIN
–&–
pxRódyTasksLi°s
[ 
uxCuºítPri‹ôy
 ] ), &–
pxTCB
->
xGíîicLi°Iãm
 ) ) )

886 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

887 
	`¥vAddTaskToRódyQueue
–
pxTCB
 );

890 if–
xYõldRequúed
 =
pdTRUE
 )

892 
	`p‹tYIELD_WITHIN_API
();

896 
	`èskEXIT_CRITICAL
();

897 
	}
}

902 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

904 
	$vTaskSu•íd
–
xTaskH™dÀ
 
pxTaskToSu•íd
 )

906 
tskTCB
 *
pxTCB
;

908 
	`èskENTER_CRITICAL
();

912 if–
pxTaskToSu•íd
 =
pxCuºítTCB
 )

914 
pxTaskToSu•íd
 = 
NULL
;

918 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
pxTaskToSu•íd
 );

920 
	`åa˚TASK_SUSPEND
–
pxTCB
 );

923 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

926 if–
pxTCB
->
xEvítLi°Iãm
.
pvC⁄èöî
 !
NULL
 )

928 
	`vLi°Remove
–&–
pxTCB
->
xEvítLi°Iãm
 ) );

931 
	`vLi°In£πEnd
––
xLi°
 * ) &
xSu•ídedTaskLi°
, &–
pxTCB
->
xGíîicLi°Iãm
 ) );

933 
	`èskEXIT_CRITICAL
();

935 if––* ) 
pxTaskToSu•íd
 =
NULL
 )

937 if–
xScheduÀrRu¬ög
 !
pdFALSE
 )

940 
	`p‹tYIELD_WITHIN_API
();

947 if–
	`li°CURRENT_LIST_LENGTH
–&
xSu•ídedTaskLi°
 ) =
uxCuºítNumbîOfTasks
 )

953 
pxCuºítTCB
 = 
NULL
;

957 
	`vTaskSwôchC⁄ãxt
();

961 
	}
}

966 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

968 sig√d 
p‹tBASE_TYPE
 
	$xTaskIsTaskSu•íded
–
xTaskH™dÀ
 
xTask
 )

970 
p‹tBASE_TYPE
 
xRëu∫
 = 
pdFALSE
;

971 c⁄° 
tskTCB
 * c⁄° 
pxTCB
 = (ÅskTCB * ) 
xTask
;

974 
	`c⁄figASSERT
–
xTask
 );

978 if–
	`li°IS_CONTAINED_WITHIN
–&
xSu•ídedTaskLi°
, &–
pxTCB
->
xGíîicLi°Iãm
 ) ) !
pdFALSE
 )

981 if–
	`li°IS_CONTAINED_WITHIN
–&
xPídögRódyLi°
, &–
pxTCB
->
xEvítLi°Iãm
 ) ) !
pdTRUE
 )

987 if–
	`li°IS_CONTAINED_WITHIN
–
NULL
, &–
pxTCB
->
xEvítLi°Iãm
 ) ) =
pdTRUE
 )

989 
xRëu∫
 = 
pdTRUE
;

994  
xRëu∫
;

995 
	}
}

1000 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

1002 
	$vTaskResume
–
xTaskH™dÀ
 
pxTaskToResume
 )

1004 
tskTCB
 *
pxTCB
;

1007 
	`c⁄figASSERT
–
pxTaskToResume
 );

1011 
pxTCB
 = ( 
tskTCB
 * ) 
pxTaskToResume
;

1015 if––
pxTCB
 !
NULL
 ) && (ÖxTCB !
pxCuºítTCB
 ) )

1017 
	`èskENTER_CRITICAL
();

1019 if–
	`xTaskIsTaskSu•íded
–
pxTCB
 ) =
pdTRUE
 )

1021 
	`åa˚TASK_RESUME
–
pxTCB
 );

1025 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

1026 
	`¥vAddTaskToRódyQueue
–
pxTCB
 );

1029 if–
pxTCB
->
uxPri‹ôy
 >
pxCuºítTCB
->uxPriority )

1033 
	`p‹tYIELD_WITHIN_API
();

1037 
	`èskEXIT_CRITICAL
();

1039 
	}
}

1045 #i‡––
INCLUDE_xTaskResumeFromISR
 =1 ) && ( 
INCLUDE_vTaskSu•íd
 == 1 ) )

1047 
p‹tBASE_TYPE
 
	$xTaskResumeFromISR
–
xTaskH™dÀ
 
pxTaskToResume
 )

1049 
p‹tBASE_TYPE
 
xYõldRequúed
 = 
pdFALSE
;

1050 
tskTCB
 *
pxTCB
;

1052 
	`c⁄figASSERT
–
pxTaskToResume
 );

1054 
pxTCB
 = ( 
tskTCB
 * ) 
pxTaskToResume
;

1056 if–
	`xTaskIsTaskSu•íded
–
pxTCB
 ) =
pdTRUE
 )

1058 
	`åa˚TASK_RESUME_FROM_ISR
–
pxTCB
 );

1060 if–
uxScheduÀrSu•íded
 =–
p‹tBASE_TYPE
 ) 
pdFALSE
 )

1062 
xYõldRequúed
 = ( 
pxTCB
->
uxPri‹ôy
 >
pxCuºítTCB
->uxPriority );

1063 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

1064 
	`¥vAddTaskToRódyQueue
–
pxTCB
 );

1071 
	`vLi°In£πEnd
––
xLi°
 * ) &–
xPídögRódyLi°
 ), &–
pxTCB
->
xEvítLi°Iãm
 ) );

1075  
xYõldRequúed
;

1076 
	}
}

1088 
	$vTaskSèπScheduÀr
( )

1090 
p‹tBASE_TYPE
 
xRëu∫
;

1093 #i‡–
INCLUDE_xTaskGëIdÀTaskH™dÀ
 == 1 )

1097 
xRëu∫
 = 
	`xTaskCª©e
–
¥vIdÀTask
, ( sig√d * ) "IDLE", 
tskIDLE_STACK_SIZE
, ( * ) 
NULL
, ( 
tskIDLE_PRIORITY
 | 
p‹tPRIVILEGE_BIT
 ), &
xIdÀTaskH™dÀ
 );

1102 
xRëu∫
 = 
	`xTaskCª©e
–
¥vIdÀTask
, ( sig√d * ) "IDLE", 
tskIDLE_STACK_SIZE
, ( * ) 
NULL
, ( 
tskIDLE_PRIORITY
 | 
p‹tPRIVILEGE_BIT
 ), NULL );

1106 #i‡–
c⁄figUSE_TIMERS
 == 1 )

1108 if–
xRëu∫
 =
pdPASS
 )

1110 
xRëu∫
 = 
	`xTimîCª©eTimîTask
();

1115 if–
xRëu∫
 =
pdPASS
 )

1125 
	`p‹tDISABLE_INTERRUPTS
();

1127 
xScheduÀrRu¬ög
 = 
pdTRUE
;

1128 
xTickCou¡
 = ( 
p‹tTickTy≥
 ) 0U;

1133 
	`p‹tCONFIGURE_TIMER_FOR_RUN_TIME_STATS
();

1137 if–
	`xP‹tSèπScheduÀr
(Ë!
pdFALSE
 )

1149 
	`c⁄figASSERT
–
xRëu∫
 );

1150 
	}
}

1153 
	$vTaskEndScheduÀr
( )

1158 
	`p‹tDISABLE_INTERRUPTS
();

1159 
xScheduÀrRu¬ög
 = 
pdFALSE
;

1160 
	`vP‹tEndScheduÀr
();

1161 
	}
}

1164 
	$vTaskSu•ídAŒ
( )

1168 ++
uxScheduÀrSu•íded
;

1169 
	}
}

1172 sig√d 
p‹tBASE_TYPE
 
	$xTaskResumeAŒ
( )

1174 
tskTCB
 *
pxTCB
;

1175 sig√d 
p‹tBASE_TYPE
 
xAÃódyYõlded
 = 
pdFALSE
;

1179 
	`c⁄figASSERT
–
uxScheduÀrSu•íded
 );

1186 
	`èskENTER_CRITICAL
();

1188 --
uxScheduÀrSu•íded
;

1190 if–
uxScheduÀrSu•íded
 =–
p‹tBASE_TYPE
 ) 
pdFALSE
 )

1192 if–
uxCuºítNumbîOfTasks
 > ( 
p‹tBASE_TYPE
 ) 0U )

1194 
p‹tBASE_TYPE
 
xYõldRequúed
 = 
pdFALSE
;

1198  
	`li°LIST_IS_EMPTY
––
xLi°
 * ) &
xPídögRódyLi°
 ) =
pdFALSE
 )

1200 
pxTCB
 = ( 
tskTCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–––
xLi°
 * ) &
xPídögRódyLi°
 ) );

1201 
	`vLi°Remove
–&–
pxTCB
->
xEvítLi°Iãm
 ) );

1202 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

1203 
	`¥vAddTaskToRódyQueue
–
pxTCB
 );

1207 if–
pxTCB
->
uxPri‹ôy
 >
pxCuºítTCB
->uxPriority )

1209 
xYõldRequúed
 = 
pdTRUE
;

1216 if–
uxMis£dTicks
 > ( 
p‹tBASE_TYPE
 ) 0U )

1218  
uxMis£dTicks
 > ( 
p‹tBASE_TYPE
 ) 0U )

1220 
	`vTaskIn¸emítTick
();

1221 --
uxMis£dTicks
;

1227 #i‡
c⁄figUSE_PREEMPTION
 == 1

1229 
xYõldRequúed
 = 
pdTRUE
;

1234 if––
xYõldRequúed
 =
pdTRUE
 ) || ( 
xMis£dYõld
 ==ÖdTRUE ) )

1236 
xAÃódyYõlded
 = 
pdTRUE
;

1237 
xMis£dYõld
 = 
pdFALSE
;

1238 
	`p‹tYIELD_WITHIN_API
();

1243 
	`èskEXIT_CRITICAL
();

1245  
xAÃódyYõlded
;

1246 
	}
}

1259 
p‹tTickTy≥
 
	$xTaskGëTickCou¡
( )

1261 
p‹tTickTy≥
 
xTicks
;

1264 
	`èskENTER_CRITICAL
();

1266 
xTicks
 = 
xTickCou¡
;

1268 
	`èskEXIT_CRITICAL
();

1270  
xTicks
;

1271 
	}
}

1274 
p‹tTickTy≥
 
	$xTaskGëTickCou¡FromISR
( )

1276 
p‹tTickTy≥
 
xRëu∫
;

1277 
p‹tBASE_TYPE
 
uxSavedI¡îru±Sètus
;

1279 
uxSavedI¡îru±Sètus
 = 
	`p‹tSET_INTERRUPT_MASK_FROM_ISR
();

1280 
xRëu∫
 = 
xTickCou¡
;

1281 
	`p‹tCLEAR_INTERRUPT_MASK_FROM_ISR
–
uxSavedI¡îru±Sètus
 );

1283  
xRëu∫
;

1284 
	}
}

1287 
p‹tBASE_TYPE
 
	$uxTaskGëNumbîOfTasks
( )

1291  
uxCuºítNumbîOfTasks
;

1292 
	}
}

1295 #i‡–
INCLUDE_pcTaskGëTaskName
 == 1 )

1297 sig√d *
	$pcTaskGëTaskName
–
xTaskH™dÀ
 
xTaskToQuîy
 )

1299 
tskTCB
 *
pxTCB
;

1302 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
xTaskToQuîy
 );

1303 
	`c⁄figASSERT
–
pxTCB
 );

1304  &–
pxTCB
->
pcTaskName
[ 0 ] );

1305 
	}
}

1310 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

1312 
	$vTaskLi°
–sig√d *
pcWrôeBuf„r
 )

1314 
p‹tBASE_TYPE
 
uxQueue
;

1319 
	`vTaskSu•ídAŒ
();

1324 *
pcWrôeBuf„r
 = ( signed ) 0x00;

1325 
	`°rˇt
––* ) 
pcWrôeBuf„r
, ( const * ) "\r\n" );

1327 
uxQueue
 = 
uxT›U£dPri‹ôy
 + ( 
p‹tBASE_TYPE
 ) 1U;

1331 
uxQueue
--;

1333 if–
	`li°LIST_IS_EMPTY
–&–
pxRódyTasksLi°s
[ 
uxQueue
 ] ) ) =
pdFALSE
 )

1335 
	`¥vLi°TaskWôhöSögÀLi°
–
pcWrôeBuf„r
, ( 
xLi°
 * ) &–
pxRódyTasksLi°s
[ 
uxQueue
 ] ), 
tskREADY_CHAR
 );

1337 } 
uxQueue
 > ( Ë
tskIDLE_PRIORITY
 );

1339 if–
	`li°LIST_IS_EMPTY
–
pxDñayedTaskLi°
 ) =
pdFALSE
 )

1341 
	`¥vLi°TaskWôhöSögÀLi°
–
pcWrôeBuf„r
, ( 
xLi°
 * ) 
pxDñayedTaskLi°
, 
tskBLOCKED_CHAR
 );

1344 if–
	`li°LIST_IS_EMPTY
–
pxOvîÊowDñayedTaskLi°
 ) =
pdFALSE
 )

1346 
	`¥vLi°TaskWôhöSögÀLi°
–
pcWrôeBuf„r
, ( 
xLi°
 * ) 
pxOvîÊowDñayedTaskLi°
, 
tskBLOCKED_CHAR
 );

1349 #if–
INCLUDE_vTaskDñëe
 == 1 )

1351 if–
	`li°LIST_IS_EMPTY
–&
xTasksWaôögTîmö©i⁄
 ) =
pdFALSE
 )

1353 
	`¥vLi°TaskWôhöSögÀLi°
–
pcWrôeBuf„r
, &
xTasksWaôögTîmö©i⁄
, 
tskDELETED_CHAR
 );

1358 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

1360 if–
	`li°LIST_IS_EMPTY
–&
xSu•ídedTaskLi°
 ) =
pdFALSE
 )

1362 
	`¥vLi°TaskWôhöSögÀLi°
–
pcWrôeBuf„r
, &
xSu•ídedTaskLi°
, 
tskSUSPENDED_CHAR
 );

1364 
	}
}

1367 
xTaskResumeAŒ
();

1373 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

1375 
	$vTaskGëRunTimeSèts
–sig√d *
pcWrôeBuf„r
 )

1377 
p‹tBASE_TYPE
 
uxQueue
;

1378 
ulTŸÆRunTime
;

1383 
	`vTaskSu•ídAŒ
();

1385 #ifde‡
p‹tALT_GET_RUN_TIME_COUNTER_VALUE


1386 
	`p‹tALT_GET_RUN_TIME_COUNTER_VALUE
–
ulTŸÆRunTime
 );

1388 
ulTŸÆRunTime
 = 
	`p‹tGET_RUN_TIME_COUNTER_VALUE
();

1393 
ulTŸÆRunTime
 /= 100UL;

1399 *
pcWrôeBuf„r
 = ( signed ) 0x00;

1400 
	`°rˇt
––* ) 
pcWrôeBuf„r
, ( const * ) "\r\n" );

1402 
uxQueue
 = 
uxT›U£dPri‹ôy
 + ( 
p‹tBASE_TYPE
 ) 1U;

1406 
uxQueue
--;

1408 if–
	`li°LIST_IS_EMPTY
–&–
pxRódyTasksLi°s
[ 
uxQueue
 ] ) ) =
pdFALSE
 )

1410 
	`¥vGíî©eRunTimeSètsF‹TasksInLi°
–
pcWrôeBuf„r
, ( 
xLi°
 * ) &–
pxRódyTasksLi°s
[ 
uxQueue
 ] ), 
ulTŸÆRunTime
 );

1412 } 
uxQueue
 > ( Ë
tskIDLE_PRIORITY
 );

1414 if–
	`li°LIST_IS_EMPTY
–
pxDñayedTaskLi°
 ) =
pdFALSE
 )

1416 
	`¥vGíî©eRunTimeSètsF‹TasksInLi°
–
pcWrôeBuf„r
, ( 
xLi°
 * ) 
pxDñayedTaskLi°
, 
ulTŸÆRunTime
 );

1419 if–
	`li°LIST_IS_EMPTY
–
pxOvîÊowDñayedTaskLi°
 ) =
pdFALSE
 )

1421 
	`¥vGíî©eRunTimeSètsF‹TasksInLi°
–
pcWrôeBuf„r
, ( 
xLi°
 * ) 
pxOvîÊowDñayedTaskLi°
, 
ulTŸÆRunTime
 );

1424 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

1426 if–
	`li°LIST_IS_EMPTY
–&
xTasksWaôögTîmö©i⁄
 ) =
pdFALSE
 )

1428 
	`¥vGíî©eRunTimeSètsF‹TasksInLi°
–
pcWrôeBuf„r
, &
xTasksWaôögTîmö©i⁄
, 
ulTŸÆRunTime
 );

1433 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

1435 if–
	`li°LIST_IS_EMPTY
–&
xSu•ídedTaskLi°
 ) =
pdFALSE
 )

1437 
	`¥vGíî©eRunTimeSètsF‹TasksInLi°
–
pcWrôeBuf„r
, &
xSu•ídedTaskLi°
, 
ulTŸÆRunTime
 );

1442 
	`xTaskResumeAŒ
();

1443 
	}
}

1448 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

1450 
	$vTaskSèπTø˚
–sig√d * 
pcBuf„r
, 
ulBuf„rSize
 )

1452 
	`c⁄figASSERT
–
pcBuf„r
 );

1453 
	`c⁄figASSERT
–
ulBuf„rSize
 );

1455 
	`èskENTER_CRITICAL
();

1457 
pcTø˚Buf„r
 = ( sig√d * )
pcBuf„r
;

1458 
pcTø˚Buf„rSèπ
 = 
pcBuf„r
;

1459 
pcTø˚Buf„rEnd
 = 
pcBuf„r
 + ( 
ulBuf„rSize
 - 
tskSIZE_OF_EACH_TRACE_LINE
 );

1460 
xTøcög
 = 
pdTRUE
;

1462 
	`èskEXIT_CRITICAL
();

1463 
	}
}

1468 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

1470 
	$ulTaskEndTø˚
( )

1472 
ulBuf„rLígth
;

1474 
	`èskENTER_CRITICAL
();

1475 
xTøcög
 = 
pdFALSE
;

1476 
	`èskEXIT_CRITICAL
();

1478 
ulBuf„rLígth
 = ( Ë–
pcTø˚Buf„r
 - 
pcTø˚Buf„rSèπ
 );

1480  
ulBuf„rLígth
;

1481 
	}
}

1486 #i‡–
INCLUDE_xTaskGëIdÀTaskH™dÀ
 == 1 )

1488 
xTaskH™dÀ
 
	$xTaskGëIdÀTaskH™dÀ
( )

1492 
	`c⁄figASSERT
––
xIdÀTaskH™dÀ
 !
NULL
 ) );

1493  
xIdÀTaskH™dÀ
;

1494 
	}
}

1503 
	$vTaskIn¸emítTick
( )

1505 
tskTCB
 * 
pxTCB
;

1510 if–
uxScheduÀrSu•íded
 =–
p‹tBASE_TYPE
 ) 
pdFALSE
 )

1512 ++
xTickCou¡
;

1513 if–
xTickCou¡
 =–
p‹tTickTy≥
 ) 0U )

1515 
xLi°
 *
pxTemp
;

1520 
	`c⁄figASSERT
––
	`li°LIST_IS_EMPTY
–
pxDñayedTaskLi°
 ) ) );

1522 
pxTemp
 = 
pxDñayedTaskLi°
;

1523 
pxDñayedTaskLi°
 = 
pxOvîÊowDñayedTaskLi°
;

1524 
pxOvîÊowDñayedTaskLi°
 = 
pxTemp
;

1525 
xNumOfOvîÊows
++;

1527 if–
	`li°LIST_IS_EMPTY
–
pxDñayedTaskLi°
 ) !
pdFALSE
 )

1534 
xNextTaskUnblockTime
 = 
p‹tMAX_DELAY
;

1542 
pxTCB
 = ( 
tskTCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxDñayedTaskLi°
 );

1543 
xNextTaskUnblockTime
 = 
	`li°GET_LIST_ITEM_VALUE
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

1548 
	`¥vCheckDñayedTasks
();

1552 ++
uxMis£dTicks
;

1556 #i‡–
c⁄figUSE_TICK_HOOK
 == 1 )

1558 
	`vAµliˇti⁄TickHook
();

1563 #i‡–
c⁄figUSE_TICK_HOOK
 == 1 )

1567 if–
uxMis£dTicks
 =–
p‹tBASE_TYPE
 ) 0U )

1569 
	`vAµliˇti⁄TickHook
();

1574 
	`åa˚TASK_INCREMENT_TICK
–
xTickCou¡
 );

1575 
	}
}

1578 #i‡–
c⁄figUSE_APPLICATION_TASK_TAG
 == 1 )

1580 
	$vTaskSëAµliˇti⁄TaskTag
–
xTaskH™dÀ
 
xTask
, 
pdTASK_HOOK_CODE
 
pxHookFun˘i⁄
 )

1582 
tskTCB
 *
xTCB
;

1585 if–
xTask
 =
NULL
 )

1587 
xTCB
 = ( 
tskTCB
 * ) 
pxCuºítTCB
;

1591 
xTCB
 = ( 
tskTCB
 * ) 
xTask
;

1596 
	`èskENTER_CRITICAL
();

1597 
xTCB
->
pxTaskTag
 = 
pxHookFun˘i⁄
;

1598 
	`èskEXIT_CRITICAL
();

1599 
	}
}

1604 #i‡–
c⁄figUSE_APPLICATION_TASK_TAG
 == 1 )

1606 
pdTASK_HOOK_CODE
 
	$xTaskGëAµliˇti⁄TaskTag
–
xTaskH™dÀ
 
xTask
 )

1608 
tskTCB
 *
xTCB
;

1609 
pdTASK_HOOK_CODE
 
xRëu∫
;

1612 if–
xTask
 =
NULL
 )

1614 
xTCB
 = ( 
tskTCB
 * ) 
pxCuºítTCB
;

1618 
xTCB
 = ( 
tskTCB
 * ) 
xTask
;

1623 
	`èskENTER_CRITICAL
();

1624 
xRëu∫
 = 
xTCB
->
pxTaskTag
;

1625 
	`èskEXIT_CRITICAL
();

1627  
xRëu∫
;

1628 
	}
}

1633 #i‡–
c⁄figUSE_APPLICATION_TASK_TAG
 == 1 )

1635 
p‹tBASE_TYPE
 
	$xTaskCÆlAµliˇti⁄TaskHook
–
xTaskH™dÀ
 
xTask
, *
pvP¨amëî
 )

1637 
tskTCB
 *
xTCB
;

1638 
p‹tBASE_TYPE
 
xRëu∫
;

1641 if–
xTask
 =
NULL
 )

1643 
xTCB
 = ( 
tskTCB
 * ) 
pxCuºítTCB
;

1647 
xTCB
 = ( 
tskTCB
 * ) 
xTask
;

1650 if–
xTCB
->
pxTaskTag
 !
NULL
 )

1652 
xRëu∫
 = 
xTCB
->
	`pxTaskTag
–
pvP¨amëî
 );

1656 
xRëu∫
 = 
pdFAIL
;

1659  
xRëu∫
;

1660 
	}
}

1665 
	$vTaskSwôchC⁄ãxt
( )

1667 if–
uxScheduÀrSu•íded
 !–
p‹tBASE_TYPE
 ) 
pdFALSE
 )

1671 
xMis£dYõld
 = 
pdTRUE
;

1675 
	`åa˚TASK_SWITCHED_OUT
();

1677 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

1679 
ulTempCou¡î
;

1681 #ifde‡
p‹tALT_GET_RUN_TIME_COUNTER_VALUE


1682 
	`p‹tALT_GET_RUN_TIME_COUNTER_VALUE
–
ulTempCou¡î
 );

1684 
ulTempCou¡î
 = 
	`p‹tGET_RUN_TIME_COUNTER_VALUE
();

1692 
pxCuºítTCB
->
ulRunTimeCou¡î
 +–
ulTempCou¡î
 - 
ulTaskSwôchedInTime
 );

1693 
ulTaskSwôchedInTime
 = 
ulTempCou¡î
;

1697 
	`èskFIRST_CHECK_FOR_STACK_OVERFLOW
();

1698 
	`èskSECOND_CHECK_FOR_STACK_OVERFLOW
();

1701  
	`li°LIST_IS_EMPTY
–&–
pxRódyTasksLi°s
[ 
uxT›RódyPri‹ôy
 ] ) ) )

1703 
	`c⁄figASSERT
–
uxT›RódyPri‹ôy
 );

1704 --
uxT›RódyPri‹ôy
;

1709 
	`li°GET_OWNER_OF_NEXT_ENTRY
–
pxCuºítTCB
, &–
pxRódyTasksLi°s
[ 
uxT›RódyPri‹ôy
 ] ) );

1711 
	`åa˚TASK_SWITCHED_IN
();

1712 
	`vWrôeTø˚ToBuf„r
();

1714 
	}
}

1717 
	$vTaskPœ˚OnEvítLi°
–c⁄° 
xLi°
 * c⁄° 
pxEvítLi°
, 
p‹tTickTy≥
 
xTicksToWaô
 )

1719 
p‹tTickTy≥
 
xTimeToWake
;

1721 
	`c⁄figASSERT
–
pxEvítLi°
 );

1729 
	`vLi°In£π
––
xLi°
 * ) 
pxEvítLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xEvítLi°Iãm
 ) );

1734 
	`vLi°Remove
––
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

1737 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

1739 if–
xTicksToWaô
 =
p‹tMAX_DELAY
 )

1744 
	`vLi°In£πEnd
––
xLi°
 * ) &
xSu•ídedTaskLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

1750 
xTimeToWake
 = 
xTickCou¡
 + 
xTicksToWaô
;

1751 
	`¥vAddCuºítTaskToDñayedLi°
–
xTimeToWake
 );

1758 
xTimeToWake
 = 
xTickCou¡
 + 
xTicksToWaô
;

1759 
	`¥vAddCuºítTaskToDñayedLi°
–
xTimeToWake
 );

1762 
	}
}

1765 #i‡
c⁄figUSE_TIMERS
 == 1

1767 
	$vTaskPœ˚OnEvítLi°Re°ri˘ed
–c⁄° 
xLi°
 * c⁄° 
pxEvítLi°
, 
p‹tTickTy≥
 
xTicksToWaô
 )

1769 
p‹tTickTy≥
 
xTimeToWake
;

1771 
	`c⁄figASSERT
–
pxEvítLi°
 );

1783 
	`vLi°In£πEnd
––
xLi°
 * ) 
pxEvítLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xEvítLi°Iãm
 ) );

1788 
	`vLi°Remove
––
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

1792 
xTimeToWake
 = 
xTickCou¡
 + 
xTicksToWaô
;

1793 
	`¥vAddCuºítTaskToDñayedLi°
–
xTimeToWake
 );

1794 
	}
}

1799 sig√d 
p‹tBASE_TYPE
 
	$xTaskRemoveFromEvítLi°
–c⁄° 
xLi°
 * c⁄° 
pxEvítLi°
 )

1801 
tskTCB
 *
pxUnblockedTCB
;

1802 
p‹tBASE_TYPE
 
xRëu∫
;

1817 
pxUnblockedTCB
 = ( 
tskTCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxEvítLi°
 );

1818 
	`c⁄figASSERT
–
pxUnblockedTCB
 );

1819 
	`vLi°Remove
–&–
pxUnblockedTCB
->
xEvítLi°Iãm
 ) );

1821 if–
uxScheduÀrSu•íded
 =–
p‹tBASE_TYPE
 ) 
pdFALSE
 )

1823 
	`vLi°Remove
–&–
pxUnblockedTCB
->
xGíîicLi°Iãm
 ) );

1824 
	`¥vAddTaskToRódyQueue
–
pxUnblockedTCB
 );

1830 
	`vLi°In£πEnd
––
xLi°
 * ) &–
xPídögRódyLi°
 ), &–
pxUnblockedTCB
->
xEvítLi°Iãm
 ) );

1833 if–
pxUnblockedTCB
->
uxPri‹ôy
 >
pxCuºítTCB
->uxPriority )

1839 
xRëu∫
 = 
pdTRUE
;

1843 
xRëu∫
 = 
pdFALSE
;

1846  
xRëu∫
;

1847 
	}
}

1850 
	$vTaskSëTimeOutSèã
–
xTimeOutTy≥
 * c⁄° 
pxTimeOut
 )

1852 
	`c⁄figASSERT
–
pxTimeOut
 );

1853 
pxTimeOut
->
xOvîÊowCou¡
 = 
xNumOfOvîÊows
;

1854 
pxTimeOut
->
xTimeOnE¡îög
 = 
xTickCou¡
;

1855 
	}
}

1858 
p‹tBASE_TYPE
 
	$xTaskCheckF‹TimeOut
–
xTimeOutTy≥
 * c⁄° 
pxTimeOut
, 
p‹tTickTy≥
 * c⁄° 
pxTicksToWaô
 )

1860 
p‹tBASE_TYPE
 
xRëu∫
;

1862 
	`c⁄figASSERT
–
pxTimeOut
 );

1863 
	`c⁄figASSERT
–
pxTicksToWaô
 );

1865 
	`èskENTER_CRITICAL
();

1867 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

1871 if–*
pxTicksToWaô
 =
p‹tMAX_DELAY
 )

1873 
xRëu∫
 = 
pdFALSE
;

1878 if––
xNumOfOvîÊows
 !
pxTimeOut
->
xOvîÊowCou¡
 ) && ( ( 
p‹tTickTy≥
 ) 
xTickCou¡
 >–p‹tTickTy≥ )ÖxTimeOut->
xTimeOnE¡îög
 ) )

1884 
xRëu∫
 = 
pdTRUE
;

1886 if–––
p‹tTickTy≥
 ) ( (Ö‹tTickTy≥ ) 
xTickCou¡
 - (Ö‹tTickTy≥ ) 
pxTimeOut
->
xTimeOnE¡îög
 ) ) < (Ö‹tTickTy≥ ) *
pxTicksToWaô
 )

1889 *
pxTicksToWaô
 -––
p‹tTickTy≥
 ) 
xTickCou¡
 - (Ö‹tTickTy≥ ) 
pxTimeOut
->
xTimeOnE¡îög
 );

1890 
	`vTaskSëTimeOutSèã
–
pxTimeOut
 );

1891 
xRëu∫
 = 
pdFALSE
;

1895 
xRëu∫
 = 
pdTRUE
;

1898 
	`èskEXIT_CRITICAL
();

1900  
xRëu∫
;

1901 
	}
}

1904 
	$vTaskMis£dYõld
( )

1906 
xMis£dYõld
 = 
pdTRUE
;

1907 
	}
}

1920 
	$p‹tTASK_FUNCTION
–
¥vIdÀTask
, 
pvP¨amëîs
 )

1923 –Ë
pvP¨amëîs
;

1928 
	`¥vCheckTasksWaôögTîmö©i⁄
();

1930 #i‡–
c⁄figUSE_PREEMPTION
 == 0 )

1936 
	`èskYIELD
();

1940 #i‡––
c⁄figUSE_PREEMPTION
 =1 ) && ( 
c⁄figIDLE_SHOULD_YIELD
 == 1 ) )

1951 if–
	`li°CURRENT_LIST_LENGTH
–&–
pxRódyTasksLi°s
[ 
tskIDLE_PRIORITY
 ] ) ) > ( 
p‹tBASE_TYPE
 ) 1 )

1953 
	`èskYIELD
();

1958 #i‡–
c⁄figUSE_IDLE_HOOK
 == 1 )

1960 
	`vAµliˇti⁄IdÀHook
( );

1967 
	`vAµliˇti⁄IdÀHook
();

1971 
	}
}

1985 
	$¥vInôüli£TCBV¨übÀs
–
tskTCB
 *
pxTCB
, c⁄° sig√d * c⁄° 
pcName
, 
p‹tBASE_TYPE
 
uxPri‹ôy
, c⁄° 
xMem‹yRegi⁄
 * c⁄° 
xRegi⁄s
, 
usSèckDïth
 )

1988 #i‡
c⁄figMAX_TASK_NAME_LEN
 > 1

1991 
	`°∫˝y
––* ) 
pxTCB
->
pcTaskName
, ( c⁄° * ) 
pcName
, ( Ë
c⁄figMAX_TASK_NAME_LEN
 );

1994 
pxTCB
->
pcTaskName
[ ( Ë
c⁄figMAX_TASK_NAME_LEN
 - ( ) 1 ] = ( signed ) '\0';

1998 if–
uxPri‹ôy
 >
c⁄figMAX_PRIORITIES
 )

2000 
uxPri‹ôy
 = 
c⁄figMAX_PRIORITIES
 - ( 
p‹tBASE_TYPE
 ) 1U;

2003 
pxTCB
->
uxPri‹ôy
 = uxPriority;

2004 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

2006 
pxTCB
->
uxBa£Pri‹ôy
 = 
uxPri‹ôy
;

2010 
	`vLi°Inôüli£Iãm
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

2011 
	`vLi°Inôüli£Iãm
–&–
pxTCB
->
xEvítLi°Iãm
 ) );

2015 
	`li°SET_LIST_ITEM_OWNER
–&–
pxTCB
->
xGíîicLi°Iãm
 ),ÖxTCB );

2018 
	`li°SET_LIST_ITEM_VALUE
–&–
pxTCB
->
xEvítLi°Iãm
 ), 
c⁄figMAX_PRIORITIES
 - ( 
p‹tTickTy≥
 ) 
uxPri‹ôy
 );

2019 
	`li°SET_LIST_ITEM_OWNER
–&–
pxTCB
->
xEvítLi°Iãm
 ),ÖxTCB );

2021 #i‡–
p‹tCRITICAL_NESTING_IN_TCB
 == 1 )

2023 
pxTCB
->
uxCrôiˇlNe°ög
 = ( 
p‹tBASE_TYPE
 ) 0U;

2027 #i‡–
c⁄figUSE_APPLICATION_TASK_TAG
 == 1 )

2029 
pxTCB
->
pxTaskTag
 = 
NULL
;

2033 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

2035 
pxTCB
->
ulRunTimeCou¡î
 = 0UL;

2039 #i‡–
p‹tUSING_MPU_WRAPPERS
 == 1 )

2041 
	`vP‹tSt‹eTaskMPUSëtögs
–&–
pxTCB
->
xMPUSëtögs
 ), 
xRegi⁄s
,ÖxTCB->
pxSèck
, 
usSèckDïth
 );

2045 –Ë
xRegi⁄s
;

2046 –Ë
usSèckDïth
;

2049 
	}
}

2052 #i‡–
p‹tUSING_MPU_WRAPPERS
 == 1 )

2054 
	$vTaskAŒoˇãMPURegi⁄s
–
xTaskH™dÀ
 
xTaskToModify
, c⁄° 
xMem‹yRegi⁄
 * c⁄° 
xRegi⁄s
 )

2056 
tskTCB
 *
pxTCB
;

2058 if–
xTaskToModify
 =
pxCuºítTCB
 )

2060 
xTaskToModify
 = 
NULL
;

2064 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
xTaskToModify
 );

2066 
	`vP‹tSt‹eTaskMPUSëtögs
–&–
pxTCB
->
xMPUSëtögs
 ), 
xRegi⁄s
, 
NULL
, 0 );

2067 
	}
}

2071 
	$¥vInôüli£TaskLi°s
( )

2073 
p‹tBASE_TYPE
 
uxPri‹ôy
;

2075  
uxPri‹ôy
 = ( 
p‹tBASE_TYPE
 ) 0U; uxPri‹ôy < 
c⁄figMAX_PRIORITIES
; uxPriority++ )

2077 
	`vLi°Inôüli£
––
xLi°
 * ) &–
pxRódyTasksLi°s
[ 
uxPri‹ôy
 ] ) );

2080 
	`vLi°Inôüli£
––
xLi°
 * ) &
xDñayedTaskLi°1
 );

2081 
	`vLi°Inôüli£
––
xLi°
 * ) &
xDñayedTaskLi°2
 );

2082 
	`vLi°Inôüli£
––
xLi°
 * ) &
xPídögRódyLi°
 );

2084 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

2086 
	`vLi°Inôüli£
––
xLi°
 * ) &
xTasksWaôögTîmö©i⁄
 );

2090 #i‡–
INCLUDE_vTaskSu•íd
 == 1 )

2092 
	`vLi°Inôüli£
––
xLi°
 * ) &
xSu•ídedTaskLi°
 );

2098 
pxDñayedTaskLi°
 = &
xDñayedTaskLi°1
;

2099 
pxOvîÊowDñayedTaskLi°
 = &
xDñayedTaskLi°2
;

2100 
	}
}

2103 
	$¥vCheckTasksWaôögTîmö©i⁄
( )

2105 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

2107 
p‹tBASE_TYPE
 
xLi°IsEm±y
;

2111 if–
uxTasksDñëed
 > ( 
p‹tBASE_TYPE
 ) 0U )

2113 
	`vTaskSu•ídAŒ
();

2114 
xLi°IsEm±y
 = 
	`li°LIST_IS_EMPTY
–&
xTasksWaôögTîmö©i⁄
 );

2115 
	`xTaskResumeAŒ
();

2117 if–
xLi°IsEm±y
 =
pdFALSE
 )

2119 
tskTCB
 *
pxTCB
;

2121 
	`èskENTER_CRITICAL
();

2123 
pxTCB
 = ( 
tskTCB
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–––
xLi°
 * ) &
xTasksWaôögTîmö©i⁄
 ) );

2124 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

2125 --
uxCuºítNumbîOfTasks
;

2126 --
uxTasksDñëed
;

2128 
	`èskEXIT_CRITICAL
();

2130 
	`¥vDñëeTCB
–
pxTCB
 );

2135 
	}
}

2138 
	$¥vAddCuºítTaskToDñayedLi°
–
p‹tTickTy≥
 
xTimeToWake
 )

2141 
	`li°SET_LIST_ITEM_VALUE
–&–
pxCuºítTCB
->
xGíîicLi°Iãm
 ), 
xTimeToWake
 );

2143 if–
xTimeToWake
 < 
xTickCou¡
 )

2146 
	`vLi°In£π
––
xLi°
 * ) 
pxOvîÊowDñayedTaskLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

2151 
	`vLi°In£π
––
xLi°
 * ) 
pxDñayedTaskLi°
, ( 
xLi°Iãm
 * ) &–
pxCuºítTCB
->
xGíîicLi°Iãm
 ) );

2156 if–
xTimeToWake
 < 
xNextTaskUnblockTime
 )

2158 
xNextTaskUnblockTime
 = 
xTimeToWake
;

2161 
	}
}

2164 
tskTCB
 *
	$¥vAŒoˇãTCBAndSèck
–
usSèckDïth
, 
p‹tSTACK_TYPE
 *
puxSèckBuf„r
 )

2166 
tskTCB
 *
pxNewTCB
;

2170 
pxNewTCB
 = ( 
tskTCB
 * ) 
	`pvP‹tMÆloc
( (ÅskTCB ) );

2172 if–
pxNewTCB
 !
NULL
 )

2177 
pxNewTCB
->
pxSèck
 = ( 
p‹tSTACK_TYPE
 * ) 
	`pvP‹tMÆlocAlig√d
––––
size_t
 )
usSèckDïth
 ) * –p‹tSTACK_TYPE ) ), 
puxSèckBuf„r
 );

2179 if–
pxNewTCB
->
pxSèck
 =
NULL
 )

2182 
	`vP‹tFªe
–
pxNewTCB
 );

2183 
pxNewTCB
 = 
NULL
;

2188 
	`mem£t
–
pxNewTCB
->
pxSèck
, ( Ë
tskSTACK_FILL_BYTE
, ( 
size_t
 ) 
usSèckDïth
 * –
p‹tSTACK_TYPE
 ) );

2192  
pxNewTCB
;

2193 
	}
}

2196 #i‡–
c⁄figUSE_TRACE_FACILITY
 == 1 )

2198 
	$¥vLi°TaskWôhöSögÀLi°
–c⁄° sig√d *
pcWrôeBuf„r
, 
xLi°
 *
pxLi°
, sig√d 
cSètus
 )

2200 vﬁ©ûê
tskTCB
 *
pxNextTCB
, *
pxFú°TCB
;

2201 
usSèckRemaöög
;

2204 
	`li°GET_OWNER_OF_NEXT_ENTRY
–
pxFú°TCB
, 
pxLi°
 );

2207 
	`li°GET_OWNER_OF_NEXT_ENTRY
–
pxNextTCB
, 
pxLi°
 );

2208 #i‡–
p‹tSTACK_GROWTH
 > 0 )

2210 
usSèckRemaöög
 = 
	`usTaskCheckFªeSèckS∑˚
––* ) 
pxNextTCB
->
pxEndOfSèck
 );

2214 
usSèckRemaöög
 = 
	`usTaskCheckFªeSèckS∑˚
––* ) 
pxNextTCB
->
pxSèck
 );

2218 
	`•rötf
–
pcSètusSåög
, ( * ) "%s\t\t%c\t%u\t%u\t%u\r\n", 
pxNextTCB
->
pcTaskName
, 
cSètus
, ( ËpxNextTCB->
uxPri‹ôy
, 
usSèckRemaöög
, ( ËpxNextTCB->
uxTCBNumbî
 );

2219 
	`°rˇt
––* ) 
pcWrôeBuf„r
, ( * ) 
pcSètusSåög
 );

2221 }  
pxNextTCB
 !
pxFú°TCB
 );

2222 
	}
}

2227 #i‡–
c⁄figGENERATE_RUN_TIME_STATS
 == 1 )

2229 
	$¥vGíî©eRunTimeSètsF‹TasksInLi°
–c⁄° sig√d *
pcWrôeBuf„r
, 
xLi°
 *
pxLi°
, 
ulTŸÆRunTime
 )

2231 vﬁ©ûê
tskTCB
 *
pxNextTCB
, *
pxFú°TCB
;

2232 
ulSètsAsPî˚¡age
;

2235 
	`li°GET_OWNER_OF_NEXT_ENTRY
–
pxFú°TCB
, 
pxLi°
 );

2239 
	`li°GET_OWNER_OF_NEXT_ENTRY
–
pxNextTCB
, 
pxLi°
 );

2242 if–
ulTŸÆRunTime
 > 0UL )

2245 if–
pxNextTCB
->
ulRunTimeCou¡î
 == 0UL )

2248 
	`•rötf
–
pcSètsSåög
, ( * ) "%s\t\t0\t\t0%%\r\n", 
pxNextTCB
->
pcTaskName
 );

2255 
ulSètsAsPî˚¡age
 = 
pxNextTCB
->
ulRunTimeCou¡î
 / 
ulTŸÆRunTime
;

2257 if–
ulSètsAsPî˚¡age
 > 0UL )

2259 #ifde‡
p‹tLU_PRINTF_SPECIFIER_REQUIRED


2261 
	`•rötf
–
pcSètsSåög
, ( * ) "%s\t\t%lu\t\t%lu%%\r\n", 
pxNextTCB
->
pcTaskName
,ÖxNextTCB->
ulRunTimeCou¡î
, 
ulSètsAsPî˚¡age
 );

2267 
	`•rötf
–
pcSètsSåög
, ( * ) "%s\t\t%u\t\t%u%%\r\n", 
pxNextTCB
->
pcTaskName
, ( ËpxNextTCB->
ulRunTimeCou¡î
, ( Ë
ulSètsAsPî˚¡age
 );

2275 #ifde‡
p‹tLU_PRINTF_SPECIFIER_REQUIRED


2277 
	`•rötf
–
pcSètsSåög
, ( * ) "%s\t\t%lu\t\t<1%%\r\n", 
pxNextTCB
->
pcTaskName
,ÖxNextTCB->
ulRunTimeCou¡î
 );

2283 
	`•rötf
–
pcSètsSåög
, ( * ) "%s\t\t%u\t\t<1%%\r\n", 
pxNextTCB
->
pcTaskName
, ( ËpxNextTCB->
ulRunTimeCou¡î
 );

2289 
	`°rˇt
––* ) 
pcWrôeBuf„r
, ( * ) 
pcSètsSåög
 );

2292 }  
pxNextTCB
 !
pxFú°TCB
 );

2293 
	}
}

2298 #i‡––
c⁄figUSE_TRACE_FACILITY
 =1 ) || ( 
INCLUDE_uxTaskGëSèckHighW©îM¨k
 == 1 ) )

2300 
	$usTaskCheckFªeSèckS∑˚
–c⁄° * 
pucSèckByã
 )

2302 
usCou¡
 = 0U;

2304  *
pucSèckByã
 =
tskSTACK_FILL_BYTE
 )

2306 
pucSèckByã
 -
p‹tSTACK_GROWTH
;

2307 
usCou¡
++;

2310 
usCou¡
 /–
p‹tSTACK_TYPE
 );

2312  
usCou¡
;

2313 
	}
}

2318 #i‡–
INCLUDE_uxTaskGëSèckHighW©îM¨k
 == 1 )

2320 
p‹tBASE_TYPE
 
	$uxTaskGëSèckHighW©îM¨k
–
xTaskH™dÀ
 
xTask
 )

2322 
tskTCB
 *
pxTCB
;

2323 *
pcEndOfSèck
;

2324 
p‹tBASE_TYPE
 
uxRëu∫
;

2326 
pxTCB
 = 
	`¥vGëTCBFromH™dÀ
–
xTask
 );

2328 #i‡
p‹tSTACK_GROWTH
 < 0

2330 
pcEndOfSèck
 = ( * ) 
pxTCB
->
pxSèck
;

2334 
pcEndOfSèck
 = ( * ) 
pxTCB
->
pxEndOfSèck
;

2338 
uxRëu∫
 = ( 
p‹tBASE_TYPE
 ) 
	`usTaskCheckFªeSèckS∑˚
–
pcEndOfSèck
 );

2340  
uxRëu∫
;

2341 
	}
}

2346 #i‡–
INCLUDE_vTaskDñëe
 == 1 )

2348 
	$¥vDñëeTCB
–
tskTCB
 *
pxTCB
 )

2352 
	`vP‹tFªeAlig√d
–
pxTCB
->
pxSèck
 );

2353 
	`vP‹tFªe
–
pxTCB
 );

2354 
	}
}

2361 #i‡––
INCLUDE_xTaskGëCuºítTaskH™dÀ
 =1 ) || ( 
c⁄figUSE_MUTEXES
 == 1 ) )

2363 
xTaskH™dÀ
 
	$xTaskGëCuºítTaskH™dÀ
( )

2365 
xTaskH™dÀ
 
xRëu∫
;

2370 
xRëu∫
 = 
pxCuºítTCB
;

2372  
xRëu∫
;

2373 
	}
}

2379 #i‡––
INCLUDE_xTaskGëScheduÀrSèã
 =1 ) || ( 
c⁄figUSE_TIMERS
 == 1 ) )

2381 
p‹tBASE_TYPE
 
	$xTaskGëScheduÀrSèã
( )

2383 
p‹tBASE_TYPE
 
xRëu∫
;

2385 if–
xScheduÀrRu¬ög
 =
pdFALSE
 )

2387 
xRëu∫
 = 
èskSCHEDULER_NOT_STARTED
;

2391 if–
uxScheduÀrSu•íded
 =–
p‹tBASE_TYPE
 ) 
pdFALSE
 )

2393 
xRëu∫
 = 
èskSCHEDULER_RUNNING
;

2397 
xRëu∫
 = 
èskSCHEDULER_SUSPENDED
;

2401  
xRëu∫
;

2402 
	}
}

2407 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

2409 
	$vTaskPri‹ôyInhîô
–
xTaskH™dÀ
 * c⁄° 
pxMuãxHﬁdî
 )

2411 
tskTCB
 * c⁄° 
pxTCB
 = (ÅskTCB * ) 
pxMuãxHﬁdî
;

2413 
	`c⁄figASSERT
–
pxMuãxHﬁdî
 );

2415 if–
pxTCB
->
uxPri‹ôy
 < 
pxCuºítTCB
->uxPriority )

2418 
	`li°SET_LIST_ITEM_VALUE
–&–
pxTCB
->
xEvítLi°Iãm
 ), 
c⁄figMAX_PRIORITIES
 - ( 
p‹tTickTy≥
 ) 
pxCuºítTCB
->
uxPri‹ôy
 );

2422 if–
	`li°IS_CONTAINED_WITHIN
–&–
pxRódyTasksLi°s
[ 
pxTCB
->
uxPri‹ôy
 ] ), &–pxTCB->
xGíîicLi°Iãm
 ) ) !
pdFALSE
 )

2424 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

2427 
pxTCB
->
uxPri‹ôy
 = 
pxCuºítTCB
->uxPriority;

2428 
	`¥vAddTaskToRódyQueue
–
pxTCB
 );

2433 
pxTCB
->
uxPri‹ôy
 = 
pxCuºítTCB
->uxPriority;

2436 
	}
}

2441 #i‡–
c⁄figUSE_MUTEXES
 == 1 )

2443 
	$vTaskPri‹ôyDisöhîô
–
xTaskH™dÀ
 * c⁄° 
pxMuãxHﬁdî
 )

2445 
tskTCB
 * c⁄° 
pxTCB
 = (ÅskTCB * ) 
pxMuãxHﬁdî
;

2447 if–
pxMuãxHﬁdî
 !
NULL
 )

2449 if–
pxTCB
->
uxPri‹ôy
 !pxTCB->
uxBa£Pri‹ôy
 )

2453 
	`vLi°Remove
–&–
pxTCB
->
xGíîicLi°Iãm
 ) );

2457 
pxTCB
->
uxPri‹ôy
 =ÖxTCB->
uxBa£Pri‹ôy
;

2458 
	`li°SET_LIST_ITEM_VALUE
–&–
pxTCB
->
xEvítLi°Iãm
 ), 
c⁄figMAX_PRIORITIES
 - ( 
p‹tTickTy≥
 )ÖxTCB->
uxPri‹ôy
 );

2459 
	`¥vAddTaskToRódyQueue
–
pxTCB
 );

2462 
	}
}

2467 #i‡–
p‹tCRITICAL_NESTING_IN_TCB
 == 1 )

2469 
	$vTaskE¡îCrôiˇl
( )

2471 
	`p‹tDISABLE_INTERRUPTS
();

2473 if–
xScheduÀrRu¬ög
 !
pdFALSE
 )

2475 –
pxCuºítTCB
->
uxCrôiˇlNe°ög
 )++;

2477 
	}
}

2482 #i‡–
p‹tCRITICAL_NESTING_IN_TCB
 == 1 )

2484 
	$vTaskExôCrôiˇl
( )

2486 if–
xScheduÀrRu¬ög
 !
pdFALSE
 )

2488 if–
pxCuºítTCB
->
uxCrôiˇlNe°ög
 > 0U )

2490 –
pxCuºítTCB
->
uxCrôiˇlNe°ög
 )--;

2492 if–
pxCuºítTCB
->
uxCrôiˇlNe°ög
 == 0U )

2494 
	`p‹tENABLE_INTERRUPTS
();

2498 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\FreeRTOS\timers.c

57 
	#MPU_WRAPPERS_INCLUDED_FROM_API_FILE


	)

59 
	~"FªeRTOS.h
"

60 
	~"èsk.h
"

61 
	~"queue.h
"

62 
	~"timîs.h
"

64 #unde‡
MPU_WRAPPERS_INCLUDED_FROM_API_FILE


70 #i‡–
c⁄figUSE_TIMERS
 == 1 )

73 
	#tmrNO_DELAY
 ( 
p‹tTickTy≥
 ) 0U

	)

76 
	stmrTimîC⁄åﬁ


78 c⁄° sig√d *
	mpcTimîName
;

79 
xLi°Iãm
 
	mxTimîLi°Iãm
;

80 
p‹tTickTy≥
 
	mxTimîPîiodInTicks
;

81 
p‹tBASE_TYPE
 
	muxAutoRñﬂd
;

82 *
	mpvTimîID
;

83 
tmrTIMER_CALLBACK
 
	mpxCÆlbackFun˘i⁄
;

84 } 
	txTIMER
;

88 
	stmrTimîQueueMesßge


90 
p‹tBASE_TYPE
 
	mxMesßgeID
;

91 
p‹tTickTy≥
 
	mxMesßgeVÆue
;

92 
xTIMER
 * 
	mpxTimî
;

93 } 
	txTIMER_MESSAGE
;

99 
PRIVILEGED_DATA
 
xLi°
 
	gxA˘iveTimîLi°1
;

100 
PRIVILEGED_DATA
 
xLi°
 
	gxA˘iveTimîLi°2
;

101 
PRIVILEGED_DATA
 
xLi°
 *
	gpxCuºítTimîLi°
;

102 
PRIVILEGED_DATA
 
xLi°
 *
	gpxOvîÊowTimîLi°
;

105 
PRIVILEGED_DATA
 
xQueueH™dÀ
 
	gxTimîQueue
 = 
NULL
;

107 #i‡–
INCLUDE_xTimîGëTimîD´m⁄TaskH™dÀ
 == 1 )

109 
PRIVILEGED_DATA
 
xTaskH™dÀ
 
	gxTimîTaskH™dÀ
 = 
NULL
;

119 
	$¥vCheckF‹VÆidLi°AndQueue
–Ë
PRIVILEGED_FUNCTION
;

126 
	$¥vTimîTask
–*
pvP¨amëîs
 ) 
PRIVILEGED_FUNCTION
;

132 
	$¥vPro˚ssRe˚ivedComm™ds
–Ë
PRIVILEGED_FUNCTION
;

138 
p‹tBASE_TYPE
 
	$¥vIn£πTimîInA˘iveLi°
–
xTIMER
 *
pxTimî
, 
p‹tTickTy≥
 
xNextExpúyTime
,Ö‹tTickTy≥ 
xTimeNow
,Ö‹tTickTy≥ 
xComm™dTime
 ) 
PRIVILEGED_FUNCTION
;

144 
	$¥vPro˚ssExpúedTimî
–
p‹tTickTy≥
 
xNextExpúeTime
,Ö‹tTickTy≥ 
xTimeNow
 ) 
PRIVILEGED_FUNCTION
;

150 
	$¥vSwôchTimîLi°s
–
p‹tTickTy≥
 
xLa°Time
 ) 
PRIVILEGED_FUNCTION
;

156 
p‹tTickTy≥
 
	$¥vSam∂eTimeNow
–
p‹tBASE_TYPE
 *
pxTimîLi°sWîeSwôched
 ) 
PRIVILEGED_FUNCTION
;

164 
p‹tTickTy≥
 
	$¥vGëNextExpúeTime
–
p‹tBASE_TYPE
 *
pxLi°WasEm±y
 ) 
PRIVILEGED_FUNCTION
;

170 
	$¥vPro˚ssTimîOrBlockTask
–
p‹tTickTy≥
 
xNextExpúeTime
, 
p‹tBASE_TYPE
 
xLi°WasEm±y
 ) 
PRIVILEGED_FUNCTION
;

174 
p‹tBASE_TYPE
 
	$xTimîCª©eTimîTask
( )

176 
p‹tBASE_TYPE
 
xRëu∫
 = 
pdFAIL
;

182 
	`¥vCheckF‹VÆidLi°AndQueue
();

184 if–
xTimîQueue
 !
NULL
 )

186 #i‡–
INCLUDE_xTimîGëTimîD´m⁄TaskH™dÀ
 == 1 )

190 
xRëu∫
 = 
	`xTaskCª©e
–
¥vTimîTask
, ( c⁄° sig√d * ) "Tm∏Svc", ( Ë
c⁄figTIMER_TASK_STACK_DEPTH
, 
NULL
, ( 
p‹tBASE_TYPE
 ) 
c⁄figTIMER_TASK_PRIORITY
, &
xTimîTaskH™dÀ
 );

195 
xRëu∫
 = 
	`xTaskCª©e
–
¥vTimîTask
, ( c⁄° sig√d * ) "Tm∏Svc", ( Ë
c⁄figTIMER_TASK_STACK_DEPTH
, 
NULL
, ( 
p‹tBASE_TYPE
 ) 
c⁄figTIMER_TASK_PRIORITY
, NULL);

200 
	`c⁄figASSERT
–
xRëu∫
 );

201  
xRëu∫
;

202 
	}
}

205 
xTimîH™dÀ
 
	$xTimîCª©e
–c⁄° sig√d *
pcTimîName
, 
p‹tTickTy≥
 
xTimîPîiodInTicks
, 
p‹tBASE_TYPE
 
uxAutoRñﬂd
, *
pvTimîID
, 
tmrTIMER_CALLBACK
 
pxCÆlbackFun˘i⁄
 )

207 
xTIMER
 *
pxNewTimî
;

210 if–
xTimîPîiodInTicks
 =–
p‹tTickTy≥
 ) 0U )

212 
pxNewTimî
 = 
NULL
;

213 
	`c⁄figASSERT
––
xTimîPîiodInTicks
 > 0 ) );

217 
pxNewTimî
 = ( 
xTIMER
 * ) 
	`pvP‹tMÆloc
( ( xTIMER ) );

218 if–
pxNewTimî
 !
NULL
 )

222 
	`¥vCheckF‹VÆidLi°AndQueue
();

225 
pxNewTimî
->
pcTimîName
 =ÖcTimerName;

226 
pxNewTimî
->
xTimîPîiodInTicks
 = xTimerPeriodInTicks;

227 
pxNewTimî
->
uxAutoRñﬂd
 = uxAutoReload;

228 
pxNewTimî
->
pvTimîID
 =ÖvTimerID;

229 
pxNewTimî
->
pxCÆlbackFun˘i⁄
 =ÖxCallbackFunction;

230 
	`vLi°Inôüli£Iãm
–&–
pxNewTimî
->
xTimîLi°Iãm
 ) );

232 
	`åa˚TIMER_CREATE
–
pxNewTimî
 );

236 
	`åa˚TIMER_CREATE_FAILED
();

240  ( 
xTimîH™dÀ
 ) 
pxNewTimî
;

241 
	}
}

244 
p‹tBASE_TYPE
 
	$xTimîGíîicComm™d
–
xTimîH™dÀ
 
xTimî
, 
p‹tBASE_TYPE
 
xComm™dID
, 
p‹tTickTy≥
 
xO±i⁄ÆVÆue
,Ö‹tBASE_TYPE *
pxHighîPri‹ôyTaskWokí
,Ö‹tTickTy≥ 
xBlockTime
 )

246 
p‹tBASE_TYPE
 
xRëu∫
 = 
pdFAIL
;

247 
xTIMER_MESSAGE
 
xMesßge
;

251 if–
xTimîQueue
 !
NULL
 )

254 
xMesßge
.
xMesßgeID
 = 
xComm™dID
;

255 
xMesßge
.
xMesßgeVÆue
 = 
xO±i⁄ÆVÆue
;

256 
xMesßge
.
pxTimî
 = ( 
xTIMER
 * ) 
xTimî
;

258 if–
pxHighîPri‹ôyTaskWokí
 =
NULL
 )

260 if–
	`xTaskGëScheduÀrSèã
(Ë=
èskSCHEDULER_RUNNING
 )

262 
xRëu∫
 = 
	`xQueueSídToBack
–
xTimîQueue
, &
xMesßge
, 
xBlockTime
 );

266 
xRëu∫
 = 
	`xQueueSídToBack
–
xTimîQueue
, &
xMesßge
, 
tmrNO_DELAY
 );

271 
xRëu∫
 = 
	`xQueueSídToBackFromISR
–
xTimîQueue
, &
xMesßge
, 
pxHighîPri‹ôyTaskWokí
 );

274 
	`åa˚TIMER_COMMAND_SEND
–
xTimî
, 
xComm™dID
, 
xO±i⁄ÆVÆue
, 
xRëu∫
 );

277  
xRëu∫
;

278 
	}
}

281 #i‡–
INCLUDE_xTimîGëTimîD´m⁄TaskH™dÀ
 == 1 )

283 
xTaskH™dÀ
 
	$xTimîGëTimîD´m⁄TaskH™dÀ
( )

287 
	`c⁄figASSERT
––
xTimîTaskH™dÀ
 !
NULL
 ) );

288  
xTimîTaskH™dÀ
;

289 
	}
}

294 
	$¥vPro˚ssExpúedTimî
–
p‹tTickTy≥
 
xNextExpúeTime
,Ö‹tTickTy≥ 
xTimeNow
 )

296 
xTIMER
 *
pxTimî
;

297 
p‹tBASE_TYPE
 
xResu…
;

301 
pxTimî
 = ( 
xTIMER
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxCuºítTimîLi°
 );

302 
	`vLi°Remove
–&–
pxTimî
->
xTimîLi°Iãm
 ) );

303 
	`åa˚TIMER_EXPIRED
–
pxTimî
 );

307 if–
pxTimî
->
uxAutoRñﬂd
 =–
p‹tBASE_TYPE
 ) 
pdTRUE
 )

315 if–
	`¥vIn£πTimîInA˘iveLi°
–
pxTimî
, ( 
xNextExpúeTime
 +ÖxTimî->
xTimîPîiodInTicks
 ), 
xTimeNow
, xNextExpúeTimêË=
pdTRUE
 )

319 
xResu…
 = 
	`xTimîGíîicComm™d
–
pxTimî
, 
tmrCOMMAND_START
, 
xNextExpúeTime
, 
NULL
, 
tmrNO_DELAY
 );

320 
	`c⁄figASSERT
–
xResu…
 );

321 –Ë
xResu…
;

326 
pxTimî
->
	`pxCÆlbackFun˘i⁄
––
xTimîH™dÀ
 )ÖxTimer );

327 
	}
}

330 
	$¥vTimîTask
–*
pvP¨amëîs
 )

332 
p‹tTickTy≥
 
xNextExpúeTime
;

333 
p‹tBASE_TYPE
 
xLi°WasEm±y
;

336 –Ë
pvP¨amëîs
;

342 
xNextExpúeTime
 = 
	`¥vGëNextExpúeTime
–&
xLi°WasEm±y
 );

346 
	`¥vPro˚ssTimîOrBlockTask
–
xNextExpúeTime
, 
xLi°WasEm±y
 );

349 
	`¥vPro˚ssRe˚ivedComm™ds
();

351 
	}
}

354 
	$¥vPro˚ssTimîOrBlockTask
–
p‹tTickTy≥
 
xNextExpúeTime
, 
p‹tBASE_TYPE
 
xLi°WasEm±y
 )

356 
p‹tTickTy≥
 
xTimeNow
;

357 
p‹tBASE_TYPE
 
xTimîLi°sWîeSwôched
;

359 
	`vTaskSu•ídAŒ
();

366 
xTimeNow
 = 
	`¥vSam∂eTimeNow
–&
xTimîLi°sWîeSwôched
 );

367 if–
xTimîLi°sWîeSwôched
 =
pdFALSE
 )

370 if––
xLi°WasEm±y
 =
pdFALSE
 ) && ( 
xNextExpúeTime
 <
xTimeNow
 ) )

372 
	`xTaskResumeAŒ
();

373 
	`¥vPro˚ssExpúedTimî
–
xNextExpúeTime
, 
xTimeNow
 );

383 
	`vQueueWaôF‹MesßgeRe°ri˘ed
–
xTimîQueue
, ( 
xNextExpúeTime
 - 
xTimeNow
 ) );

385 if–
	`xTaskResumeAŒ
(Ë=
pdFALSE
 )

391 
	`p‹tYIELD_WITHIN_API
();

397 
	`xTaskResumeAŒ
();

400 
	}
}

403 
p‹tTickTy≥
 
	$¥vGëNextExpúeTime
–
p‹tBASE_TYPE
 *
pxLi°WasEm±y
 )

405 
p‹tTickTy≥
 
xNextExpúeTime
;

414 *
pxLi°WasEm±y
 = 
	`li°LIST_IS_EMPTY
–
pxCuºítTimîLi°
 );

415 if–*
pxLi°WasEm±y
 =
pdFALSE
 )

417 
xNextExpúeTime
 = 
	`li°GET_ITEM_VALUE_OF_HEAD_ENTRY
–
pxCuºítTimîLi°
 );

422 
xNextExpúeTime
 = ( 
p‹tTickTy≥
 ) 0U;

425  
xNextExpúeTime
;

426 
	}
}

429 
p‹tTickTy≥
 
	$¥vSam∂eTimeNow
–
p‹tBASE_TYPE
 *
pxTimîLi°sWîeSwôched
 )

431 
p‹tTickTy≥
 
xTimeNow
;

432 
p‹tTickTy≥
 
xLa°Time
 = (ÖortTickType ) 0U;

434 
xTimeNow
 = 
	`xTaskGëTickCou¡
();

436 if–
xTimeNow
 < 
xLa°Time
 )

438 
	`¥vSwôchTimîLi°s
–
xLa°Time
 );

439 *
pxTimîLi°sWîeSwôched
 = 
pdTRUE
;

443 *
pxTimîLi°sWîeSwôched
 = 
pdFALSE
;

446 
xLa°Time
 = 
xTimeNow
;

448  
xTimeNow
;

449 
	}
}

452 
p‹tBASE_TYPE
 
	$¥vIn£πTimîInA˘iveLi°
–
xTIMER
 *
pxTimî
, 
p‹tTickTy≥
 
xNextExpúyTime
,Ö‹tTickTy≥ 
xTimeNow
,Ö‹tTickTy≥ 
xComm™dTime
 )

454 
p‹tBASE_TYPE
 
xPro˚ssTimîNow
 = 
pdFALSE
;

456 
	`li°SET_LIST_ITEM_VALUE
–&–
pxTimî
->
xTimîLi°Iãm
 ), 
xNextExpúyTime
 );

457 
	`li°SET_LIST_ITEM_OWNER
–&–
pxTimî
->
xTimîLi°Iãm
 ),ÖxTimer );

459 if–
xNextExpúyTime
 <
xTimeNow
 )

463 if–––
p‹tTickTy≥
 ) ( 
xTimeNow
 - 
xComm™dTime
 ) ) >
pxTimî
->
xTimîPîiodInTicks
 )

467 
xPro˚ssTimîNow
 = 
pdTRUE
;

471 
	`vLi°In£π
–
pxOvîÊowTimîLi°
, &–
pxTimî
->
xTimîLi°Iãm
 ) );

476 if––
xTimeNow
 < 
xComm™dTime
 ) && ( 
xNextExpúyTime
 >= xCommandTime ) )

481 
xPro˚ssTimîNow
 = 
pdTRUE
;

485 
	`vLi°In£π
–
pxCuºítTimîLi°
, &–
pxTimî
->
xTimîLi°Iãm
 ) );

489  
xPro˚ssTimîNow
;

490 
	}
}

493 
	$¥vPro˚ssRe˚ivedComm™ds
( )

495 
xTIMER_MESSAGE
 
xMesßge
;

496 
xTIMER
 *
pxTimî
;

497 
p‹tBASE_TYPE
 
xTimîLi°sWîeSwôched
, 
xResu…
;

498 
p‹tTickTy≥
 
xTimeNow
;

502 
xTimeNow
 = 
	`¥vSam∂eTimeNow
–&
xTimîLi°sWîeSwôched
 );

504  
	`xQueueRe˚ive
–
xTimîQueue
, &
xMesßge
, 
tmrNO_DELAY
 ) !
pdFAIL
 )

506 
pxTimî
 = 
xMesßge
.pxTimer;

511 if–
pxTimî
 !
NULL
 )

513 if–
	`li°IS_CONTAINED_WITHIN
–
NULL
, &–
pxTimî
->
xTimîLi°Iãm
 ) ) =
pdFALSE
 )

516 
	`vLi°Remove
–&–
pxTimî
->
xTimîLi°Iãm
 ) );

520 
	`åa˚TIMER_COMMAND_RECEIVED
–
pxTimî
, 
xMesßge
.
xMesßgeID
, xMesßge.
xMesßgeVÆue
 );

522  
xMesßge
.
xMesßgeID
 )

524 
tmrCOMMAND_START
 :

526 if–
	`¥vIn£πTimîInA˘iveLi°
–
pxTimî
, 
xMesßge
.
xMesßgeVÆue
 +ÖxTimî->
xTimîPîiodInTicks
, 
xTimeNow
, xMesßge.xMesßgeVÆuêË=
pdTRUE
 )

530 
pxTimî
->
	`pxCÆlbackFun˘i⁄
––
xTimîH™dÀ
 )ÖxTimer );

532 if–
pxTimî
->
uxAutoRñﬂd
 =–
p‹tBASE_TYPE
 ) 
pdTRUE
 )

534 
xResu…
 = 
	`xTimîGíîicComm™d
–
pxTimî
, 
tmrCOMMAND_START
, 
xMesßge
.
xMesßgeVÆue
 +ÖxTimî->
xTimîPîiodInTicks
, 
NULL
, 
tmrNO_DELAY
 );

535 
	`c⁄figASSERT
–
xResu…
 );

536 –Ë
xResu…
;

541 
tmrCOMMAND_STOP
 :

546 
tmrCOMMAND_CHANGE_PERIOD
 :

547 
pxTimî
->
xTimîPîiodInTicks
 = 
xMesßge
.
xMesßgeVÆue
;

548 
	`c⁄figASSERT
––
pxTimî
->
xTimîPîiodInTicks
 > 0 ) );

549 
	`¥vIn£πTimîInA˘iveLi°
–
pxTimî
, ( 
xTimeNow
 +ÖxTimî->
xTimîPîiodInTicks
 ), xTimeNow, xTimeNow );

552 
tmrCOMMAND_DELETE
 :

555 
	`vP‹tFªe
–
pxTimî
 );

563 
	}
}

566 
	$¥vSwôchTimîLi°s
–
p‹tTickTy≥
 
xLa°Time
 )

568 
p‹tTickTy≥
 
xNextExpúeTime
, 
xRñﬂdTime
;

569 
xLi°
 *
pxTemp
;

570 
xTIMER
 *
pxTimî
;

571 
p‹tBASE_TYPE
 
xResu…
;

574 –Ë
xLa°Time
;

580  
	`li°LIST_IS_EMPTY
–
pxCuºítTimîLi°
 ) =
pdFALSE
 )

582 
xNextExpúeTime
 = 
	`li°GET_ITEM_VALUE_OF_HEAD_ENTRY
–
pxCuºítTimîLi°
 );

585 
pxTimî
 = ( 
xTIMER
 * ) 
	`li°GET_OWNER_OF_HEAD_ENTRY
–
pxCuºítTimîLi°
 );

586 
	`vLi°Remove
–&–
pxTimî
->
xTimîLi°Iãm
 ) );

591 
pxTimî
->
	`pxCÆlbackFun˘i⁄
––
xTimîH™dÀ
 )ÖxTimer );

593 if–
pxTimî
->
uxAutoRñﬂd
 =–
p‹tBASE_TYPE
 ) 
pdTRUE
 )

601 
xRñﬂdTime
 = ( 
xNextExpúeTime
 + 
pxTimî
->
xTimîPîiodInTicks
 );

602 if–
xRñﬂdTime
 > 
xNextExpúeTime
 )

604 
	`li°SET_LIST_ITEM_VALUE
–&–
pxTimî
->
xTimîLi°Iãm
 ), 
xRñﬂdTime
 );

605 
	`li°SET_LIST_ITEM_OWNER
–&–
pxTimî
->
xTimîLi°Iãm
 ),ÖxTimer );

606 
	`vLi°In£π
–
pxCuºítTimîLi°
, &–
pxTimî
->
xTimîLi°Iãm
 ) );

610 
xResu…
 = 
	`xTimîGíîicComm™d
–
pxTimî
, 
tmrCOMMAND_START
, 
xNextExpúeTime
, 
NULL
, 
tmrNO_DELAY
 );

611 
	`c⁄figASSERT
–
xResu…
 );

612 –Ë
xResu…
;

617 
pxTemp
 = 
pxCuºítTimîLi°
;

618 
pxCuºítTimîLi°
 = 
pxOvîÊowTimîLi°
;

619 
pxOvîÊowTimîLi°
 = 
pxTemp
;

620 
	}
}

623 
	$¥vCheckF‹VÆidLi°AndQueue
( )

628 
	`èskENTER_CRITICAL
();

630 if–
xTimîQueue
 =
NULL
 )

632 
	`vLi°Inôüli£
–&
xA˘iveTimîLi°1
 );

633 
	`vLi°Inôüli£
–&
xA˘iveTimîLi°2
 );

634 
pxCuºítTimîLi°
 = &
xA˘iveTimîLi°1
;

635 
pxOvîÊowTimîLi°
 = &
xA˘iveTimîLi°2
;

636 
xTimîQueue
 = 
	`xQueueCª©e
––
p‹tBASE_TYPE
 ) 
c⁄figTIMER_QUEUE_LENGTH
, –
xTIMER_MESSAGE
 ) );

639 
	`èskEXIT_CRITICAL
();

640 
	}
}

643 
p‹tBASE_TYPE
 
	$xTimîIsTimîA˘ive
–
xTimîH™dÀ
 
xTimî
 )

645 
p‹tBASE_TYPE
 
xTimîIsInA˘iveLi°
;

646 
xTIMER
 *
pxTimî
 = ( xTIMER * ) 
xTimî
;

649 
	`èskENTER_CRITICAL
();

654 
xTimîIsInA˘iveLi°
 = !–
	`li°IS_CONTAINED_WITHIN
–
NULL
, &–
pxTimî
->
xTimîLi°Iãm
 ) ) );

656 
	`èskEXIT_CRITICAL
();

658  
xTimîIsInA˘iveLi°
;

659 
	}
}

662 *
	$pvTimîGëTimîID
–
xTimîH™dÀ
 
xTimî
 )

664 
xTIMER
 *
pxTimî
 = ( xTIMER * ) 
xTimî
;

666  
pxTimî
->
pvTimîID
;

667 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\ADC.c

1 
	~"adc.h
"

3 
	#ADC1_DR_Addªss
 ((
u32
)0x4001244C)

	)

6 
ADCTy≥Def
 
	gADCSåu˘uª
;

14 
	$GPIOC⁄fig
()

16 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

17 
	`RCC_AHBPîùhClockCmd
(
RCC_AHBPîùh_DMA1
, 
ENABLE
);

18 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_ADC1
 | 
RCC_APB2Pîùh_GPIOB
, 
ENABLE
);

20 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_1
;

21 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AIN
;

22 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

24 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_0
;

25 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AIN
;

26 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

27 
	}
}

36 
	$ADCC⁄fig
()

38 
DMA_InôTy≥Def
 
DMA_InôSåu˘uª
;

39 
ADC_InôTy≥Def
 
ADC_InôSåu˘uª
;

42 
	`DMA_DeInô
(
DMA1_Ch™√l1
);

43 
DMA_InôSåu˘uª
.
DMA_PîùhîÆBa£Addr
 = 
ADC1_DR_Addªss
;

44 
DMA_InôSåu˘uª
.
DMA_Mem‹yBa£Addr
 = (
u32
)
ADCSåu˘uª
.
c⁄vîãdVÆue
;

45 
DMA_InôSåu˘uª
.
DMA_DIR
 = 
DMA_DIR_PîùhîÆSRC
;

46 
DMA_InôSåu˘uª
.
DMA_Buf„rSize
 = 2;

47 
DMA_InôSåu˘uª
.
DMA_PîùhîÆInc
 = 
DMA_PîùhîÆInc_DißbÀ
;

48 
DMA_InôSåu˘uª
.
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_DißbÀ
;

49 
DMA_InôSåu˘uª
.
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_HÆfW‹d
;

50 
DMA_InôSåu˘uª
.
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_HÆfW‹d
;

51 
DMA_InôSåu˘uª
.
DMA_Mode
 = 
DMA_Mode_Cúcuœr
;

52 
DMA_InôSåu˘uª
.
DMA_Pri‹ôy
 = 
DMA_Pri‹ôy_High
;

53 
DMA_InôSåu˘uª
.
DMA_M2M
 = 
DMA_M2M_DißbÀ
;

55 
DMA_InôSåu˘uª
.
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_E«bÀ
;

56 
DMA_InôSåu˘uª
.
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_HÆfW‹d
;

57 
DMA_InôSåu˘uª
.
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_HÆfW‹d
;

58 
DMA_InôSåu˘uª
.
DMA_Buf„rSize
 = 2;

59 
	`DMA_Inô
(
DMA1_Ch™√l1
, &
DMA_InôSåu˘uª
);

61 
	`DMA_Cmd
(
DMA1_Ch™√l1
, 
ENABLE
);

63 
ADC_InôSåu˘uª
.
ADC_Mode
 = 
ADC_Mode_Indïídít
;

64 
ADC_InôSåu˘uª
.
ADC_SˇnC⁄vMode
 = 
ENABLE
;

65 
ADC_InôSåu˘uª
.
ADC_C⁄töuousC⁄vMode
 = 
ENABLE
;

66 
ADC_InôSåu˘uª
.
ADC_Exã∫ÆTrigC⁄v
 = 
ADC_Exã∫ÆTrigC⁄v_N⁄e
;

67 
ADC_InôSåu˘uª
.
ADC_D©aAlign
 = 
ADC_D©aAlign_Right
;

68 
ADC_InôSåu˘uª
.
ADC_NbrOfCh™√l
 = 2;

70 
	`ADC_Inô
(
ADC1
, &
ADC_InôSåu˘uª
);

72 
	`ADC_ReguœrCh™√lC⁄fig
(
ADC1
, 
ADC_Ch™√l_9
, 1, 
ADC_Sam∂eTime_55Cy˛es5
);

73 
	`ADC_ReguœrCh™√lC⁄fig
(
ADC1
, 
ADC_Ch™√l_8
, 2, 
ADC_Sam∂eTime_55Cy˛es5
);

75 
	`ADC_DMACmd
(
ADC1
, 
ENABLE
);

78 
	`ADC_Cmd
(
ADC1
, 
ENABLE
);

81 
	`ADC_Re£tCÆibøti⁄
(
ADC1
);

83 
	`ADC_GëRe£tCÆibøti⁄Sètus
(
ADC1
));

86 
	`ADC_SèπCÆibøti⁄
(
ADC1
);

88 
	`ADC_GëCÆibøti⁄Sètus
(
ADC1
));

91 
	`ADC_So·w¨eSèπC⁄vCmd
(
ADC1
, 
ENABLE
);

92 
	}
}

101 
	$ADCInô
()

103 
	`GPIOC⁄fig
();

104 
	`ADCC⁄fig
();

105 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\I2C.c

8 
	~"I2C.h
"

9 
	~"dñay.h
"

15 
	$IIC_Inô
()

17 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

18 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOB
, 
ENABLE
);

19 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_6
 | 
GPIO_Pö_7
;

20 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

21 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

22 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

23 
	}
}

29 
	$IIC_Sèπ
()

31 
	`SDA_OUT
();

32 
IIC_SDA
=1;

33 
IIC_SCL
=1;

34 
	`dñay_us
(4);

35 
IIC_SDA
=0;

36 
	`dñay_us
(4);

37 
IIC_SCL
=0;

38 
	}
}

44 
	$IIC_St›
()

46 
	`SDA_OUT
();

47 
IIC_SCL
=0;

48 
IIC_SDA
=0;

49 
	`dñay_us
(4);

50 
IIC_SCL
=1;

51 
IIC_SDA
=1;

52 
	`dñay_us
(4);

53 
	}
}

61 
u8
 
	$IIC_Waô_Ack
()

63 
u8
 
ucEºTime
=0;

64 
	`SDA_IN
();

65 
IIC_SDA
=1;

66 
	`dñay_us
(1);

67 
IIC_SCL
=1;

68 
	`dñay_us
(1);

69 
READ_SDA
)

71 
ucEºTime
++;

72 if(
ucEºTime
>50)

74 
	`IIC_St›
();

77 
	`dñay_us
(1);

79 
IIC_SCL
=0;

81 
	}
}

87 
	$IIC_Ack
()

89 
IIC_SCL
=0;

90 
	`SDA_OUT
();

91 
IIC_SDA
=0;

92 
	`dñay_us
(2);

93 
IIC_SCL
=1;

94 
	`dñay_us
(2);

95 
IIC_SCL
=0;

96 
	}
}

102 
	$IIC_NAck
()

104 
IIC_SCL
=0;

105 
	`SDA_OUT
();

106 
IIC_SDA
=1;

107 
	`dñay_us
(2);

108 
IIC_SCL
=1;

109 
	`dñay_us
(2);

110 
IIC_SCL
=0;

111 
	}
}

117 
	$IIC_Síd_Byã
(
u8
 
txd
)

119 
u8
 
t
;

120 
	`SDA_OUT
();

121 
IIC_SCL
=0;

122 
t
=0;Å<8;Å++)

124 
IIC_SDA
=(
txd
&0x80)>>7;

125 
txd
<<=1;

126 
	`dñay_us
(2);

127 
IIC_SCL
=1;

128 
	`dñay_us
(2);

129 
IIC_SCL
=0;

130 
	`dñay_us
(2);

132 
	}
}

138 
u8
 
	$IIC_Ród_Byã
(
ack
)

140 
i
,
ª˚ive
=0;

141 
	`SDA_IN
();

142 
i
=0; i<8; i++ )

144 
IIC_SCL
=0;

145 
	`dñay_us
(2);

146 
IIC_SCL
=1;

147 
ª˚ive
<<=1;

148 if(
READ_SDA
)
ª˚ive
++;

149 
	`dñay_us
(2);

151 i‡(
ack
)

152 
	`IIC_Ack
();

154 
	`IIC_NAck
();

155  
ª˚ive
;

156 
	}
}

165 
	$I2C_RódO√Byã
(
I2C_Addr
,
addr
)

167 
ªs
=0;

169 
	`IIC_Sèπ
();

170 
	`IIC_Síd_Byã
(
I2C_Addr
);

171 
ªs
++;

172 
	`IIC_Waô_Ack
();

173 
	`IIC_Síd_Byã
(
addr
);

174 
ªs
++;

175 
	`IIC_Waô_Ack
();

176 
	`IIC_St›
();

177 
	`IIC_Sèπ
();

178 
	`IIC_Síd_Byã
(
I2C_Addr
+1);

179 
ªs
++;

180 
	`IIC_Waô_Ack
();

181 
ªs
=
	`IIC_Ród_Byã
(0);

182 
	`IIC_St›
();

184  
ªs
;

185 
	}
}

197 
u8
 
	$IICªadByãs
(
u8
 
dev
, u8 
ªg
, u8 
Àngth
, u8 *
d©a
)

199 
u8
 
cou¡
 = 0;

200 
	`IIC_Sèπ
();

201 
	`IIC_Síd_Byã
(
dev
);

202 
	`IIC_Waô_Ack
();

203 
	`IIC_Síd_Byã
(
ªg
);

204 
	`IIC_Waô_Ack
();

205 
	`IIC_Sèπ
();

206 
	`IIC_Síd_Byã
(
dev
+1);

207 
	`IIC_Waô_Ack
();

208 
cou¡
=0; cou¡<
Àngth
; count++)

210 if(
cou¡
!=
Àngth
-1)
d©a
[cou¡]=
	`IIC_Ród_Byã
(1);

211 
d©a
[
cou¡
]=
	`IIC_Ród_Byã
(0);

213 
	`IIC_St›
();

215 
	}
}

226 
u8
 
	$IICwrôeByãs
(
u8
 
dev
, u8 
ªg
, u8 
Àngth
, u8* 
d©a
) {

228 
u8
 
cou¡
 = 0;

229 
	`IIC_Sèπ
();

230 
	`IIC_Síd_Byã
(
dev
);

231 
	`IIC_Waô_Ack
();

232 
	`IIC_Síd_Byã
(
ªg
);

233 
	`IIC_Waô_Ack
();

234 
cou¡
=0; cou¡<
Àngth
; count++)

236 
	`IIC_Síd_Byã
(
d©a
[
cou¡
]);

237 
	`IIC_Waô_Ack
();

239 
	`IIC_St›
();

241 
	}
}

251 
u8
 
	$IICªadByã
(
u8
 
dev
, u8 
ªg
, u8 *
d©a
)

253 *
d©a
=
	`I2C_RódO√Byã
(
dev
, 
ªg
);

255 
	}
}

265 
	$IICwrôeByã
(
dev
, 
ªg
, 
d©a
)

267  
	`IICwrôeByãs
(
dev
, 
ªg
, 1, &
d©a
);

268 
	}
}

281 
u8
 
	$IICwrôeBôs
(
u8
 
dev
,u8 
ªg
,u8 
bôSèπ
,u8 
Àngth
,u8 
d©a
)

283 
u8
 
b
;

284 i‡(
	`IICªadByã
(
dev
, 
ªg
, &
b
) != 0) {

285 
u8
 
mask
 = (0xFF << (
bôSèπ
 + 1)Ë| 0xFF >> ((8 - bôSèπË+ 
Àngth
 - 1);

286 
d©a
 <<(8 - 
Àngth
);

287 
d©a
 >>(7 - 
bôSèπ
);

288 
b
 &
mask
;

289 
b
 |
d©a
;

290  
	`IICwrôeByã
(
dev
, 
ªg
, 
b
);

295 
	}
}

307 
u8
 
	$IICwrôeBô
(
u8
 
dev
, u8 
ªg
, u8 
bôNum
, u8 
d©a
)

309 
u8
 
b
;

310 
	`IICªadByã
(
dev
, 
ªg
, &
b
);

311 
b
 = (
d©a
 !0Ë? (b | (1 << 
bôNum
)) : (b & ~(1 << bitNum));

312  
	`IICwrôeByã
(
dev
, 
ªg
, 
b
);

313 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\MPU9250.c

1 
	~"MPU9250.h
"

2 
	~"I2C.h
"

3 
	~"dñay.h
"

4 
	~"Êash.h
"

5 
	~"comm.h
"

7 
u8
 
	gmpu6500_buf„r
[14];

8 
S_INT16_XYZ
 
	gGYRO_OFFSET
,
	gACC_OFFSET
;

9 
u8
 
	gGYRO_OFFSET_OK
 = 1;

10 
u8
 
	gACC_OFFSET_OK
 = 1;

11 
S_INT16_XYZ
 
	gMPU6500_ACC_LAST
,
	gMPU6500_GYRO_LAST
;

16 
	$MPU6500_D©Ø∆
()

18 
MPU6500_ACC_LAST
.
X
=((((
öt16_t
)
mpu6500_buf„r
[0]Ë<< 8Ë| mpu6500_buf„r[1]Ë- 
ACC_OFFSET
.X;

19 
MPU6500_ACC_LAST
.
Y
=((((
öt16_t
)
mpu6500_buf„r
[2]Ë<< 8Ë| mpu6500_buf„r[3]Ë- 
ACC_OFFSET
.Y;

20 
MPU6500_ACC_LAST
.
Z
=((((
öt16_t
)
mpu6500_buf„r
[4]Ë<< 8Ë| mpu6500_buf„r[5]Ë- 
ACC_OFFSET
.Z;

22 
MPU6500_GYRO_LAST
.
X
=((((
öt16_t
)
mpu6500_buf„r
[8]) << 8) | mpu6500_buffer[9]);

23 
MPU6500_GYRO_LAST
.
Y
=((((
öt16_t
)
mpu6500_buf„r
[10]) << 8) | mpu6500_buffer[11]);

24 
MPU6500_GYRO_LAST
.
Z
=((((
öt16_t
)
mpu6500_buf„r
[12]) << 8) | mpu6500_buffer[13]);

25 if(
MPU6500_GYRO_LAST
.
X
 < 5 && MPU6500_GYRO_LAST.X > -5 ) MPU6500_GYRO_LAST.X =0;

26 if(
MPU6500_GYRO_LAST
.
Y
 < 5 && MPU6500_GYRO_LAST.Y > -5) MPU6500_GYRO_LAST.Y =0;

27 if(
MPU6500_GYRO_LAST
.
Z
 < 5 && MPU6500_GYRO_LAST.Z > -5) MPU6500_GYRO_LAST.Z =0;

30 if(!
GYRO_OFFSET_OK
)

32 
öt32_t
 
ãmpgx
=0,
ãmpgy
=0,
ãmpgz
=0;

33 
uöt8_t
 
˙t_g
=0;

34 if(
˙t_g
==0)

36 
GYRO_OFFSET
.
X
=0;

37 
GYRO_OFFSET
.
Y
=0;

38 
GYRO_OFFSET
.
Z
=0;

39 
ãmpgx
 = 0;

40 
ãmpgy
 = 0;

41 
ãmpgz
 = 0;

42 
˙t_g
 = 1;

44 
ãmpgx
+
MPU6500_GYRO_LAST
.
X
;

45 
ãmpgy
+
MPU6500_GYRO_LAST
.
Y
;

46 
ãmpgz
+
MPU6500_GYRO_LAST
.
Z
;

47 if(
˙t_g
==200)

49 
GYRO_OFFSET
.
X
=
ãmpgx
/
˙t_g
;

50 
GYRO_OFFSET
.
Y
=
ãmpgy
/
˙t_g
;

51 
GYRO_OFFSET
.
Z
=
ãmpgz
/
˙t_g
;

52 
˙t_g
 = 0;

53 
GYRO_OFFSET_OK
 = 1;

54 
	`EE_SAVE_GYRO_OFFSET
();

57 
˙t_g
++;

60 
	}
}

64 
	$MPU6500_Ród
()

66 
	`IICªadByãs
(
devAddr
,
MPU6500_RA_ACCEL_XOUT_H
,14,
mpu6500_buf„r
);

67 
	}
}

78 
	$MPU6500_IICwrôeBô
(
u8
 
dev
, u8 
ªg
, u8 
bôNum
, u8 
d©a
)

80 
u8
 
b
;

81 
	`IICªadByãs
(
dev
, 
ªg
, 1, &
b
);

82 
b
 = (
d©a
 !0Ë? (b | (1 << 
bôNum
)) : (b & ~(1 << bitNum));

83 
	`IICwrôeByãs
(
dev
, 
ªg
, 1, &
b
);

84 
	}
}

96 
	$MPU6500_IICwrôeBôs
(
u8
 
dev
,u8 
ªg
,u8 
bôSèπ
,u8 
Àngth
,u8 
d©a
)

98 
u8
 
b
,
mask
;

99 
	`IICªadByãs
(
dev
, 
ªg
, 1, &
b
);

100 
mask
 = (0xFF << (
bôSèπ
 + 1)Ë| 0xFF >> ((8 - bôSèπË+ 
Àngth
 - 1);

101 
d©a
 <<(8 - 
Àngth
);

102 
d©a
 >>(7 - 
bôSèπ
);

103 
b
 &
mask
;

104 
b
 |
d©a
;

105 
	`IICwrôeByãs
(
dev
, 
ªg
, 1, &
b
);

106 
	}
}

121 
	$MPU6500_£tClockSour˚
(
uöt8_t
 
sour˚
)

123 
	`MPU6500_IICwrôeBôs
(
devAddr
, 
MPU6500_RA_PWR_MGMT_1
, 
MPU6500_PWR1_CLKSEL_BIT
, 
MPU6500_PWR1_CLKSEL_LENGTH
, 
sour˚
);

124 
	}
}

133 
	$MPU6500_£tFuŒSˇÀGyroR™ge
(
uöt8_t
 
ønge
)

135 
	`MPU6500_IICwrôeBôs
(
devAddr
, 
MPU6500_RA_GYRO_CONFIG
, 
MPU6500_GCONFIG_FS_SEL_BIT
, 
MPU6500_GCONFIG_FS_SEL_LENGTH
, 
ønge
);

136 
	}
}

142 
	$MPU6500_£tFuŒSˇÀAc˚lR™ge
(
uöt8_t
 
ønge
)

144 
	`MPU6500_IICwrôeBôs
(
devAddr
, 
MPU6500_RA_ACCEL_CONFIG
, 
MPU6500_ACONFIG_AFS_SEL_BIT
, 
MPU6500_ACONFIG_AFS_SEL_LENGTH
, 
ønge
);

145 
	}
}

152 
	$MPU6500_£tSÀïE«bÀd
(
uöt8_t
 
íabÀd
)

154 
	`MPU6500_IICwrôeBô
(
devAddr
, 
MPU6500_RA_PWR_MGMT_1
, 
MPU6500_PWR1_SLEEP_BIT
, 
íabÀd
);

155 
	}
}

161 
	$MPU6500_£tI2CMa°îModeE«bÀd
(
uöt8_t
 
íabÀd
) {

162 
	`MPU6500_IICwrôeBô
(
devAddr
, 
MPU6500_RA_USER_CTRL
, 
MPU6500_USERCTRL_I2C_MST_EN_BIT
, 
íabÀd
);

163 
	}
}

169 
	$MPU6500_£tI2CBy∑ssE«bÀd
(
uöt8_t
 
íabÀd
)

171 
	`MPU6500_IICwrôeBô
(
devAddr
, 
MPU6500_RA_INT_PIN_CFG
, 
MPU6500_INTCFG_I2C_BYPASS_EN_BIT
, 
íabÀd
);

172 
	}
}

174 
	$MPU6500_£tDLPF
(
uöt8_t
 
mode
)

176 
	`MPU6500_IICwrôeBôs
(
devAddr
, 
MPU6500_RA_CONFIG
, 
MPU6500_CFG_DLPF_CFG_BIT
, 
MPU6500_CFG_DLPF_CFG_LENGTH
, 
mode
);

177 
	}
}

179 
	$Dñay_ms_mpu
(
u16
 
nms
)

181 
u8
 
i
;

182 
i
=0; i<
nms
; i++)

184 
u16
 
dñay_˙t
 = 50000;

185 if(
dñay_˙t
)

186 
dñay_˙t
--;

188 
	}
}

194 
	$MPU6500_Inô
()

196 
u8
 
Ø
 = 0x00;

197 
	`MPU6500_£tSÀïE«bÀd
(0);

198 
	`Dñay_ms_mpu
(200);

199 
	`MPU6500_£tClockSour˚
(
MPU6500_CLOCK_PLL_XGYRO
);

200 
	`Dñay_ms_mpu
(50);

201 
	`IICªadByãs
(0xd0,0x1a,1,&
Ø
);

202 
	`Dñay_ms_mpu
(50);

203 
	`MPU6500_£tFuŒSˇÀGyroR™ge
(
MPU6500_GYRO_FS_2000
);

204 
	`Dñay_ms_mpu
(50);

205 
	`MPU6500_£tFuŒSˇÀAc˚lR™ge
(
MPU6500_ACCEL_FS_4
);

206 
	`Dñay_ms_mpu
(50);

207 
	`MPU6500_£tDLPF
(
MPU6500_DLPF_BW_42
);

208 
	`Dñay_ms_mpu
(50);

209 
	`MPU6500_£tI2CMa°îModeE«bÀd
(0);

210 
	`Dñay_ms_mpu
(50);

211 
	`MPU6500_£tI2CBy∑ssE«bÀd
(1);

212 
	`Dñay_ms_mpu
(50);

214 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\ble.c

2 
	~"FªeRTOS.h
"

3 
	~"queue.h
"

4 
	~"£mphr.h
"

7 
	~"°m32f10x.h
"

8 
	~<°dio.h
>

11 
	~"bÀ.h
"

12 
	~"imu.h
"

13 
	~"Àd.h
"

14 
	~"ADC.h
"

15 
	~"ußπ2.h
"

17 
BLETy≥Def
 
	gBLESåu˘uª
;

25 
	$GPIOInô
()

27 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

28 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOB
 , 
ENABLE
);

29 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_14
;

30 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

31 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

32 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

34 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_15
;

35 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

36 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

37 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

39 
	`BLE_EN
(
ON
);

40 
	`BLE_BRTS
(
ON
);

41 
	}
}

49 
	$SídD©a
(
S_FLOAT_XYZ
 
Q_ANGLE
)

51 
_ãmp
;

52 
u8
 
sum
;

54 
BLESåu˘uª
.
£ndBuff
.
d©a
[0] = 0x88;

55 
BLESåu˘uª
.
£ndBuff
.
d©a
[1] = 0x01;

56 
BLESåu˘uª
.
£ndBuff
.
d©a
[2] = 0x0B;

57 
BLESåu˘uª
.
£ndBuff
.
d©a
[4] = 0x31;

58 
_ãmp
 = ()(
Q_ANGLE
.
X
*100);

59 
BLESåu˘uª
.
£ndBuff
.
d©a
[5] = 
	`BYTE1
(
_ãmp
);

60 
BLESåu˘uª
.
£ndBuff
.
d©a
[6] = 
	`BYTE0
(
_ãmp
);

61 
_ãmp
 = ()(
Q_ANGLE
.
Y
*100);

62 
BLESåu˘uª
.
£ndBuff
.
d©a
[7] = 
	`BYTE1
(
_ãmp
);

63 
BLESåu˘uª
.
£ndBuff
.
d©a
[8] = 
	`BYTE0
(
_ãmp
);

64 
_ãmp
 = ()(
ADC_C⁄vîãdVÆue
[0]);

65 
BLESåu˘uª
.
£ndBuff
.
d©a
[9] = 
	`BYTE1
(
_ãmp
);

66 
BLESåu˘uª
.
£ndBuff
.
d©a
[10] = 
	`BYTE0
(
_ãmp
);

68 
sum
 = 0;

69 
sum
 +
BLESåu˘uª
.
£ndBuff
.
d©a
[0];

70 
sum
 +
BLESåu˘uª
.
£ndBuff
.
d©a
[1];

71 
sum
 +
BLESåu˘uª
.
£ndBuff
.
d©a
[2];

72 
i
=4; i<11; i++)

74 
sum
 +
BLESåu˘uª
.
£ndBuff
.
d©a
[
i
];

76 
BLESåu˘uª
.
£ndBuff
.
d©a
[3] = 
sum
;

78 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l7
,
BLESåu˘uª
.
£ndBuff
.
d©a
[2]);

79 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
ENABLE
);

81 
	}
}

89 c⁄° 
u8
 
	gbÀCmdBrushOn
[6] = {0x88,0x11,0x06,0xA1,0x11,0x01};

90 c⁄° 
u8
 
	gbÀCmdBrushOff
[6] = {0x88,0x11,0x06,0xA2,0x11,0x02};

92 
	$SídCmd
(
u8
 
CmdToAµ
)

94 if(
CmdToAµ
 =
BURSH_ON
)

96 
u8
 
i
=0; i<6; i++)

98 
BLESåu˘uª
.
£ndBuff
.
d©a
[
i
] = 
bÀCmdBrushOn
[i];

100 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l7
,
bÀCmdBrushOn
[2]);

101 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
ENABLE
);

103 if(
CmdToAµ
 =
BURSH_OFF
)

105 
u8
 
i
=0; i<6; i++)

107 
BLESåu˘uª
.
£ndBuff
.
d©a
[
i
] = 
bÀCmdBrushOff
[i];

109 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l7
,
bÀCmdBrushOn
[2]);

110 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
ENABLE
);

113 
	}
}

121 c⁄° 
u8
 
	gbÀAµAckCmdBrushOn
[6] = {0x88,0x11,0x06,0xB1,0x11,0x01};

122 c⁄° 
u8
 
	gbÀAµAckCmdBrushOff
[6] = {0x88,0x11,0x06,0xB2,0x11,0x02};

124 
	$SídAck
(
u8
 
ack
)

126 if(
ack
 =
ACK_ON
)

128 
u8
 
i
=0; i<6; i++)

130 
BLESåu˘uª
.
£ndBuff
.
d©a
[
i
] = 
bÀAµAckCmdBrushOn
[i];

132 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l7
,
bÀAµAckCmdBrushOn
[2]);

133 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
ENABLE
);

135 if(
ack
 =
ACK_OFF
)

137 
u8
 
i
=0; i<6; i++)

139 
BLESåu˘uª
.
£ndBuff
.
d©a
[
i
] = 
bÀAµAckCmdBrushOff
[i];

141 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l7
,
bÀAµAckCmdBrushOff
[2]);

142 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
ENABLE
);

145 
	}
}

153 
u8
 
	$CRCCheck
(
BLESídBuffTy≥Def
 * 
pBuff
)

155 
u8
 
sum
 = 0;

156 
sum
 +(*
pBuff
).
d©a
[0];

157 
sum
 +(*
pBuff
).
d©a
[1];

158 
sum
 +(*
pBuff
).
d©a
[2];

160 
u8
 
i
 = 4; i < (*
pBuff
).
Àngth
 ; i ++)

162 
sum
 +(*
pBuff
).
d©a
[
i
];

165 if(
sum
 =(*
pBuff
).
d©a
[3])

173 
	}
}

181 c⁄° 
u8
 
	gcomm™dAck
[] = {"TTM:OK\r\n\0"};

183 
u8
 
	$APPbuffD©aPª∑ª
(
BLESídBuffTy≥Def
 * 
pBuff
)

185 
u8
 
îrFœg
 = 0;

187 if((*
pBuff
).
d©a
[0] == 0x88)

189 if(
	`CRCCheck
(
pBuff
) == 0)

192 if(((*
pBuff
).
d©a
[4] & 0xF0) == 0x10 )

194 
BLESåu˘uª
.
comm™d
 = 
ba£dC⁄åﬁ
;

196 if(((*
pBuff
).
d©a
[4] & 0xF0) == 0x20)

198 
BLESåu˘uª
.
comm™d
 = 
wifiC⁄åﬁ
;

200 if(((*
pBuff
).
d©a
[4] & 0xF0) == 0x30)

202 
BLESåu˘uª
.
comm™d
 = 
d©aTønsmissi⁄
;

206 
BLESåu˘uª
.
comm™d
 = 
noC⁄åﬁ
;

210 if((*
pBuff
).
d©a
[0] == 'T')

212 
u8
 
i
 = 0; i < (*
pBuff
).
Àngth
; i++)

214 if((*
pBuff
).
d©a
[
i
] !
comm™dAck
[i])

216 
îrFœg
 = 1;

219 if(
îrFœg
 == 0)

221 
c⁄åﬁSem≠h‹e
.
bÀC⁄n˚t
 = 1;

227 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\delay.c

2 
	~"°m32f10x.h
"

3 
	~"dñay.h
"

4 
	~"FªeRTOS.h
"

5 
	~"èsk.h
"

7 
	#p‹tTICK_RATE_US
 ( ( 
p‹tTickTy≥
 ) 1 / 
c⁄figTICK_RATE_HZ
 )

	)

15 
	$dñayMs
(
u16
 
nms
)

17 
p‹tTickTy≥
 
xLa°WakeTime
;

18 
xLa°WakeTime
 = 
	`xTaskGëTickCou¡
();

19 
	`vTaskDñayU¡û
–&
xLa°WakeTime
, ( 
nms
 / 
p‹tTICK_RATE_MS
 ) );

20 
	}
}

28 
	$dñayUs
(
u32
 
nus
)

30 
p‹tTickTy≥
 
xLa°WakeTime
;

31 
xLa°WakeTime
 = 
	`xTaskGëTickCou¡
();

32 
	`vTaskDñayU¡û
–&
xLa°WakeTime
, ( 
nus
 / 
p‹tTICK_RATE_US
 ) );

33 
	}
}

41 
	$°up_dñay_ms
(
uöt16_t
 
nms
)

43 
uöt16_t
 
i
;

44 
i
=0; i<
nms
; i++)

46 
uöt16_t
 
dñay_˙t
 = 50000;

47 if(
dñay_˙t
)

48 
dñay_˙t
--;

50 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\dog.c

1 
	~"dog.h
"

3 
	$IWDG_Inô
(
u8
 
¥î
,
u16
 
ær
)

5 
IWDG
->
KR
=0X5555;

6 
IWDG
->
PR
=
¥î
;

7 
IWDG
->
RLR
=
ær
;

8 
IWDG
->
KR
=0XAAAA;

9 
IWDG
->
KR
=0XCCCC;

10 
	}
}

12 
	$IWDG_Fìd
()

14 
IWDG
->
KR
=0XAAAA;

15 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\esp8266.c

1 
	~<°rög.h
>

2 
	~<°dio.h
>

3 
	~<°dboﬁ.h
>

4 
	~"e•8266.h
"

5 
	~"ußπ2.h
"

6 
	~"ußπ3.h
"

7 
	~"dñay.h
"

9 
WIFITy≥Def
 
	gWIFISåu˘
;

11 
	$GPIOC⁄fig
( )

13 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

14 
	`RCC_APB2PîùhClockCmd
–
RCC_APB2Pîùh_GPIOB
, 
ENABLE
 );

16 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_3
 | 
GPIO_Pö_13
;

17 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

18 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

19 
	`GPIO_Inô
–
GPIOB
, &
GPIO_InôSåu˘uª
 );

20 
	`GPIO_Re£tBôs
–
GPIOB
, 
GPIO_Pö_13
 );

21 
	`GPIO_SëBôs
–
GPIOB
, 
GPIO_Pö_3
 );

22 
	}
}

32 
	$E«bÀ
 ( 
Fun˘i⁄ÆSèã
 
íumChoo£
 )

34 i‡–
íumChoo£
 =
ENABLE
 )

35 
	`ESP8266_CH_HIGH_LEVEL
();

38 
	`ESP8266_CH_LOW_LEVEL
();

40 
	}
}

53 
boﬁ
 
	$CmdI≈ut
 ( * 
cmd
, * 
ª∂y1
, * 
ª∂y2
, 
u32
 
waôtime
 )

55 
°rE•8266_Føm_Rec‹d
.
InfRxBô
.
FømLígth
 = 0;

57 
	`ESP8266UßπI≈ut
 ( "%s\r\n", 
cmd
 );

59 i‡––
ª∂y1
 =0 ) && ( 
ª∂y2
 == 0 ) )

60  
åue
;

62 
	`dñay_ms
 ( 
waôtime
 );

64 if(
°rE•8266_Føm_Rec‹d
.
InfRxBô
 .
FømLígth
 >= 199)

65 
°rE•8266_Føm_Rec‹d
.
InfRxBô
 .
FømLígth
 = 199;

67 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
 [ såE•8266_Føm_Rec‹d.
InfRxBô
.
FømLígth
 ] = '\0';

69 
	`PC_Ußπ
 ( "%s", 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
 );

71 i‡––
ª∂y1
 !0 ) && ( 
ª∂y2
 != 0 ) )

72  ( ( 
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
, 
ª∂y1
 ) ||

73 –
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
, 
ª∂y2
 ) );

75 i‡–
ª∂y1
 != 0 )

76  ( ( 
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
, 
ª∂y1
 ) );

79  ( ( 
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
, 
ª∂y2
 ) );

81 
	}
}

90 
	$Re°
 ( )

93 
	`CmdI≈ut
 ( "AT+RST", "OK", "ready", 2500 );

96 
	`ESP8266_RST_LOW_LEVEL
();

97 
	`dñay_ms
 ( 500 );

98 
	`ESP8266_RST_HIGH_LEVEL
();

102 
	}
}

111 
	$ATTe°
 ( )

113 
	`ESP8266_RST_HIGH_LEVEL
();

115 
	`dñay_ms
 ( 1000 );

117  ! 
	`CmdI≈ut
 ( "AT", "OK", 
NULL
, 200 ) ) 
	`Re°
 ();

119 
	}
}

131 
boﬁ
 
	$L⁄gAckCmdI≈ut
 ( * 
cmd
, * 
ª∂y1
, * 
ª∂y2
, 
u32
 
waôtime
 )

133 * 
pWifiNameLi°
[20] , *
pSå
 , *
pBuff
;

135 
°rE•8266_Føm_Rec‹d
.
InfRxBô
.
FømLígth
 = 0;

137 
	`ESP8266UßπI≈ut
 ( "%s\r\n", 
cmd
 );

138 i‡––
ª∂y1
 =0 ) && ( 
ª∂y2
 == 0 ) )

139  
åue
;

141 
	`dñay_ms
 ( 
waôtime
 );

143 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
 [ såE•8266_Føm_Rec‹d.
InfRxBô
.
FømLígth
 ] = '\0';

144 
pBuff
 = 
°rE•8266_Føm_Rec‹d
.
D©a_RX_BUF
;

145 
pSå
 = 
	`°πok
 ( 
pBuff
, "0");

146  
pSå
 !
NULL
 )

149 
	`PC_Ußπ
 ( "%s", 
pSå
 );

150 
pSå
 = 
	`°πok
 ( 
NULL
, "0" );

151 
	`dñay_ms
(50);

156 i‡––
ª∂y1
 !0 ) && ( 
ª∂y2
 != 0 ) )

157  ( ( 
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
, 
ª∂y1
 ) ||

158 –
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
, 
ª∂y2
 ) );

160 i‡–
ª∂y1
 != 0 )

161  ( ( 
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
, 
ª∂y1
 ) );

164  ( ( 
boﬁ
 ) 
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
, 
ª∂y2
 ) );

166 
	}
}

177 
boﬁ
 
	$NëModeChoo£
 ( 
ENUM_Në_ModeTy≥Def
 
íumMode
 )

179  
íumMode
 )

181 
STA
:

182  
	`CmdI≈ut
 ( "AT+CWMODE=1", "OK", "no change", 2500 );

184 
AP
:

185  
	`CmdI≈ut
 ( "AT+CWMODE=2", "OK", "no change", 2500 );

187 
STA_AP
:

188  
	`CmdI≈ut
 ( "AT+CWMODE=3", "OK", "no change", 2500 );

191  
Ál£
;

194 
	}
}

206 
boﬁ
 
	$JoöAP
 ( * 
pSSID
, * 
pPassW‹d
 )

208 
cCmd
 [120];

210 
	`•rötf
 ( 
cCmd
, "AT+CWJAP=\"%s\",\"%s\"", 
pSSID
, 
pPassW‹d
 );

212  
	`CmdI≈ut
 ( 
cCmd
, "OK", 
NULL
, 7000 );

214 
	}
}

227 
boﬁ
 
	$BuûdAP
 ( * 
pSSID
, * 
pPassW‹d
, * 
íunPsdMode
 )

229 
cCmd
 [120];

231 
	`•rötf
 ( 
cCmd
, "AT+CWSAP=\"%s\",\"%s\",1,%s", 
pSSID
, 
pPassW‹d
, 
íunPsdMode
 );

233  
	`CmdI≈ut
 ( 
cCmd
, "OK", 0, 1000 );

235 
	}
}

246 
boﬁ
 
	$E«bÀMu…ùÀId
 ( 
Fun˘i⁄ÆSèã
 
íumEnUnv¨nishTx
 )

248 
cSå
 [20];

250 
	`•rötf
 ( 
cSå
, "AT+CIPMUX=%d", ( 
íumEnUnv¨nishTx
 ? 1 : 0 ) );

252  
	`CmdI≈ut
 ( 
cSå
, "OK", 0, 500 );

254 
	}
}

268 
boﬁ
 
	$LökSîvî
 ( 
ENUM_NëPro_Ty≥Def
 
íumE
, * 
ù
, * 
ComNum
, 
ENUM_ID_NO_Ty≥Def
 
id
)

270 
cSå
 [100] = { 0 }, 
cCmd
 [120];

272  
íumE
 )

274 
íumTCP
:

275 
	`•rötf
 ( 
cSå
, "\"%s\",\"%s\",%s", "TCP", 
ù
, 
ComNum
 );

278 
íumUDP
:

279 
	`•rötf
 ( 
cSå
, "\"%s\",\"%s\",%s", "UDP", 
ù
, 
ComNum
 );

286 i‡–
id
 < 5 )

287 
	`•rötf
 ( 
cCmd
, "AT+CIPSTART=%d,%s", 
id
, 
cSå
);

290 
	`•rötf
 ( 
cCmd
, "AT+CIPSTART=%s", 
cSå
 );

292  
	`CmdI≈ut
 ( 
cCmd
, "OK", "ALREAY CONNECT", 500 );

294 
	}
}

307 
boﬁ
 
	$SèπOrShutSîvî
 ( 
Fun˘i⁄ÆSèã
 
íumMode
, * 
pP‹tNum
, * 
pTimeOvî
 )

309 
cCmd1
 [120], 
cCmd2
 [120];

311 i‡–
íumMode
 )

313 
	`•rötf
 ( 
cCmd1
, "AT+CIPSERVER=%d,%s", 1, 
pP‹tNum
 );

315 
	`•rötf
 ( 
cCmd2
, "AT+CIPSTO=%s", 
pTimeOvî
 );

317  ( 
	`CmdI≈ut
 ( 
cCmd1
, "OK", 0, 500 ) &&

318 
	`CmdI≈ut
 ( 
cCmd2
, "OK", 0, 500 ) );

323 
	`•rötf
 ( 
cCmd1
, "AT+CIPSERVER=%d,%s", 0, 
pP‹tNum
 );

325  
	`CmdI≈ut
 ( 
cCmd1
, "OK", 0, 500 );

328 
	}
}

339 
boﬁ
 
	$ESP8266_Unv¨nishSíd
 ( )

342 
	`CmdI≈ut
 ( "AT+CIPMODE=1", "OK", 0, 500 ) &&

343 
	`CmdI≈ut
 ( "AT+CIPSEND", "\r\n", ">", 500 ) );

345 
	}
}

359 
boﬁ
 
	$SídSåög
 ( 
Fun˘i⁄ÆSèã
 
íumEnUnv¨nishTx
, * 
pSå
, 
u32
 
ulSåLígth
, 
ENUM_ID_NO_Ty≥Def
 
ucId
 )

361 
cSå
 [20];

362 
boﬁ
 
bRë
 = 
Ál£
;

364 i‡–
íumEnUnv¨nishTx
 )

365 
	`ESP8266UßπI≈ut
 ( "%s", 
pSå
 );

370 i‡–
ucId
 < 5 )

371 
	`•rötf
 ( 
cSå
, "AT+CIPSEND=%d,%d", 
ucId
, 
ulSåLígth
 + 2 );

374 
	`•rötf
 ( 
cSå
, "AT+CIPSEND=%d", 
ulSåLígth
 + 2 );

376 
	`CmdI≈ut
 ( 
cSå
, "> ", 0, 1000 );

378 
bRë
 = 
	`CmdI≈ut
 ( 
pSå
, "SEND OK", 0, 1000 );

381  
bRë
;

383 
	}
}

393 * 
	$Re˚iveSåög
 ( 
Fun˘i⁄ÆSèã
 
íumEnUnv¨nishTx
 )

395 * 
pRecSå
 = 0;

397 
°rE•8266_Føm_Rec‹d
 .
InfRxBô
 .
FømLígth
 = 0;

398 
°rE•8266_Føm_Rec‹d
 .
InfRxBô
 .
FømFöishFœg
 = 0;

399  ! 
°rE•8266_Føm_Rec‹d
 .
InfRxBô
 .
FømFöishFœg
 );

400 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
 [ såE•8266_Føm_Rec‹d .
InfRxBô
 .
FømLígth
 ] = '\0';

402 i‡–
íumEnUnv¨nishTx
 )

404 i‡–
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
, ">" ) )

405 
pRecSå
 = 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
;

411 i‡–
	`°r°r
 ( 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
, "+IPD" ) )

412 
pRecSå
 = 
°rE•8266_Føm_Rec‹d
 .
D©a_RX_BUF
;

416  
pRecSå
;

418 
	}
}

438 
	$Inô
()

440 
	`E«bÀ
–
ENABLE
 );

441 
	`ATTe°
();

442 
	`NëModeChoo£
 ( 
STA
 );

443 
	}
}

447 
	$Li°AP
()

449 
	`L⁄gAckCmdI≈ut
( "AT+CWLAP", "OK", 0, 5000 );

450 
	}
}

454 
	$AddAP
()

456 * 
pSåDñimôî
 [2], * 
pBuf
, * 
pSå
;

457 
u8
 
uc
;

460 
pBuf
 = 
wifiC⁄fig
.
APNamePassw‹d
;

461 
uc
 = 0;

462  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

464 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

465 
pBuf
 = 
NULL
;

468 }  ! 
	`JoöAP
 ( 
pSåDñimôî
 [0],ÖStrDelimiter [1] ) );

470 
	`E«bÀMu…ùÀId
 ( 
ENABLE
 );

471 
	`PC_Ußπ
 ( "\r\nádded AP\r\n" );

472 
	}
}

476 
	$AddSîvî
()

478 * 
pSåDñimôî
 [2], * 
pBuf
, * 
pSå
;

479 
u8
 
uc
;

482 
pBuf
 = 
wifiC⁄fig
.
£rvîIP
;

483 
uc
 = 0;

484  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

486 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

487 
pBuf
 = 
NULL
;

490 }  ! ( 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_0
 ) &&

491 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_1
 ) &&

492 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_2
 ) &&

493 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_3
 ) &&

494 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_4
 ) ) );

496 
	}
}

498 
	$WIFISídTe°
()

500 
cSåI≈ut
 [] = "wifòã°\r\n", * 
pSåDñimôî
 [2], * 
pBuf
, * 
pSå
;

501 
u8
 
uc
,
ul
;

502  
uc
 = 0; uc < 5; uc ++ )

505 
	`PC_Ußπ
("please input char\r\n");

506 
ul
 = 
	`°æí
 ( 
cSåI≈ut
 );

508 
	`ESP8266_SídSåög
 ( 
DISABLE
, 
cSåI≈ut
, 
ul
, ( 
ENUM_ID_NO_Ty≥Def
 ) 
uc
 );

512 
	}
}

521 
	$ESP8266_STA_TCP_Clõ¡
 ( )

523 
cSåI≈ut
 [100] = "AIYA,aiya9999" , * 
pSåDñimôî
 [2], * 
pBuf
, * 
pSå
;

524 
u8
 
uc
 = 0;

525 
u32
 
ul
 = 0;

527 
	`ESP8266_Choo£
 ( 
ENABLE
 );

529 
	`ESP8266_AT_Te°
 ();

531 
	`ESP8266_Në_Mode_Choo£
 ( 
STA
 );

533 
	`ESP8266_L⁄gCmd
 ( "AT+CWLAP", "OK", 0, 5000 );

534 
	`dñay_ms
(50);

537 
	`PC_Ußπ
 ( "\r\nÖlease input wifiÇame\r\n" );

541 
	`PC_Ußπ
 ( "\r\n wait ...\r\n" );

543 
pBuf
 = 
cSåI≈ut
;

544 
uc
 = 0;

545  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

547 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

548 
pBuf
 = 
NULL
;

551 }  ! 
	`ESP8266_JoöAP
 ( 
pSåDñimôî
 [0],ÖStrDelimiter [1] ) );

553 
	`ESP8266_E«bÀ_Mu…ùÀId
 ( 
ENABLE
 );

557 
	`PC_Ußπ
 ( "\r\nÖlease set server\r\n" );

559 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

561 
	`PC_Ußπ
 ( "\r\n wait....\r\n" );

563 
pBuf
 = 
cSåI≈ut
;

564 
uc
 = 0;

565  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

567 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

568 
pBuf
 = 
NULL
;

571 }  ! ( 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_0
 ) &&

572 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_1
 ) &&

573 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_2
 ) &&

574 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_3
 ) &&

575 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_4
 ) ) );

577  
uc
 = 0; uc < 5; uc ++ )

580 
	`PC_Ußπ
("please input char\r\n");

581 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

583 
ul
 = 
	`°æí
 ( 
cSåI≈ut
 );

585 
	`ESP8266_SídSåög
 ( 
DISABLE
, 
cSåI≈ut
, 
ul
, ( 
ENUM_ID_NO_Ty≥Def
 ) 
uc
 );

590 
	`PC_Ußπ
 ( "\r\n«Î‘⁄Õ¯¬Áµ˜ ‘÷˙ ÷∑¢ÀÕ◊÷∑˚¥Æ\r\n" );

593 
pSå
 = 
	`ESP8266_Re˚iveSåög
 ( 
DISABLE
 );

594 
	`PC_Ußπ
 ( "%s", 
pSå
 );

597 
	}
}

607 
	$ESP8266_AP_TCP_Sîvî
 ( )

609 
cSåI≈ut
 [100] = { 0 }, * 
pSåDñimôî
 [3], * 
pBuf
, * 
pSå
;

610 
u8
 
uc
 = 0;

611 
u32
 
ul
 = 0;

613 
	`ESP8266_Choo£
 ( 
ENABLE
 );

615 
	`ESP8266_AT_Te°
 ();

617 
	`ESP8266_Në_Mode_Choo£
 ( 
AP
 );

620 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î“™¥¥Ω®µƒWiFiµƒ√˚≥∆°¢º”√‹∑Ω Ω∫Õ√‹‘ø£¨º”√‹∑Ω Ωµƒ±‡∫≈Œ™£∫\
\r\n0 = OPEN\
\r\n1 = WEP\
\r\n2 = WPA_PSK\
\r\n3 = WPA2_PSK\
\r\n4 = WPA_WPA2_PSK\
\r\n ‰»Î∏Ò ΩŒ™£∫√˚≥∆◊÷∑˚+”¢Œƒ∂∫∫≈+º”√‹∑Ω Ω±‡∫≈+”¢Œƒ∂∫∫≈+√‹‘ø◊÷∑˚+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

628 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

630 
	`PC_Ußπ
 ( "\r\n…‘µ»∆¨øÃ °≠°≠\r\n" );

632 
pBuf
 = 
cSåI≈ut
;

633 
uc
 = 0;

634  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

636 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

637 
pBuf
 = 
NULL
;

640 
	`ESP8266_BuûdAP
 ( 
pSåDñimôî
 [0],ÖStrDelimiter [2],ÖStrDelimiter [1] );

641 
	`ESP8266_Cmd
 ( "AT+RST", "OK", "ready", 2500 );

644 
	`ESP8266_E«bÀ_Mu…ùÀId
 ( 
ENABLE
 );

647 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î∑˛ŒÒ∆˜“™ø™∆Ùµƒ∂Àø⁄∫≈∫Õ≥¨ ± ±º‰£®0~28800£¨µ•Œª£∫√Î£©£¨ ‰»Î∏Ò ΩŒ™£∫∂Àø⁄∫≈◊÷∑˚+”¢Œƒ∂∫∫≈+≥¨ ± ±º‰◊÷∑˚+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

649 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

651 
	`PC_Ußπ
 ( "\r\n…‘µ»∆¨øÃ °≠°≠\r\n" );

653 
pBuf
 = 
cSåI≈ut
;

654 
uc
 = 0;

655  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

657 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

658 
pBuf
 = 
NULL
;

661 
	`ESP8266_SèπOrShutSîvî
 ( 
ENABLE
, 
pSåDñimôî
 [0],ÖStrDelimiter [1] );

666 
	`PC_Ußπ
 ( "\r\n’˝≤È—Ø±æƒ£øÈIP°≠°≠\r\n" );

667 
	`ESP8266_Cmd
 ( "AT+CIFSR", "OK", "Link", 500 );

669 
	`PC_Ußπ
 ( "\r\n«Î”√ ÷ª˙¡¨Ω”∏’≤≈¥¥Ω®µƒWiFi£¨’‚¿Ô÷ª¡¨Ω”“ª∏ˆ ÷ª˙£¨◊˜Œ™ID0£¨»ª∫Û”√ ÷ª˙Õ¯¬Áµ˜ ‘÷˙ ÷“‘TCP Client¡¨Ω”∏’≤≈ø™∆Ùµƒ∑˛ŒÒ∆˜£®AP IP£©°≠°≠\r\n" );

670 
	`dñay_ms
 ( 20000 ) ;

671 }  ! 
	`ESP8266_Cmd
 ( "AT+CIPSTATUS", "+CIPSTATUS:0", 0, 500 ) );

674 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î“™œÚ∂Àø⁄ ÷ª˙£®ID0£©∑¢ÀÕµƒ◊÷∑˚¥Æ£¨ ‰»Î∏Ò ΩŒ™£∫◊÷∑˚¥Æ£®≤ª∫¨ø’∏Ò£©+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

676 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

678 
ul
 = 
	`°æí
 ( 
cSåI≈ut
 );

680 
	`ESP8266_SídSåög
 ( 
DISABLE
, 
cSåI≈ut
, 
ul
, 
Mu…ùÀ_ID_0
 );

683 
	`PC_Ußπ
 ( "\r\n«Î‘⁄ ÷ª˙Õ¯¬Áµ˜ ‘÷˙ ÷∑¢ÀÕ◊÷∑˚¥Æ\r\n" );

686 
pSå
 = 
	`ESP8266_Re˚iveSåög
 ( 
DISABLE
 );

687 
	`PC_Ußπ
 ( "%s", 
pSå
 );

690 
	}
}

700 
	$ESP8266_SèT˝Clõ¡_ApT˝Sîvî
 ( )

702 
cSåI≈ut
 [100] = { 0 }, * 
pSåDñimôî
 [3], * 
pBuf
, * 
pSå
;

703 
u8
 
uc
 = 0;

704 
u32
 
ul
 = 0;

706 
	`ESP8266_Choo£
 ( 
ENABLE
 );

708 
	`ESP8266_AT_Te°
 ();

710 
	`ESP8266_Në_Mode_Choo£
 ( 
STA_AP
 );

713 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î“™¥¥Ω®µƒWiFiµƒ√˚≥∆°¢º”√‹∑Ω Ω∫Õ√‹‘ø£¨º”√‹∑Ω Ωµƒ±‡∫≈Œ™£∫\
\r\n0 = OPEN\
\r\n1 =WEP\
\r\n2 = WPA_PSK\
\r\n3 = WPA2_PSK\
\r\n4 = WPA_WPA2_PSK\
\r\n ‰»Î∏Ò ΩŒ™£∫√˚≥∆◊÷∑˚+”¢Œƒ∂∫∫≈+º”√‹∑Ω Ω±‡∫≈+”¢Œƒ∂∫∫≈+√‹‘ø◊÷∑˚+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

721 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

723 
	`PC_Ußπ
 ( "\r\n…‘µ»∆¨øÃ °≠°≠\r\n" );

725 
pBuf
 = 
cSåI≈ut
;

726 
uc
 = 0;

727  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

729 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

730 
pBuf
 = 
NULL
;

733 
	`ESP8266_BuûdAP
 ( 
pSåDñimôî
 [0],ÖStrDelimiter [2],ÖStrDelimiter [1] );

734 
	`ESP8266_Cmd
 ( "AT+RST", "OK", "ready", 2500 );

737 
	`ESP8266_Cmd
 ( "AT+CWLAP", "OK", 0, 5000 );

741 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î“™¡¨Ω”µƒWiFi√˚≥∆∫Õ√‹‘ø£¨ ‰»Î∏Ò ΩŒ™£∫√˚≥∆◊÷∑˚+”¢Œƒ∂∫∫≈+√‹‘ø◊÷∑˚+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

743 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

745 
	`PC_Ußπ
 ( "\r\n…‘µ»∆¨øÃ °≠°≠\r\n" );

747 
pBuf
 = 
cSåI≈ut
;

748 
uc
 = 0;

749  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

751 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

752 
pBuf
 = 
NULL
;

755 }  ! 
	`ESP8266_JoöAP
 ( 
pSåDñimôî
 [0],ÖStrDelimiter [1] ) );

758 
	`ESP8266_E«bÀ_Mu…ùÀId
 ( 
ENABLE
 );

761 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î∑˛ŒÒ∆˜“™ø™∆Ùµƒ∂Àø⁄∫≈∫Õ≥¨ ± ±º‰£®0~28800£¨µ•Œª£∫√Î£©£¨ ‰»Î∏Ò ΩŒ™£∫∂Àø⁄∫≈◊÷∑˚+”¢Œƒ∂∫∫≈+≥¨ ± ±º‰◊÷∑˚+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

763 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

765 
	`PC_Ußπ
 ( "\r\n…‘µ»∆¨øÃ °≠°≠\r\n" );

767 
pBuf
 = 
cSåI≈ut
;

768 
uc
 = 0;

769  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

771 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

772 
pBuf
 = 
NULL
;

775 
	`ESP8266_SèπOrShutSîvî
 ( 
ENABLE
, 
pSåDñimôî
 [0],ÖStrDelimiter [1] );

780 
	`PC_Ußπ
 ( "\r\n«Î‘⁄µÁƒ‘…œΩ´Õ¯¬Áµ˜ ‘÷˙ ÷“‘TCP Server¡¨Ω”Õ¯¬Á£¨≤¢ ‰»ÎµÁƒ‘µƒIP∫Õ∂Àø⁄∫≈£¨ ‰»Î∏Ò ΩŒ™£∫µÁƒ‘IP+”¢Œƒ∂∫∫≈+∂Àø⁄∫≈+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

782 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

784 
	`PC_Ußπ
 ( "\r\n…‘µ»∆¨øÃ °≠°≠\r\n" );

786 
pBuf
 = 
cSåI≈ut
;

787 
uc
 = 0;

788  ( 
pSå
 = 
	`°πok
 ( 
pBuf
, "," ) ) !
NULL
 )

790 
pSåDñimôî
 [ 
uc
 ++ ] = 
pSå
;

791 
pBuf
 = 
NULL
;

794 }  ! ( 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_0
 ) &&

795 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_1
 ) &&

796 
	`ESP8266_Lök_Sîvî
 ( 
íumTCP
, 
pSåDñimôî
 [0],ÖSåDñimôî [1], 
Mu…ùÀ_ID_2
 ) ) );

801 
	`PC_Ußπ
 ( "\r\n’˝≤È—Ø±æƒ£øÈIP£¨«∞“ª∏ˆŒ™AP IP£¨∫Û“ª∏ˆŒ™STA IP°≠°≠\r\n" );

802 
	`ESP8266_Cmd
 ( "AT+CIFSR", "OK", "Link", 500 );

804 
	`PC_Ußπ
 ( "\r\n«Î”√ ÷ª˙¡¨Ω”∏’≤≈¥¥Ω®µƒWiFi£¨’‚¿Ô÷ª¡¨Ω”“ª∏ˆ ÷ª˙£¨◊˜Œ™ID3£¨»ª∫Û”√ ÷ª˙Õ¯¬Áµ˜ ‘÷˙ ÷“‘TCP Client¡¨Ω”∏’≤≈ø™∆Ùµƒ∑˛ŒÒ∆˜£®AP IP£©°≠°≠\r\n" );

805 
	`dñay_ms
 ( 20000 ) ;

806 }  ! 
	`ESP8266_Cmd
 ( "AT+CIPSTATUS", "+CIPSTATUS:3", 0, 500 ) );

809  
uc
 = 0; uc < 3; uc ++ )

811 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î∂Àø⁄ID%d“™∑¢ÀÕµƒ◊÷∑˚¥Æ£¨ ‰»Î∏Ò ΩŒ™£∫◊÷∑˚¥Æ£®≤ª∫¨ø’∏Ò£©+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n", 
uc
 );

813 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

815 
ul
 = 
	`°æí
 ( 
cSåI≈ut
 );

817 
	`ESP8266_SídSåög
 ( 
DISABLE
, 
cSåI≈ut
, 
ul
, ( 
ENUM_ID_NO_Ty≥Def
 ) 
uc
 );

822 
	`PC_Ußπ
 ( "\r\n«Î ‰»Î“™œÚ∂Àø⁄ ÷ª˙£®ID3£©∑¢ÀÕµƒ◊÷∑˚¥Æ£¨ ‰»Î∏Ò ΩŒ™£∫◊÷∑˚¥Æ£®≤ª∫¨ø’∏Ò£©+ø’∏Ò£¨µ„ª˜∑¢ÀÕ\r\n" );

824 
	`sˇnf
 ( "%s", 
cSåI≈ut
 );

826 
ul
 = 
	`°æí
 ( 
cSåI≈ut
 );

828 
	`ESP8266_SídSåög
 ( 
DISABLE
, 
cSåI≈ut
, 
ul
, 
Mu…ùÀ_ID_3
 );

831 
	`PC_Ußπ
 ( "\r\n«Î‘⁄µÁƒ‘Õ¯¬Áµ˜ ‘÷˙ ÷ªÚ ÷ª˙Õ¯¬Áµ˜ ‘÷˙ ÷∑¢ÀÕ◊÷∑˚¥Æ°≠°≠\r\n" );

834 
pSå
 = 
	`ESP8266_Re˚iveSåög
 ( 
DISABLE
 );

835 
	`PC_Ußπ
 ( "%s", 
pSå
 );

838 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\key.c

1 
	~"°m32f10x.h
"

2 
	~"key.h
"

3 
	~"dñay.h
"

4 
	~"öãºu±Pri‹ôy.h
"

5 
	~"Àd.h
"

7 
KEYTy≥Def
 
	gKEYSåu˘uª
;

16 
	$GPIOC⁄fig
()

18 
EXTI_InôTy≥Def
 
EXTI_InôSåu˘uª
;

19 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

20 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

22 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOA
 | 
RCC_APB2Pîùh_AFIO
, 
ENABLE
);

23 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_0
;

24 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

25 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_IPD
;

26 
	`GPIO_Inô
(
GPIOA
, &
GPIO_InôSåu˘uª
);

28 
	`GPIO_EXTILöeC⁄fig
(
GPIO_P‹tSour˚GPIOA
, 
GPIO_PöSour˚0
);

29 
EXTI_InôSåu˘uª
.
EXTI_Löe
 = 
EXTI_Löe0
;

30 
EXTI_InôSåu˘uª
.
EXTI_Mode
 = 
EXTI_Mode_I¡îru±
;

31 
EXTI_InôSåu˘uª
.
EXTI_Triggî
 = 
EXTI_Triggî_Risög
;

32 
EXTI_InôSåu˘uª
.
EXTI_LöeCmd
 = 
ENABLE
;

33 
	`EXTI_Inô
(&
EXTI_InôSåu˘uª
);

35 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√l
 = 
EXTI0_IRQn
;

36 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
 = 
INTERRUPT_PRIORITY_EXIT
;

37 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lSubPri‹ôy
 = 0;

38 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lCmd
 = 
ENABLE
;

39 
	`NVIC_Inô
(&
NVIC_InôSåu˘uª
);

41 
	}
}

50 
	$EXTI0_IRQH™dÀr
()

52 
	`EXTI_CÀ¨ITPídögBô
(
EXTI_Löe0
);

53 sig√d 
p‹tBASE_TYPE
 
xHighîPri‹ôyTaskWokí
 = 
pdFALSE
;

54 
	`xSem≠h‹eGiveFromISR
–
KEYSåu˘uª
.
xSem≠h‹eKeyOn
, &
xHighîPri‹ôyTaskWokí
 );

55 
	}
}

64 
	$KeyInô
()

66 
	`GPIOC⁄fig
();

67 
	`vSem≠h‹eCª©eBö¨y
–
KEYSåu˘uª
.
xSem≠h‹eKeyOn
 );

68 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\led.c

1 
	~"°m32f10x.h
"

2 
	~"°m32f10x_ô.h
"

4 
	~"dñay.h
"

5 
	~"Àd.h
"

7 
	~"FªeRTOS.h
"

8 
	~"èsk.h
"

9 
	~"queue.h
"

10 
	~"li°.h
"

11 
	~"p‹èbÀ.h
"

12 
	~"FªeRTOSC⁄fig.h
"

13 
	~"£mphr.h
"

15 
LEDTy≥Def
 
	gLEDSåu˘uª
;

17 c⁄° 
uöt16_t
 
	gödexWave
[88] = {

36 
	$GPIOC⁄fig
()

38 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

39 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOB
 | 
RCC_APB2Pîùh_AFIO
, 
ENABLE
);

41 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_8
;

42 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

43 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

44 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

46 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_9
;

47 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

48 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

49 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

51 
	`GPIO_PöRem≠C⁄fig
(
GPIO_P¨tülRem≠_TIM3
,
ENABLE
);

52 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_5
 ;

53 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

54 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

56 
	`GPIO_PöRem≠C⁄fig
(
GPIO_Rem≠_SWJ_DißbÀ
, 
ENABLE
);

57 
	`GPIO_PöRem≠C⁄fig
(
GPIO_Rem≠_SWJ_JTAGDißbÀ
 , 
ENABLE
);

59 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

60 
	`ÀdBlue
(
OFF
);

61 
	}
}

69 
	$GªíLedBª©h
()

71 
uöt8_t
 
pwm_ödex
 ;

73 
TIM3
->
CCR2
 = 
ödexWave
[
pwm_ödex
];

74 if–++
pwm_ödex
 >= 88)

76 
pwm_ödex
=0;

78 
	}
}

86 
	$GªíLedOn
()

88 
TIM3
->
CCR2
 = 2550;

89 
	}
}

97 
	$GªíLedOff
()

99 
TIM3
->
CCR2
 = 0;

100 
	}
}

108 
	$RedLedBª©h
()

110 
u8
 
c⁄t
;

111 
uöt8_t
 
pwm_ödex
 ;

112 if(++
c⁄t
 == 3)

114 
c⁄t
 = 0;

115 
TIM4
->
CCR4
 = 
ödexWave
[
pwm_ödex
];

116 if–++
pwm_ödex
 >= 88)

118 
pwm_ödex
=0;

121 
	}
}

129 
	$RedLedOn
()

131 
TIM4
->
CCR4
 = 2550;

132 
	}
}

140 
	$RedLedOff
()

142 
TIM4
->
CCR4
 = 0;

143 
	}
}

151 
	$BlueLedBlök
()

153 if(
	`GPIO_RódOuçutD©aBô
(
GPIOB
, 
GPIO_Pö_8
))

154 
	`GPIO_Re£tBôs
(
GPIOB
, 
GPIO_Pö_8
);

156 
	`GPIO_SëBôs
(
GPIOB
, 
GPIO_Pö_8
);

157 
	}
}

165 
	$BlueLedOff
()

167 
	`GPIO_SëBôs
(
GPIOB
, 
GPIO_Pö_8
);

168 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\moto.c

1 
	~"mŸo.h
"

3 
MOTOTy≥Def
 
	gMOTOSåu˘uª
;

11 
	$SëPWM
(
öt16_t
 
mŸoPWM
)

13 if(
mŸoPWM
>
MŸoPwmMax
)

14 
mŸoPWM
 = 
MŸoPwmMax
;

16 if(
mŸoPWM
<0)

17 
mŸoPWM
 = 0;

19 
TIM2
->
CCR2
 = 
mŸoPWM
;

20 
	}
}

28 
	$Tim2Inô
()

30 
TIM_TimeBa£InôTy≥Def
 
TIM_TimeBa£Såu˘uª
;

31 
TIM_OCInôTy≥Def
 
TIM_OCInôSåu˘uª
;

32 
uöt16_t
 
PªsˇÀrVÆue
 = 0;

34 
	`RCC_APB1PîùhClockCmd
(
RCC_APB1Pîùh_TIM2
, 
ENABLE
);

36 
PªsˇÀrVÆue
 = (
uöt16_t
Ë(
Sy°emC‹eClock
 / 24000000) - 1;

38 
TIM_TimeBa£Såu˘uª
.
TIM_Pîiod
 = 999;

39 
TIM_TimeBa£Såu˘uª
.
TIM_PªsˇÀr
 = 
PªsˇÀrVÆue
;

40 
TIM_TimeBa£Såu˘uª
.
TIM_ClockDivisi⁄
 = 0;

41 
TIM_TimeBa£Såu˘uª
.
TIM_Cou¡îMode
 = 
TIM_Cou¡îMode_Up
;

42 
	`TIM_TimeBa£Inô
(
TIM2
, &
TIM_TimeBa£Såu˘uª
);

45 
TIM_OCInôSåu˘uª
.
TIM_OCMode
 = 
TIM_OCMode_PWM1
;

46 
TIM_OCInôSåu˘uª
.
TIM_OuçutSèã
 = 
TIM_OuçutSèã_E«bÀ
;

47 
TIM_OCInôSåu˘uª
.
TIM_Pul£
 = 0;

48 
TIM_OCInôSåu˘uª
.
TIM_OCPﬁ¨ôy
 = 
TIM_OCPﬁ¨ôy_High
;

50 
	`TIM_OC2Inô
(
TIM2
, &
TIM_OCInôSåu˘uª
);

51 
	`TIM_OC2PªlﬂdC⁄fig
(
TIM2
, 
TIM_OCPªlﬂd_E«bÀ
);

53 
	`TIM_ARRPªlﬂdC⁄fig
(
TIM2
, 
ENABLE
);

54 
	`TIM_Cmd
(
TIM2
, 
ENABLE
);

55 
	}
}

63 
	$GPIOInô
()

65 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

66 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOA
 , 
ENABLE
);

67 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_1
 ;

68 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

69 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

70 
	`GPIO_Inô
(
GPIOA
, &
GPIO_InôSåu˘uª
);

72 
	`Tim2Inô
();

73 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\power.c

1 
	~"°m32f10x.h
"

2 
	~"°m32f10x_ô.h
"

3 
	~<°dio.h
>

5 
	~"FªeRTOS.h
"

6 
	~"èsk.h
"

7 
	~"queue.h
"

8 
	~"li°.h
"

9 
	~"p‹èbÀ.h
"

10 
	~"FªeRTOSC⁄fig.h
"

11 
	~"£mphr.h
"

13 
	~"ußπ1.h
"

14 
	~"dñay.h
"

15 
	~"Àd.h
"

16 
	~"I2C.h
"

17 
	~"MPU9250.h
"

18 
	~"imu.h
"

19 
	~"tim.h
"

20 
	~"ADC.h
"

21 
	~"mŸo.h
"

22 
	~"bÀ.h
"

23 
	~"key.h
"

24 
	~"comm.h
"

25 
	~"powî.h
"

28 
POWERTy≥Def
 
	gPOWERSåu˘uª
;

37 
	$GPIOInô
()

40 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

41 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOB
 | 
RCC_APB2Pîùh_AFIO
 , 
ENABLE
);

42 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_12
;

43 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

44 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

45 
	`GPIO_Inô
(
GPIOB
, &
GPIO_InôSåu˘uª
);

46 
	`GPIO_SëBôs
(
GPIOB
, 
GPIO_Pö_12
);

48 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOA
 , 
ENABLE
);

50 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_11
;

51 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

52 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_IPU
;

53 
	`GPIO_Inô
(
GPIOA
, &
GPIO_InôSåu˘uª
);

55 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_12
;

56 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

57 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_IPU
;

58 
	`GPIO_Inô
(
GPIOA
, &
GPIO_InôSåu˘uª
);

60 
	`RCC_APB1PîùhClockCmd
(
RCC_APB1Pîùh_PWR
 , 
ENABLE
);

61 
	}
}

70 
	$Off
()

73 
	`BLE_EN
(
OFF
);

74 
	`BLE_BRTS
(
OFF
);

75 
	`GPIO_Re£tBôs
(
GPIOB
, 
GPIO_Pö_12
);

76 
MOTOSåu˘uª
.
	`SëPWM
(0);

77 
	`MPU6500_£tSÀïE«bÀd
(1);

78 
	`°up_dñay_ms
(500);

80 
	`PWR_WakeUpPöCmd
(
ENABLE
);

81 
	`PWR_E¡îSTANDBYMode
();

83 
	}
}

92 
	$On
()

94 
	`GPIO_SëBôs
(
GPIOB
, 
GPIO_Pö_12
);

95 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\tim.c

1 
	~"°m32f10x.h
"

2 
	~"tim.h
"

3 
	~"FªeRTOS.h
"

4 
	~"queue.h
"

5 
	~"£mphr.h
"

6 
	~"öãºu±Pri‹ôy.h
"

8 
xSem≠h‹eH™dÀ
 
	gxSem≠h‹eTimeC⁄t10ms
;

17 
	$Tim3Inô
(
u16
 
≥riod_num
)

19 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

20 
TIM_OCInôTy≥Def
 
TIM_OCInôSåu˘uª
;

21 
TIM_TimeBa£InôTy≥Def
 
TIM_TimeBa£Såu˘uª
;

22 
	`RCC_APB1PîùhClockCmd
(
RCC_APB1Pîùh_TIM3
,
ENABLE
);

23 
	`TIM_DeInô
(
TIM3
);

24 
TIM_TimeBa£Såu˘uª
.
TIM_Pîiod
 = 
≥riod_num
;

26 
TIM_TimeBa£Såu˘uª
.
TIM_PªsˇÀr
 = 72-1;

27 
TIM_TimeBa£Såu˘uª
.
TIM_ClockDivisi⁄
 = 
TIM_CKD_DIV1
;

28 
TIM_TimeBa£Såu˘uª
.
TIM_Cou¡îMode
 = 
TIM_Cou¡îMode_Up
;

29 
	`TIM_TimeBa£Inô
(
TIM3
,&
TIM_TimeBa£Såu˘uª
);

30 
	`TIM_CÀ¨Fœg
(
TIM3
,
TIM_FLAG_Upd©e
);

33 
TIM_OCInôSåu˘uª
.
TIM_OCMode
 = 
TIM_OCMode_PWM1
;

34 
TIM_OCInôSåu˘uª
.
TIM_OuçutSèã
 = 
TIM_OuçutSèã_E«bÀ
;

35 
TIM_OCInôSåu˘uª
.
TIM_Pul£
 = 0;

36 
TIM_OCInôSåu˘uª
.
TIM_OCPﬁ¨ôy
 = 
TIM_OCPﬁ¨ôy_Low
;

37 
	`TIM_OC2Inô
(
TIM3
, &
TIM_OCInôSåu˘uª
);

38 
	`TIM_OC2PªlﬂdC⁄fig
(
TIM3
, 
TIM_OCPªlﬂd_E«bÀ
);

39 
	`TIM_ARRPªlﬂdC⁄fig
(
TIM3
, 
ENABLE
);

41 
	`TIM_Cmd
(
TIM3
,
ENABLE
);

42 
	}
}

52 
	$Tim4Inô
(
u16
 
≥riod_num
)

54 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

55 
TIM_OCInôTy≥Def
 
TIM_OCInôSåu˘uª
;

56 
TIM_TimeBa£InôTy≥Def
 
TIM_TimeBa£Såu˘uª
;

57 
	`RCC_APB1PîùhClockCmd
(
RCC_APB1Pîùh_TIM4
,
ENABLE
);

59 
	`TIM_DeInô
(
TIM4
);

60 
TIM_TimeBa£Såu˘uª
.
TIM_Pîiod
 = 
≥riod_num
;

62 
TIM_TimeBa£Såu˘uª
.
TIM_PªsˇÀr
 = 72-1;

63 
TIM_TimeBa£Såu˘uª
.
TIM_ClockDivisi⁄
 = 
TIM_CKD_DIV1
;

64 
TIM_TimeBa£Såu˘uª
.
TIM_Cou¡îMode
 = 
TIM_Cou¡îMode_Up
;

65 
	`TIM_TimeBa£Inô
(
TIM4
,&
TIM_TimeBa£Såu˘uª
);

66 
	`TIM_CÀ¨Fœg
(
TIM4
,
TIM_FLAG_Upd©e
);

68 
TIM_OCInôSåu˘uª
.
TIM_OCMode
 = 
TIM_OCMode_PWM1
;

69 
TIM_OCInôSåu˘uª
.
TIM_OuçutSèã
 = 
TIM_OuçutSèã_E«bÀ
;

70 
TIM_OCInôSåu˘uª
.
TIM_Pul£
 = 0;

71 
TIM_OCInôSåu˘uª
.
TIM_OCPﬁ¨ôy
 = 
TIM_OCPﬁ¨ôy_Low
;

72 
	`TIM_OC4Inô
(
TIM4
, &
TIM_OCInôSåu˘uª
);

73 
	`TIM_OC4PªlﬂdC⁄fig
(
TIM4
, 
TIM_OCPªlﬂd_E«bÀ
);

74 
	`TIM_ARRPªlﬂdC⁄fig
(
TIM4
, 
ENABLE
);

76 
	`TIM_Cmd
(
TIM4
,
ENABLE
);

78 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\usart2.c

1 
	~"FªeRTOS.h
"

2 
	~"queue.h
"

3 
	~"£mphr.h
"

5 
	~"°m32f10x.h
"

6 
	~<°dio.h
>

8 
	~"bÀ.h
"

9 
	~"ußπ2.h
"

11 
Ußπ2Ty≥Def
 
	gUßπ2Såu˘uª
;

19 
	$DMATxC⁄fig
(
u8
 * 
pUßπ2TxBuff
 )

21 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

22 
DMA_InôTy≥Def
 
DMA_InôSåu˘uª
;

23 
	`RCC_AHBPîùhClockCmd
(
RCC_AHBPîùh_DMA1
, 
ENABLE
);

24 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
DISABLE
);

25 
DMA_InôSåu˘uª
.
DMA_PîùhîÆBa£Addr
 = (
u32
)(&
USART2
->
DR
);

26 
DMA_InôSåu˘uª
.
DMA_Mem‹yBa£Addr
 = (
u32
)
pUßπ2TxBuff
;

27 
DMA_InôSåu˘uª
.
DMA_DIR
 = 
DMA_DIR_PîùhîÆDST
;

28 
DMA_InôSåu˘uª
.
DMA_Buf„rSize
 = 0;

29 
DMA_InôSåu˘uª
.
DMA_PîùhîÆInc
 = 
DMA_PîùhîÆInc_DißbÀ
;

30 
DMA_InôSåu˘uª
.
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_E«bÀ
;

31 
DMA_InôSåu˘uª
.
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_Byã
;

32 
DMA_InôSåu˘uª
.
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_Byã
;

33 
DMA_InôSåu˘uª
.
DMA_Mode
 = 
DMA_Mode_N‹mÆ
 ;

34 
DMA_InôSåu˘uª
.
DMA_Pri‹ôy
 = 
DMA_Pri‹ôy_High
;

35 
DMA_InôSåu˘uª
.
DMA_M2M
 = 
DMA_M2M_DißbÀ
;

36 
	`DMA_Inô
(
DMA1_Ch™√l7
, &
DMA_InôSåu˘uª
);

38 
	`DMA_CÀ¨Fœg
(
DMA1_FLAG_GL7
);

39 
	`DMA_Cmd
 (
DMA1_Ch™√l7
,
DISABLE
);

41 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√l
 = 
DMA1_Ch™√l7_IRQn
;

42 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
 = 
INTERRUPT_PRIORITY_DMA1_Ch™√l7
;

43 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lSubPri‹ôy
 = 2;

44 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lCmd
 = 
ENABLE
;

45 
	`NVIC_Inô
–&
NVIC_InôSåu˘uª
 );

47 
	`DMA_ITC⁄fig
(
DMA1_Ch™√l7
, 
DMA_IT_TC
, 
ENABLE
);

48 
	}
}

56 
	$DMARxC⁄fig
(
u8
 * 
pUßπ2RxBuff
 )

58 
DMA_InôTy≥Def
 
DMA_InôSåu˘uª
;

59 
	`RCC_AHBPîùhClockCmd
(
RCC_AHBPîùh_DMA1
, 
ENABLE
);

60 
	`DMA_Cmd
(
DMA1_Ch™√l6
, 
DISABLE
);

61 
DMA_InôSåu˘uª
.
DMA_PîùhîÆBa£Addr
 = (
u32
)(&
USART2
->
DR
);

62 
DMA_InôSåu˘uª
.
DMA_Mem‹yBa£Addr
 = (
u32
)
pUßπ2RxBuff
;

63 
DMA_InôSåu˘uª
.
DMA_DIR
 = 
DMA_DIR_PîùhîÆSRC
;

64 
DMA_InôSåu˘uª
.
DMA_Buf„rSize
 = 
Ußπ2Re˚võBuffLígth
;

65 
DMA_InôSåu˘uª
.
DMA_PîùhîÆInc
 = 
DMA_PîùhîÆInc_DißbÀ
;

66 
DMA_InôSåu˘uª
.
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_E«bÀ
;

67 
DMA_InôSåu˘uª
.
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_Byã
;

68 
DMA_InôSåu˘uª
.
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_Byã
;

69 
DMA_InôSåu˘uª
.
DMA_Mode
 = 
DMA_Mode_N‹mÆ
 ;

70 
DMA_InôSåu˘uª
.
DMA_Pri‹ôy
 = 
DMA_Pri‹ôy_VîyHigh
;

71 
DMA_InôSåu˘uª
.
DMA_M2M
 = 
DMA_M2M_DißbÀ
;

72 
	`DMA_Inô
(
DMA1_Ch™√l6
, &
DMA_InôSåu˘uª
);

73 
	`DMA_CÀ¨Fœg
(
DMA1_FLAG_GL6
);

74 
	`DMA_Cmd
 (
DMA1_Ch™√l6
,
ENABLE
);

76 
	}
}

84 
	$DMA1_Ch™√l7_IRQH™dÀr
()

86 sig√d 
p‹tBASE_TYPE
 
xHighîPri‹ôyTaskWokí
;

87 
xHighîPri‹ôyTaskWokí
 = 
pdFALSE
;

88 if(
	`DMA_GëITSètus
(
DMA1_FLAG_TC7
))

90 
	`DMA_CÀ¨Fœg
(
DMA1_FLAG_GL7
);

91 
	`DMA_Cmd
(
DMA1_Ch™√l7
, 
DISABLE
);

92 
	`xSem≠h‹eGiveFromISR
–
xSem≠h‹eBLESídOvî
, &
xHighîPri‹ôyTaskWokí
 );

94 
	}
}

103 
	$USART2_IRQH™dÀr
()

105 sig√d 
p‹tBASE_TYPE
 
xHighîPri‹ôyTaskWokí
;

106 
xHighîPri‹ôyTaskWokí
 = 
pdFALSE
;

107 if(
	`USART_GëITSètus
(
USART2
, 
USART_IT_IDLE
Ë!
RESET
)

109 
	`DMA_Cmd
(
DMA1_Ch™√l6
, 
DISABLE
);

110 
	`DMA_CÀ¨Fœg
–
DMA1_FLAG_GL6
 );

111 
BLERe˚iveBuff
.
Àngth
 = 
Ußπ2Re˚võBuffLígth
 - 
	`DMA_GëCuºD©aCou¡î
(
DMA1_Ch™√l6
);

112 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l6
,
BÀRe˚võBuffLígth
);

113 
	`DMA_Cmd
(
DMA1_Ch™√l6
, 
ENABLE
);

114 
	`USART_Re˚iveD©a
–
USART2
 );

115 
	`xSem≠h‹eGiveFromISR
–
xSem≠h‹eBLERódFuŒ
, &
xHighîPri‹ôyTaskWokí
 );

117 
	}
}

125 
	$Ußπ2Inô
–
baud
)

127 
USART_InôTy≥Def
 
USART_InôSåu˘uª
;

128 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

129 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

131 
	`RCC_APB1PîùhClockCmd
(
RCC_APB1Pîùh_USART2
, 
ENABLE
);

132 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOA
,
ENABLE
);

133 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_3
;

134 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_IN_FLOATING
;

135 
	`GPIO_Inô
–
GPIOA
, &
GPIO_InôSåu˘uª
 );

137 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_2
;

138 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

139 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

140 
	`GPIO_Inô
–
GPIOA
, &
GPIO_InôSåu˘uª
 );

142 
USART_InôSåu˘uª
.
USART_BaudR©e
 = 
baud
;

143 
USART_InôSåu˘uª
.
USART_W‹dLígth
 = 
USART_W‹dLígth_8b
;

144 
USART_InôSåu˘uª
.
USART_St›Bôs
 = 
USART_St›Bôs_1
;

145 
USART_InôSåu˘uª
.
USART_P¨ôy
 = 
USART_P¨ôy_No
 ;

146 
USART_InôSåu˘uª
.
USART_H¨dw¨eFlowC⁄åﬁ
 = 
USART_H¨dw¨eFlowC⁄åﬁ_N⁄e
;

147 
USART_InôSåu˘uª
.
USART_Mode
 = 
USART_Mode_Rx
 | 
USART_Mode_Tx
;

148 
	`USART_Inô
–
USART2
, &
USART_InôSåu˘uª
 );

150 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√l
 = 
USART2_IRQn
;

151 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
 = 
INTERRUPT_PRIORITY_USART2_RX
;

152 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lSubPri‹ôy
 = 2;

153 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lCmd
 = 
ENABLE
;

154 
	`NVIC_Inô
–&
NVIC_InôSåu˘uª
 );

156 
	`USART_ITC⁄fig
(
USART2
, 
USART_IT_IDLE
, 
ENABLE
);

158 
	`USART_Cmd
–
USART2
, 
ENABLE
 );

159 
	`DMATxC⁄fig
(
Ußπ2Såu˘uª
.
Ußπ2SídBuff
.
d©a
);

160 
	`DMARxC⁄fig
(
Ußπ2Såu˘uª
.
Ußπ2Re˚võBuff
.
d©a
);

161 
	`USART_DMACmd
(
USART2
, 
USART_DMAReq_Tx
, 
ENABLE
);

162 
	`USART_DMACmd
(
USART2
, 
USART_DMAReq_Rx
, 
ENABLE
);

164 
	`vSem≠h‹eCª©eBö¨y
–
Ußπ2Såu˘uª
.
xSem≠h‹eBLERódFuŒ
 );

165 
	`vSem≠h‹eCª©eBö¨y
–
Ußπ2Såu˘uª
.
xSem≠h‹eBLESídOvî
 );

166 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\usart3.c

6 
	~"FªeRTOS.h
"

7 
	~"queue.h
"

8 
	~"£mphr.h
"

11 
	~"°m32f10x.h
"

12 
	~<°dio.h
>

15 
	~"bÀ.h
"

16 
	~"imu.h
"

17 
	~"Àd.h
"

18 
	~"öãºu±Pri‹ôy.h
"

19 
	~"ADC.h
"

20 
	~<°d¨g.h
>

21 
	~"ußπ3.h
"

22 
	~"e•8266.h
"

25 
Ußπ3Ty≥Def
 
	gUßπ3Såu˘uª
;

33 
	$DMATxC⁄fig
(
u8
 * 
pUßπ3TxBuff
 )

35 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

36 
DMA_InôTy≥Def
 
DMA_InôSåu˘uª
;

37 
	`RCC_AHBPîùhClockCmd
(
RCC_AHBPîùh_DMA1
, 
ENABLE
);

38 
	`DMA_Cmd
(
DMA1_Ch™√l2
, 
DISABLE
);

39 
DMA_InôSåu˘uª
.
DMA_PîùhîÆBa£Addr
 = (
u32
)(&
USART3
->
DR
);

40 
DMA_InôSåu˘uª
.
DMA_Mem‹yBa£Addr
 = (
u32
)
pUßπ3TxBuff
;

41 
DMA_InôSåu˘uª
.
DMA_DIR
 = 
DMA_DIR_PîùhîÆDST
;

42 
DMA_InôSåu˘uª
.
DMA_Buf„rSize
 = 0;

43 
DMA_InôSåu˘uª
.
DMA_PîùhîÆInc
 = 
DMA_PîùhîÆInc_DißbÀ
;

44 
DMA_InôSåu˘uª
.
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_E«bÀ
;

45 
DMA_InôSåu˘uª
.
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_Byã
;

46 
DMA_InôSåu˘uª
.
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_Byã
;

47 
DMA_InôSåu˘uª
.
DMA_Mode
 = 
DMA_Mode_N‹mÆ
;

48 
DMA_InôSåu˘uª
.
DMA_Pri‹ôy
 = 
DMA_Pri‹ôy_High
;

49 
DMA_InôSåu˘uª
.
DMA_M2M
 = 
DMA_M2M_DißbÀ
;

50 
	`DMA_Inô
(
DMA1_Ch™√l2
, &
DMA_InôSåu˘uª
);

52 
	`DMA_CÀ¨Fœg
(
DMA1_FLAG_GL2
);

53 
	`DMA_Cmd
 (
DMA1_Ch™√l2
,
DISABLE
);

55 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√l
 = 
DMA1_Ch™√l2_IRQn
;

56 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
 = 
INTERRUPT_PRIORITY_DMA1_Ch™√l2
;

57 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lSubPri‹ôy
 = 2;

58 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lCmd
 = 
ENABLE
;

59 
	`NVIC_Inô
–&
NVIC_InôSåu˘uª
 );

61 
	`DMA_ITC⁄fig
(
DMA1_Ch™√l2
, 
DMA_IT_TC
, 
ENABLE
);

62 
	}
}

70 
	$DMARxC⁄fig
(
u8
 * 
pUßπ3RxBuff
 )

72 
DMA_InôTy≥Def
 
DMA_InôSåu˘uª
;

73 
	`RCC_AHBPîùhClockCmd
(
RCC_AHBPîùh_DMA1
, 
ENABLE
);

74 
	`DMA_Cmd
(
DMA1_Ch™√l3
, 
DISABLE
);

75 
DMA_InôSåu˘uª
.
DMA_PîùhîÆBa£Addr
 = (
u32
)(&
USART3
->
DR
);

76 
DMA_InôSåu˘uª
.
DMA_Mem‹yBa£Addr
 = (
u32
)
pUßπ3RxBuff
;

77 
DMA_InôSåu˘uª
.
DMA_DIR
 = 
DMA_DIR_PîùhîÆSRC
;

78 
DMA_InôSåu˘uª
.
DMA_Buf„rSize
 = 
Ußπ3Re˚võBuffLígth
;

79 
DMA_InôSåu˘uª
.
DMA_PîùhîÆInc
 = 
DMA_PîùhîÆInc_DißbÀ
;

80 
DMA_InôSåu˘uª
.
DMA_Mem‹yInc
 = 
DMA_Mem‹yInc_E«bÀ
;

81 
DMA_InôSåu˘uª
.
DMA_PîùhîÆD©aSize
 = 
DMA_PîùhîÆD©aSize_Byã
;

82 
DMA_InôSåu˘uª
.
DMA_Mem‹yD©aSize
 = 
DMA_Mem‹yD©aSize_Byã
;

83 
DMA_InôSåu˘uª
.
DMA_Mode
 = 
DMA_Mode_N‹mÆ
 ;

84 
DMA_InôSåu˘uª
.
DMA_Pri‹ôy
 = 
DMA_Pri‹ôy_VîyHigh
;

85 
DMA_InôSåu˘uª
.
DMA_M2M
 = 
DMA_M2M_DißbÀ
;

86 
	`DMA_Inô
(
DMA1_Ch™√l3
, &
DMA_InôSåu˘uª
);

87 
	`DMA_CÀ¨Fœg
(
DMA1_FLAG_GL3
);

88 
	`DMA_Cmd
 (
DMA1_Ch™√l3
,
ENABLE
);

90 
	}
}

98 
	$DMA1_Ch™√l2_IRQH™dÀr
()

100 sig√d 
p‹tBASE_TYPE
 
xHighîPri‹ôyTaskWokí
;

101 
xHighîPri‹ôyTaskWokí
 = 
pdFALSE
;

102 if(
	`DMA_GëITSètus
(
DMA1_FLAG_TC2
))

104 
	`DMA_CÀ¨Fœg
(
DMA1_FLAG_GL2
);

105 
	`DMA_Cmd
(
DMA1_Ch™√l2
, 
DISABLE
);

106 
	`xSem≠h‹eGiveFromISR
–
Ußπ3Såu˘uª
.
xSem≠h‹eUßπ3SídOvî
, &
xHighîPri‹ôyTaskWokí
 );

108 
	}
}

117 
	$USART3_IRQH™dÀr
()

119 sig√d 
p‹tBASE_TYPE
 
xHighîPri‹ôyTaskWokí
;

120 
xHighîPri‹ôyTaskWokí
 = 
pdFALSE
;

121 if(
	`USART_GëITSètus
(
USART3
, 
USART_IT_IDLE
Ë!
RESET
)

123 
	`DMA_Cmd
(
DMA1_Ch™√l3
, 
DISABLE
);

124 
	`DMA_CÀ¨Fœg
–
DMA1_FLAG_GL3
 );

125 
Ußπ3Såu˘uª
.
Ußπ3Re˚võBuff
.
Àngth
 = 
Ußπ3Re˚võBuffLígth
 - 
	`DMA_GëCuºD©aCou¡î
(
DMA1_Ch™√l3
);

126 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l3
,
Ußπ3Re˚võBuffLígth
);

127 
	`DMA_Cmd
(
DMA1_Ch™√l3
, 
ENABLE
);

128 
	`USART_Re˚iveD©a
–
USART3
 );

129 
	`xSem≠h‹eGiveFromISR
–
Ußπ3Såu˘uª
.
xSem≠h‹eUßπ3RódFuŒ
, &
xHighîPri‹ôyTaskWokí
 );

131 
	}
}

139 
	$Ußπ3Inô
–
baud
)

141 
USART_InôTy≥Def
 
USART_InôSåu˘uª
;

142 
NVIC_InôTy≥Def
 
NVIC_InôSåu˘uª
;

143 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

146 
	`RCC_APB1PîùhClockCmd
(
RCC_APB1Pîùh_USART3
, 
ENABLE
);

147 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOB
,
ENABLE
);

150 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_11
;

151 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_IN_FLOATING
;

152 
	`GPIO_Inô
–
GPIOB
, &
GPIO_InôSåu˘uª
 );

155 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_10
;

156 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

157 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

158 
	`GPIO_Inô
–
GPIOB
, &
GPIO_InôSåu˘uª
 );

160 
USART_InôSåu˘uª
.
USART_BaudR©e
 = 
baud
;

161 
USART_InôSåu˘uª
.
USART_W‹dLígth
 = 
USART_W‹dLígth_8b
;

162 
USART_InôSåu˘uª
.
USART_St›Bôs
 = 
USART_St›Bôs_1
;

163 
USART_InôSåu˘uª
.
USART_P¨ôy
 = 
USART_P¨ôy_No
 ;

164 
USART_InôSåu˘uª
.
USART_H¨dw¨eFlowC⁄åﬁ
 = 
USART_H¨dw¨eFlowC⁄åﬁ_N⁄e
;

165 
USART_InôSåu˘uª
.
USART_Mode
 = 
USART_Mode_Rx
 | 
USART_Mode_Tx
;

166 
	`USART_Inô
–
USART2
, &
USART_InôSåu˘uª
 );

168 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√l
 = 
USART3_IRQn
;

169 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lPªem±i⁄Pri‹ôy
 = 
INTERRUPT_PRIORITY_USART3
;

170 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lSubPri‹ôy
 = 2;

171 
NVIC_InôSåu˘uª
.
NVIC_IRQCh™√lCmd
 = 
ENABLE
;

172 
	`NVIC_Inô
–&
NVIC_InôSåu˘uª
 );

174 
	`USART_ITC⁄fig
(
USART3
, 
USART_IT_IDLE
, 
ENABLE
);

176 
	`USART_Cmd
–
USART3
, 
ENABLE
 );

177 
	`DMATxC⁄fig
(
Ußπ3Såu˘uª
.
Ußπ3SídBuff
.
d©a
);

178 
	`DMARxC⁄fig
(
Ußπ3Såu˘uª
.
Ußπ3Re˚võBuff
.
d©a
);

179 
	`USART_DMACmd
(
USART3
, 
USART_DMAReq_Tx
, 
ENABLE
);

180 
	`USART_DMACmd
(
USART3
, 
USART_DMAReq_Rx
, 
ENABLE
);

182 
	`vSem≠h‹eCª©eBö¨y
–
Ußπ3Såu˘uª
.
xSem≠h‹eUßπ3RódFuŒ
 );

183 
	`vSem≠h‹eCª©eBö¨y
–
Ußπ3Såu˘uª
.
xSem≠h‹eUßπ3SídOvî
 );

184 
	}
}

193 *
	$ôﬂ
–
vÆue
, *
°rög
, 
ødix
 )

195 
i
, 
d
;

196 
Êag
 = 0;

197 *
±r
 = 
°rög
;

200 i‡(
ødix
 != 10)

202 *
±r
 = 0;

203  
°rög
;

206 i‡(!
vÆue
)

208 *
±r
++ = 0x30;

209 *
±r
 = 0;

210  
°rög
;

214 i‡(
vÆue
 < 0)

216 *
±r
++ = '-';

219 
vÆue
 *= -1;

222 
i
 = 10000; i > 0; i /= 10)

224 
d
 = 
vÆue
 / 
i
;

226 i‡(
d
 || 
Êag
)

228 *
±r
++ = ()(
d
 + 0x30);

229 
vÆue
 -(
d
 * 
i
);

230 
Êag
 = 1;

235 *
±r
 = 0;

237  
°rög
;

239 
	}
}

243 
	$USART3Prötf
–
USART_Ty≥Def
* 
USARTx
, *
D©a
, ... )

245 c⁄° *
s
;

246 
d
;

247 
buf
[16];

248 * 
pBuff
;

249 
pBuff
 = 
°rE•8266_Føm_Rec‹d
.
D©a_TX_BUF
;

250 
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømLígth
 = 0;

251 
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømFöishFœg
 = 0;

252 
va_li°
 
≠
;

253 
	`va_°¨t
(
≠
, 
D©a
);

256  *
D©a
 != 0)

258 i‡–*
D©a
 == 0x5c )

260  *++
D©a
 )

263 *
pBuff
++ = 0x0d;

264 
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømLígth
 ++;

265 
D©a
 ++;

269 *
pBuff
++ = 0x0a;

270 
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømLígth
 ++;

271 
D©a
 ++;

275 
D©a
 ++;

279 i‡–*
D©a
 == '%')

281  *++
D©a
 )

284 
s
 = 
	`va_¨g
(
≠
, const *);

285  ; *
s
; s++)

287 *
pBuff
++ = *
s
;

288 
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømLígth
 ++;

290 
D©a
++;

294 
d
 = 
	`va_¨g
(
≠
, );

295 
	`ôﬂ
(
d
, 
buf
, 10);

296 
s
 = 
buf
; *s; s++)

298 *
pBuff
++ = *
s
;

299 
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømLígth
 ++;

301 
D©a
++;

304 
D©a
++;

310 *
pBuff
++ = *
D©a
++;

311 
Ußπ3Såu˘uª
.
Ußπ3SídBuff
.
Àngth
++;

315 if(
pdTRUE
 =
	`xSem≠h‹eTake
–
Ußπ3Såu˘uª
.
xSem≠h‹eUßπ3SídOvî
, ( 
p‹tTickTy≥
 ) 
p‹tMAX_DELAY
 ))

317 
	`DMA_SëCuºD©aCou¡î
(
DMA1_Ch™√l2
,
°rE•8266_Føm_Rec‹d
.
InfTxBô
.
FømLígth
);

318 
	`DMA_Cmd
(
DMA1_Ch™√l2
, 
ENABLE
);

320 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\HAL\w25q256.c

1 
	~"w25Q256.h
"

3 
FœshTy≥Def
 
	gFœshSåu˘uª
;

12 
	$FœshInô
()

14 
SPI_InôTy≥Def
 
SPI_InôSåu˘uª
;

15 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

17 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_GPIOA
 | 
RCC_APB2Pîùh_AFIO
, 
ENABLE
);

20 
	`RCC_APB2PîùhClockCmd
(
RCC_APB2Pîùh_SPI1
, 
ENABLE
);

23 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_5
 | 
GPIO_Pö_6
 | 
GPIO_Pö_7
;

24 
GPIO_InôSåu˘uª
.
GPIO_S≥ed
 = 
GPIO_S≥ed_50MHz
;

25 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

26 
	`GPIO_Inô
(
GPIOA
, &
GPIO_InôSåu˘uª
);

29 
GPIO_InôSåu˘uª
.
GPIO_Pö
 = 
GPIO_Pö_4
;

30 
GPIO_InôSåu˘uª
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

31 
	`GPIO_Inô
(
GPIOA
, &
GPIO_InôSåu˘uª
);

33 
	`SPI_FLASH_CS_HIGH
();

37 
SPI_InôSåu˘uª
.
SPI_Dúe˘i⁄
 = 
SPI_Dúe˘i⁄_2Löes_FuŒDu∂ex
;

38 
SPI_InôSåu˘uª
.
SPI_Mode
 = 
SPI_Mode_Ma°î
;

39 
SPI_InôSåu˘uª
.
SPI_D©aSize
 = 
SPI_D©aSize_8b
;

40 
SPI_InôSåu˘uª
.
SPI_CPOL
 = 
SPI_CPOL_High
;

41 
SPI_InôSåu˘uª
.
SPI_CPHA
 = 
SPI_CPHA_2Edge
;

42 
SPI_InôSåu˘uª
.
SPI_NSS
 = 
SPI_NSS_So·
;

43 
SPI_InôSåu˘uª
.
SPI_BaudR©ePªsˇÀr
 = 
SPI_BaudR©ePªsˇÀr_4
;

44 
SPI_InôSåu˘uª
.
SPI_Fú°Bô
 = 
SPI_Fú°Bô_MSB
;

45 
SPI_InôSåu˘uª
.
SPI_CRCPﬁynomül
 = 7;

46 
	`SPI_Inô
(
SPI1
, &
SPI_InôSåu˘uª
);

48 
	`SPI_Cmd
(
SPI1
, 
ENABLE
);

49 
	}
}

59 
u8
 
	$SídByã
(
u8
 
byã
)

62 
	`SPI_I2S_GëFœgSètus
(
SPI1
, 
SPI_I2S_FLAG_TXE
Ë=
RESET
);

65 
	`SPI_I2S_SídD©a
(
SPI1
, 
byã
);

68 
	`SPI_I2S_GëFœgSètus
(
SPI1
, 
SPI_I2S_FLAG_RXNE
Ë=
RESET
);

71  
	`SPI_I2S_Re˚iveD©a
(
SPI1
);

72 
	}
}

83 
u8
 
	$RódByã
()

85  (
	`SídByã
(
Dummy_Byã
));

86 
	}
}

95 
	$WrôeE«bÀ
()

98 
	`SPI_FLASH_CS_LOW
();

100 
	`SídByã
(
W25X_WrôeE«bÀ
);

102 
	`SPI_FLASH_CS_HIGH
();

103 
	}
}

114 
	$WaôF‹WrôeEnd
()

116 
u8
 
FLASH_Sètus
 = 0;

118 
	`SPI_FLASH_CS_LOW
();

120 
	`SídByã
(
W25X_RódSètusReg
);

126 
FLASH_Sètus
 = 
	`SídByã
(
Dummy_Byã
);

128 (
FLASH_Sètus
 & 
WIP_Fœg
Ë=
SET
);

130 
	`SPI_FLASH_CS_HIGH
();

131 
	}
}

140 
	$Se˘‹Eø£4K
(
u32
 
Se˘‹Addr
)

143 
	`WrôeE«bÀ
();

144 
	`WaôF‹WrôeEnd
();

147 
	`SPI_FLASH_CS_LOW
();

149 
	`SídByã
(0x20);

150 
	`SídByã
((
Se˘‹Addr
 & 0xFF000000) >> 24);

152 
	`SídByã
((
Se˘‹Addr
 & 0xFF0000) >> 16);

154 
	`SídByã
((
Se˘‹Addr
 & 0xFF00) >> 8);

156 
	`SídByã
(
Se˘‹Addr
 & 0xFF);

158 
	`SPI_FLASH_CS_HIGH
();

160 
	`WaôF‹WrôeEnd
();

161 
	}
}

170 
	$BlockEø£32K
(
u32
 
Se˘‹Addr
)

173 
	`WrôeE«bÀ
();

174 
	`WaôF‹WrôeEnd
();

177 
	`SPI_FLASH_CS_LOW
();

179 
	`SídByã
(0x52);

180 
	`SídByã
((
Se˘‹Addr
 & 0xFF000000) >> 24);

182 
	`SídByã
((
Se˘‹Addr
 & 0xFF0000) >> 16);

184 
	`SídByã
((
Se˘‹Addr
 & 0xFF00) >> 8);

186 
	`SídByã
(
Se˘‹Addr
 & 0xFF);

188 
	`SPI_FLASH_CS_HIGH
();

190 
	`WaôF‹WrôeEnd
();

191 
	}
}

200 
	$BlockEø£64K
(
u32
 
Se˘‹Addr
)

203 
	`WrôeE«bÀ
();

204 
	`WaôF‹WrôeEnd
();

207 
	`SPI_FLASH_CS_LOW
();

209 
	`SídByã
(0xd8);

210 
	`SídByã
((
Se˘‹Addr
 & 0xFF000000) >> 24);

212 
	`SídByã
((
Se˘‹Addr
 & 0xFF0000) >> 16);

214 
	`SídByã
((
Se˘‹Addr
 & 0xFF00) >> 8);

216 
	`SídByã
(
Se˘‹Addr
 & 0xFF);

218 
	`SPI_FLASH_CS_HIGH
();

220 
	`WaôF‹WrôeEnd
();

221 
	}
}

230 
	$ChùEø£
()

233 
	`WrôeE«bÀ
();

235 
	`SPI_FLASH_CS_LOW
();

237 
	`SídByã
(
W25X_ChùEø£
);

239 
	`SPI_FLASH_CS_HIGH
();

242 
	`WaôF‹WrôeEnd
();

243 
	}
}

258 
	$PageWrôe
(
u8
* 
pBuf„r
, 
u32
 
WrôeAddr
, 
u16
 
NumByãToWrôe
)

261 
	`WrôeE«bÀ
();

263 
	`SPI_FLASH_CS_LOW
();

265 
	`SídByã
(
W25X_PageProgøm
);

266 
	`SídByã
((
WrôeAddr
 & 0xFF000000) >> 24);

268 
	`SídByã
((
WrôeAddr
 & 0xFF0000) >> 16);

270 
	`SídByã
((
WrôeAddr
 & 0xFF00) >> 8);

272 
	`SídByã
(
WrôeAddr
 & 0xFF);

274 if(
NumByãToWrôe
 > 
SPI_FLASH_PîWrôePageSize
)

276 
NumByãToWrôe
 = 
SPI_FLASH_PîWrôePageSize
;

280 
NumByãToWrôe
--)

283 
	`SídByã
(*
pBuf„r
);

285 
pBuf„r
++;

289 
	`SPI_FLASH_CS_HIGH
();

292 
	`WaôF‹WrôeEnd
();

293 
	}
}

306 
	$Buf„rWrôe
(
u8
* 
pBuf„r
, 
u32
 
WrôeAddr
, 
u16
 
NumByãToWrôe
)

308 
u8
 
NumOfPage
 = 0, 
NumOfSögÀ
 = 0, 
Addr
 = 0, 
cou¡
 = 0, 
ãmp
 = 0;

310 
Addr
 = 
WrôeAddr
 % 
SPI_FLASH_PageSize
;

311 
cou¡
 = 
SPI_FLASH_PageSize
 - 
Addr
;

312 
NumOfPage
 = 
NumByãToWrôe
 / 
SPI_FLASH_PageSize
;

313 
NumOfSögÀ
 = 
NumByãToWrôe
 % 
SPI_FLASH_PageSize
;

315 i‡(
Addr
 == 0)

317 i‡(
NumOfPage
 == 0)

319 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
NumByãToWrôe
);

323 
NumOfPage
--)

325 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
SPI_FLASH_PageSize
);

326 
WrôeAddr
 +
SPI_FLASH_PageSize
;

327 
pBuf„r
 +
SPI_FLASH_PageSize
;

330 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
NumOfSögÀ
);

335 i‡(
NumOfPage
 == 0)

337 i‡(
NumOfSögÀ
 > 
cou¡
)

339 
ãmp
 = 
NumOfSögÀ
 - 
cou¡
;

341 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
cou¡
);

342 
WrôeAddr
 +
cou¡
;

343 
pBuf„r
 +
cou¡
;

345 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
ãmp
);

349 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
NumByãToWrôe
);

354 
NumByãToWrôe
 -
cou¡
;

355 
NumOfPage
 = 
NumByãToWrôe
 / 
SPI_FLASH_PageSize
;

356 
NumOfSögÀ
 = 
NumByãToWrôe
 % 
SPI_FLASH_PageSize
;

358 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
cou¡
);

359 
WrôeAddr
 +
cou¡
;

360 
pBuf„r
 +
cou¡
;

362 
NumOfPage
--)

364 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
SPI_FLASH_PageSize
);

365 
WrôeAddr
 +
SPI_FLASH_PageSize
;

366 
pBuf„r
 +
SPI_FLASH_PageSize
;

369 i‡(
NumOfSögÀ
 != 0)

371 
	`PageWrôe
(
pBuf„r
, 
WrôeAddr
, 
NumOfSögÀ
);

375 
	}
}

387 
	$Buf„rRód
(
u8
* 
pBuf„r
, 
u32
 
RódAddr
, 
u16
 
NumByãToRód
)

390 
	`SPI_FLASH_CS_LOW
();

393 
	`SídByã
(
W25X_RódD©a
);

394 
	`SídByã
((
RódAddr
 & 0xFF000000) >> 24);

396 
	`SídByã
((
RódAddr
 & 0xFF0000) >> 16);

398 
	`SídByã
((
RódAddr
& 0xFF00) >> 8);

400 
	`SídByã
(
RódAddr
 & 0xFF);

402 
NumByãToRód
--)

405 *
pBuf„r
 = 
	`SídByã
(
Dummy_Byã
);

407 
pBuf„r
++;

411 
	`SPI_FLASH_CS_HIGH
();

412 
	}
}

421 
u32
 
	$RódID
()

423 
u32
 
Temp
 = 0, 
Temp0
 = 0, 
Temp1
 = 0, 
Temp2
 = 0, 
Temp3
 = 0;

426 
	`SPI_FLASH_CS_LOW
();

429 
	`SídByã
(
W25X_JedecDevi˚ID
);

432 
Temp0
 = 
	`SídByã
(
Dummy_Byã
);

435 
Temp1
 = 
	`SídByã
(
Dummy_Byã
);

438 
Temp2
 = 
	`SídByã
(
Dummy_Byã
);

439 
Temp3
 = 
	`SídByã
(
Dummy_Byã
);

441 
	`SPI_FLASH_CS_HIGH
();

443 
Temp
 = (
Temp0
 << 16Ë| (
Temp1
 << 8Ë| 
Temp2
;

445  
Temp
;

446 
	}
}

455 
u32
 
	$RódDevi˚ID
()

457 
u32
 
Temp
 = 0;

459 
	`SPI_FLASH_CS_LOW
();

461 
	`SídByã
(
W25X_Devi˚ID
);

462 
	`SídByã
(
Dummy_Byã
);

463 
	`SídByã
(
Dummy_Byã
);

464 
	`SídByã
(
Dummy_Byã
);

465 
	`SídByã
(
Dummy_Byã
);

467 
Temp
 = 
	`SídByã
(
Dummy_Byã
);

469 
	`SPI_FLASH_CS_HIGH
();

470  
Temp
;

471 
	}
}

485 
	$SèπRódSequí˚
(
u32
 
RódAddr
)

488 
	`SPI_FLASH_CS_LOW
();

491 
	`SídByã
(
W25X_RódD©a
);

492 
	`SídByã
((
RódAddr
 & 0xFF000000) >> 24);

495 
	`SídByã
((
RódAddr
 & 0xFF0000) >> 16);

497 
	`SídByã
((
RódAddr
& 0xFF00) >> 8);

499 
	`SídByã
(
RódAddr
 & 0xFF);

500 
	}
}

512 
u16
 
	$SídHÆfW‹d
(
u16
 
HÆfW‹d
)

515 
	`SPI_I2S_GëFœgSètus
(
SPI1
, 
SPI_I2S_FLAG_TXE
Ë=
RESET
);

518 
	`SPI_I2S_SídD©a
(
SPI1
, 
HÆfW‹d
);

521 
	`SPI_I2S_GëFœgSètus
(
SPI1
, 
SPI_I2S_FLAG_RXNE
Ë=
RESET
);

524  
	`SPI_I2S_Re˚iveD©a
(
SPI1
);

525 
	}
}

539 
	$PowîDown
()

542 
	`SPI_FLASH_CS_LOW
();

545 
	`SídByã
(
W25X_PowîDown
);

548 
	`SPI_FLASH_CS_HIGH
();

549 
	}
}

560 
	$WAKEUP
()

563 
	`SPI_FLASH_CS_LOW
();

566 
	`SídByã
(
W25X_Rñó£PowîDown
);

569 
	`SPI_FLASH_CS_HIGH
();

570 
	}
}

579 
	$E¡î4byãAddªssMode
()

582 
	`SPI_FLASH_CS_LOW
();

585 
	`SídByã
(
W25X_íãr4ByãAddªss
);

588 
	`SPI_FLASH_CS_HIGH
();

589 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\STM32F~1.C

25 
	~"°m32f10x_ô.h
"

47 
	$NMI_H™dÀr
()

49 
	}
}

56 
	$H¨dFau…_H™dÀr
()

62 
	}
}

69 
	$MemM™age_H™dÀr
()

75 
	}
}

82 
	$BusFau…_H™dÀr
()

88 
	}
}

95 
	$UßgeFau…_H™dÀr
()

101 
	}
}

108 
	$SVC_H™dÀr
()

110 
	}
}

117 
	$DebugM⁄_H™dÀr
()

119 
	}
}

126 
	$PídSV_H™dÀr
()

128 
	}
}

135 
	$SysTick_H™dÀr
()

137 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\bleTask.c

1 
	~"bÀTask.h
"

2 
	~"maö.h
"

3 
	~"FªeRTOS.h
"

4 
	~"èsk.h
"

5 
	~"queue.h
"

6 
	~"li°.h
"

7 
	~"p‹èbÀ.h
"

8 
	~"FªeRTOSC⁄fig.h
"

9 
	~"£mphr.h
"

10 
	~"ußπ2.h
"

13 
	$vBLESídD©aTask
(*
pvP¨amëîs
)

15 
S_FLOAT_XYZ
 * 
Q_ANGLE
;

16 
p‹tTickTy≥
 
xLa°WakeTime
 = 
	`xTaskGëTickCou¡
();;

21 if–
	`xQueueRe˚ive
(
xAngÀBuffSíd
, &(
Q_ANGLE
), ( 
p‹tTickTy≥
 ) 0 ) =
pdPASS
)

23 if–
	`xSem≠h‹eTake
–
xSem≠h‹eBLESídOvî
, ( 
p‹tTickTy≥
 ) 0 ) =
pdTRUE
 )

25 
BLESåu˘uª
.
	`SídD©a
(*
Q_ANGLE
);

28 
	`vTaskDñayU¡û
–&
xLa°WakeTime
, 40/
p‹tTICK_RATE_MS
 );

30 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\imu.c

1 
	~"imu.h
"

2 
	~"MPU9250.h
"

3 
	~"m©h.h
"

4 
	~"FªeRTOS.h
"

5 
	~"queue.h
"

7 
	#RtA
 57.324841

8 
	#AtR
 0.0174533

9 
	#Acc_G
 0.0011963

10 
	#Gyro_G
 0.0609756

11 
	#Gyro_Gr
 0.0010653

12 
	#FILTER_NUM
 20

	)

14 
S_INT16_XYZ
 
	gACC_AVG
;

18 
öt16_t
 
	gACC_X_BUF
[
FILTER_NUM
],
	gACC_Y_BUF
[FILTER_NUM],
	gACC_Z_BUF
[FILTER_NUM];

20 
	$Pª∑ª_D©a
()

22 
uöt8_t
 
fûãr_˙t
=0;

23 
öt32_t
 
ãmp1
=0,
ãmp2
=0,
ãmp3
=0;

24 
uöt8_t
 
i
;

26 
	`MPU6500_Ród
();

27 
	`MPU6500_D©Ø∆
();

29 
ACC_X_BUF
[
fûãr_˙t
] = 
MPU6500_ACC_LAST
.
X
;

30 
ACC_Y_BUF
[
fûãr_˙t
] = 
MPU6500_ACC_LAST
.
Y
;

31 
ACC_Z_BUF
[
fûãr_˙t
] = 
MPU6500_ACC_LAST
.
Z
;

32 
i
=0; i<
FILTER_NUM
; i++)

34 
ãmp1
 +
ACC_X_BUF
[
i
];

35 
ãmp2
 +
ACC_Y_BUF
[
i
];

36 
ãmp3
 +
ACC_Z_BUF
[
i
];

38 
ACC_AVG
.
X
 = 
ãmp1
 / 
FILTER_NUM
;

39 
ACC_AVG
.
Y
 = 
ãmp2
 / 
FILTER_NUM
;

40 
ACC_AVG
.
Z
 = 
ãmp3
 / 
FILTER_NUM
;

41 
fûãr_˙t
++;

42 if(
fûãr_˙t
==
FILTER_NUM
) filter_cnt=0;

44 
	}
}

49 
	#Kp
 10.0f

50 
	#Ki
 0.001f

51 
	#hÆfT
 0.0025f

52 

	)

53 
	gq0
 = 1, 
	gq1
 = 0, 
	gq2
 = 0, 
	gq3
 = 0;

54 
	gexI¡
 = 0, 
	geyI¡
 = 0, 
	gezI¡
 = 0;

56 
	$Gë_Aâôude
(
S_FLOAT_XYZ
 * 
pANGLE
)

58 
gx
,
gy
,
gz
,
ax
,
ay
,
az
;

59 
gx
 = 
MPU6500_GYRO_LAST
.
X
*
Gyro_Gr
;

60 
gy
 = 
MPU6500_GYRO_LAST
.
Y
*
Gyro_Gr
;

61 
gz
 = 
MPU6500_GYRO_LAST
.
Z
*
Gyro_Gr
;

62 
ax
 = 
ACC_AVG
.
X
;

63 
ay
 = 
ACC_AVG
.
Y
;

64 
az
 = 
ACC_AVG
.
Z
;

66 
n‹m
;

68 
vx
, 
vy
, 
vz
;

69 
ex
, 
ey
, 
ez
;

72 
q0q0
 = 
q0
*q0;

73 
q0q1
 = 
q0
*
q1
;

74 
q0q2
 = 
q0
*
q2
;

76 
q1q1
 = 
q1
*q1;

78 
q1q3
 = 
q1
*
q3
;

79 
q2q2
 = 
q2
*q2;

80 
q2q3
 = 
q2
*
q3
;

81 
q3q3
 = 
q3
*q3;

83 if(
ax
*
ay
*
az
==0)

86 
n‹m
 = 
	`sqπ
(
ax
*ax + 
ay
*ay + 
az
*az);

87 
ax
 =áx /
n‹m
;

88 
ay
 =áy / 
n‹m
;

89 
az
 =áz / 
n‹m
;

92 
vx
 = 2*(
q1q3
 - 
q0q2
);

93 
vy
 = 2*(
q0q1
 + 
q2q3
);

94 
vz
 = 
q0q0
 - 
q1q1
 - 
q2q2
 + 
q3q3
 ;

97 
ex
 = (
ay
*
vz
 - 
az
*
vy
) ;

98 
ey
 = (
az
*
vx
 - 
ax
*
vz
) ;

99 
ez
 = (
ax
*
vy
 - 
ay
*
vx
) ;

101 
exI¡
 =ÉxI¡ + 
ex
 * 
Ki
;

102 
eyI¡
 =ÉyI¡ + 
ey
 * 
Ki
;

103 
ezI¡
 =ÉzI¡ + 
ez
 * 
Ki
;

106 
gx
 = gx + 
Kp
*
ex
 + 
exI¡
;

107 
gy
 = gy + 
Kp
*
ey
 + 
eyI¡
;

108 
gz
 = gz + 
Kp
*
ez
 + 
ezI¡
;

111 
q0
 = q0 + (-
q1
*
gx
 - 
q2
*
gy
 - 
q3
*
gz
)*
hÆfT
;

112 
q1
 = q1 + (
q0
*
gx
 + 
q2
*
gz
 - 
q3
*
gy
)*
hÆfT
;

113 
q2
 = q2 + (
q0
*
gy
 - 
q1
*
gz
 + 
q3
*
gx
)*
hÆfT
;

114 
q3
 = q3 + (
q0
*
gz
 + 
q1
*
gy
 - 
q2
*
gx
)*
hÆfT
;

117 
n‹m
 = 
	`sqπ
(
q0
*q0 + 
q1
*q1 + 
q2
*q2 + 
q3
*q3);

118 
q0
 = q0 / 
n‹m
;

119 
q1
 = q1 / 
n‹m
;

120 
q2
 = q2 / 
n‹m
;

121 
q3
 = q3 / 
n‹m
;

124 (*
pANGLE
).
Y
 = 
	`asö
(-2 * 
q1
 * 
q3
 + 2 * 
q0
* 
q2
)* 57.3;

125 (*
pANGLE
).
X
 = 
	`©™2
(2 * 
q2
 * 
q3
 + 2 * 
q0
 * 
q1
, -2 * q1 * q1 - 2 * q2* q2 + 1)* 57.3;

127 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\imuTask.c

1 
	~"imuTask.h
"

2 
	~"FªeRTOS.h
"

3 
	~"èsk.h
"

4 
	~"queue.h
"

5 
	~"li°.h
"

6 
	~"p‹èbÀ.h
"

7 
	~"FªeRTOSC⁄fig.h
"

8 
	~"£mphr.h
"

10 
	~"imu.h
"

11 
	~"Êash.h
"

12 
	~"comm.h
"

13 
	~"MPU9250.h
"

15 
	$vIMUTask
(*
pvP¨amëîs
)

17 
S_FLOAT_XYZ
 
Q_ANGLE
;

18 
S_FLOAT_XYZ
 *
pQ_ANGLE
;

19 
p‹tTickTy≥
 
xLa°WakeTime
 = 
	`xTaskGëTickCou¡
();;

21 
	`MPU6500_Inô
();

23 
xAngÀBuffSíd
 = 
	`xQueueCª©e
–1, ( 
p‹tBASE_TYPE
 ) (
S_FLOAT_XYZ
*) );

24 
xAngÀBuffSt‹age
 = 
	`xQueueCª©e
–1, ( 
p‹tBASE_TYPE
 ) (
S_FLOAT_XYZ
*) );

28 
pQ_ANGLE
 = &
Q_ANGLE
;

29 
	`èskENTER_CRITICAL
();

31 
	`Pª∑ª_D©a
();

32 
	`Gë_Aâôude
(&
Q_ANGLE
);

34 
	`èskEXIT_CRITICAL
();

36 
	`xQueueSíd
–
xAngÀBuffSt‹age
, (*)&
pQ_ANGLE
, ( 
p‹tTickTy≥
 ) 0 )

38 
	`xQueueSíd
–
xAngÀBuffSíd
, (*)&
pQ_ANGLE
, ( 
p‹tTickTy≥
 ) 0 )

40 
	`vTaskDñayU¡û
–&
xLa°WakeTime
, 5/
p‹tTICK_RATE_MS
 );

43 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\ledTask.c

1 
	~"ÀdTask.h
"

2 
	~"°m32f10x.h
"

3 
	~"bÀ.h
"

4 
	~"Àd.h
"

5 
	~"FªeRTOS.h
"

6 
	~"èsk.h
"

7 
	~"queue.h
"

8 
	~"li°.h
"

9 
	~"p‹èbÀ.h
"

10 
	~"FªeRTOSC⁄fig.h
"

11 
	~"£mphr.h
"

12 
	~"maö.h
"

13 
	~"mŸo.h
"

14 
	~"powî.h
"

16 
	$vLEDTask
(*
pvP¨amëîs
)

18 
u8
 
°¨tFœg
 = 0;

19 
u8
 
c⁄√˘Fri°Fœg
 = 0;

22 if(
BLESåu˘uª
.
c⁄√˘
 =
ON
 && 
c⁄√˘Fri°Fœg
 == 0)

24 
LEDSåu˘uª
.
	`GªíLedOff
();

25 
LEDSåu˘uª
.
	`RedLedOff
();

26 
u8
 
i
=0; i<10; i++)

28 
LEDSåu˘uª
.
	`BlueLedBlök
();

29 
	`vTaskDñay
–250/
p‹tTICK_RATE_MS
 );

31 
LEDSåu˘uª
.
	`BlueLedOff
();

32 
c⁄√˘Fri°Fœg
 = 1;

34 if(
POWERSåu˘uª
.
ch¨geMode
 =
noCh¨ge
 )

37 if(
c⁄åﬁSem≠h‹e
.
xKeyLedGªíC⁄åﬁ
)

39 
	`ÀdGªíBª©h
();

41 
	`ÀdGªíOn
();

46 if(
c⁄åﬁSem≠h‹e
.
ch¨gög
)

48 
	`ÀdGªíOff
();

49 
	`ÀdRedBª©h
();

52 
	`ÀdRedOff
();

55 if((
c⁄åﬁSem≠h‹e
.
b©ãrVÆue
 =
LOW
Ë&& 
°¨tFœg
 == 0)

57 
	`ÀdGªíOff
();

58 
	`ÀdBlue
(
OFF
);

59 
u8
 
i
=0; i<10; i++)

61 
	`ÀdRedOn
();

62 
	`vTaskDñay
–250/
p‹tTICK_RATE_MS
 );

63 
	`ÀdRedOff
();

64 
	`vTaskDñay
–250/
p‹tTICK_RATE_MS
 );

66 
°¨tFœg
 = 1;

68 
°¨tFœg
 = 1;

70 
	`vTaskDñay
–10/
p‹tTICK_RATE_MS
 );

73 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\main.c

1 
	~"°m32f10x.h
"

2 
	~"°m32f10x_ô.h
"

3 
	~<°dio.h
>

5 
	~"FªeRTOS.h
"

6 
	~"èsk.h
"

7 
	~"queue.h
"

8 
	~"li°.h
"

9 
	~"p‹èbÀ.h
"

10 
	~"FªeRTOSC⁄fig.h
"

11 
	~"£mphr.h
"

13 
	~"ußπ1.h
"

14 
	~"ußπ2.h
"

15 
	~"dñay.h
"

16 
	~"Àd.h
"

17 
	~"I2C.h
"

18 
	~"MPU9250.h
"

19 
	~"imu.h
"

20 
	~"tim.h
"

21 
	~"ADC.h
"

22 
	~"mŸo.h
"

23 
	~"bÀ.h
"

24 
	~"key.h
"

25 
	~"comm.h
"

26 
	~"powî.h
"

27 
	~"Êash.h
"

28 
	~"dog.h
"

29 
	~"bÀTask.h
"

30 
	~"ÀdTask.h
"

31 
	~"imuTask.h
"

32 
	~"keyTask.h
"

33 
	~"bÀRe˚iveTask.h
"

34 
	~"powîTask.h
"

35 
	~"ußπ1Task.h
"

36 
	~"w25q256.h
"

37 
	~"w25q256Task.h
"

38 
	~"mŸoTask.h
"

39 
	~"wifiTask.h
"

40 
	~"ußπ3.h
"

41 
	~"e•8266.h
"

47 
xQueueH™dÀ
 
	gxAngÀBuffSíd
;

48 
xQueueH™dÀ
 
	gxAngÀBuffSt‹age
;

51 
xTaskH™dÀ
 
	gxH™dÀ
;

52 
xSem≠h‹eH™dÀ
 
	gxSem≠h‹eBÀVSAck
;

53 
xSem≠h‹eH™dÀ
 
	gxSem≠h‹eWifi
;

54 
c⁄åﬁSem≠h‹eSåu˘
 
	gc⁄åﬁSem≠h‹e
;

55 
xTaskH™dÀ
 
	gxH™dÀWifi
;

56 
wifiC⁄figSåu˘
 
	gwifiC⁄fig
;

58 
¥vSëupH¨dw¨e
( );

62 
	$maö
()

64 
	`¥vSëupH¨dw¨e
();

67 
	`xTaskCª©e
–
vIMUTask
, ( sig√d 
p‹tCHAR
 * ) "IMU", 
c⁄figMIDMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+15, NULL );

68 
	`xTaskCª©e
–
vBLESídD©aTask
, ( sig√d 
p‹tCHAR
 * ) "BLESENDDATA", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+3, NULL );

70 
	`xTaskCª©e
–
vLEDMŸoTask
, ( sig√d 
p‹tCHAR
 * ) "LEDMOTO", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+10, NULL );

71 
	`xTaskCª©e
–
vKeyOnTask
, ( sig√d 
p‹tCHAR
 * ) "KEY", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+4, NULL );

72 
	`xTaskCª©e
–
vBLERe˚iveTask
, ( sig√d 
p‹tCHAR
 * ) "COMM", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+5, NULL );

73 
	`xTaskCª©e
–
vPowîTask
, ( sig√d 
p‹tCHAR
 * ) "POWER", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+2, NULL );

75 
	`xTaskCª©e
–
vMŸoTask
, ( sig√d 
p‹tCHAR
 * ) "MOTO", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+9, NULL );

76 
	`xTaskCª©e
–
vWifiTask
, ( sig√d 
p‹tCHAR
 * ) "WIFI", 1024, 
NULL
, 
tskIDLE_PRIORITY
+1, NULL );

79 #ifde‡
USING_USART1


80 
	`xTaskCª©e
–
vUßâ1SídAngÀTask
, ( sig√d 
p‹tCHAR
 * ) "USART1SENDANGLE", 
c⁄figMINIMAL_STACK_SIZE
, 
NULL
, 
tskIDLE_PRIORITY
+3, NULL );

83 #ifde‡
USING_BLE


87 
	`vTaskSèπScheduÀr
();

92 
	}
}

96 
	$¥vSëupH¨dw¨e
( )

98 
	`LED_GPIO_C⁄fig
();

99 
	`ADC1_Inô
();

102 
	`xSîülP‹tInôMöimÆ
( 115200, 32 );

105 #ifde‡
USING_BLE


106 
	`Ußπ2Inô
( 115200, 32 );

107 
	`BLEIOInô
();

109 
	`Ußπ3Inô
(9600);

110 
	`IIC_Inô
();

111 
	`Tim3_Inô
(5000);

112 
	`Tim4_Inô
(2500);

114 
	`MŸo_Inô
();

116 
	`powîInô
();

118 
	`SPI_FLASH_Inô
();

120 
	`SPI_Fœsh_4byãAddªss
();

122 
	`WiFi_C⁄fig
();

123 
	`NVIC_Pri‹ôyGroupC⁄fig
(
NVIC_Pri‹ôyGroup_4
);

125 
	}
}

	@E:\MYTEET~1\MYTEET~1.3\USER\main.h

1 #i‚de‡
__MAIN_H


2 
	#__MAIN_H


	)

4 
	~"°m32f10x.h
"

6 
	~"FªeRTOS.h
"

7 
	~"èsk.h
"

8 
	~"queue.h
"

9 
	~"li°.h
"

10 
	~"p‹èbÀ.h
"

11 
	~"FªeRTOSC⁄fig.h
"

12 
	~"£mphr.h
"

14 
	#LOW
 1

	)

15 
	#VERYLOW
 2

	)

19 
u8
 
	mburshSètus
;

20 
u8
 
	mch¨gög
;

21 
u8
 
	mb©ãrVÆue
;

22 
u8
 
	mbÀC⁄n˚t
;

23 
u8
 
	mxKeyLedTe°OnFœg
;

24 
u8
 
	mxKeyBÀSídD©a
;

25 
u8
 
	mxKeyLedGªíC⁄åﬁ
;

26 
u8
 
	mxKeyMŸoFœg
;

27 
	eStuès
 {
	m⁄
,
	moff
,
	mli°AP
,
	maddAP
,
	maddSîvî
,
	m£ndTe°
} 
	mwifiStuès
;

28 } 
	tc⁄åﬁSem≠h‹eSåu˘
;

31 
	mAPNamePassw‹d
[64];

32 
	m£rvîIP
[64];

33 } 
	twifiC⁄figSåu˘
;

36 
	mX
;

37 
	mY
;

38 
	mZ
;

39 } 
	tS_FLOAT_XYZ
;

43 
xQueueH™dÀ
 
xAngÀBuffSíd
;

44 
xQueueH™dÀ
 
xAngÀBuffSt‹age
;

45 
xTaskH™dÀ
 
xH™dÀ
;

46 
xSem≠h‹eH™dÀ
 
xSem≠h‹eBÀVSAck
;

47 
xSem≠h‹eH™dÀ
 
xSem≠h‹eWifi
;

49 
c⁄åﬁSem≠h‹eSåu˘
 
c⁄åﬁSem≠h‹e
;

50 
xTaskH™dÀ
 
xH™dÀWifi
;

51 
wifiC⁄figSåu˘
 
wifiC⁄fig
;

	@bleReceiveTask.h

1 #i‚de‡
_BLE_RECEIVE_TASK_H


2 
	#_BLE_RECEIVE_TASK_H


	)

5 
vBLERe˚iveTask
(*
pvP¨amëîs
);

	@bleTask.h

1 #i‚de‡
__BLE_TASK_H


2 
	#__BLE_TASK_H


	)

3 
	#USING_BLE


	)

5 #ifde‡
USING_BLE


6 
BLE_SídD©aTask
(*
pvP¨amëîs
);

	@imu.h

1 #i‚de‡
_IMU_H_


2 
	#_IMU_H_


	)

3 
	~"°m32f10x.h
"

4 
	~"FªeRTOS.h
"

5 
	~"queue.h
"

6 
	~"maö.h
"

8 
	#BYTE0
(
dwTemp
Ë(*(*)(&dwTemp))

	)

9 
	#BYTE1
(
dwTemp
Ë(*((*)(&dwTempË+ 1))

	)

10 
	#BYTE2
(
dwTemp
Ë(*((*)(&dwTempË+ 2))

	)

11 
	#BYTE3
(
dwTemp
Ë(*((*)(&dwTempË+ 3))

	)

15 
Pª∑ª_D©a
();

16 
Gë_Aâôude
(
S_FLOAT_XYZ
 * 
Q_ANGLE
);

17 sig√d 
p‹tBASE_TYPE
 
xImuPutAngÀ
–
S_FLOAT_XYZ
 
Q_ANGLE
, 
p‹tTickTy≥
 
xBlockTime
 );

	@imuTask.h

1 #i‚de‡
_IMU_TASK_H


2 
	#_IMU_TASK_H


	)

4 
vIMUTask
(*
pvP¨amëîs
);

	@interruptPriority.h

1 #i‚de‡
_INTERRUPT_PRIORITY_H


2 
	#_INTERRUPT_PRIORITY_H


	)

9 
	#INTERRUPT_PRIORITY_DMA1_Ch™√l7
 6

	)

10 
	#INTERRUPT_PRIORITY_DMA1_Ch™√l2
 6

	)

11 
	#INTERRUPT_PRIORITY_USART2_RX
 5

	)

12 
	#INTERRUPT_PRIORITY_DMA1_Ch™√l4
 6

	)

13 
	#INTERRUPT_PRIORITY_USART1_RX
 5

	)

14 
	#INTERRUPT_PRIORITY_USART3_RX
 5

	)

16 
	#INTERRUPT_PRIORITY_TIM3
 10

	)

17 
	#INTERRUPT_PRIORITY_EXIT
 2

	)

	@keyTask.h

1 #i‚de‡
_KEY_TASK_H


2 
	#_KEY_TASK_H


	)

5 
vKeyOnTask
(*
pvP¨amëîs
);

	@ledTask.h

1 #i‚de‡
__LED_TASK_H


2 
	#__LED_TASK_H


	)

4 
vLEDMŸoTask
(*
pvP¨amëîs
);

	@main.h

1 #i‚de‡
__MAIN_H


2 
	#__MAIN_H


	)

4 
	~"°m32f10x.h
"

6 
	~"FªeRTOS.h
"

7 
	~"èsk.h
"

8 
	~"queue.h
"

9 
	~"li°.h
"

10 
	~"p‹èbÀ.h
"

11 
	~"FªeRTOSC⁄fig.h
"

12 
	~"£mphr.h
"

14 
	#LOW
 1

	)

15 
	#VERYLOW
 2

	)

19 
u8
 
	mburshSètus
;

20 
u8
 
	mch¨gög
;

21 
u8
 
	mb©ãrVÆue
;

22 
u8
 
	mbÀC⁄n˚t
;

23 
u8
 
	mxKeyLedTe°OnFœg
;

24 
u8
 
	mxKeyBÀSídD©a
;

25 
u8
 
	mxKeyLedGªíC⁄åﬁ
;

26 
u8
 
	mxKeyMŸoFœg
;

27 
	eStuès
 {
	m⁄
,
	moff
,
	mli°AP
,
	maddAP
,
	maddSîvî
,
	m£ndTe°
} 
	mwifiStuès
;

28 } 
	tc⁄åﬁSem≠h‹eSåu˘
;

31 
	mAPNamePassw‹d
[64];

32 
	m£rvîIP
[64];

33 } 
	twifiC⁄figSåu˘
;

36 
	mX
;

37 
	mY
;

38 
	mZ
;

39 } 
	tS_FLOAT_XYZ
;

43 
xQueueH™dÀ
 
xAngÀBuffSíd
;

44 
xQueueH™dÀ
 
xAngÀBuffSt‹age
;

45 
xTaskH™dÀ
 
xH™dÀ
;

46 
xSem≠h‹eH™dÀ
 
xSem≠h‹eBÀVSAck
;

47 
xSem≠h‹eH™dÀ
 
xSem≠h‹eWifi
;

49 
c⁄åﬁSem≠h‹eSåu˘
 
c⁄åﬁSem≠h‹e
;

50 
xTaskH™dÀ
 
xH™dÀWifi
;

51 
wifiC⁄figSåu˘
 
wifiC⁄fig
;

	@motoTask.h

1 #i‚de‡
__MOTO_TASK_H


2 
	#__MOTO_TASK_H


	)

4 
vMŸoTask
(*
pvP¨amëîs
);

	@powerTask.h

1 #i‚de‡
_POWER_TASK_H


2 
	#_POWER_TASK_H


	)

4 
vPowîTask
(*
pvP¨amëîs
);

	@stm32f10x_it.h

23 #i‚de‡
__STM32F10x_IT_H


24 
	#__STM32F10x_IT_H


	)

26 #ifde‡
__˝lu•lus


31 
	~"°m32f10x.h
"

38 
NMI_H™dÀr
();

39 
H¨dFau…_H™dÀr
();

40 
MemM™age_H™dÀr
();

41 
BusFau…_H™dÀr
();

42 
UßgeFau…_H™dÀr
();

43 
SVC_H™dÀr
();

44 
DebugM⁄_H™dÀr
();

45 
PídSV_H™dÀr
();

46 
SysTick_H™dÀr
();

48 #ifde‡
__˝lu•lus


	@usart1Task.h

1 #i‚de‡
_USART1_TASK_H


2 
	#_USART1_TASK_H


	)

4 #ifde‡
USING_USART1


5 
vUßâ1SídAngÀTask
(*
pvP¨amëîs
);

	@w25q256Task.h

3 #i‚de‡
_W25Q256_TASK_H


4 
	#_W25Q256_TASK_H


	)

6 
	~"°m32f10x.h
"

7 
	~"°m32f10x_ô.h
"

8 
	~<°dio.h
>

10 
	~"FªeRTOS.h
"

11 
	~"èsk.h
"

12 
	~"queue.h
"

13 
	~"li°.h
"

14 
	~"p‹èbÀ.h
"

15 
	~"FªeRTOSC⁄fig.h
"

16 
	~"£mphr.h
"

18 
	~"ußπ1.h
"

19 
	~"ußπ2.h
"

20 
	~"dñay.h
"

21 
	~"Àd.h
"

22 
	~"I2C.h
"

23 
	~"MPU9250.h
"

24 
	~"imu.h
"

25 
	~"tim.h
"

26 
	~"ADC.h
"

27 
	~"mŸo.h
"

28 
	~"bÀ.h
"

29 
	~"key.h
"

30 
	~"comm.h
"

31 
	~"powî.h
"

32 
	~"Êash.h
"

33 
	~"dog.h
"

34 
	~"bÀTask.h
"

35 
	~"ÀdTask.h
"

36 
	~"imuTask.h
"

37 
	~"keyTask.h
"

38 
	~"bÀRe˚iveTask.h
"

39 
	~"powîTask.h
"

40 
	~"ußπ1Task.h
"

42 
	#burshD©aAddªssSèπ
 0x01„0000

	)

43 
	#burshD©aAddªssSèπLígth
 4

	)

45 
	#burshD©aAddªssEnd
 0x01„1000

	)

46 
	#burshD©aAddªssEndLígth
 4

	)

48 
vW25q256Task
(*
pvP¨amëîs
);

	@wifiTask.h

1 #i‚de‡
_WIFI_TASK_H


2 
	#_WIFI_TASK_H


	)

4 
vWifiTask
(*
pvP¨amëîs
);

	@
1
.
0
82
3008
E:\MYTEET~1\MYTEET~1.3\CMSIS\SYSTEM~1.C
E:\MYTEET~1\MYTEET~1.3\CMSIS\core_cm3.c
E:\MYTEET~1\MYTEET~1.3\CMSIS\startup\STFEF3~1.S
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST12DF~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST1D4B~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST508A~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST53A5~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST57C7~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST585B~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST5F15~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST7656~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST7B0D~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST866E~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\ST92BF~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STA2D5~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STB65C~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STC0DE~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STCCCA~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STF68C~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STF6A9~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STFD4F~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~1.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~2.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~3.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\STM32F~4.C
E:\MYTEET~1\MYTEET~1.3\FWlib\src\misc.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\croutine.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\heap_2.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\FREERT~1.H
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\FreeRTOS.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\MPU_WR~1.H
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\PORTMA~1.H
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\STACKM~1.H
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\croutine.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\list.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\portable.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\projdefs.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\queue.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\semphr.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\task.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\include\timers.h
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\list.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\port.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\queue.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\tasks.c
E:\MYTEET~1\MYTEET~1.3\FreeRTOS\timers.c
E:\MYTEET~1\MYTEET~1.3\HAL\ADC.c
E:\MYTEET~1\MYTEET~1.3\HAL\I2C.c
E:\MYTEET~1\MYTEET~1.3\HAL\MPU9250.c
E:\MYTEET~1\MYTEET~1.3\HAL\ble.c
E:\MYTEET~1\MYTEET~1.3\HAL\delay.c
E:\MYTEET~1\MYTEET~1.3\HAL\dog.c
E:\MYTEET~1\MYTEET~1.3\HAL\esp8266.c
E:\MYTEET~1\MYTEET~1.3\HAL\key.c
E:\MYTEET~1\MYTEET~1.3\HAL\led.c
E:\MYTEET~1\MYTEET~1.3\HAL\moto.c
E:\MYTEET~1\MYTEET~1.3\HAL\power.c
E:\MYTEET~1\MYTEET~1.3\HAL\tim.c
E:\MYTEET~1\MYTEET~1.3\HAL\usart2.c
E:\MYTEET~1\MYTEET~1.3\HAL\usart3.c
E:\MYTEET~1\MYTEET~1.3\HAL\w25q256.c
E:\MYTEET~1\MYTEET~1.3\USER\STM32F~1.C
E:\MYTEET~1\MYTEET~1.3\USER\bleTask.c
E:\MYTEET~1\MYTEET~1.3\USER\imu.c
E:\MYTEET~1\MYTEET~1.3\USER\imuTask.c
E:\MYTEET~1\MYTEET~1.3\USER\ledTask.c
E:\MYTEET~1\MYTEET~1.3\USER\main.c
E:\MYTEET~1\MYTEET~1.3\USER\main.h
bleReceiveTask.h
bleTask.h
imu.h
imuTask.h
interruptPriority.h
keyTask.h
ledTask.h
main.h
motoTask.h
powerTask.h
stm32f10x_it.h
usart1Task.h
w25q256Task.h
wifiTask.h
